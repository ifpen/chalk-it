/*! head.core - v1.0.2 */
!function(e,t){"use strict";function n(e){k[k.length]=e}function r(e){var t=new RegExp(" ?\\b"+e+"\\b");T.className=T.className.replace(t,"")}function o(e,t){for(var n=0,r=e.length;n<r;n++)t.call(e,e[n],n)}function a(){var t,r,a,s;T.className=T.className.replace(/ (w-|eq-|gt-|gte-|lt-|lte-|portrait|no-portrait|landscape|no-landscape)\d+/g,""),t=e.innerWidth||T.clientWidth,r=e.outerWidth||e.screen.width,c.screen.innerWidth=t,c.screen.outerWidth=r,n("w-"+t),o(E.screens,(function(e){t>e?(E.screensCss.gt&&n("gt-"+e),E.screensCss.gte&&n("gte-"+e)):t<e?(E.screensCss.lt&&n("lt-"+e),E.screensCss.lte&&n("lte-"+e)):t===e&&(E.screensCss.lte&&n("lte-"+e),E.screensCss.eq&&n("e-q"+e),E.screensCss.gte&&n("gte-"+e))})),a=e.innerHeight||T.clientHeight,s=e.outerHeight||e.screen.height,c.screen.innerHeight=a,c.screen.outerHeight=s,c.feature("portrait",a>t),c.feature("landscape",a<t)}function s(){e.clearTimeout(v),v=e.setTimeout(a,50)}var i,c,u,l,d,f,h,p,m,g,b,y,v,w=e.document,x=e.navigator,C=e.location,T=w.documentElement,k=[],E={screens:[240,320,480,640,768,800,1024,1280,1440,1680,1920],screensCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!1},browsers:[{ie:{min:6,max:11}}],browserCss:{gt:!0,gte:!1,lt:!0,lte:!1,eq:!0},html5:!0,page:"-page",section:"-section",head:"head"};if(e.head_conf)for(i in e.head_conf)e.head_conf[i]!==t&&(E[i]=e.head_conf[i]);switch((c=e[E.head]=function(){c.ready.apply(null,arguments)}).feature=function(e,t,o){return e?("[object Function]"===Object.prototype.toString.call(t)&&(t=t.call()),n((t?"":"no-")+e),c[e]=!!t,o||(r("no-"+e),r(e),c.feature()),c):(T.className+=" "+k.join(" "),k=[],c)},c.feature("js",!0),u=x.userAgent.toLowerCase(),l=/mobile|android|kindle|silk|midp|phone|(windows .+arm|touch)/.test(u),c.feature("mobile",l,!0),c.feature("desktop",!l,!0),d=(u=/(chrome|firefox)[ \/]([\w.]+)/.exec(u)||/(iphone|ipad|ipod)(?:.*version)?[ \/]([\w.]+)/.exec(u)||/(android)(?:.*version)?[ \/]([\w.]+)/.exec(u)||/(webkit|opera)(?:.*version)?[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||/(trident).+rv:(\w.)+/.exec(u)||[])[1],f=parseFloat(u[2]),d){case"msie":case"trident":d="ie",f=w.documentMode||f;break;case"firefox":d="ff";break;case"ipod":case"ipad":case"iphone":d="ios";break;case"webkit":d="safari"}for(c.browser={name:d,version:f},c.browser[d]=!0,h=0,p=E.browsers.length;h<p;h++)for(m in E.browsers[h])if(d===m)for(n(m),g=E.browsers[h][m].min,b=E.browsers[h][m].max,y=g;y<=b;y++)f>y?(E.browserCss.gt&&n("gt-"+m+y),E.browserCss.gte&&n("gte-"+m+y)):f<y?(E.browserCss.lt&&n("lt-"+m+y),E.browserCss.lte&&n("lte-"+m+y)):f===y&&(E.browserCss.lte&&n("lte-"+m+y),E.browserCss.eq&&n("eq-"+m+y),E.browserCss.gte&&n("gte-"+m+y));else n("no-"+m);n(d),n(d+parseInt(f,10)),E.html5&&"ie"===d&&f<9&&o("abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|progress|section|summary|time|video".split("|"),(function(e){w.createElement(e)})),o(C.pathname.split("/"),(function(e,r){if(this.length>2&&this[r+1]!==t)r&&n(this.slice(r,r+1).join("-").toLowerCase()+E.section);else{var o=e||"index",a=o.indexOf(".");a>0&&(o=o.substring(0,a)),T.id=o.toLowerCase()+E.page,r||n("root"+E.section)}})),c.screen={height:e.screen.height,width:e.screen.width},a(),v=0,e.addEventListener?e.addEventListener("resize",s,!1):e.attachEvent("onresize",s)}(window),
/*! head.css3 - v1.0.0 */
function(e,t){"use strict";function n(e){for(var t in e)if(void 0!==a[e[t]])return!0;return!1}function r(e){var t=e.charAt(0).toUpperCase()+e.substr(1);return!!n((e+" "+i.join(t+" ")+t).split(" "))}var o=e.document.createElement("i"),a=o.style,s=" -o- -moz- -ms- -webkit- -khtml- ".split(" "),i="Webkit Moz O ms Khtml".split(" "),c=e.head_conf&&e.head_conf.head||"head",u=e[c],l={gradient:function(){var e="background-image:";return a.cssText=(e+s.join("gradient(linear,left top,right bottom,from(#9f9),to(#fff));"+e)+s.join("linear-gradient(left top,#eee,#fff);"+e)).slice(0,-e.length),!!a.backgroundImage},rgba:function(){return a.cssText="background-color:rgba(0,0,0,0.5)",!!a.backgroundColor},opacity:function(){return""===o.style.opacity},textshadow:function(){return""===a.textShadow},multiplebgs:function(){a.cssText="background:url(https://),url(https://),red url(https://)";var e=(a.background||"").match(/url/g);return"[object Array]"===Object.prototype.toString.call(e)&&3===e.length},boxshadow:function(){return r("boxShadow")},borderimage:function(){return r("borderImage")},borderradius:function(){return r("borderRadius")},cssreflections:function(){return r("boxReflect")},csstransforms:function(){return r("transform")},csstransitions:function(){return r("transition")},touch:function(){return"ontouchstart"in e},retina:function(){return e.devicePixelRatio>1},fontface:function(){var e=u.browser.name,t=u.browser.version;switch(e){case"ie":return t>=9;case"chrome":return t>=13;case"ff":return t>=6;case"ios":return t>=5;case"android":return!1;case"webkit":return t>=5.1;case"opera":return t>=10;default:return!1}}};for(var d in l)l[d]&&u.feature(d,l[d].call(),!0);u.feature()}(window),
/*! head.load - v1.0.3 */
function(e,t){"use strict";function n(){}function r(e,t){if(e){"object"==typeof e&&(e=[].slice.call(e));for(var n=0,r=e.length;n<r;n++)t.call(e,e[n],n)}}function o(e,n){var r=Object.prototype.toString.call(n).slice(8,-1);return n!==t&&null!==n&&r===e}function a(e){return o("Function",e)}function s(e){return o("Array",e)}function i(e){var t=e.split("/"),n=t[t.length-1],r=n.indexOf("?");return-1!==r?n.substring(0,r):n}function c(e){(e=e||n)._done||(e(),e._done=1)}function u(e){var t,n,r={};if("object"==typeof e)for(t in e)!e[t]||(r={name:t,url:e[t]});else r={name:i(e),url:e};return(n=x[r.name])&&n.url===r.url?n:(x[r.name]=r,r)}function l(e){for(var t in e=e||x)if(e.hasOwnProperty(t)&&e[t].state!==S)return!1;return!0}function d(e){e.state===t&&(e.state=E,e.onpreload=[],h({url:e.url,type:"cache"},(function(){!function(e){e.state=L,r(e.onpreload,(function(e){e.call()}))}(e)})))}function f(e,t){t=t||n,e.state!==S?e.state!==j?e.state!==E?(e.state=j,h(e,(function(){e.state=S,t(),r(w[e.name],(function(e){c(e)})),g&&l()&&r(w.ALL,(function(e){c(e)}))}))):e.onpreload.push((function(){f(e,t)})):k.ready(e.name,t):t()}function h(t,r){function o(t){t=t||e.event,s.onload=s.onreadystatechange=s.onerror=null,r()}function a(n){("load"===(n=n||e.event).type||/loaded|complete/.test(s.readyState)&&(!y.documentMode||y.documentMode<9))&&(e.clearTimeout(t.errorTimeout),e.clearTimeout(t.cssTimeout),s.onload=s.onreadystatechange=s.onerror=null,r())}var s,i;r=r||n,"css"===function(e){var t=(e=e||"").split("?")[0].split(".");return t[t.length-1].toLowerCase()}(t.url)?((s=y.createElement("link")).type="text/"+(t.type||"css"),s.rel="stylesheet",s.href=t.url,t.cssRetries=0,t.cssTimeout=e.setTimeout((function n(){if(t.state!==S&&t.cssRetries<=20){for(var r=0,o=y.styleSheets.length;r<o;r++)if(y.styleSheets[r].href===s.href)return void a({type:"load"});t.cssRetries++,t.cssTimeout=e.setTimeout(n,250)}}),500)):((s=y.createElement("script")).type="text/"+(t.type||"javascript"),s.src=t.url),s.onload=s.onreadystatechange=a,s.onerror=o,s.async=!1,s.defer=!1,t.errorTimeout=e.setTimeout((function(){o({type:"timeout"})}),7e3),(i=y.head||y.getElementsByTagName("head")[0]).insertBefore(s,i.lastChild)}function p(){if(!y.body)return e.clearTimeout(k.readyTimeout),void(k.readyTimeout=e.setTimeout(p,50));g||(g=!0,function(){for(var e,t=y.getElementsByTagName("script"),n=0,r=t.length;n<r;n++)if(e=t[n].getAttribute("data-headjs-load"))return void k.load(e)}(),r(v,(function(e){c(e)})))}function m(){y.addEventListener?(y.removeEventListener("DOMContentLoaded",m,!1),p()):"complete"===y.readyState&&(y.detachEvent("onreadystatechange",m),p())}var g,b,y=e.document,v=[],w={},x={},C="async"in y.createElement("script")||"MozAppearance"in y.documentElement.style||e.opera,T=e.head_conf&&e.head_conf.head||"head",k=e[T]=e[T]||function(){k.ready.apply(null,arguments)},E=1,L=2,j=3,S=4;if("complete"===y.readyState)p();else if(y.addEventListener)y.addEventListener("DOMContentLoaded",m,!1),e.addEventListener("load",p,!1);else{y.attachEvent("onreadystatechange",m),e.attachEvent("onload",p),b=!1;try{b=!e.frameElement&&y.documentElement}catch(e){}b&&b.doScroll&&function t(){if(!g){try{b.doScroll("left")}catch(n){return e.clearTimeout(k.readyTimeout),void(k.readyTimeout=e.setTimeout(t,50))}p()}}()}k.load=k.js=C?function(){var e=arguments,t=e[e.length-1],n={};return a(t)||(t=null),s(e[0])?(e[0].push(t),k.load.apply(null,e[0]),k):(r(e,(function(e){e!==t&&(e=u(e),n[e.name]=e)})),r(e,(function(e){e!==t&&f(e=u(e),(function(){l(n)&&c(t)}))})),k)}:function(){var e=arguments,t=e[e.length-1],n=[].slice.call(e,1),o=n[0];return a(t)||(t=null),s(e[0])?(e[0].push(t),k.load.apply(null,e[0]),k):(o?(r(n,(function(e){a(e)||!e||d(u(e))})),f(u(e[0]),a(o)?o:function(){k.load.apply(null,n)})):f(u(e[0])),k)},k.test=function(e,t,r,o){var a="object"==typeof e?e:{test:e,success:!!t&&(s(t)?t:[t]),failure:!!r&&(s(r)?r:[r]),callback:o||n},i=!!a.test;return i&&a.success?(a.success.push(a.callback),k.load.apply(null,a.success)):i||!a.failure?o():(a.failure.push(a.callback),k.load.apply(null,a.failure)),k},k.ready=function(e,t){var n,o,i;return e===y?(g?c(t):v.push(t),k):(a(e)&&(t=e,e="ALL"),s(e)?(n={},r(e,(function(e){n[e]=x[e],k.ready(e,(function(){l(n)&&c(t)}))})),k):"string"==typeof e&&a(t)?(o=x[e])&&o.state===S||"ALL"===e&&l()&&g?(c(t),k):((i=w[e])?i.push(t):i=w[e]=[t],k):k)},k.ready(y,(function(){l()&&r(w.ALL,(function(e){c(e)})),k.feature&&k.feature("domloaded",!0)}))}(window);
/*!
 * ClockPicker v0.0.7 (http://weareoutman.github.io/clockpicker/)
 * Copyright 2014 Wang Shenwei.
 * Licensed under MIT (https://github.com/weareoutman/clockpicker/blob/gh-pages/LICENSE)
 */
!function(){var t,i,e,s,o=window.jQuery,c=o(window),n=o(document),a="http://www.w3.org/2000/svg",r="SVGAngle"in window&&((e=document.createElement("div")).innerHTML="<svg/>",i=(e.firstChild&&e.firstChild.namespaceURI)==a,e.innerHTML="",i),p="transition"in(s=document.createElement("div").style)||"WebkitTransition"in s||"MozTransition"in s||"msTransition"in s||"OTransition"in s,l="ontouchstart"in window,h="mousedown"+(l?" touchstart":""),u="mousemove.clockpicker"+(l?" touchmove.clockpicker":""),k="mouseup.clockpicker"+(l?" touchend.clockpicker":""),d=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null;function f(t){return document.createElementNS(a,t)}function v(t){return(t<10?"0":"")+t}var m=0;var b=p?350:1,g=['<div class="popover clockpicker-popover">','<div class="arrow"></div>','<div class="popover-title">','<span class="clockpicker-span-hours text-primary"></span>'," : ",'<span class="clockpicker-span-minutes"></span>','<span class="clockpicker-span-am-pm"></span>',"</div>",'<div class="popover-content">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<span class="clockpicker-am-pm-block">',"</span>","</div>","</div>"].join("");function w(i,e){var s,c,a=o(g),p=a.find(".clockpicker-plate"),l=a.find(".clockpicker-hours"),d=a.find(".clockpicker-minutes"),w=a.find(".clockpicker-am-pm-block"),M="INPUT"===i.prop("tagName"),A=M?i:i.find("input"),V=i.find(".input-group-addon"),T=this;if(this.id=(c=++m+"",(s="cp")?s+c:c),this.element=i,this.options=e,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=M,this.input=A,this.addon=V,this.popover=a,this.plate=p,this.hoursView=l,this.minutesView=d,this.amPmBlock=w,this.spanHours=a.find(".clockpicker-span-hours"),this.spanMinutes=a.find(".clockpicker-span-minutes"),this.spanAmPm=a.find(".clockpicker-span-am-pm"),this.amOrPm="PM",e.twelvehour){var C=['<div class="clockpicker-am-pm-block">','<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-am-button">',"AM</button>",'<button type="button" class="btn btn-sm btn-default clockpicker-button clockpicker-pm-button">',"PM</button>","</div>"].join("");o(C);o('<button type="button" class="btn btn-sm btn-default clockpicker-button am-button">AM</button>').on("click",(function(){T.amOrPm="AM",o(".clockpicker-span-am-pm").empty().append("AM")})).appendTo(this.amPmBlock),o('<button type="button" class="btn btn-sm btn-default clockpicker-button pm-button">PM</button>').on("click",(function(){T.amOrPm="PM",o(".clockpicker-span-am-pm").empty().append("PM")})).appendTo(this.amPmBlock)}e.autoclose||o('<button type="button" class="btn btn-sm btn-default btn-block clockpicker-button">'+e.donetext+"</button>").click(o.proxy(this.done,this)).appendTo(a),"top"!==e.placement&&"bottom"!==e.placement||"top"!==e.align&&"bottom"!==e.align||(e.align="left"),"left"!==e.placement&&"right"!==e.placement||"left"!==e.align&&"right"!==e.align||(e.align="top"),a.addClass(e.placement),a.addClass("clockpicker-align-"+e.align),this.spanHours.click(o.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(o.proxy(this.toggleView,this,"minutes")),A.on("focus.clockpicker click.clockpicker",o.proxy(this.show,this)),V.on("click.clockpicker",o.proxy(this.toggle,this));var H,P,x,S,E=o('<div class="clockpicker-tick"></div>');if(e.twelvehour)for(H=1;H<13;H+=1)P=E.clone(),x=H/6*Math.PI,S=80,P.css("font-size","120%"),P.css({left:100+Math.sin(x)*S-13,top:100-Math.cos(x)*S-13}),P.html(0===H?"00":H),l.append(P),P.on(h,I);else for(H=0;H<24;H+=1){P=E.clone(),x=H/6*Math.PI;var D=H>0&&H<13;S=D?54:80,P.css({left:100+Math.sin(x)*S-13,top:100-Math.cos(x)*S-13}),D&&P.css("font-size","120%"),P.html(0===H?"00":H),l.append(P),P.on(h,I)}for(H=0;H<60;H+=5)P=E.clone(),x=H/30*Math.PI,P.css({left:100+80*Math.sin(x)-13,top:100-80*Math.cos(x)-13}),P.css("font-size","120%"),P.html(v(H)),d.append(P),P.on(h,I);function I(i,s){var o=p.offset(),c=/^touch/.test(i.type),a=o.left+100,l=o.top+100,h=(c?i.originalEvent.touches[0]:i).pageX-a,d=(c?i.originalEvent.touches[0]:i).pageY-l,f=Math.sqrt(h*h+d*d),v=!1;if(!s||!(f<67||f>93)){i.preventDefault();var m=setTimeout((function(){t.addClass("clockpicker-moving")}),200);r&&p.append(T.canvas),T.setHand(h,d,!s,!0),n.off(u).on(u,(function(t){t.preventDefault();var i=/^touch/.test(t.type),e=(i?t.originalEvent.touches[0]:t).pageX-a,s=(i?t.originalEvent.touches[0]:t).pageY-l;(v||e!==h||s!==d)&&(v=!0,T.setHand(e,s,!1,!0))})),n.off(k).on(k,(function(i){n.off(k),i.preventDefault();var o=/^touch/.test(i.type),c=(o?i.originalEvent.changedTouches[0]:i).pageX-a,r=(o?i.originalEvent.changedTouches[0]:i).pageY-l;(s||v)&&c===h&&r===d&&T.setHand(c,r),"hours"===T.currentView?T.toggleView("minutes",b/2):e.autoclose&&(T.minutesView.addClass("clockpicker-dial-out"),setTimeout((function(){T.done()}),b/2)),p.prepend(B),clearTimeout(m),t.removeClass("clockpicker-moving"),n.off(u)}))}}if(p.on(h,(function(t){0===o(t.target).closest(".clockpicker-tick").length&&I(t,!0)})),r){var B=a.find(".clockpicker-canvas"),z=f("svg");z.setAttribute("class","clockpicker-svg"),z.setAttribute("width",200),z.setAttribute("height",200);var O=f("g");O.setAttribute("transform","translate(100,100)");var j=f("circle");j.setAttribute("class","clockpicker-canvas-bearing"),j.setAttribute("cx",0),j.setAttribute("cy",0),j.setAttribute("r",2);var L=f("line");L.setAttribute("x1",0),L.setAttribute("y1",0);var U=f("circle");U.setAttribute("class","clockpicker-canvas-bg"),U.setAttribute("r",13);var W=f("circle");W.setAttribute("class","clockpicker-canvas-fg"),W.setAttribute("r",3.5),O.appendChild(L),O.appendChild(U),O.appendChild(W),O.appendChild(j),z.appendChild(O),B.append(z),this.hand=L,this.bg=U,this.fg=W,this.bearing=j,this.g=O,this.canvas=B}y(this.options.init)}function y(t){t&&"function"==typeof t&&t()}w.DEFAULTS={default:"",fromnow:0,placement:"bottom",align:"left",donetext:"完成",autoclose:!1,twelvehour:!1,vibrate:!0},w.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},w.prototype.locate=function(){var t=this.element,i=this.popover,e=t.offset(),s=t.outerWidth(),o=t.outerHeight(),c=this.options.placement,n=this.options.align,a={};switch(i.show(),c){case"bottom":a.top=e.top+o;break;case"right":a.left=e.left+s;break;case"top":a.top=e.top-i.outerHeight();break;case"left":a.left=e.left-i.outerWidth()}switch(n){case"left":a.left=e.left;break;case"right":a.left=e.left+s-i.outerWidth();break;case"top":a.top=e.top;break;case"bottom":a.top=e.top+o-i.outerHeight()}i.css(a)},w.prototype.show=function(i){if(!this.isShown){y(this.options.beforeShow);var e=this;this.isAppended||(t=o(document.body).append(this.popover),c.on("resize.clockpicker"+this.id,(function(){e.isShown&&e.locate()})),this.isAppended=!0);var s=((this.input.prop("value")||this.options.default||"")+"").split(":");if("now"===s[0]){var a=new Date(+new Date+this.options.fromnow);s=[a.getHours(),a.getMinutes()]}this.hours=+s[0]||0,this.minutes=+s[1]||0,this.spanHours.html(v(this.hours)),this.spanMinutes.html(v(this.minutes)),this.toggleView("hours"),this.locate(),this.isShown=!0,n.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,(function(t){var i=o(t.target);0===i.closest(e.popover).length&&0===i.closest(e.addon).length&&0===i.closest(e.input).length&&e.hide()})),n.on("keyup.clockpicker."+this.id,(function(t){27===t.keyCode&&e.hide()})),y(this.options.afterShow)}},w.prototype.hide=function(){y(this.options.beforeHide),this.isShown=!1,n.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),n.off("keyup.clockpicker."+this.id),this.popover.hide(),y(this.options.afterHide)},w.prototype.toggleView=function(t,i){var e=!1;"minutes"===t&&"visible"===o(this.hoursView).css("visibility")&&(y(this.options.beforeHourSelect),e=!0);var s="hours"===t,c=s?this.hoursView:this.minutesView,n=s?this.minutesView:this.hoursView;this.currentView=t,this.spanHours.toggleClass("text-primary",s),this.spanMinutes.toggleClass("text-primary",!s),n.addClass("clockpicker-dial-out"),c.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout((function(){n.css("visibility","hidden")}),b),e&&y(this.options.afterHourSelect)},w.prototype.resetClock=function(t){var i=this.currentView,e=this[i],s="hours"===i,o=e*(Math.PI/(s?6:30)),c=s&&e>0&&e<13?54:80,n=Math.sin(o)*c,a=-Math.cos(o)*c,p=this;r&&t?(p.canvas.addClass("clockpicker-canvas-out"),setTimeout((function(){p.canvas.removeClass("clockpicker-canvas-out"),p.setHand(n,a)}),t)):this.setHand(n,a)},w.prototype.setHand=function(t,i,e,s){var c,n=Math.atan2(t,-i),a="hours"===this.currentView,p=Math.PI/(a||e?6:30),l=Math.sqrt(t*t+i*i),h=this.options,u=a&&l<67,k=u?54:80;if(h.twelvehour&&(k=80),n<0&&(n=2*Math.PI+n),n=(c=Math.round(n/p))*p,h.twelvehour?a?0===c&&(c=12):(e&&(c*=5),60===c&&(c=0)):a?(12===c&&(c=0),c=u?0===c?12:c:0===c?0:c+12):(e&&(c*=5),60===c&&(c=0)),this[this.currentView]!==c&&d&&this.options.vibrate&&(this.vibrateTimer||(navigator[d](10),this.vibrateTimer=setTimeout(o.proxy((function(){this.vibrateTimer=null}),this),100))),this[this.currentView]=c,this[a?"spanHours":"spanMinutes"].html(v(c)),r){s||!a&&c%5?(this.g.insertBefore(this.hand,this.bearing),this.g.insertBefore(this.bg,this.fg),this.bg.setAttribute("class","clockpicker-canvas-bg clockpicker-canvas-bg-trans")):(this.g.insertBefore(this.hand,this.bg),this.g.insertBefore(this.fg,this.bg),this.bg.setAttribute("class","clockpicker-canvas-bg"));var f=Math.sin(n)*k,m=-Math.cos(n)*k;this.hand.setAttribute("x2",f),this.hand.setAttribute("y2",m),this.bg.setAttribute("cx",f),this.bg.setAttribute("cy",m),this.fg.setAttribute("cx",f),this.fg.setAttribute("cy",m)}else this[a?"hoursView":"minutesView"].find(".clockpicker-tick").each((function(){var t=o(this);t.toggleClass("active",c===+t.html())}))},w.prototype.done=function(){y(this.options.beforeDone),this.hide();var t=this.input.prop("value"),i=v(this.hours)+":"+v(this.minutes);this.options.twelvehour&&(i+=this.amOrPm),this.input.prop("value",i),i!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),y(this.options.afterDone)},w.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.addon.off("click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(c.off("resize.clockpicker"+this.id),this.popover.remove())},o.fn.clockpicker=function(t){var i=Array.prototype.slice.call(arguments,1);return this.each((function(){var e=o(this),s=e.data("clockpicker");if(s)"function"==typeof s[t]&&s[t].apply(s,i);else{var c=o.extend({},w.DEFAULTS,e.data(),"object"==typeof t&&t);e.data("clockpicker",new w(e,c))}}))}}();
/*!
 * Knockout JavaScript library v3.4.2
 * (c) The Knockout.js team - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
!function(e){var n=this||(0,eval)("this"),t=n.document,a=n.navigator,r=n.jQuery,i=n.JSON;!function(e){"function"==typeof define&&define.amd?define(["exports","require"],e):"object"==typeof exports&&"object"==typeof module?e(module.exports||exports):e(n.ko={})}((function(o,u){function c(e,n){return(null===e||typeof e in k)&&e===n}function s(n,t){var a;return function(){a||(a=x.a.setTimeout((function(){a=e,n()}),t))}}function l(e,n){var t;return function(){clearTimeout(t),t=x.a.setTimeout(e,n)}}function f(e,n){n&&n!==E?"beforeChange"===n?this.Ob(e):this.Ja(e,n):this.Pb(e)}function d(e,n){null!==n&&n.k&&n.k()}function p(e,n){var t=this.Mc,a=t[_];a.T||(this.ob&&this.Oa[n]?(t.Sb(n,e,this.Oa[n]),this.Oa[n]=null,--this.ob):a.s[n]||t.Sb(n,e,a.t?{$:e}:t.yc(e)),e.Ha&&e.Hc())}function h(e,n,t,a){x.d[e]={init:function(e,r,i,o,u){var c,s;return x.m((function(){var i=r(),o=x.a.c(i),l=(o=!t!=!o,!s);(l||n||o!==c)&&(l&&x.xa.Ca()&&(s=x.a.wa(x.f.childNodes(e),!0)),o?(l||x.f.fa(e,x.a.wa(s)),x.hb(a?a(u,i):u,e)):x.f.za(e),c=o)}),null,{i:e}),{controlsDescendantBindings:!0}}},x.h.va[e]=!1,x.f.aa[e]=!0}var b,v,g,m,y,w,x=void 0!==o?o:{};x.b=function(e,n){for(var t=e.split("."),a=x,r=0;r<t.length-1;r++)a=a[t[r]];a[t[t.length-1]]=n},x.H=function(e,n,t){e[n]=t},x.version="3.4.2",x.b("version",x.version),x.options={deferUpdates:!1,useOnlyNativeEvents:!1},x.a=function(){function o(e,n){for(var t in e)e.hasOwnProperty(t)&&n(t,e[t])}function u(e,n){if(n)for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function c(e,n){return e.__proto__=n,e}function s(e,n,t,a){var r=e[n].match(v)||[];x.a.r(t.match(v),(function(e){x.a.ra(r,e,a)})),e[n]=r.join(" ")}var l={__proto__:[]}instanceof Array,f="function"==typeof Symbol,d={},p={};d[a&&/Firefox\/2/i.test(a.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],d.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),o(d,(function(e,n){if(n.length)for(var t=0,a=n.length;t<a;t++)p[n[t]]=e}));var h={propertychange:!0},b=t&&function(){for(var n=3,a=t.createElement("div"),r=a.getElementsByTagName("i");a.innerHTML="\x3c!--[if gt IE "+ ++n+"]><i></i><![endif]--\x3e",r[0];);return 4<n?n:e}(),v=/\S+/g;return{gc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],r:function(e,n){for(var t=0,a=e.length;t<a;t++)n(e[t],t)},o:function(e,n){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,n);for(var t=0,a=e.length;t<a;t++)if(e[t]===n)return t;return-1},Vb:function(e,n,t){for(var a=0,r=e.length;a<r;a++)if(n.call(t,e[a],a))return e[a];return null},Na:function(e,n){var t=x.a.o(e,n);0<t?e.splice(t,1):0===t&&e.shift()},Wb:function(e){for(var n=[],t=0,a=(e=e||[]).length;t<a;t++)0>x.a.o(n,e[t])&&n.push(e[t]);return n},ib:function(e,n){for(var t=[],a=0,r=(e=e||[]).length;a<r;a++)t.push(n(e[a],a));return t},Ma:function(e,n){for(var t=[],a=0,r=(e=e||[]).length;a<r;a++)n(e[a],a)&&t.push(e[a]);return t},ta:function(e,n){if(n instanceof Array)e.push.apply(e,n);else for(var t=0,a=n.length;t<a;t++)e.push(n[t]);return e},ra:function(e,n,t){var a=x.a.o(x.a.Bb(e),n);0>a?t&&e.push(n):t||e.splice(a,1)},la:l,extend:u,$a:c,ab:l?c:u,D:o,Ea:function(e,n){if(!e)return e;var t,a={};for(t in e)e.hasOwnProperty(t)&&(a[t]=n(e[t],t,e));return a},rb:function(e){for(;e.firstChild;)x.removeNode(e.firstChild)},nc:function(e){for(var n=((e=x.a.W(e))[0]&&e[0].ownerDocument||t).createElement("div"),a=0,r=e.length;a<r;a++)n.appendChild(x.ba(e[a]));return n},wa:function(e,n){for(var t=0,a=e.length,r=[];t<a;t++){var i=e[t].cloneNode(!0);r.push(n?x.ba(i):i)}return r},fa:function(e,n){if(x.a.rb(e),n)for(var t=0,a=n.length;t<a;t++)e.appendChild(n[t])},uc:function(e,n){var t=e.nodeType?[e]:e;if(0<t.length){for(var a=t[0],r=a.parentNode,i=0,o=n.length;i<o;i++)r.insertBefore(n[i],a);for(i=0,o=t.length;i<o;i++)x.removeNode(t[i])}},Ba:function(e,n){if(e.length){for(n=8===n.nodeType&&n.parentNode||n;e.length&&e[0].parentNode!==n;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==n;)e.length--;if(1<e.length){var t=e[0],a=e[e.length-1];for(e.length=0;t!==a;)e.push(t),t=t.nextSibling;e.push(a)}}return e},wc:function(e,n){7>b?e.setAttribute("selected",n):e.selected=n},cb:function(n){return null===n||n===e?"":n.trim?n.trim():n.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},sd:function(e,n){return e=e||"",!(n.length>e.length)&&e.substring(0,n.length)===n},Rc:function(e,n){if(e===n)return!0;if(11===e.nodeType)return!1;if(n.contains)return n.contains(3===e.nodeType?e.parentNode:e);if(n.compareDocumentPosition)return 16==(16&n.compareDocumentPosition(e));for(;e&&e!=n;)e=e.parentNode;return!!e},qb:function(e){return x.a.Rc(e,e.ownerDocument.documentElement)},Tb:function(e){return!!x.a.Vb(e,x.a.qb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Zb:function(e){return x.onError?function(){try{return e.apply(this,arguments)}catch(e){throw x.onError&&x.onError(e),e}}:e},setTimeout:function(e,n){return setTimeout(x.a.Zb(e),n)},dc:function(e){setTimeout((function(){throw x.onError&&x.onError(e),e}),0)},q:function(e,n,t){var a=x.a.Zb(t);if(t=b&&h[n],x.options.useOnlyNativeEvents||t||!r)if(t||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(n){a.call(e,n)},o="on"+n;e.attachEvent(o,i),x.a.G.qa(e,(function(){e.detachEvent(o,i)}))}else e.addEventListener(n,a,!1);else r(e).bind(n,a)},Fa:function(e,a){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var i;if(i=!("input"!==x.a.A(e)||!e.type||"click"!=a.toLowerCase())&&("checkbox"==(i=e.type)||"radio"==i),x.options.useOnlyNativeEvents||!r||i)if("function"==typeof t.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(i=t.createEvent(p[a]||"HTMLEvents")).initEvent(a,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(i)}else if(i&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+a)}else r(e).trigger(a)},c:function(e){return x.I(e)?e():e},Bb:function(e){return x.I(e)?e.p():e},fb:function(e,n,t){var a;n&&("object"==typeof e.classList?(a=e.classList[t?"add":"remove"],x.a.r(n.match(v),(function(n){a.call(e.classList,n)}))):"string"==typeof e.className.baseVal?s(e.className,"baseVal",n,t):s(e,"className",n,t))},bb:function(n,t){var a=x.a.c(t);null!==a&&a!==e||(a="");var r=x.f.firstChild(n);!r||3!=r.nodeType||x.f.nextSibling(r)?x.f.fa(n,[n.ownerDocument.createTextNode(a)]):r.data=a,x.a.Wc(n)},vc:function(e,n){if(e.name=n,7>=b)try{e.mergeAttributes(t.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Wc:function(e){9<=b&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Sc:function(e){if(b){var n=e.style.width;e.style.width=0,e.style.width=n}},nd:function(e,n){e=x.a.c(e),n=x.a.c(n);for(var t=[],a=e;a<=n;a++)t.push(a);return t},W:function(e){for(var n=[],t=0,a=e.length;t<a;t++)n.push(e[t]);return n},bc:function(e){return f?Symbol(e):e},xd:6===b,yd:7===b,C:b,ic:function(e,n){for(var t=x.a.W(e.getElementsByTagName("input")).concat(x.a.W(e.getElementsByTagName("textarea"))),a="string"==typeof n?function(e){return e.name===n}:function(e){return n.test(e.name)},r=[],i=t.length-1;0<=i;i--)a(t[i])&&r.push(t[i]);return r},kd:function(e){return"string"==typeof e&&(e=x.a.cb(e))?i&&i.parse?i.parse(e):new Function("return "+e)():null},Gb:function(e,n,t){if(!i||!i.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return i.stringify(x.a.c(e),n,t)},ld:function(e,n,a){var r=(a=a||{}).params||{},i=a.includeFields||this.gc,u=e;if("object"==typeof e&&"form"===x.a.A(e)){u=e.action;for(var c=i.length-1;0<=c;c--)for(var s=x.a.ic(e,i[c]),l=s.length-1;0<=l;l--)r[s[l].name]=s[l].value}n=x.a.c(n);var f=t.createElement("form");for(var d in f.style.display="none",f.action=u,f.method="post",n)(e=t.createElement("input")).type="hidden",e.name=d,e.value=x.a.Gb(x.a.c(n[d])),f.appendChild(e);o(r,(function(e,n){var a=t.createElement("input");a.type="hidden",a.name=e,a.value=n,f.appendChild(a)})),t.body.appendChild(f),a.submitter?a.submitter(f):f.submit(),setTimeout((function(){f.parentNode.removeChild(f)}),0)}}}(),x.b("utils",x.a),x.b("utils.arrayForEach",x.a.r),x.b("utils.arrayFirst",x.a.Vb),x.b("utils.arrayFilter",x.a.Ma),x.b("utils.arrayGetDistinctValues",x.a.Wb),x.b("utils.arrayIndexOf",x.a.o),x.b("utils.arrayMap",x.a.ib),x.b("utils.arrayPushAll",x.a.ta),x.b("utils.arrayRemoveItem",x.a.Na),x.b("utils.extend",x.a.extend),x.b("utils.fieldsIncludedWithJsonPost",x.a.gc),x.b("utils.getFormFields",x.a.ic),x.b("utils.peekObservable",x.a.Bb),x.b("utils.postJson",x.a.ld),x.b("utils.parseJson",x.a.kd),x.b("utils.registerEventHandler",x.a.q),x.b("utils.stringifyJson",x.a.Gb),x.b("utils.range",x.a.nd),x.b("utils.toggleDomNodeCssClass",x.a.fb),x.b("utils.triggerEvent",x.a.Fa),x.b("utils.unwrapObservable",x.a.c),x.b("utils.objectForEach",x.a.D),x.b("utils.addOrRemoveItem",x.a.ra),x.b("utils.setTextContent",x.a.bb),x.b("unwrap",x.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var n=this;if(1===arguments.length)return function(){return n.apply(e,arguments)};var t=Array.prototype.slice.call(arguments,1);return function(){var a=t.slice(0);return a.push.apply(a,arguments),n.apply(e,a)}}),x.a.e=new function(){function n(n,i){var o=n[a];if(!o||"null"===o||!r[o]){if(!i)return e;o=n[a]="ko"+t++,r[o]={}}return r[o]}var t=0,a="__ko__"+(new Date).getTime(),r={};return{get:function(t,a){var r=n(t,!1);return r===e?e:r[a]},set:function(t,a,r){r===e&&n(t,!1)===e||(n(t,!0)[a]=r)},clear:function(e){var n=e[a];return!!n&&(delete r[n],e[a]=null,!0)},J:function(){return t+++a}}},x.b("utils.domData",x.a.e),x.b("utils.domData.clear",x.a.e.clear),x.a.G=new function(){function n(n,t){var r=x.a.e.get(n,a);return r===e&&t&&(r=[],x.a.e.set(n,a,r)),r}function t(e){if(a=n(e,!1))for(var a=a.slice(0),r=0;r<a.length;r++)a[r](e);if(x.a.e.clear(e),x.a.G.cleanExternalData(e),o[e.nodeType])for(a=e.firstChild;e=a;)a=e.nextSibling,8===e.nodeType&&t(e)}var a=x.a.e.J(),i={1:!0,8:!0,9:!0},o={1:!0,9:!0};return{qa:function(e,t){if("function"!=typeof t)throw Error("Callback must be a function");n(e,!0).push(t)},tc:function(t,r){var i=n(t,!1);i&&(x.a.Na(i,r),0==i.length&&x.a.e.set(t,a,e))},ba:function(e){if(i[e.nodeType]&&(t(e),o[e.nodeType])){var n=[];x.a.ta(n,e.getElementsByTagName("*"));for(var a=0,r=n.length;a<r;a++)t(n[a])}return e},removeNode:function(e){x.ba(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){r&&"function"==typeof r.cleanData&&r.cleanData([e])}}},x.ba=x.a.G.ba,x.removeNode=x.a.G.removeNode,x.b("cleanNode",x.ba),x.b("removeNode",x.removeNode),x.b("utils.domNodeDisposal",x.a.G),x.b("utils.domNodeDisposal.addDisposeCallback",x.a.G.qa),x.b("utils.domNodeDisposal.removeDisposeCallback",x.a.G.tc),b=[0,"",""],y={thead:v=[1,"<table>","</table>"],tbody:v,tfoot:v,tr:[2,"<table><tbody>","</tbody></table>"],td:g=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:g,option:m=[1,"<select multiple='multiple'>","</select>"],optgroup:m},w=8>=x.a.C,x.a.na=function(e,a){var i;if(r){if(r.parseHTML)i=r.parseHTML(e,a)||[];else if((i=r.clean([e],a))&&i[0]){for(var o=i[0];o.parentNode&&11!==o.parentNode.nodeType;)o=o.parentNode;o.parentNode&&o.parentNode.removeChild(o)}}else{(i=a)||(i=t),o=i.parentWindow||i.defaultView||n;var u,c=x.a.cb(e).toLowerCase(),s=i.createElement("div");for(u=(c=c.match(/^<([a-z]+)[ >]/))&&y[c[1]]||b,c=u[0],u="ignored<div>"+u[1]+e+u[2]+"</div>","function"==typeof o.innerShiv?s.appendChild(o.innerShiv(u)):(w&&i.appendChild(s),s.innerHTML=u,w&&s.parentNode.removeChild(s));c--;)s=s.lastChild;i=x.a.W(s.lastChild.childNodes)}return i},x.a.Eb=function(n,t){if(x.a.rb(n),null!==(t=x.a.c(t))&&t!==e)if("string"!=typeof t&&(t=t.toString()),r)r(n).html(t);else for(var a=x.a.na(t,n.ownerDocument),i=0;i<a.length;i++)n.appendChild(a[i])},x.b("utils.parseHtmlFragment",x.a.na),x.b("utils.setHtml",x.a.Eb),x.N=function(){var n={};return{yb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return n[t]=e,"\x3c!--[ko_memo:"+t+"]--\x3e"},Bc:function(t,a){var r=n[t];if(r===e)throw Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.");try{return r.apply(null,a||[]),!0}finally{delete n[t]}},Cc:function(e,n){var t=[];!function e(n,t){if(n)if(8==n.nodeType)null!=(a=x.N.pc(n.nodeValue))&&t.push({Qc:n,hd:a});else if(1==n.nodeType)for(var a=0,r=n.childNodes,i=r.length;a<i;a++)e(r[a],t)}(e,t);for(var a=0,r=t.length;a<r;a++){var i=t[a].Qc,o=[i];n&&x.a.ta(o,n),x.N.Bc(t[a].hd,o),i.nodeValue="",i.parentNode&&i.parentNode.removeChild(i)}},pc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),x.b("memoization",x.N),x.b("memoization.memoize",x.N.yb),x.b("memoization.unmemoize",x.N.Bc),x.b("memoization.parseMemoText",x.N.pc),x.b("memoization.unmemoizeDomNodeAndDescendants",x.N.Cc),x.Z=function(){function e(){if(i)for(var e,n=i,t=0;u<i;)if(e=r[u++]){if(u>n){if(5e3<=++t){u=i,x.a.dc(Error("'Too much recursion' after processing "+t+" task groups."));break}n=i}try{e()}catch(e){x.a.dc(e)}}}function a(){e(),u=i=r.length=0}var r=[],i=0,o=1,u=0;return{scheduler:n.MutationObserver?function(e){var n=t.createElement("div");return new MutationObserver(e).observe(n,{attributes:!0}),function(){n.classList.toggle("foo")}}(a):t&&"onreadystatechange"in t.createElement("script")?function(e){var n=t.createElement("script");n.onreadystatechange=function(){n.onreadystatechange=null,t.documentElement.removeChild(n),n=null,e()},t.documentElement.appendChild(n)}:function(e){setTimeout(e,0)},Za:function(e){return i||x.Z.scheduler(a),r[i++]=e,o++},cancel:function(e){(e-=o-i)>=u&&e<i&&(r[e]=null)},resetForTesting:function(){var e=i-u;return u=i=r.length=0,e},rd:e}}(),x.b("tasks",x.Z),x.b("tasks.schedule",x.Z.Za),x.b("tasks.runEarly",x.Z.rd),x.Aa={throttle:function(e,n){e.throttleEvaluation=n;var t=null;return x.B({read:e,write:function(a){clearTimeout(t),t=x.a.setTimeout((function(){e(a)}),n)}})},rateLimit:function(e,n){var t,a,r;"number"==typeof n?t=n:(t=n.timeout,a=n.method),e.gb=!1,r="notifyWhenChangesStop"==a?l:s,e.Wa((function(e){return r(e,t)}))},deferred:function(n,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");n.gb||(n.gb=!0,n.Wa((function(t){var a,r=!1;return function(){if(!r){x.Z.cancel(a),a=x.Z.Za(t);try{r=!0,n.notifySubscribers(e,"dirty")}finally{r=!1}}}})))},notify:function(e,n){e.equalityComparer="always"==n?null:c}};var k={undefined:1,boolean:1,number:1,string:1};x.b("extenders",x.Aa),x.zc=function(e,n,t){this.$=e,this.jb=n,this.Pc=t,this.T=!1,x.H(this,"dispose",this.k)},x.zc.prototype.k=function(){this.T=!0,this.Pc()},x.K=function(){x.a.ab(this,T),T.ub(this)};var E="change",T={ub:function(e){e.F={change:[]},e.Qb=1},Y:function(e,n,t){var a=this;t=t||E;var r=new x.zc(a,n?e.bind(n):e,(function(){x.a.Na(a.F[t],r),a.Ka&&a.Ka(t)}));return a.ua&&a.ua(t),a.F[t]||(a.F[t]=[]),a.F[t].push(r),r},notifySubscribers:function(e,n){if((n=n||E)===E&&this.Kb(),this.Ra(n)){var t=n===E&&this.Fc||this.F[n].slice(0);try{x.l.Xb();for(var a,r=0;a=t[r];++r)a.T||a.jb(e)}finally{x.l.end()}}},Pa:function(){return this.Qb},Zc:function(e){return this.Pa()!==e},Kb:function(){++this.Qb},Wa:function(e){var n,t,a,r,i=this,o=x.I(i);i.Ja||(i.Ja=i.notifySubscribers,i.notifySubscribers=f);var u=e((function(){i.Ha=!1,o&&r===i&&(r=i.Mb?i.Mb():i());var e=t||i.Ua(a,r);t=n=!1,e&&i.Ja(a=r)}));i.Pb=function(e){i.Fc=i.F[E].slice(0),i.Ha=n=!0,r=e,u()},i.Ob=function(e){n||(a=e,i.Ja(e,"beforeChange"))},i.Hc=function(){i.Ua(a,i.p(!0))&&(t=!0)}},Ra:function(e){return this.F[e]&&this.F[e].length},Xc:function(e){if(e)return this.F[e]&&this.F[e].length||0;var n=0;return x.a.D(this.F,(function(e,t){"dirty"!==e&&(n+=t.length)})),n},Ua:function(e,n){return!this.equalityComparer||!this.equalityComparer(e,n)},extend:function(e){var n=this;return e&&x.a.D(e,(function(e,t){var a=x.Aa[e];"function"==typeof a&&(n=a(n,t)||n)})),n}};x.H(T,"subscribe",T.Y),x.H(T,"extend",T.extend),x.H(T,"getSubscriptionsCount",T.Xc),x.a.la&&x.a.$a(T,Function.prototype),x.K.fn=T,x.lc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers},x.b("subscribable",x.K),x.b("isSubscribable",x.lc),x.xa=x.l=function(){function e(e){a.push(t),t=e}function n(){t=a.pop()}var t,a=[],r=0;return{Xb:e,end:n,sc:function(e){if(t){if(!x.lc(e))throw Error("Only subscribable things can act as dependencies");t.jb.call(t.Lc,e,e.Gc||(e.Gc=++r))}},w:function(t,a,r){try{return e(),t.apply(a,r||[])}finally{n()}},Ca:function(){if(t)return t.m.Ca()},Va:function(){if(t)return t.Va}}}(),x.b("computedContext",x.xa),x.b("computedContext.getDependenciesCount",x.xa.Ca),x.b("computedContext.isInitial",x.xa.Va),x.b("ignoreDependencies",x.wd=x.l.w);var C=x.a.bc("_latestValue");x.O=function(e){function n(){return 0<arguments.length?(n.Ua(n[C],arguments[0])&&(n.ia(),n[C]=arguments[0],n.ha()),this):(x.l.sc(n),n[C])}return n[C]=e,x.a.la||x.a.extend(n,x.K.fn),x.K.fn.ub(n),x.a.ab(n,N),x.options.deferUpdates&&x.Aa.deferred(n,!0),n};var N={equalityComparer:c,p:function(){return this[C]},ha:function(){this.notifySubscribers(this[C])},ia:function(){this.notifySubscribers(this[C],"beforeChange")}};x.a.la&&x.a.$a(N,x.K.fn);var S=x.O.md="__ko_proto__";N[S]=x.O,x.Qa=function(n,t){return null!==n&&n!==e&&n[S]!==e&&(n[S]===t||x.Qa(n[S],t))},x.I=function(e){return x.Qa(e,x.O)},x.Da=function(e){return!!("function"==typeof e&&e[S]===x.O||"function"==typeof e&&e[S]===x.B&&e.$c)},x.b("observable",x.O),x.b("isObservable",x.I),x.b("isWriteableObservable",x.Da),x.b("isWritableObservable",x.Da),x.b("observable.fn",N),x.H(N,"peek",N.p),x.H(N,"valueHasMutated",N.ha),x.H(N,"valueWillMutate",N.ia),x.ma=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=x.O(e),x.a.ab(e,x.ma.fn),e.extend({trackArrayChanges:!0})},x.ma.fn={remove:function(e){for(var n=this.p(),t=[],a="function"!=typeof e||x.I(e)?function(n){return n===e}:e,r=0;r<n.length;r++){var i=n[r];a(i)&&(0===t.length&&this.ia(),t.push(i),n.splice(r,1),r--)}return t.length&&this.ha(),t},removeAll:function(n){if(n===e){var t=this.p(),a=t.slice(0);return this.ia(),t.splice(0,t.length),this.ha(),a}return n?this.remove((function(e){return 0<=x.a.o(n,e)})):[]},destroy:function(e){var n=this.p(),t="function"!=typeof e||x.I(e)?function(n){return n===e}:e;this.ia();for(var a=n.length-1;0<=a;a--)t(n[a])&&(n[a]._destroy=!0);this.ha()},destroyAll:function(n){return n===e?this.destroy((function(){return!0})):n?this.destroy((function(e){return 0<=x.a.o(n,e)})):[]},indexOf:function(e){var n=this();return x.a.o(n,e)},replace:function(e,n){var t=this.indexOf(e);0<=t&&(this.ia(),this.p()[t]=n,this.ha())}},x.a.la&&x.a.$a(x.ma.fn,x.O.fn),x.a.r("pop push reverse shift sort splice unshift".split(" "),(function(e){x.ma.fn[e]=function(){var n=this.p();this.ia(),this.Yb(n,e,arguments);var t=n[e].apply(n,arguments);return this.ha(),t===n?this:t}})),x.a.r(["slice"],(function(e){x.ma.fn[e]=function(){var n=this();return n[e].apply(n,arguments)}})),x.b("observableArray",x.ma),x.Aa.trackArrayChanges=function(n,t){function a(){if(!o){o=!0,i=n.notifySubscribers,n.notifySubscribers=function(e,n){return n&&n!==E||++c,i.apply(this,arguments)};var e=[].concat(n.p()||[]);u=null,r=n.Y((function(t){var a;t=[].concat(t||[]),n.Ra("arrayChange")&&((!u||1<c)&&(u=x.a.lb(e,t,n.kb)),a=u),e=t,u=null,c=0,a&&a.length&&n.notifySubscribers(a,"arrayChange")}))}}if(n.kb={},t&&"object"==typeof t&&x.a.extend(n.kb,t),n.kb.sparse=!0,!n.Yb){var r,i,o=!1,u=null,c=0,s=n.ua,l=n.Ka;n.ua=function(e){s&&s.call(n,e),"arrayChange"===e&&a()},n.Ka=function(t){l&&l.call(n,t),"arrayChange"!==t||n.Ra("arrayChange")||(i&&(n.notifySubscribers=i,i=e),r.k(),o=!1)},n.Yb=function(e,n,t){function a(e,n,t){return r[r.length]={status:e,value:n,index:t}}if(o&&!c){var r=[],i=e.length,s=t.length,l=0;switch(n){case"push":l=i;case"unshift":for(n=0;n<s;n++)a("added",t[n],l+n);break;case"pop":l=i-1;case"shift":i&&a("deleted",e[l],l);break;case"splice":n=Math.min(Math.max(0,0>t[0]?i+t[0]:t[0]),i),i=1===s?i:Math.min(n+(t[1]||0),i),s=n+s-2,l=Math.max(i,s);for(var f=[],d=[],p=2;n<l;++n,++p)n<i&&d.push(a("deleted",e[n],n)),n<s&&f.push(a("added",t[p],n));x.a.hc(d,f);break;default:return}u=r}}}};var _=x.a.bc("_state");x.m=x.B=function(n,t,a){function r(){if(0<arguments.length){if("function"!=typeof i)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return i.apply(o.sb,arguments),this}return x.l.sc(r),(o.V||o.t&&r.Sa())&&r.U(),o.M}if("object"==typeof n?a=n:(a=a||{},n&&(a.read=n)),"function"!=typeof a.read)throw Error("Pass a function that returns the value of the ko.computed");var i=a.write,o={M:e,da:!0,V:!0,Ta:!1,Hb:!1,T:!1,Ya:!1,t:!1,od:a.read,sb:t||a.owner,i:a.disposeWhenNodeIsRemoved||a.i||null,ya:a.disposeWhen||a.ya,pb:null,s:{},L:0,fc:null};return r[_]=o,r.$c="function"==typeof i,x.a.la||x.a.extend(r,x.K.fn),x.K.fn.ub(r),x.a.ab(r,D),a.pure?(o.Ya=!0,o.t=!0,x.a.extend(r,B)):a.deferEvaluation&&x.a.extend(r,A),x.options.deferUpdates&&x.Aa.deferred(r,!0),o.i&&(o.Hb=!0,o.i.nodeType||(o.i=null)),o.t||a.deferEvaluation||r.U(),o.i&&r.ca()&&x.a.G.qa(o.i,o.pb=function(){r.k()}),r};var D={equalityComparer:c,Ca:function(){return this[_].L},Sb:function(e,n,t){if(this[_].Ya&&n===this)throw Error("A 'pure' computed must not be called recursively");this[_].s[e]=t,t.Ia=this[_].L++,t.pa=n.Pa()},Sa:function(){var e,n,t=this[_].s;for(e in t)if(t.hasOwnProperty(e)&&(n=t[e],this.oa&&n.$.Ha||n.$.Zc(n.pa)))return!0},gd:function(){this.oa&&!this[_].Ta&&this.oa(!1)},ca:function(){var e=this[_];return e.V||0<e.L},qd:function(){this.Ha?this[_].V&&(this[_].da=!0):this.ec()},yc:function(e){if(e.gb&&!this[_].i){var n=e.Y(this.gd,this,"dirty"),t=e.Y(this.qd,this);return{$:e,k:function(){n.k(),t.k()}}}return e.Y(this.ec,this)},ec:function(){var e=this,n=e.throttleEvaluation;n&&0<=n?(clearTimeout(this[_].fc),this[_].fc=x.a.setTimeout((function(){e.U(!0)}),n)):e.oa?e.oa(!0):e.U(!0)},U:function(e){var n=this[_],t=n.ya,a=!1;if(!n.Ta&&!n.T){if(n.i&&!x.a.qb(n.i)||t&&t()){if(!n.Hb)return void this.k()}else n.Hb=!1;n.Ta=!0;try{a=this.Vc(e)}finally{n.Ta=!1}return n.L||this.k(),a}},Vc:function(n){var t=this[_],a=!1,r=t.Ya?e:!t.L,i={Mc:this,Oa:t.s,ob:t.L};return x.l.Xb({Lc:i,jb:p,m:this,Va:r}),t.s={},t.L=0,i=this.Uc(t,i),this.Ua(t.M,i)&&(t.t||this.notifySubscribers(t.M,"beforeChange"),t.M=i,t.t?this.Kb():n&&this.notifySubscribers(t.M),a=!0),r&&this.notifySubscribers(t.M,"awake"),a},Uc:function(e,n){try{var t=e.od;return e.sb?t.call(e.sb):t()}finally{x.l.end(),n.ob&&!e.t&&x.a.D(n.Oa,d),e.da=e.V=!1}},p:function(e){var n=this[_];return(n.V&&(e||!n.L)||n.t&&this.Sa())&&this.U(),n.M},Wa:function(e){x.K.fn.Wa.call(this,e),this.Mb=function(){return this[_].da?this.U():this[_].V=!1,this[_].M},this.oa=function(e){this.Ob(this[_].M),this[_].V=!0,e&&(this[_].da=!0),this.Pb(this)}},k:function(){var e=this[_];!e.t&&e.s&&x.a.D(e.s,(function(e,n){n.k&&n.k()})),e.i&&e.pb&&x.a.G.tc(e.i,e.pb),e.s=null,e.L=0,e.T=!0,e.da=!1,e.V=!1,e.t=!1,e.i=null}},B={ua:function(e){var n=this,t=n[_];if(!t.T&&t.t&&"change"==e){if(t.t=!1,t.da||n.Sa())t.s=null,t.L=0,n.U()&&n.Kb();else{var a=[];x.a.D(t.s,(function(e,n){a[n.Ia]=e})),x.a.r(a,(function(e,a){var r=t.s[e],i=n.yc(r.$);i.Ia=a,i.pa=r.pa,t.s[e]=i}))}t.T||n.notifySubscribers(t.M,"awake")}},Ka:function(n){var t=this[_];t.T||"change"!=n||this.Ra("change")||(x.a.D(t.s,(function(e,n){n.k&&(t.s[e]={$:n.$,Ia:n.Ia,pa:n.pa},n.k())})),t.t=!0,this.notifySubscribers(e,"asleep"))},Pa:function(){var e=this[_];return e.t&&(e.da||this.Sa())&&this.U(),x.K.fn.Pa.call(this)}},A={ua:function(e){"change"!=e&&"beforeChange"!=e||this.p()}};x.a.la&&x.a.$a(D,x.K.fn);var O=x.O.md;x.m[O]=x.O,D[O]=x.m,x.bd=function(e){return x.Qa(e,x.m)},x.cd=function(e){return x.Qa(e,x.m)&&e[_]&&e[_].Ya},x.b("computed",x.m),x.b("dependentObservable",x.m),x.b("isComputed",x.bd),x.b("isPureComputed",x.cd),x.b("computed.fn",D),x.H(D,"peek",D.p),x.H(D,"dispose",D.k),x.H(D,"isActive",D.ca),x.H(D,"getDependenciesCount",D.Ca),x.rc=function(e,n){return"function"==typeof e?x.m(e,n,{pure:!0}):((e=x.a.extend({},e)).pure=!0,x.m(e,n))},x.b("pureComputed",x.rc),function(){function n(a,r,i){if(i=i||new t,"object"!=typeof(a=r(a))||null===a||a===e||a instanceof RegExp||a instanceof Date||a instanceof String||a instanceof Number||a instanceof Boolean)return a;var o=a instanceof Array?[]:{};return i.save(a,o),function(e,n){if(e instanceof Array){for(var t=0;t<e.length;t++)n(t);"function"==typeof e.toJSON&&n("toJSON")}else for(t in e)n(t)}(a,(function(t){var u=r(a[t]);switch(typeof u){case"boolean":case"number":case"string":case"function":o[t]=u;break;case"object":case"undefined":var c=i.get(u);o[t]=c!==e?c:n(u,r,i)}})),o}function t(){this.keys=[],this.Lb=[]}x.Ac=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return n(e,(function(e){for(var n=0;x.I(e)&&10>n;n++)e=e();return e}))},x.toJSON=function(e,n,t){return e=x.Ac(e),x.a.Gb(e,n,t)},t.prototype={save:function(e,n){var t=x.a.o(this.keys,e);0<=t?this.Lb[t]=n:(this.keys.push(e),this.Lb.push(n))},get:function(n){return 0<=(n=x.a.o(this.keys,n))?this.Lb[n]:e}}}(),x.b("toJS",x.Ac),x.b("toJSON",x.toJSON),x.j={u:function(n){switch(x.a.A(n)){case"option":return!0===n.__ko__hasDomDataOptionValue__?x.a.e.get(n,x.d.options.zb):7>=x.a.C?n.getAttributeNode("value")&&n.getAttributeNode("value").specified?n.value:n.text:n.value;case"select":return 0<=n.selectedIndex?x.j.u(n.options[n.selectedIndex]):e;default:return n.value}},ja:function(n,t,a){switch(x.a.A(n)){case"option":switch(typeof t){case"string":x.a.e.set(n,x.d.options.zb,e),"__ko__hasDomDataOptionValue__"in n&&delete n.__ko__hasDomDataOptionValue__,n.value=t;break;default:x.a.e.set(n,x.d.options.zb,t),n.__ko__hasDomDataOptionValue__=!0,n.value="number"==typeof t?t:""}break;case"select":""!==t&&null!==t||(t=e);for(var r,i=-1,o=0,u=n.options.length;o<u;++o)if((r=x.j.u(n.options[o]))==t||""==r&&t===e){i=o;break}(a||0<=i||t===e&&1<n.size)&&(n.selectedIndex=i);break;default:null!==t&&t!==e||(t=""),n.value=t}}},x.b("selectExtensions",x.j),x.b("selectExtensions.readValue",x.j.u),x.b("selectExtensions.writeValue",x.j.ja),x.h=function(){function e(e){123===(e=x.a.cb(e)).charCodeAt(0)&&(e=e.slice(1,-1));var n,t=[],o=e.match(a),u=[],c=0;if(o){o.push(",");for(var s,l=0;s=o[l];++l){var f=s.charCodeAt(0);if(44===f){if(0>=c){t.push(n&&u.length?{key:n,value:u.join("")}:{unknown:n||u.join("")}),n=c=0,u=[];continue}}else if(58===f){if(!c&&!n&&1===u.length){n=u.pop();continue}}else 47===f&&l&&1<s.length?(f=o[l-1].match(r))&&!i[f[0]]&&((o=(e=e.substr(e.indexOf(s)+1)).match(a)).push(","),l=-1,s="/"):40===f||123===f||91===f?++c:41===f||125===f||93===f?--c:n||u.length||34!==f&&39!==f||(s=s.slice(1,-1));u.push(s)}}return t}var n=["true","false","null","undefined"],t=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,a=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),r=/[\])"'A-Za-z0-9_$]+$/,i={in:1,return:1,typeof:1},o={};return{va:[],ga:o,Ab:e,Xa:function(a,r){function i(e,a){var r;if(!l){var f=x.getBindingHandler(e);if(f&&f.preprocess&&!(a=f.preprocess(a,e,i)))return;(f=o[e])&&(r=a,0<=x.a.o(n,r)?r=!1:(f=r.match(t),r=null!==f&&(f[1]?"Object("+f[1]+")"+f[2]:r)),f=r),f&&c.push("'"+e+"':function(_z){"+r+"=_z}")}s&&(a="function(){return "+a+" }"),u.push("'"+e+"':"+a)}var u=[],c=[],s=(r=r||{}).valueAccessors,l=r.bindingParams,f="string"==typeof a?e(a):a;return x.a.r(f,(function(e){i(e.key||e.unknown,e.value)})),c.length&&i("_ko_property_writers","{"+c.join(",")+" }"),u.join(",")},fd:function(e,n){for(var t=0;t<e.length;t++)if(e[t].key==n)return!0;return!1},Ga:function(e,n,t,a,r){e&&x.I(e)?!x.Da(e)||r&&e.p()===a||e(a):(e=n.get("_ko_property_writers"))&&e[t]&&e[t](a)}}}(),x.b("expressionRewriting",x.h),x.b("expressionRewriting.bindingRewriteValidators",x.h.va),x.b("expressionRewriting.parseObjectLiteral",x.h.Ab),x.b("expressionRewriting.preProcessBindings",x.h.Xa),x.b("expressionRewriting._twoWayBindings",x.h.ga),x.b("jsonExpressionRewriting",x.h),x.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",x.h.Xa),function(){function e(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(e){return 8==e.nodeType&&u.test(i?e.text:e.nodeValue)}function a(t,a){for(var r=t,i=1,o=[];r=r.nextSibling;){if(n(r)&&0==--i)return o;o.push(r),e(r)&&i++}if(!a)throw Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function r(e,n){var t=a(e,n);return t?0<t.length?t[t.length-1].nextSibling:e.nextSibling:null}var i=t&&"\x3c!--test--\x3e"===t.createComment("test").text,o=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,u=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,c={ul:!0,ol:!0};x.f={aa:{},childNodes:function(n){return e(n)?a(n):n.childNodes},za:function(n){if(e(n))for(var t=0,a=(n=x.f.childNodes(n)).length;t<a;t++)x.removeNode(n[t]);else x.a.rb(n)},fa:function(n,t){if(e(n)){x.f.za(n);for(var a=n.nextSibling,r=0,i=t.length;r<i;r++)a.parentNode.insertBefore(t[r],a)}else x.a.fa(n,t)},qc:function(n,t){e(n)?n.parentNode.insertBefore(t,n.nextSibling):n.firstChild?n.insertBefore(t,n.firstChild):n.appendChild(t)},kc:function(n,t,a){a?e(n)?n.parentNode.insertBefore(t,a.nextSibling):a.nextSibling?n.insertBefore(t,a.nextSibling):n.appendChild(t):x.f.qc(n,t)},firstChild:function(t){return e(t)?!t.nextSibling||n(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){return e(t)&&(t=r(t)),t.nextSibling&&n(t.nextSibling)?null:t.nextSibling},Yc:e,vd:function(e){return(e=(i?e.text:e.nodeValue).match(o))?e[1]:null},oc:function(t){if(c[x.a.A(t)]){var a=t.firstChild;if(a)do{if(1===a.nodeType){var i,o=null;if(i=a.firstChild)do{if(o)o.push(i);else if(e(i)){var u=r(i,!0);u?i=u:o=[i]}else n(i)&&(o=[i])}while(i=i.nextSibling);if(i=o)for(o=a.nextSibling,u=0;u<i.length;u++)o?t.insertBefore(i[u],o):t.appendChild(i[u])}}while(a=a.nextSibling)}}}}(),x.b("virtualElements",x.f),x.b("virtualElements.allowedBindings",x.f.aa),x.b("virtualElements.emptyNode",x.f.za),x.b("virtualElements.insertAfter",x.f.kc),x.b("virtualElements.prepend",x.f.qc),x.b("virtualElements.setDomNodeChildren",x.f.fa),x.S=function(){this.Kc={}},x.a.extend(x.S.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||x.g.getComponentNameForNode(e);case 8:return x.f.Yc(e);default:return!1}},getBindings:function(e,n){var t=(t=this.getBindingsString(e,n))?this.parseBindingsString(t,n,e):null;return x.g.Rb(t,e,n,!1)},getBindingAccessors:function(e,n){var t=(t=this.getBindingsString(e,n))?this.parseBindingsString(t,n,e,{valueAccessors:!0}):null;return x.g.Rb(t,e,n,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return x.f.vd(e);default:return null}},parseBindingsString:function(e,n,t,a){try{var r,i=this.Kc,o=e+(a&&a.valueAccessors||"");if(!(r=i[o])){var u,c="with($context){with($data||{}){return{"+x.h.Xa(e,a)+"}}}";u=new Function("$context","$element",c),r=i[o]=u}return r(n,t)}catch(n){throw n.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+n.message,n}}}),x.S.instance=new x.S,x.b("bindingProvider",x.S),function(){function t(e){return function(){return e}}function a(e){return e()}function i(e){return x.a.Ea(x.l.w(e),(function(n,t){return function(){return e()[t]}}))}function o(e,n,a){return"function"==typeof e?i(e.bind(null,n,a)):x.a.Ea(e,t)}function u(e,n){return i(this.getBindings.bind(this,e,n))}function c(e,n,t){var a,r=x.f.firstChild(n),i=x.S.instance,o=i.preprocessNode;if(o){for(;a=r;)r=x.f.nextSibling(a),o.call(i,a);r=x.f.firstChild(n)}for(;a=r;)r=x.f.nextSibling(a),s(e,a,t)}function s(e,n,t){var a=!0,r=1===n.nodeType;r&&x.f.oc(n),(r&&t||x.S.instance.nodeHasBindings(n))&&(a=l(n,null,e,t).shouldBindDescendants),a&&!d[x.a.A(n)]&&c(e,n,!r)}function l(n,t,r,i){var o,c,s=x.a.e.get(n,p);if(!t){if(s)throw Error("You cannot apply bindings multiple times to the same element.");x.a.e.set(n,p,!0)}if(!s&&i&&x.xc(n,r),t&&"function"!=typeof t)o=t;else{var l=x.S.instance,f=l.getBindingAccessors||u,d=x.B((function(){return(o=t?t(r,n):f.call(l,n,r))&&r.Q&&r.Q(),o}),null,{i:n});o&&d.ca()||(d=null)}if(o){var h=d?function(e){return function(){return a(d()[e])}}:function(e){return o[e]},b=function(){return x.a.Ea(d?d():o,a)};b.get=function(e){return o[e]&&a(h(e))},b.has=function(e){return e in o},i=function(e){var n=[],t={},a=[];return x.a.D(e,(function r(i){if(!t[i]){var o=x.getBindingHandler(i);o&&(o.after&&(a.push(i),x.a.r(o.after,(function(n){if(e[n]){if(-1!==x.a.o(a,n))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+a.join(", "));r(n)}})),a.length--),n.push({key:i,jc:o})),t[i]=!0}})),n}(o),x.a.r(i,(function(t){var a=t.jc.init,i=t.jc.update,u=t.key;if(8===n.nodeType&&!x.f.aa[u])throw Error("The binding '"+u+"' cannot be used with virtual elements");try{"function"==typeof a&&x.l.w((function(){var t=a(n,h(u),b,r.$data,r);if(t&&t.controlsDescendantBindings){if(c!==e)throw Error("Multiple bindings ("+c+" and "+u+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");c=u}})),"function"==typeof i&&x.B((function(){i(n,h(u),b,r.$data,r)}),null,{i:n})}catch(e){throw e.message='Unable to process binding "'+u+": "+o[u]+'"\nMessage: '+e.message,e}}))}return{shouldBindDescendants:c===e}}function f(e){return e&&e instanceof x.R?e:new x.R(e)}x.d={};var d={script:!0,textarea:!0,template:!0};x.getBindingHandler=function(e){return x.d[e]},x.R=function(n,t,a,r,i){function o(){var e=l?n():n,i=x.a.c(e);return t?(t.Q&&t.Q(),x.a.extend(s,t),s.Q=c):(s.$parents=[],s.$root=i,s.ko=x),s.$rawData=e,s.$data=i,a&&(s[a]=i),r&&r(s,t,i),s.$data}var u,c,s=this,l="function"==typeof n&&!x.I(n);i&&i.exportDependencies?o():(c=x.B(o,null,{ya:function(){return u&&!x.a.Tb(u)},i:!0})).ca()&&(s.Q=c,c.equalityComparer=null,u=[],c.Dc=function(n){u.push(n),x.a.G.qa(n,(function(n){x.a.Na(u,n),u.length||(c.k(),s.Q=c=e)}))})},x.R.prototype.createChildContext=function(e,n,t,a){return new x.R(e,this,n,(function(e,n){e.$parentContext=n,e.$parent=n.$data,e.$parents=(n.$parents||[]).slice(0),e.$parents.unshift(e.$parent),t&&t(e)}),a)},x.R.prototype.extend=function(e){return new x.R(this.Q||this.$data,this,null,(function(n,t){n.$rawData=t.$rawData,x.a.extend(n,"function"==typeof e?e():e)}))},x.R.prototype.ac=function(e,n){return this.createChildContext(e,n,null,{exportDependencies:!0})};var p=x.a.e.J(),h=x.a.e.J();x.xc=function(e,n){if(2!=arguments.length)return x.a.e.get(e,h);x.a.e.set(e,h,n),n.Q&&n.Q.Dc(e)},x.La=function(e,n,t){return 1===e.nodeType&&x.f.oc(e),l(e,n,f(t),!0)},x.Ic=function(e,n,t){return t=f(t),x.La(e,o(n,t,e),t)},x.hb=function(e,n){1!==n.nodeType&&8!==n.nodeType||c(f(e),n,!0)},x.Ub=function(e,t){if(!r&&n.jQuery&&(r=n.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||n.document.body,s(f(e),t,!0)},x.nb=function(n){switch(n.nodeType){case 1:case 8:var t=x.xc(n);if(t)return t;if(n.parentNode)return x.nb(n.parentNode)}return e},x.Oc=function(n){return(n=x.nb(n))?n.$data:e},x.b("bindingHandlers",x.d),x.b("applyBindings",x.Ub),x.b("applyBindingsToDescendants",x.hb),x.b("applyBindingAccessorsToNode",x.La),x.b("applyBindingsToNode",x.Ic),x.b("contextFor",x.nb),x.b("dataFor",x.Oc)}(),function(e){function n(n,a){var o,u=r.hasOwnProperty(n)?r[n]:e;u?u.Y(a):((u=r[n]=new x.K).Y(a),t(n,(function(e,t){var a=!(!t||!t.synchronous);i[n]={definition:e,dd:a},delete r[n],o||a?u.notifySubscribers(e):x.Z.Za((function(){u.notifySubscribers(e)}))})),o=!0)}function t(e,n){a("getConfig",[e],(function(t){t?a("loadComponent",[e,t],(function(e){n(e,t)})):n(null,null)}))}function a(n,t,r,i){i||(i=x.g.loaders.slice(0));var o=i.shift();if(o){var u=o[n];if(u){var c=!1;if(u.apply(o,t.concat((function(e){c?r(null):null!==e?r(e):a(n,t,r,i)})))!==e&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else a(n,t,r,i)}else r(null)}var r={},i={};x.g={get:function(t,a){var r=i.hasOwnProperty(t)?i[t]:e;r?r.dd?x.l.w((function(){a(r.definition)})):x.Z.Za((function(){a(r.definition)})):n(t,a)},$b:function(e){delete i[e]},Nb:a},x.g.loaders=[],x.b("components",x.g),x.b("components.get",x.g.get),x.b("components.clearCachedDefinition",x.g.$b)}(),function(){function e(e,n,t,a){function r(){0==--u&&a(o)}var o={},u=2,c=t.template;t=t.viewModel,c?i(n,c,(function(n){x.g.Nb("loadTemplate",[e,n],(function(e){o.template=e,r()}))})):r(),t?i(n,t,(function(n){x.g.Nb("loadViewModel",[e,n],(function(e){o[s]=e,r()}))})):r()}function a(e){switch(x.a.A(e)){case"script":return x.a.na(e.text);case"textarea":return x.a.na(e.value);case"template":if(r(e.content))return x.a.wa(e.content.childNodes)}return x.a.wa(e.childNodes)}function r(e){return n.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function i(e,t,a){"string"==typeof t.require?u||n.require?(u||n.require)([t.require],a):e("Uses require, but no AMD loader is present"):a(t)}function o(e){return function(n){throw Error("Component '"+e+"': "+n)}}var c={};x.g.register=function(e,n){if(!n)throw Error("Invalid configuration for "+e);if(x.g.wb(e))throw Error("Component "+e+" is already registered");c[e]=n},x.g.wb=function(e){return c.hasOwnProperty(e)},x.g.ud=function(e){delete c[e],x.g.$b(e)},x.g.cc={getConfig:function(e,n){n(c.hasOwnProperty(e)?c[e]:null)},loadComponent:function(n,t,a){var r=o(n);i(r,t,(function(t){e(n,r,t,a)}))},loadTemplate:function(e,i,u){if(e=o(e),"string"==typeof i)u(x.a.na(i));else if(i instanceof Array)u(i);else if(r(i))u(x.a.W(i.childNodes));else if(i.element)if(i=i.element,n.HTMLElement?i instanceof HTMLElement:i&&i.tagName&&1===i.nodeType)u(a(i));else if("string"==typeof i){var c=t.getElementById(i);c?u(a(c)):e("Cannot find element with ID "+i)}else e("Unknown element type: "+i);else e("Unknown template value: "+i)},loadViewModel:function(e,n,t){!function e(n,t,a){if("function"==typeof t)a((function(e){return new t(e)}));else if("function"==typeof t[s])a(t[s]);else if("instance"in t){var r=t.instance;a((function(){return r}))}else"viewModel"in t?e(n,t.viewModel,a):n("Unknown viewModel value: "+t)}(o(e),n,t)}};var s="createViewModel";x.b("components.register",x.g.register),x.b("components.isRegistered",x.g.wb),x.b("components.unregister",x.g.ud),x.b("components.defaultLoader",x.g.cc),x.g.loaders.push(x.g.cc),x.g.Ec=c}(),function(){function e(e,t){if(a=e.getAttribute("params")){var a=n.parseBindingsString(a,t,e,{valueAccessors:!0,bindingParams:!0}),r=(a=x.a.Ea(a,(function(n){return x.m(n,null,{i:e})})),x.a.Ea(a,(function(n){var t=n.p();return n.ca()?x.m({read:function(){return x.a.c(n())},write:x.Da(t)&&function(e){n()(e)},i:e}):t})));return r.hasOwnProperty("$raw")||(r.$raw=a),r}return{$raw:{}}}x.g.getComponentNameForNode=function(e){var n=x.a.A(e);if(x.g.wb(n)&&(-1!=n.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=x.a.C&&e.tagName===n))return n},x.g.Rb=function(n,t,a,r){if(1===t.nodeType){var i=x.g.getComponentNameForNode(t);if(i){if((n=n||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:i,params:e(t,a)};n.component=r?function(){return o}:o}}return n};var n=new x.S;9>x.a.C&&(x.g.register=function(e){return function(n){return t.createElement(n),e.apply(this,arguments)}}(x.g.register),t.createDocumentFragment=function(e){return function(){var n,t=e(),a=x.g.Ec;for(n in a)a.hasOwnProperty(n)&&t.createElement(n);return t}}(t.createDocumentFragment))}(),function(e){var n=0;x.d.component={init:function(e,t,a,r,i){function o(){var e=u&&u.dispose;"function"==typeof e&&e.call(u),c=u=null}var u,c,s=x.a.W(x.f.childNodes(e));return x.a.G.qa(e,o),x.m((function(){var a,r,l=x.a.c(t());if("string"==typeof l?a=l:(a=x.a.c(l.name),r=x.a.c(l.params)),!a)throw Error("No component name specified");var f=c=++n;x.g.get(a,(function(n){if(c===f){if(o(),!n)throw Error("Unknown component '"+a+"'");!function(e,n,t){if(!(n=n.template))throw Error("Component '"+e+"' has no template");e=x.a.wa(n),x.f.fa(t,e)}(a,n,e);var t=function(e,n,t,a){var r=e.createViewModel;return r?r.call(e,a,{element:n,templateNodes:t}):a}(n,e,s,r);n=i.createChildContext(t,void 0,(function(e){e.$component=t,e.$componentTemplateNodes=s})),u=t,x.hb(n,e)}}))}),null,{i:e}),{controlsDescendantBindings:!0}}},x.f.aa.component=!0}();var M={class:"className",for:"htmlFor"};x.d.attr={update:function(n,t){var a=x.a.c(t())||{};x.a.D(a,(function(t,a){var r=!1===(a=x.a.c(a))||null===a||a===e;r&&n.removeAttribute(t),8>=x.a.C&&t in M?(t=M[t],r?n.removeAttribute(t):n[t]=a):r||n.setAttribute(t,a.toString()),"name"===t&&x.a.vc(n,r?"":a.toString())}))}},x.d.checked={after:["value","attr"],init:function(n,t,a){function r(){var e=n.checked,r=d?i():e;if(!x.xa.Va()&&(!u||e)){var o=x.l.w(t);if(s){var c=l?o.p():o;f!==r?(e&&(x.a.ra(c,r,!0),x.a.ra(c,f,!1)),f=r):x.a.ra(c,r,e),l&&x.Da(o)&&o(c)}else x.h.Ga(o,a,"checked",r,!0)}}var i=x.rc((function(){return a.has("checkedValue")?x.a.c(a.get("checkedValue")):a.has("value")?x.a.c(a.get("value")):n.value})),o="checkbox"==n.type,u="radio"==n.type;if(o||u){var c=t(),s=o&&x.a.c(c)instanceof Array,l=!(s&&c.push&&c.splice),f=s?i():e,d=u||s;u&&!n.name&&x.d.uniqueName.init(n,(function(){return!0})),x.m(r,null,{i:n}),x.a.q(n,"click",r),x.m((function(){var e=x.a.c(t());n.checked=s?0<=x.a.o(e,i()):o?e:i()===e}),null,{i:n}),c=e}}},x.h.ga.checked=!0,x.d.checkedValue={update:function(e,n){e.value=x.a.c(n())}},x.d.css={update:function(e,n){var t=x.a.c(n());null!==t&&"object"==typeof t?x.a.D(t,(function(n,t){t=x.a.c(t),x.a.fb(e,n,t)})):(t=x.a.cb(String(t||"")),x.a.fb(e,e.__ko__cssValue,!1),e.__ko__cssValue=t,x.a.fb(e,t,!0))}},x.d.enable={update:function(e,n){var t=x.a.c(n());t&&e.disabled?e.removeAttribute("disabled"):t||e.disabled||(e.disabled=!0)}},x.d.disable={update:function(e,n){x.d.enable.update(e,(function(){return!x.a.c(n())}))}},x.d.event={init:function(e,n,t,a,r){var i=n()||{};x.a.D(i,(function(i){"string"==typeof i&&x.a.q(e,i,(function(e){var o,u=n()[i];if(u){try{var c=x.a.W(arguments);a=r.$data,c.unshift(a),o=u.apply(a,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===t.get(i+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}}))}))}},x.d.foreach={mc:function(e){return function(){var n=e(),t=x.a.Bb(n);return t&&"number"!=typeof t.length?(x.a.c(n),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:x.X.vb}):{foreach:n,templateEngine:x.X.vb}}},init:function(e,n){return x.d.template.init(e,x.d.foreach.mc(n))},update:function(e,n,t,a,r){return x.d.template.update(e,x.d.foreach.mc(n),t,a,r)}},x.h.va.foreach=!1,x.f.aa.foreach=!0,x.d.hasfocus={init:function(e,n,t){function a(a){e.__ko_hasfocusUpdating=!0;var r=e.ownerDocument;if("activeElement"in r){var i;try{i=r.activeElement}catch(e){i=r.body}a=i===e}r=n(),x.h.Ga(r,t,"hasfocus",a,!0),e.__ko_hasfocusLastValue=a,e.__ko_hasfocusUpdating=!1}var r=a.bind(null,!0),i=a.bind(null,!1);x.a.q(e,"focus",r),x.a.q(e,"focusin",r),x.a.q(e,"blur",i),x.a.q(e,"focusout",i)},update:function(e,n){var t=!!x.a.c(n());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===t||(t?e.focus():e.blur(),!t&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),x.l.w(x.a.Fa,null,[e,t?"focusin":"focusout"]))}},x.h.ga.hasfocus=!0,x.d.hasFocus=x.d.hasfocus,x.h.ga.hasFocus=!0,x.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){x.a.Eb(e,n())}},h("if"),h("ifnot",!1,!0),h("with",!0,!1,(function(e,n){return e.ac(n)}));var j={};x.d.options={init:function(e){if("select"!==x.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(n,t,a){function r(){return x.a.Ma(n.options,(function(e){return e.selected}))}function i(e,n,t){var a=typeof n;return"function"==a?n(e):"string"==a?e[n]:t}function o(e,t){if(h&&l)x.j.ja(n,x.a.c(a.get("value")),!0);else if(p.length){var r=0<=x.a.o(p,x.j.u(t[0]));x.a.wc(t[0],r),h&&!r&&x.l.w(x.a.Fa,null,[n,"change"])}}var u=n.multiple,c=0!=n.length&&u?n.scrollTop:null,s=x.a.c(t()),l=a.get("valueAllowUnset")&&a.has("value"),f=a.get("optionsIncludeDestroyed");t={};var d,p=[];l||(u?p=x.a.ib(r(),x.j.u):0<=n.selectedIndex&&p.push(x.j.u(n.options[n.selectedIndex]))),s&&(void 0===s.length&&(s=[s]),d=x.a.Ma(s,(function(n){return f||n===e||null===n||!x.a.c(n._destroy)})),a.has("optionsCaption")&&null!==(s=x.a.c(a.get("optionsCaption")))&&s!==e&&d.unshift(j));var h=!1;t.beforeRemove=function(e){n.removeChild(e)},s=o,a.has("optionsAfterRender")&&"function"==typeof a.get("optionsAfterRender")&&(s=function(n,t){o(0,t),x.l.w(a.get("optionsAfterRender"),null,[t[0],n!==j?n:e])}),x.a.Db(n,d,(function(t,r,o){return o.length&&(p=!l&&o[0].selected?[x.j.u(o[0])]:[],h=!0),r=n.ownerDocument.createElement("option"),t===j?(x.a.bb(r,a.get("optionsCaption")),x.j.ja(r,e)):(o=i(t,a.get("optionsValue"),t),x.j.ja(r,x.a.c(o)),t=i(t,a.get("optionsText"),o),x.a.bb(r,t)),[r]}),t,s),x.l.w((function(){l?x.j.ja(n,x.a.c(a.get("value")),!0):(u?p.length&&r().length<p.length:p.length&&0<=n.selectedIndex?x.j.u(n.options[n.selectedIndex])!==p[0]:p.length||0<=n.selectedIndex)&&x.a.Fa(n,"change")})),x.a.Sc(n),c&&20<Math.abs(c-n.scrollTop)&&(n.scrollTop=c)}},x.d.options.zb=x.a.e.J(),x.d.selectedOptions={after:["options","foreach"],init:function(e,n,t){x.a.q(e,"change",(function(){var a=n(),r=[];x.a.r(e.getElementsByTagName("option"),(function(e){e.selected&&r.push(x.j.u(e))})),x.h.Ga(a,t,"selectedOptions",r)}))},update:function(e,n){if("select"!=x.a.A(e))throw Error("values binding applies only to SELECT elements");var t=x.a.c(n()),a=e.scrollTop;t&&"number"==typeof t.length&&x.a.r(e.getElementsByTagName("option"),(function(e){var n=0<=x.a.o(t,x.j.u(e));e.selected!=n&&x.a.wc(e,n)})),e.scrollTop=a}},x.h.ga.selectedOptions=!0,x.d.style={update:function(n,t){var a=x.a.c(t()||{});x.a.D(a,(function(t,a){null!==(a=x.a.c(a))&&a!==e&&!1!==a||(a=""),n.style[t]=a}))}},x.d.submit={init:function(e,n,t,a,r){if("function"!=typeof n())throw Error("The value for a submit binding must be a function");x.a.q(e,"submit",(function(t){var a,i=n();try{a=i.call(r.$data,e)}finally{!0!==a&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}}))}},x.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,n){x.a.bb(e,n())}},x.f.aa.text=!0,function(){if(n&&n.navigator)var t=function(e){if(e)return parseFloat(e[1])},a=n.opera&&n.opera.version&&parseInt(n.opera.version()),r=n.navigator.userAgent,i=t(r.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),o=t(r.match(/Firefox\/([^ ]*)/));if(10>x.a.C)var u=x.a.e.J(),c=x.a.e.J(),s=function(e){var n=this.activeElement;(n=n&&x.a.e.get(n,c))&&n(e)},l=function(e,n){var t=e.ownerDocument;x.a.e.get(t,u)||(x.a.e.set(t,u,!0),x.a.q(t,"selectionchange",s)),x.a.e.set(e,c,n)};x.d.textInput={init:function(n,t,r){function u(e,t){x.a.q(n,e,t)}function c(){f||(d=n.value,f=x.a.setTimeout(s,4))}function s(){clearTimeout(f),d=f=e;var a=n.value;p!==a&&(p=a,x.h.Ga(t(),r,"textInput",a))}var f,d,p=n.value,h=9==x.a.C?c:s;10>x.a.C?(u("propertychange",(function(e){"value"===e.propertyName&&h(e)})),8==x.a.C&&(u("keyup",s),u("keydown",s)),8<=x.a.C&&(l(n,h),u("dragend",c))):(u("input",s),5>i&&"textarea"===x.a.A(n)?(u("keydown",c),u("paste",c),u("cut",c)):11>a?u("keydown",c):4>o&&(u("DOMAutoComplete",s),u("dragdrop",s),u("drop",s))),u("change",s),x.m((function a(){var r=x.a.c(t());null!==r&&r!==e||(r=""),d!==e&&r===d?x.a.setTimeout(a,4):n.value!==r&&(p=r,n.value=r)}),null,{i:n})}},x.h.ga.textInput=!0,x.d.textinput={preprocess:function(e,n,t){t("textInput",e)}}}(),x.d.uniqueName={init:function(e,n){if(n()){var t="ko_unique_"+ ++x.d.uniqueName.Nc;x.a.vc(e,t)}}},x.d.uniqueName.Nc=0,x.d.value={after:["options","foreach"],init:function(e,n,t){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var a=["change"],r=t.get("valueUpdate"),i=!1,o=null;r&&("string"==typeof r&&(r=[r]),x.a.ta(a,r),a=x.a.Wb(a));var u=function(){o=null,i=!1;var a=n(),r=x.j.u(e);x.h.Ga(a,t,"value",r)};!x.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=x.a.o(a,"propertychange")||(x.a.q(e,"propertychange",(function(){i=!0})),x.a.q(e,"focus",(function(){i=!1})),x.a.q(e,"blur",(function(){i&&u()}))),x.a.r(a,(function(n){var t=u;x.a.sd(n,"after")&&(t=function(){o=x.j.u(e),x.a.setTimeout(u,0)},n=n.substring(5)),x.a.q(e,n,t)}));var c=function(){var a=x.a.c(n()),r=x.j.u(e);if(null!==o&&a===o)x.a.setTimeout(c,0);else if(a!==r)if("select"===x.a.A(e)){var i=t.get("valueAllowUnset");(r=function(){x.j.ja(e,a,i)})(),i||a===x.j.u(e)?x.a.setTimeout(r,0):x.l.w(x.a.Fa,null,[e,"change"])}else x.j.ja(e,a)};x.m(c,null,{i:e})}else x.La(e,{checkedValue:n})},update:function(){}},x.h.ga.value=!0,x.d.visible={update:function(e,n){var t=x.a.c(n()),a="none"!=e.style.display;t&&!a?e.style.display="":!t&&a&&(e.style.display="none")}},function(e){x.d[e]={init:function(n,t,a,r,i){return x.d.event.init.call(this,n,(function(){var n={};return n[e]=t(),n}),a,r,i)}}}("click"),x.P=function(){},x.P.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},x.P.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},x.P.prototype.makeTemplateSource=function(e,n){if("string"==typeof e){var a=(n=n||t).getElementById(e);if(!a)throw Error("Cannot find template with ID "+e);return new x.v.n(a)}if(1==e.nodeType||8==e.nodeType)return new x.v.sa(e);throw Error("Unknown template type: "+e)},x.P.prototype.renderTemplate=function(e,n,t,a){return e=this.makeTemplateSource(e,a),this.renderTemplateSource(e,n,t,a)},x.P.prototype.isTemplateRewritten=function(e,n){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,n).data("isRewritten")},x.P.prototype.rewriteTemplate=function(e,n,t){n=n((e=this.makeTemplateSource(e,t)).text()),e.text(n),e.data("isRewritten",!0)},x.b("templateEngine",x.P),x.Ib=function(){function e(e,n,t,a){e=x.h.Ab(e);for(var r=x.h.va,i=0;i<e.length;i++){var o=e[i].key;if(r.hasOwnProperty(o)){var u=r[o];if("function"==typeof u){if(o=u(e[i].value))throw Error(o)}else if(!u)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return t="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+x.h.Xa(e,{valueAccessors:!0})+" } })()},'"+t.toLowerCase()+"')",a.createJavaScriptEvaluatorBlock(t)+n}var n=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,t=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Tc:function(e,n,t){n.isTemplateRewritten(e,t)||n.rewriteTemplate(e,(function(e){return x.Ib.jd(e,n)}),t)},jd:function(a,r){return a.replace(n,(function(n,t,a,i,o){return e(o,t,a,r)})).replace(t,(function(n,t){return e(t,"\x3c!-- ko --\x3e","#comment",r)}))},Jc:function(e,n){return x.N.yb((function(t,a){var r=t.nextSibling;r&&r.nodeName.toLowerCase()===n&&x.La(r,e,a)}))}}}(),x.b("__tr_ambtns",x.Ib.Jc),function(){x.v={},x.v.n=function(e){if(this.n=e){var n=x.a.A(e);this.eb="script"===n?1:"textarea"===n?2:"template"==n&&e.content&&11===e.content.nodeType?3:4}},x.v.n.prototype.text=function(){var e=1===this.eb?"text":2===this.eb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var n=arguments[0];"innerHTML"===e?x.a.Eb(this.n,n):this.n[e]=n};var n=x.a.e.J()+"_";x.v.n.prototype.data=function(e){if(1===arguments.length)return x.a.e.get(this.n,n+e);x.a.e.set(this.n,n+e,arguments[1])};var t=x.a.e.J();x.v.n.prototype.nodes=function(){var n=this.n;if(0==arguments.length)return(x.a.e.get(n,t)||{}).mb||(3===this.eb?n.content:4===this.eb?n:e);x.a.e.set(n,t,{mb:arguments[0]})},x.v.sa=function(e){this.n=e},x.v.sa.prototype=new x.v.n,x.v.sa.prototype.text=function(){if(0==arguments.length){var n=x.a.e.get(this.n,t)||{};return n.Jb===e&&n.mb&&(n.Jb=n.mb.innerHTML),n.Jb}x.a.e.set(this.n,t,{Jb:arguments[0]})},x.b("templateSources",x.v),x.b("templateSources.domElement",x.v.n),x.b("templateSources.anonymousTemplate",x.v.sa)}(),function(){function n(e,n,t){var a;for(n=x.f.nextSibling(n);e&&(a=e)!==n;)t(a,e=x.f.nextSibling(a))}function t(e,t){if(e.length){var a=e[0],r=e[e.length-1],i=a.parentNode,o=x.S.instance,u=o.preprocessNode;if(u){if(n(a,r,(function(e,n){var t=e.previousSibling,i=u.call(o,e);i&&(e===a&&(a=i[0]||n),e===r&&(r=i[i.length-1]||t))})),e.length=0,!a)return;a===r?e.push(a):(e.push(a,r),x.a.Ba(e,i))}n(a,r,(function(e){1!==e.nodeType&&8!==e.nodeType||x.Ub(t,e)})),n(a,r,(function(e){1!==e.nodeType&&8!==e.nodeType||x.N.Cc(e,[t])})),x.a.Ba(e,i)}}function a(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,n,r,i,u){u=u||{};var c=(e&&a(e)||r||{}).ownerDocument,s=u.templateEngine||o;if(x.Ib.Tc(r,s,c),"number"!=typeof(r=s.renderTemplate(r,i,u,c)).length||0<r.length&&"number"!=typeof r[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(c=!1,n){case"replaceChildren":x.f.fa(e,r),c=!0;break;case"replaceNode":x.a.uc(e,r),c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+n)}return c&&(t(r,i),u.afterRender&&x.l.w(u.afterRender,null,[r,i.$data])),r}function i(e,n,t){return x.I(e)?e():"function"==typeof e?e(n,t):e}var o;x.Fb=function(n){if(n!=e&&!(n instanceof x.P))throw Error("templateEngine must inherit from ko.templateEngine");o=n},x.Cb=function(n,t,u,c,s){if(((u=u||{}).templateEngine||o)==e)throw Error("Set a template engine before calling renderTemplate");if(s=s||"replaceChildren",c){var l=a(c);return x.B((function(){var e=t&&t instanceof x.R?t:new x.R(t,null,null,null,{exportDependencies:!0}),o=i(n,e.$data,e);e=r(c,s,o,e,u),"replaceNode"==s&&(l=a(c=e))}),null,{ya:function(){return!l||!x.a.qb(l)},i:l&&"replaceNode"==s?l.parentNode:l})}return x.N.yb((function(e){x.Cb(n,t,u,e,"replaceNode")}))},x.pd=function(n,a,o,u,c){function s(e,n){t(n,f),o.afterRender&&o.afterRender(n,e),f=null}function l(e,t){return f=c.createChildContext(e,o.as,(function(e){e.$index=t})),r(null,"ignoreTargetNode",i(n,e,f),f,o)}var f;return x.B((function(){var n=x.a.c(a)||[];void 0===n.length&&(n=[n]),n=x.a.Ma(n,(function(n){return o.includeDestroyed||n===e||null===n||!x.a.c(n._destroy)})),x.l.w(x.a.Db,null,[u,n,l,o,s])}),null,{i:u})};var u=x.a.e.J();x.d.template={init:function(e,n){var t=x.a.c(n());if("string"==typeof t||t.name)x.f.za(e);else{if("nodes"in t){if(t=t.nodes||[],x.I(t))throw Error('The "nodes" option must be a plain, non-observable array.')}else t=x.f.childNodes(e);t=x.a.nc(t),new x.v.sa(e).nodes(t)}return{controlsDescendantBindings:!0}},update:function(n,t,a,r,i){var o=t();a=!0,r=null,"string"==typeof(t=x.a.c(o))?t={}:(o=t.name,"if"in t&&(a=x.a.c(t.if)),a&&"ifnot"in t&&(a=!x.a.c(t.ifnot))),"foreach"in t?r=x.pd(o||n,a&&t.foreach||[],t,n,i):a?(i="data"in t?i.ac(t.data,t.as):i,r=x.Cb(o||n,i,t,n)):x.f.za(n),i=r,(t=x.a.e.get(n,u))&&"function"==typeof t.k&&t.k(),x.a.e.set(n,u,i&&i.ca()?i:e)}},x.h.va.template=function(e){return 1==(e=x.h.Ab(e)).length&&e[0].unknown||x.h.fd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},x.f.aa.template=!0}(),x.b("setTemplateEngine",x.Fb),x.b("renderTemplate",x.Cb),x.a.hc=function(e,n,t){var a,r,i,o,u;if(e.length&&n.length)for(a=r=0;(!t||a<t)&&(o=e[r]);++r){for(i=0;u=n[i];++i)if(o.value===u.value){o.moved=u.index,u.moved=o.index,n.splice(i,1),a=i=0;break}a+=i}},x.a.lb=function(){function e(e,n,t,a,r){var i,o,u,c,s,l=Math.min,f=Math.max,d=[],p=e.length,h=n.length,b=h-p||1,v=p+h+1;for(i=0;i<=p;i++)for(c=u,d.push(u=[]),s=l(h,i+b),o=f(0,i-1);o<=s;o++)u[o]=o?i?e[i-1]===n[o-1]?c[o-1]:l(c[o]||v,u[o-1]||v)+1:o+1:i+1;for(l=[],f=[],b=[],i=p,o=h;i||o;)h=d[i][o]-1,o&&h===d[i][o-1]?f.push(l[l.length]={status:t,value:n[--o],index:o}):i&&h===d[i-1][o]?b.push(l[l.length]={status:a,value:e[--i],index:i}):(--o,--i,r.sparse||l.push({status:"retained",value:n[o]}));return x.a.hc(b,f,!r.dontLimitMoves&&10*p),l.reverse()}return function(n,t,a){return a="boolean"==typeof a?{dontLimitMoves:a}:a||{},t=t||[],(n=n||[]).length<t.length?e(n,t,"added","deleted",a):e(t,n,"deleted","added",a)}}(),x.b("utils.compareArrays",x.a.lb),function(){function n(n,t,a,r,i){var o=[],u=x.B((function(){var e=t(a,i,x.a.Ba(o,n))||[];0<o.length&&(x.a.uc(o,e),r&&x.l.w(r,null,[a,e,i])),o.length=0,x.a.ta(o,e)}),null,{i:n,ya:function(){return!x.a.Tb(o)}});return{ea:o,B:u.ca()?u:e}}var t=x.a.e.J(),a=x.a.e.J();x.a.Db=function(r,i,o,u,c){function s(e,n){k=p[n],m!==n&&(C[e]=k),k.tb(m++),x.a.Ba(k.ea,r),v.push(k),w.push(k)}function l(e,n){if(e)for(var t=0,a=n.length;t<a;t++)n[t]&&x.a.r(n[t].ea,(function(a){e(a,t,n[t].ka)}))}i=i||[],u=u||{};var f,d=x.a.e.get(r,t)===e,p=x.a.e.get(r,t)||[],h=x.a.ib(p,(function(e){return e.ka})),b=x.a.lb(h,i,u.dontLimitMoves),v=[],g=0,m=0,y=[],w=[];i=[];for(var k,E,T,C=[],N=(h=[],0);E=b[N];N++)switch(T=E.moved,E.status){case"deleted":T===e&&((k=p[g]).B&&(k.B.k(),k.B=e),x.a.Ba(k.ea,r).length&&(u.beforeRemove&&(v.push(k),w.push(k),k.ka===a?k=null:i[N]=k),k&&y.push.apply(y,k.ea))),g++;break;case"retained":s(N,g++);break;case"added":T!==e?s(N,T):(k={ka:E.value,tb:x.O(m++)},v.push(k),w.push(k),d||(h[N]=k))}for(x.a.e.set(r,t,v),l(u.beforeMove,C),x.a.r(y,u.beforeRemove?x.ba:x.removeNode),N=0,d=x.f.firstChild(r);k=w[N];N++){for(k.ea||x.a.extend(k,n(r,o,k.ka,c,k.tb)),g=0;b=k.ea[g];d=b.nextSibling,f=b,g++)b!==d&&x.f.kc(r,b,f);!k.ad&&c&&(c(k.ka,k.ea,k.tb),k.ad=!0)}for(l(u.beforeRemove,i),N=0;N<i.length;++N)i[N]&&(i[N].ka=a);l(u.afterMove,C),l(u.afterAdd,h)}}(),x.b("utils.setDomNodeChildrenFromArrayMapping",x.a.Db),x.X=function(){this.allowTemplateRewriting=!1},x.X.prototype=new x.P,x.X.prototype.renderTemplateSource=function(e,n,t,a){return(n=9>x.a.C||!e.nodes?null:e.nodes())?x.a.W(n.cloneNode(!0).childNodes):(e=e.text(),x.a.na(e,a))},x.X.vb=new x.X,x.Fb(x.X.vb),x.b("nativeTemplateEngine",x.X),function(){x.xb=function(){var e=this.ed=function(){if(!r||!r.tmpl)return 0;try{if(0<=r.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(n,a,i,o){if(o=o||t,i=i||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var u=n.data("precompiled");return u||(u=n.text()||"",u=r.template(null,"{{ko_with $item.koBindingContext}}"+u+"{{/ko_with}}"),n.data("precompiled",u)),n=[a.$data],a=r.extend({koBindingContext:a},i.templateOptions),(a=r.tmpl(u,n,a)).appendTo(o.createElement("div")),r.fragments={},a},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,n){t.write("<script type='text/html' id='"+e+"'>"+n+"<\/script>")},0<e&&(r.tmpl.tag.ko_code={open:"__.push($1 || '');"},r.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},x.xb.prototype=new x.P;var e=new x.xb;0<e.ed&&x.Fb(e),x.b("jqueryTmplTemplateEngine",x.xb)}()}))}();
!function(){var n="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},r=n._,t=Array.prototype,e=Object.prototype,u="undefined"!=typeof Symbol?Symbol.prototype:null,i=t.push,o=t.slice,a=e.toString,c=e.hasOwnProperty,l=Array.isArray,f=Object.keys,s=Object.create,p=function(){},v=function(n){return n instanceof v?n:this instanceof v?void(this._wrapped=n):new v(n)};"undefined"==typeof exports||exports.nodeType?n._=v:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=v),exports._=v),v.VERSION="1.9.1";var h,y=function(n,r,t){if(void 0===r)return n;switch(null==t?3:t){case 1:return function(t){return n.call(r,t)};case 3:return function(t,e,u){return n.call(r,t,e,u)};case 4:return function(t,e,u,i){return n.call(r,t,e,u,i)}}return function(){return n.apply(r,arguments)}},d=function(n,r,t){return v.iteratee!==h?v.iteratee(n,r):null==n?v.identity:v.isFunction(n)?y(n,r,t):v.isObject(n)&&!v.isArray(n)?v.matcher(n):v.property(n)};v.iteratee=h=function(n,r){return d(n,r,1/0)};var g=function(n,r){return r=null==r?n.length-1:+r,function(){for(var t=Math.max(arguments.length-r,0),e=Array(t),u=0;u<t;u++)e[u]=arguments[u+r];switch(r){case 0:return n.call(this,e);case 1:return n.call(this,arguments[0],e);case 2:return n.call(this,arguments[0],arguments[1],e)}var i=Array(r+1);for(u=0;u<r;u++)i[u]=arguments[u];return i[r]=e,n.apply(this,i)}},m=function(n){if(!v.isObject(n))return{};if(s)return s(n);p.prototype=n;var r=new p;return p.prototype=null,r},b=function(n){return function(r){return null==r?void 0:r[n]}},j=function(n,r){return null!=n&&c.call(n,r)},x=function(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0},_=Math.pow(2,53)-1,A=b("length"),w=function(n){var r=A(n);return"number"==typeof r&&r>=0&&r<=_};v.each=v.forEach=function(n,r,t){var e,u;if(r=y(r,t),w(n))for(e=0,u=n.length;e<u;e++)r(n[e],e,n);else{var i=v.keys(n);for(e=0,u=i.length;e<u;e++)r(n[i[e]],i[e],n)}return n},v.map=v.collect=function(n,r,t){r=d(r,t);for(var e=!w(n)&&v.keys(n),u=(e||n).length,i=Array(u),o=0;o<u;o++){var a=e?e[o]:o;i[o]=r(n[a],a,n)}return i};var O=function(n){var r=function(r,t,e,u){var i=!w(r)&&v.keys(r),o=(i||r).length,a=n>0?0:o-1;for(u||(e=r[i?i[a]:a],a+=n);a>=0&&a<o;a+=n){var c=i?i[a]:a;e=t(e,r[c],c,r)}return e};return function(n,t,e,u){var i=arguments.length>=3;return r(n,y(t,u,4),e,i)}};v.reduce=v.foldl=v.inject=O(1),v.reduceRight=v.foldr=O(-1),v.find=v.detect=function(n,r,t){var e=(w(n)?v.findIndex:v.findKey)(n,r,t);if(void 0!==e&&-1!==e)return n[e]},v.filter=v.select=function(n,r,t){var e=[];return r=d(r,t),v.each(n,(function(n,t,u){r(n,t,u)&&e.push(n)})),e},v.reject=function(n,r,t){return v.filter(n,v.negate(d(r)),t)},v.every=v.all=function(n,r,t){r=d(r,t);for(var e=!w(n)&&v.keys(n),u=(e||n).length,i=0;i<u;i++){var o=e?e[i]:i;if(!r(n[o],o,n))return!1}return!0},v.some=v.any=function(n,r,t){r=d(r,t);for(var e=!w(n)&&v.keys(n),u=(e||n).length,i=0;i<u;i++){var o=e?e[i]:i;if(r(n[o],o,n))return!0}return!1},v.contains=v.includes=v.include=function(n,r,t,e){return w(n)||(n=v.values(n)),("number"!=typeof t||e)&&(t=0),v.indexOf(n,r,t)>=0},v.invoke=g((function(n,r,t){var e,u;return v.isFunction(r)?u=r:v.isArray(r)&&(e=r.slice(0,-1),r=r[r.length-1]),v.map(n,(function(n){var i=u;if(!i){if(e&&e.length&&(n=x(n,e)),null==n)return;i=n[r]}return null==i?i:i.apply(n,t)}))})),v.pluck=function(n,r){return v.map(n,v.property(r))},v.where=function(n,r){return v.filter(n,v.matcher(r))},v.findWhere=function(n,r){return v.find(n,v.matcher(r))},v.max=function(n,r,t){var e,u,i=-1/0,o=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=w(n)?n:v.values(n)).length;a<c;a++)null!=(e=n[a])&&e>i&&(i=e);else r=d(r,t),v.each(n,(function(n,t,e){((u=r(n,t,e))>o||u===-1/0&&i===-1/0)&&(i=n,o=u)}));return i},v.min=function(n,r,t){var e,u,i=1/0,o=1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=w(n)?n:v.values(n)).length;a<c;a++)null!=(e=n[a])&&e<i&&(i=e);else r=d(r,t),v.each(n,(function(n,t,e){((u=r(n,t,e))<o||u===1/0&&i===1/0)&&(i=n,o=u)}));return i},v.shuffle=function(n){return v.sample(n,1/0)},v.sample=function(n,r,t){if(null==r||t)return w(n)||(n=v.values(n)),n[v.random(n.length-1)];var e=w(n)?v.clone(n):v.values(n),u=A(e);r=Math.max(Math.min(r,u),0);for(var i=u-1,o=0;o<r;o++){var a=v.random(o,i),c=e[o];e[o]=e[a],e[a]=c}return e.slice(0,r)},v.sortBy=function(n,r,t){var e=0;return r=d(r,t),v.pluck(v.map(n,(function(n,t,u){return{value:n,index:e++,criteria:r(n,t,u)}})).sort((function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index})),"value")};var k=function(n,r){return function(t,e,u){var i=r?[[],[]]:{};return e=d(e,u),v.each(t,(function(r,u){var o=e(r,u,t);n(i,r,o)})),i}};v.groupBy=k((function(n,r,t){j(n,t)?n[t].push(r):n[t]=[r]})),v.indexBy=k((function(n,r,t){n[t]=r})),v.countBy=k((function(n,r,t){j(n,t)?n[t]++:n[t]=1}));var S=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;v.toArray=function(n){return n?v.isArray(n)?o.call(n):v.isString(n)?n.match(S):w(n)?v.map(n,v.identity):v.values(n):[]},v.size=function(n){return null==n?0:w(n)?n.length:v.keys(n).length},v.partition=k((function(n,r,t){n[t?0:1].push(r)}),!0),v.first=v.head=v.take=function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[0]:v.initial(n,n.length-r)},v.initial=function(n,r,t){return o.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))},v.last=function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[n.length-1]:v.rest(n,Math.max(0,n.length-r))},v.rest=v.tail=v.drop=function(n,r,t){return o.call(n,null==r||t?1:r)},v.compact=function(n){return v.filter(n,Boolean)};var M=function(n,r,t,e){for(var u=(e=e||[]).length,i=0,o=A(n);i<o;i++){var a=n[i];if(w(a)&&(v.isArray(a)||v.isArguments(a)))if(r)for(var c=0,l=a.length;c<l;)e[u++]=a[c++];else M(a,r,t,e),u=e.length;else t||(e[u++]=a)}return e};v.flatten=function(n,r){return M(n,r,!1)},v.without=g((function(n,r){return v.difference(n,r)})),v.uniq=v.unique=function(n,r,t,e){v.isBoolean(r)||(e=t,t=r,r=!1),null!=t&&(t=d(t,e));for(var u=[],i=[],o=0,a=A(n);o<a;o++){var c=n[o],l=t?t(c,o,n):c;r&&!t?(o&&i===l||u.push(c),i=l):t?v.contains(i,l)||(i.push(l),u.push(c)):v.contains(u,c)||u.push(c)}return u},v.union=g((function(n){return v.uniq(M(n,!0,!0))})),v.intersection=function(n){for(var r=[],t=arguments.length,e=0,u=A(n);e<u;e++){var i=n[e];if(!v.contains(r,i)){var o;for(o=1;o<t&&v.contains(arguments[o],i);o++);o===t&&r.push(i)}}return r},v.difference=g((function(n,r){return r=M(r,!0,!0),v.filter(n,(function(n){return!v.contains(r,n)}))})),v.unzip=function(n){for(var r=n&&v.max(n,A).length||0,t=Array(r),e=0;e<r;e++)t[e]=v.pluck(n,e);return t},v.zip=g(v.unzip),v.object=function(n,r){for(var t={},e=0,u=A(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t};var F=function(n){return function(r,t,e){t=d(t,e);for(var u=A(r),i=n>0?0:u-1;i>=0&&i<u;i+=n)if(t(r[i],i,r))return i;return-1}};v.findIndex=F(1),v.findLastIndex=F(-1),v.sortedIndex=function(n,r,t,e){for(var u=(t=d(t,e,1))(r),i=0,o=A(n);i<o;){var a=Math.floor((i+o)/2);t(n[a])<u?i=a+1:o=a}return i};var E=function(n,r,t){return function(e,u,i){var a=0,c=A(e);if("number"==typeof i)n>0?a=i>=0?i:Math.max(i+c,a):c=i>=0?Math.min(i+1,c):i+c+1;else if(t&&i&&c)return e[i=t(e,u)]===u?i:-1;if(u!=u)return(i=r(o.call(e,a,c),v.isNaN))>=0?i+a:-1;for(i=n>0?a:c-1;i>=0&&i<c;i+=n)if(e[i]===u)return i;return-1}};v.indexOf=E(1,v.findIndex,v.sortedIndex),v.lastIndexOf=E(-1,v.findLastIndex),v.range=function(n,r,t){null==r&&(r=n||0,n=0),t||(t=r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),i=0;i<e;i++,n+=t)u[i]=n;return u},v.chunk=function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,u=n.length;e<u;)t.push(o.call(n,e,e+=r));return t};var N=function(n,r,t,e,u){if(!(e instanceof r))return n.apply(t,u);var i=m(n.prototype),o=n.apply(i,u);return v.isObject(o)?o:i};v.bind=g((function(n,r,t){if(!v.isFunction(n))throw new TypeError("Bind must be called on a function");var e=g((function(u){return N(n,e,r,this,t.concat(u))}));return e})),v.partial=g((function(n,r){var t=v.partial.placeholder,e=function(){for(var u=0,i=r.length,o=Array(i),a=0;a<i;a++)o[a]=r[a]===t?arguments[u++]:r[a];for(;u<arguments.length;)o.push(arguments[u++]);return N(n,e,this,this,o)};return e})),v.partial.placeholder=v,v.bindAll=g((function(n,r){var t=(r=M(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=v.bind(n[e],n)}})),v.memoize=function(n,r){var t=function(e){var u=t.cache,i=""+(r?r.apply(this,arguments):e);return j(u,i)||(u[i]=n.apply(this,arguments)),u[i]};return t.cache={},t},v.delay=g((function(n,r,t){return setTimeout((function(){return n.apply(null,t)}),r)})),v.defer=v.partial(v.delay,v,1),v.throttle=function(n,r,t){var e,u,i,o,a=0;t||(t={});var c=function(){a=!1===t.leading?0:v.now(),e=null,o=n.apply(u,i),e||(u=i=null)},l=function(){var l=v.now();a||!1!==t.leading||(a=l);var f=r-(l-a);return u=this,i=arguments,f<=0||f>r?(e&&(clearTimeout(e),e=null),a=l,o=n.apply(u,i),e||(u=i=null)):e||!1===t.trailing||(e=setTimeout(c,f)),o};return l.cancel=function(){clearTimeout(e),a=0,e=u=i=null},l},v.debounce=function(n,r,t){var e,u,i=function(r,t){e=null,t&&(u=n.apply(r,t))},o=g((function(o){if(e&&clearTimeout(e),t){var a=!e;e=setTimeout(i,r),a&&(u=n.apply(this,o))}else e=v.delay(i,r,this,o);return u}));return o.cancel=function(){clearTimeout(e),e=null},o},v.wrap=function(n,r){return v.partial(r,n)},v.negate=function(n){return function(){return!n.apply(this,arguments)}},v.compose=function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},v.after=function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},v.before=function(n,r){var t;return function(){return--n>0&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}},v.once=v.partial(v.before,2),v.restArguments=g;var I=!{toString:null}.propertyIsEnumerable("toString"),T=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],B=function(n,r){var t=T.length,u=n.constructor,i=v.isFunction(u)&&u.prototype||e,o="constructor";for(j(n,o)&&!v.contains(r,o)&&r.push(o);t--;)(o=T[t])in n&&n[o]!==i[o]&&!v.contains(r,o)&&r.push(o)};v.keys=function(n){if(!v.isObject(n))return[];if(f)return f(n);var r=[];for(var t in n)j(n,t)&&r.push(t);return I&&B(n,r),r},v.allKeys=function(n){if(!v.isObject(n))return[];var r=[];for(var t in n)r.push(t);return I&&B(n,r),r},v.values=function(n){for(var r=v.keys(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e},v.mapObject=function(n,r,t){r=d(r,t);for(var e=v.keys(n),u=e.length,i={},o=0;o<u;o++){var a=e[o];i[a]=r(n[a],a,n)}return i},v.pairs=function(n){for(var r=v.keys(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e},v.invert=function(n){for(var r={},t=v.keys(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r},v.functions=v.methods=function(n){var r=[];for(var t in n)v.isFunction(n[t])&&r.push(t);return r.sort()};var R=function(n,r){return function(t){var e=arguments.length;if(r&&(t=Object(t)),e<2||null==t)return t;for(var u=1;u<e;u++)for(var i=arguments[u],o=n(i),a=o.length,c=0;c<a;c++){var l=o[c];r&&void 0!==t[l]||(t[l]=i[l])}return t}};v.extend=R(v.allKeys),v.extendOwn=v.assign=R(v.keys),v.findKey=function(n,r,t){r=d(r,t);for(var e,u=v.keys(n),i=0,o=u.length;i<o;i++)if(r(n[e=u[i]],e,n))return e};var q,K,z=function(n,r,t){return r in t};v.pick=g((function(n,r){var t={},e=r[0];if(null==n)return t;v.isFunction(e)?(r.length>1&&(e=y(e,r[1])),r=v.allKeys(n)):(e=z,r=M(r,!1,!1),n=Object(n));for(var u=0,i=r.length;u<i;u++){var o=r[u],a=n[o];e(a,o,n)&&(t[o]=a)}return t})),v.omit=g((function(n,r){var t,e=r[0];return v.isFunction(e)?(e=v.negate(e),r.length>1&&(t=r[1])):(r=v.map(M(r,!1,!1),String),e=function(n,t){return!v.contains(r,t)}),v.pick(n,e,t)})),v.defaults=R(v.allKeys,!0),v.create=function(n,r){var t=m(n);return r&&v.extendOwn(t,r),t},v.clone=function(n){return v.isObject(n)?v.isArray(n)?n.slice():v.extend({},n):n},v.tap=function(n,r){return r(n),n},v.isMatch=function(n,r){var t=v.keys(r),e=t.length;if(null==n)return!e;for(var u=Object(n),i=0;i<e;i++){var o=t[i];if(r[o]!==u[o]||!(o in u))return!1}return!0},q=function(n,r,t,e){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return!1;if(n!=n)return r!=r;var u=typeof n;return("function"===u||"object"===u||"object"==typeof r)&&K(n,r,t,e)},K=function(n,r,t,e){n instanceof v&&(n=n._wrapped),r instanceof v&&(r=r._wrapped);var i=a.call(n);if(i!==a.call(r))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+n==""+r;case"[object Number]":return+n!=+n?+r!=+r:0==+n?1/+n==1/r:+n==+r;case"[object Date]":case"[object Boolean]":return+n==+r;case"[object Symbol]":return u.valueOf.call(n)===u.valueOf.call(r)}var o="[object Array]"===i;if(!o){if("object"!=typeof n||"object"!=typeof r)return!1;var c=n.constructor,l=r.constructor;if(c!==l&&!(v.isFunction(c)&&c instanceof c&&v.isFunction(l)&&l instanceof l)&&"constructor"in n&&"constructor"in r)return!1}e=e||[];for(var f=(t=t||[]).length;f--;)if(t[f]===n)return e[f]===r;if(t.push(n),e.push(r),o){if((f=n.length)!==r.length)return!1;for(;f--;)if(!q(n[f],r[f],t,e))return!1}else{var s,p=v.keys(n);if(f=p.length,v.keys(r).length!==f)return!1;for(;f--;)if(s=p[f],!j(r,s)||!q(n[s],r[s],t,e))return!1}return t.pop(),e.pop(),!0},v.isEqual=function(n,r){return q(n,r)},v.isEmpty=function(n){return null==n||(w(n)&&(v.isArray(n)||v.isString(n)||v.isArguments(n))?0===n.length:0===v.keys(n).length)},v.isElement=function(n){return!(!n||1!==n.nodeType)},v.isArray=l||function(n){return"[object Array]"===a.call(n)},v.isObject=function(n){var r=typeof n;return"function"===r||"object"===r&&!!n},v.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],(function(n){v["is"+n]=function(r){return a.call(r)==="[object "+n+"]"}})),v.isArguments(arguments)||(v.isArguments=function(n){return j(n,"callee")});var D=n.document&&n.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof D&&(v.isFunction=function(n){return"function"==typeof n||!1}),v.isFinite=function(n){return!v.isSymbol(n)&&isFinite(n)&&!isNaN(parseFloat(n))},v.isNaN=function(n){return v.isNumber(n)&&isNaN(n)},v.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===a.call(n)},v.isNull=function(n){return null===n},v.isUndefined=function(n){return void 0===n},v.has=function(n,r){if(!v.isArray(r))return j(n,r);for(var t=r.length,e=0;e<t;e++){var u=r[e];if(null==n||!c.call(n,u))return!1;n=n[u]}return!!t},v.noConflict=function(){return n._=r,this},v.identity=function(n){return n},v.constant=function(n){return function(){return n}},v.noop=function(){},v.property=function(n){return v.isArray(n)?function(r){return x(r,n)}:b(n)},v.propertyOf=function(n){return null==n?function(){}:function(r){return v.isArray(r)?x(n,r):n[r]}},v.matcher=v.matches=function(n){return n=v.extendOwn({},n),function(r){return v.isMatch(r,n)}},v.times=function(n,r,t){var e=Array(Math.max(0,n));r=y(r,t,1);for(var u=0;u<n;u++)e[u]=r(u);return e},v.random=function(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))},v.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=v.invert(L),W=function(n){var r=function(r){return n[r]},t="(?:"+v.keys(n).join("|")+")",e=RegExp(t),u=RegExp(t,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,r):n}};v.escape=W(L),v.unescape=W(P),v.result=function(n,r,t){v.isArray(r)||(r=[r]);var e=r.length;if(!e)return v.isFunction(t)?t.call(n):t;for(var u=0;u<e;u++){var i=null==n?void 0:n[r[u]];void 0===i&&(i=t,u=e),n=v.isFunction(i)?i.call(n):i}return n};var C=0;v.uniqueId=function(n){var r=++C+"";return n?n+r:r},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\u2028|\u2029/g,$=function(n){return"\\"+U[n]};v.template=function(n,r,t){!r&&t&&(r=t),r=v.defaults({},r,v.templateSettings);var e,u=RegExp([(r.escape||J).source,(r.interpolate||J).source,(r.evaluate||J).source].join("|")+"|$","g"),i=0,o="__p+='";n.replace(u,(function(r,t,e,u,a){return o+=n.slice(i,a).replace(V,$),i=a+r.length,t?o+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?o+="'+\n((__t=("+e+"))==null?'':__t)+\n'":u&&(o+="';\n"+u+"\n__p+='"),r})),o+="';\n",r.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{e=new Function(r.variable||"obj","_",o)}catch(n){throw n.source=o,n}var a=function(n){return e.call(this,n,v)},c=r.variable||"obj";return a.source="function("+c+"){\n"+o+"}",a},v.chain=function(n){var r=v(n);return r._chain=!0,r};var G=function(n,r){return n._chain?v(r).chain():r};v.mixin=function(n){return v.each(v.functions(n),(function(r){var t=v[r]=n[r];v.prototype[r]=function(){var n=[this._wrapped];return i.apply(n,arguments),G(this,t.apply(v,n))}})),v},v.mixin(v),v.each(["pop","push","reverse","shift","sort","splice","unshift"],(function(n){var r=t[n];v.prototype[n]=function(){var t=this._wrapped;return r.apply(t,arguments),"shift"!==n&&"splice"!==n||0!==t.length||delete t[0],G(this,t)}})),v.each(["concat","join","slice"],(function(n){var r=t[n];v.prototype[n]=function(){return G(this,r.apply(this._wrapped,arguments))}})),v.prototype.value=function(){return this._wrapped},v.prototype.valueOf=v.prototype.toJSON=v.prototype.value,v.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],(function(){return v}))}();
var toGeoJSON=function(){"use strict";var e,t=/\s*/g,r=/^\s*|\s*$/g,n=/\s+/;function i(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function o(e,t){return e.getElementsByTagName(t)}function a(e,t){return e.getAttribute(t)}function s(e,t){return parseFloat(a(e,t))}function l(e,t){var r=o(e,t);return r.length?r[0]:null}function u(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function f(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function p(e,t){var r,n,i={};for(n=0;n<t.length;n++)(r=l(e,t[n]))&&(i[t[n]]=f(r));return i}function c(e,t){for(var r in t)e[r]=t[r]}function h(e){return u(e.replace(t,"").split(","))}function g(e){for(var t=e.replace(r,"").split(n),i=[],o=0;o<t.length;o++)i.push(h(t[o]));return i}function m(e){var t,r=[s(e,"lon"),s(e,"lat")],n=l(e,"ele"),i=l(e,"gpxtpx:hr")||l(e,"hr"),o=l(e,"time");return n&&(t=parseFloat(f(n)),isNaN(t)||r.push(t)),{coordinates:r,time:o?f(o):null,heartRate:i?parseFloat(f(i)):null}}function y(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return"undefined"!=typeof XMLSerializer?e=new XMLSerializer:"object"!=typeof exports||"object"!=typeof process||process.browser||(e=new(require("xmldom").XMLSerializer)),{kml:function(e){for(var t={type:"FeatureCollection",features:[]},r={},n={},s={},p=["Polygon","LineString","Point","Track","gx:Track"],c=o(e,"Placemark"),m=o(e,"Style"),d=o(e,"StyleMap"),v=0;v<m.length;v++){var k=i(y(m[v])).toString(16);r["#"+a(m[v],"id")]=k,n[k]=m[v]}for(var S=0;S<d.length;S++){r["#"+a(d[S],"id")]=i(y(d[S])).toString(16);for(var T=o(d[S],"Pair"),x={},N=0;N<T.length;N++)x[f(l(T[N],"key"))]=f(l(T[N],"styleUrl"));s["#"+a(d[S],"id")]=x}for(var b=0;b<c.length;b++)t.features=t.features.concat(M(c[b]));function F(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function L(e){var t=o(e,"coord"),r=[],n=[];0===t.length&&(t=o(e,"gx:coord"));for(var i=0;i<t.length;i++)r.push(u(f(t[i]).split(" ")));for(var a=o(e,"when"),s=0;s<a.length;s++)n.push(f(a[s]));return{coords:r,times:n}}function M(e){var t,i=function e(t){var r,n,i,a,s,u=[],c=[];if(l(t,"MultiGeometry"))return e(l(t,"MultiGeometry"));if(l(t,"MultiTrack"))return e(l(t,"MultiTrack"));if(l(t,"gx:MultiTrack"))return e(l(t,"gx:MultiTrack"));for(i=0;i<p.length;i++)if(n=o(t,p[i]))for(a=0;a<n.length;a++)if(r=n[a],"Point"===p[i])u.push({type:"Point",coordinates:h(f(l(r,"coordinates")))});else if("LineString"===p[i])u.push({type:"LineString",coordinates:g(f(l(r,"coordinates")))});else if("Polygon"===p[i]){var m=o(r,"LinearRing"),y=[];for(s=0;s<m.length;s++)y.push(g(f(l(m[s],"coordinates"))));u.push({type:"Polygon",coordinates:y})}else if("Track"===p[i]||"gx:Track"===p[i]){var d=L(r);u.push({type:"LineString",coordinates:d.coords}),d.times.length&&c.push(d.times)}return{geoms:u,coordTimes:c}}(e),u={},c=f(l(e,"name")),m=f(l(e,"address")),y=f(l(e,"styleUrl")),d=f(l(e,"description")),v=l(e,"TimeSpan"),k=l(e,"TimeStamp"),S=l(e,"ExtendedData"),T=l(e,"LineStyle"),x=l(e,"PolyStyle"),N=l(e,"visibility");if(!i.geoms.length)return[];if(c&&(u.name=c),m&&(u.address=m),y){"#"!==y[0]&&(y="#"+y),u.styleUrl=y,r[y]&&(u.styleHash=r[y]),s[y]&&(u.styleMapHash=s[y],u.styleHash=r[s[y].normal]);var b=n[u.styleHash];b&&(T||(T=l(b,"LineStyle")),x||(x=l(b,"PolyStyle")))}if(d&&(u.description=d),v){var M=f(l(v,"begin")),w=f(l(v,"end"));u.timespan={begin:M,end:w}}if(k&&(u.timestamp=f(l(k,"when"))),T){var P=F(f(l(T,"color"))),R=P[0],z=P[1],C=parseFloat(f(l(T,"width")));R&&(u.stroke=R),isNaN(z)||(u["stroke-opacity"]=z),isNaN(C)||(u["stroke-width"]=C)}if(x){var G=F(f(l(x,"color"))),A=G[0],H=G[1],D=f(l(x,"fill")),U=f(l(x,"outline"));A&&(u.fill=A),isNaN(H)||(u["fill-opacity"]=H),D&&(u["fill-opacity"]="1"===D?u["fill-opacity"]||1:0),U&&(u["stroke-opacity"]="1"===U?u["stroke-opacity"]||1:0)}if(S){var X=o(S,"Data"),j=o(S,"SimpleData");for(t=0;t<X.length;t++)u[X[t].getAttribute("name")]=f(l(X[t],"value"));for(t=0;t<j.length;t++)u[j[t].getAttribute("name")]=f(j[t])}N&&(u.visibility=f(N)),i.coordTimes.length&&(u.coordTimes=1===i.coordTimes.length?i.coordTimes[0]:i.coordTimes);var E={type:"Feature",geometry:1===i.geoms.length?i.geoms[0]:{type:"GeometryCollection",geometries:i.geoms},properties:u};return a(e,"id")&&(E.id=a(e,"id")),[E]}return t},gpx:function(e){var t,r,n=o(e,"trk"),i=o(e,"rte"),s=o(e,"wpt"),u={type:"FeatureCollection",features:[]};for(t=0;t<n.length;t++)(r=g(n[t]))&&u.features.push(r);for(t=0;t<i.length;t++)(r=y(i[t]))&&u.features.push(r);for(t=0;t<s.length;t++)u.features.push(d(s[t]));function h(e,t){var r=o(e,t),n=[],i=[],a=[],s=r.length;if(s<2)return{};for(var l=0;l<s;l++){var u=m(r[l]);n.push(u.coordinates),u.time&&i.push(u.time),u.heartRate&&a.push(u.heartRate)}return{line:n,times:i,heartRates:a}}function g(e){for(var t,r=o(e,"trkseg"),n=[],i=[],a=[],s=0;s<r.length;s++)(t=h(r[s],"trkpt"))&&(t.line&&n.push(t.line),t.times&&t.times.length&&i.push(t.times),t.heartRates&&t.heartRates.length&&a.push(t.heartRates));if(0!==n.length){var u=k(e);return c(u,v(l(e,"extensions"))),i.length&&(u.coordTimes=1===n.length?i[0]:i),a.length&&(u.heartRates=1===n.length?a[0]:a),{type:"Feature",properties:u,geometry:{type:1===n.length?"LineString":"MultiLineString",coordinates:1===n.length?n[0]:n}}}}function y(e){var t=h(e,"rtept");if(t.line){var r=k(e);return c(r,v(l(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}function d(e){var t=k(e);return c(t,p(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:m(e).coordinates}}}function v(e){var t={};if(e){var r=l(e,"line");if(r){var n=f(l(r,"color")),i=parseFloat(f(l(r,"opacity"))),o=parseFloat(f(l(r,"width")));n&&(t.stroke=n),isNaN(i)||(t["stroke-opacity"]=i),isNaN(o)||(t["stroke-width"]=96*o/25.4)}}return t}function k(e){var t=p(e,["name","cmt","desc","type","time","keywords"]),r=o(e,"link");r.length&&(t.links=[]);for(var n,i=0;i<r.length;i++)c(n={href:a(r[i],"href")},p(r[i],["text","type"])),t.links.push(n);return t}return u}}}();"undefined"!=typeof module&&(module.exports=toGeoJSON);
function Vertex(e,t){this.name=e,this.successors=t,this.reset()}function Graph(){this.vertices={}}Vertex.prototype={reset:function(){this.index=-1,this.lowLink=-1,this.onStack=!1,this.visited=!1}},Graph.prototype={add:function(e,t){var n=this,s=(t=Array.isArray(t)?t:[t]).map((function(e){return n.vertices[e]||(n.vertices[e]=new Vertex(e,[])),n.vertices[e]}));return this.vertices[e]||(this.vertices[e]=new Vertex(e)),this.vertices[e].successors=s.concat([]).reverse(),this},reset:function(){var e=this;Object.keys(this.vertices).forEach((function(t){e.vertices[t].reset()}))},addAndVerify:function(e,t){this.add(e,t);var n=this.getCycles();if(n.length){var s="Detected "+n.length+" cycle"+(1===n.length?"":"s")+":";s+="\n"+n.map((function(e){var t=e.map((function(e){return e.name}));return"  "+t.join(" -> ")+" -> "+t[0]})).join("\n");var r=new Error(s);throw r.cycles=n,r}return this},dfs:function(e,t){this.reset();for(var n,s=[this.vertices[e]];n=s.pop();)n.visited||(t(n),n.visited=!0,n.successors.forEach((function(e){s.push(e)})))},getDescendants:function(e){var t=[],n=!0;return this.dfs(e,(function(e){n?n=!1:t.push(e.name)})),t},hasCycle:function(){return this.getCycles().length>0},getStronglyConnectedComponents:function(){var e=this,t=Object.keys(e.vertices).map((function(t){return e.vertices[t].reset(),e.vertices[t]})),n=0,s=[],r=[];return t.forEach((function(e){e.index<0&&function e(t){if(t.index=n,t.lowLink=n,n++,s.push(t),t.onStack=!0,t.successors.forEach((function(n){n.index<0?(e(n),t.lowLink=Math.min(t.lowLink,n.lowLink)):n.onStack&&(t.lowLink=Math.min(t.lowLink,n.index))})),t.lowLink===t.index){var i=[];do{var c=s.pop();c.onStack=!1,i.push(c)}while(c!==t);r.push(i)}}(e)})),r},getCycles:function(){return this.getStronglyConnectedComponents().filter((function(e){return e.length>1}))},clone:function(){var e=new Graph,t=this;return Object.keys(this.vertices).forEach((function(n){var s=t.vertices[n];e.add(s.name,s.successors.map((function(e){return e.name})))})),e},toDot:function(){var e=this.vertices,t=["digraph {"];return this.getCycles().forEach((function(e,n){t.push("  subgraph cluster"+n+" {"),t.push("    color=red;"),t.push("    "+e.map((function(e){return e.name})).join("; ")+";"),t.push("  }")})),Object.keys(e).forEach((function(n){var s=e[n];s.successors.length&&s.successors.forEach((function(e){t.push("  "+s.name+" -> "+e.name)}))})),t.push("}"),t.join("\n")+"\n"}},"undefined"!=typeof module&&(module.exports=Graph);
function GraphDS(n){var r={addNode:o,removeNode:function(n){return Object.keys(e).forEach((function(r){e[r].forEach((function(e){e===n&&f(r,e)}))})),delete e[n],r},nodes:t,adjacent:c,addEdge:u,removeEdge:f,indegree:function(n){var r=0;function o(e){e===n&&r++}return Object.keys(e).forEach((function(n){e[n].forEach(o)})),r},outdegree:function(n){return n in e?e[n].length:0},depthFirstSearch:i,topologicalSort:function(n,r){return i(n,r).reverse()},serialize:function(){var n={nodes:t().map((function(n){return{id:n}})),links:[]};return n.nodes.forEach((function(r){var e=r.id;c(e).forEach((function(r){n.links.push({source:e,target:r})}))})),n},deserialize:a},e={};function o(n){return e[n]=c(n),r}function t(){var n={};return Object.keys(e).forEach((function(r){n[r]=!0,e[r].forEach((function(r){n[r]=!0}))})),Object.keys(n)}function c(n){return e[n]||[]}function u(n,e){return o(n),o(e),c(n).push(e),r}function f(n,o){return e[n]&&(e[n]=c(n).filter((function(n){return n!==o}))),r}function i(n,r){n||(n=t()),"boolean"!=typeof r&&(r=!0);var e={},o=[];function u(n){e[n]||(e[n]=!0,c(n).forEach(u),o.push(n))}return r?n.forEach(u):(n.forEach((function(n){e[n]=!0})),n.forEach((function(n){c(n).forEach(u)}))),o}function a(n){return n.nodes.forEach((function(n){o(n.id)})),n.links.forEach((function(n){u(n.source,n.target)})),r}return n&&a(n),r}"undefined"!=typeof module&&(module.exports=GraphDS);
!function(){"use strict";function t(i){return this instanceof t?(this._canvas=i="string"==typeof i?document.getElementById(i):i,this._ctx=i.getContext("2d"),this._width=i.width,this._height=i.height,this._max=1,void this.clear()):new t(i)}t.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(t,i){return this._data=t,this},max:function(t){return this._max=t,this},add:function(t){return this._data.push(t),this},clear:function(){return this._data=[],this},radius:function(t,i){i=i||15;var a=this._circle=document.createElement("canvas"),s=a.getContext("2d"),e=this._r=t+i;return a.width=a.height=2*e,s.shadowOffsetX=s.shadowOffsetY=200,s.shadowBlur=i,s.shadowColor="black",s.beginPath(),s.arc(e-200,e-200,t,0,2*Math.PI,!0),s.closePath(),s.fill(),this},gradient:function(t){var i=document.createElement("canvas"),a=i.getContext("2d"),s=a.createLinearGradient(0,0,0,256);for(var e in i.width=1,i.height=256,t)s.addColorStop(e,t[e]);return a.fillStyle=s,a.fillRect(0,0,1,256),this._grad=a.getImageData(0,0,1,256).data,this},draw:function(t){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var i=this._ctx;i.clearRect(0,0,this._width,this._height);for(var a,s=0,e=this._data.length;e>s;s++)a=this._data[s],i.globalAlpha=Math.max(a[2]/this._max,t||.05),i.drawImage(this._circle,a[0]-this._r,a[1]-this._r);var n=i.getImageData(0,0,this._width,this._height);return this._colorize(n.data,this._grad),i.putImageData(n,0,0),this},_colorize:function(t,i){for(var a,s=3,e=t.length;e>s;s+=4)(a=4*t[s])&&(t[s-3]=i[a],t[s-2]=i[a+1],t[s-1]=i[a+2])}},window.simpleheat=t}(),L.MeanLayer=(L.Layer?L.Layer:L.Class).extend({initialize:function(t,i){this._latlngs=t,L.setOptions(this,i)},setLatLngs:function(t){return this._latlngs=t,this.redraw()},addLatLng:function(t){return this._latlngs.push(t),this.redraw()},setOptions:function(t){return L.setOptions(this,t),this._heat&&this._updateOptions(),this.redraw()},redraw:function(){return this._heat&&!this._frame&&this._map&&!this._map._animating&&(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this._canvas||this._initCanvas(),this.options.pane?this.getPane().appendChild(this._canvas):t._panes.overlayPane.appendChild(this._canvas),t.on("moveend",this._reset,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){this.options.pane?this.getPane().removeChild(this._canvas):t.getPanes().overlayPane.removeChild(this._canvas),t.off("moveend",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},_initCanvas:function(){var t=this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer leaflet-layer"),i=L.DomUtil.testProp(["transformOrigin","WebkitTransformOrigin","msTransformOrigin"]);t.style[i]="50% 50%";var a=this._map.getSize();t.width=a.x,t.height=a.y;var s=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(t,"leaflet-zoom-"+(s?"animated":"hide")),this._heat=simpleheat(t),this._updateOptions()},_updateOptions:function(){this._heat.radius(this.options.radius||this._heat.defaultRadius,this.options.blur),this.options.gradient&&this._heat.gradient(this.options.gradient),this.options.max&&this._heat.max(this.options.max)},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t);var i=this._map.getSize();this._heat._width!==i.x&&(this._canvas.width=this._heat._width=i.x),this._heat._height!==i.y&&(this._canvas.height=this._heat._height=i.y),this._redraw()},_redraw:function(){if(this._map){var t,i,a,s,e,n,h,o,r,_=[],d=this._heat._r,l=this._map.getSize(),m=new L.Bounds(L.point([-d,-d]),l.add([d,d])),c=void 0===this.options.max?1:this.options.max,u=void 0===this.options.maxZoom?this._map.getMaxZoom():this.options.maxZoom,p=(Math.pow(2,Math.max(0,Math.min(u-this._map.getZoom(),12))),d/2),f=[],g=this._map._getMapPanePos(),v=g.x%p,w=g.y%p;for(t=0,i=this._latlngs.length;t<i;t++){if(a=this._map.latLngToContainerPoint(this._latlngs[t]),m.contains(a))e=Math.floor((a.x-v)/p)+2,n=Math.floor((a.y-w)/p)+2,r=void 0!==this._latlngs[t].alt?this._latlngs[t].alt:void 0!==this._latlngs[t][2]?+this._latlngs[t][2]:1,f[n]=f[n]||[],(s=f[n][e])?(kk=r/s[3],s[0]=(s[0]*s[2]/s[3]+a.x*r)/(s[2]/s[3]+r),s[1]=(s[1]*s[2]/s[3]+a.y*r)/(s[2]/s[3]+r),s[2]+=r,s[3]+=1):f[n][e]=[a.x,a.y,r,1]}for(t=0,i=f.length;t<i;t++)if(f[t])for(h=0,o=f[t].length;h<o;h++)(s=f[t][h])&&_.push([Math.round(s[0]),Math.round(s[1]),Math.min(s[2]/s[3],c)]);this._heat.data(_).draw(this.options.minOpacity),this._frame=null}},_animateZoom:function(t){var i=this._map.getZoomScale(t.zoom),a=this._map._getCenterOffset(t.center)._multiplyBy(-i).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,a,i):this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(a)+" scale("+i+")"}}),L.meanLayer=function(t,i){return new L.MeanLayer(t,i)};
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.geojsonExtent=e()}}((function(){return function e(t,n,o){function r(u,a){if(!n[u]){if(!t[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[u]={exports:{}};t[u][0].call(f.exports,(function(e){var n=t[u][1][e];return r(n||e)}),f,f.exports,e,t,n,o)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(e,t){function n(e){for(var t=i(),n=o(e),r=0;r<n.length;r++)t.include(n[r]);return t}var o=e("geojson-coords"),r=e("traverse"),i=e("extent"),u=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Feature","FeatureCollection","GeometryCollection"];t.exports=function(e){return n(e).bbox()},t.exports.polygon=function(e){return n(e).polygon()},t.exports.bboxify=function(e){return r(e).map((function(e){e&&-1!==typeof u.indexOf(e.type)&&(console.log(e.type,e),e.bbox=n(e).bbox(),this.update(e))}))}},{extent:2,"geojson-coords":4,traverse:7}],2:[function(e,t){function n(){return this instanceof n?(this._bbox=[1/0,1/0,-1/0,-1/0],void(this._valid=!1)):new n}t.exports=n,n.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this},n.prototype.union=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[2]),this._bbox[3]=Math.max(this._bbox[3],e[3]),this},n.prototype.bbox=function(){return this._valid?this._bbox:null},n.prototype.contains=function(e){return this._valid?this._bbox[0]<=e[0]&&this._bbox[1]<=e[1]&&this._bbox[2]>=e[0]&&this._bbox[3]>=e[1]:null},n.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null}},{}],3:[function(e,t){t.exports=function(e){return function e(t){return Array.isArray(t)&&t.length&&"number"==typeof t[0]?[t]:t.reduce((function(t,n){return Array.isArray(n)&&Array.isArray(n[0])?t.concat(e(n)):(t.push(n),t)}),[])}(e)}},{}],4:[function(e,t){var n=e("geojson-normalize"),o=e("geojson-flatten"),r=e("./flatten");t.exports=function(e){if(!e)return[];var t=o(n(e)),i=[];return t.features.forEach((function(e){e.geometry&&(i=i.concat(r(e.geometry.coordinates)))})),i}},{"./flatten":3,"geojson-flatten":5,"geojson-normalize":6}],5:[function(e,t){t.exports=function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce((function(t,n){return t.concat(e(n))}),[]),t;case"Feature":return e(t.geometry).map((function(e){return{type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:e}}));case"MultiPoint":return t.coordinates.map((function(e){return{type:"Point",coordinates:e}}));case"MultiPolygon":return t.coordinates.map((function(e){return{type:"Polygon",coordinates:e}}));case"MultiLineString":return t.coordinates.map((function(e){return{type:"LineString",coordinates:e}}));case"GeometryCollection":return t.geometries;case"Point":case"Polygon":case"LineString":return[t];default:return t}}},{}],6:[function(e,t){t.exports=function(e){if(!e||!e.type)return null;var t=n[e.type];return t?"geometry"===t?{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:e}]}:"feature"===t?{type:"FeatureCollection",features:[e]}:"featurecollection"===t?e:void 0:null};var n={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"}},{}],7:[function(e,t){function n(e){this.value=e}function o(e,t,n){var o=[],i=[],u=!0;return function e(l){function p(){if("object"==typeof d.node&&null!==d.node){d.keys&&d.node_===d.node||(d.keys=a(d.node)),d.isLeaf=0==d.keys.length;for(var e=0;e<i.length;e++)if(i[e].node_===l){d.circular=i[e];break}}else d.isLeaf=!0,d.keys=null;d.notLeaf=!d.isLeaf,d.notRoot=!d.isRoot}var b=n?r(l):l,h={},y=!0,d={node:b,node_:l,path:[].concat(o),parent:i[i.length-1],parents:i,key:o.slice(-1)[0],isRoot:0===o.length,level:o.length,circular:null,update:function(e,t){d.isRoot||(d.parent.node[d.key]=e),d.node=e,t&&(y=!1)},delete:function(e){delete d.parent.node[d.key],e&&(y=!1)},remove:function(e){c(d.parent.node)?d.parent.node.splice(d.key,1):delete d.parent.node[d.key],e&&(y=!1)},keys:null,before:function(e){h.before=e},after:function(e){h.after=e},pre:function(e){h.pre=e},post:function(e){h.post=e},stop:function(){u=!1},block:function(){y=!1}};if(!u)return d;p();var g=t.call(d,d.node);return void 0!==g&&d.update&&d.update(g),h.before&&h.before.call(d,d.node),y?("object"!=typeof d.node||null===d.node||d.circular||(i.push(d),p(),s(d.keys,(function(t,r){o.push(t),h.pre&&h.pre.call(d,d.node[t],t);var i=e(d.node[t]);n&&f.call(d.node,t)&&(d.node[t]=i.node),i.isLast=r==d.keys.length-1,i.isFirst=0==r,h.post&&h.post.call(d,i),o.pop()})),i.pop()),h.after&&h.after.call(d,d.node),d):d}(e).node}function r(e){if("object"==typeof e&&null!==e){var t;if(c(e))t=[];else if("[object Date]"===i(e))t=new Date(e.getTime?e.getTime():e);else if(function(e){return"[object RegExp]"===i(e)}(e))t=new RegExp(e);else if(function(e){return"[object Error]"===i(e)}(e))t={message:e.message};else if(function(e){return"[object Boolean]"===i(e)}(e))t=new Boolean(e);else if(function(e){return"[object Number]"===i(e)}(e))t=new Number(e);else if(function(e){return"[object String]"===i(e)}(e))t=new String(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},o=function(){};o.prototype=n,t=new o}return s(a(e),(function(n){t[n]=e[n]})),t}return e}function i(e){return Object.prototype.toString.call(e)}var u=t.exports=function(e){return new n(e)};n.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var o=e[n];if(!t||!f.call(t,o)){t=void 0;break}t=t[o]}return t},n.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var o=e[n];if(!t||!f.call(t,o))return!1;t=t[o]}return!0},n.prototype.set=function(e,t){for(var n=this.value,o=0;o<e.length-1;o++){var r=e[o];f.call(n,r)||(n[r]={}),n=n[r]}return n[e[o]]=t,t},n.prototype.map=function(e){return o(this.value,e,!0)},n.prototype.forEach=function(e){return this.value=o(this.value,e,!1),this.value},n.prototype.reduce=function(e,t){var n=1===arguments.length,o=n?this.value:t;return this.forEach((function(t){this.isRoot&&n||(o=e.call(this,o,t))})),o},n.prototype.paths=function(){var e=[];return this.forEach((function(){e.push(this.path)})),e},n.prototype.nodes=function(){var e=[];return this.forEach((function(){e.push(this.node)})),e},n.prototype.clone=function(){var e=[],t=[];return function n(o){for(var i=0;i<e.length;i++)if(e[i]===o)return t[i];if("object"==typeof o&&null!==o){var u=r(o);return e.push(o),t.push(u),s(a(o),(function(e){u[e]=n(o[e])})),e.pop(),t.pop(),u}return o}(this.value)};var a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)};s(a(n.prototype),(function(e){u[e]=function(t){var o=[].slice.call(arguments,1),r=new n(t);return r[e].apply(r,o)}}));var f=Object.hasOwnProperty||function(e,t){return t in e}},{}]},{},[1])(1)}));
var geoJsonColors=["#800080","#FF00FF","#000080","#0000FF","#008080","#00FFFF","#FFFF00","#800000"],geoConversion=function(){function e(e,t,r,n){for(var o=[],i={type:"FeatureCollection",features:[]},s=0;s<t.length;s++)o.push([t[s],e[s]]);var u={type:"Feature",geometry:{type:"LineString",coordinates:o},properties:{style:{color:geoJsonColors[n],weight:4,opacity:.9},description:'<span style="color: '+geoJsonColors[n]+'">'+r+"</span>"}};return u&&i.features.push(u),i}return{geoJson2dqTrip:function(e){var t={longitude:[],latitude:[]};for(i=0;i<e.features.length&&"LineString"==e.features[i].geometry.type;i++){var r=e.features[i].geometry.coordinates;for(k=0;k<r.length;k++)curLat=Number(r[k][1]),curLng=Number(r[k][0]),t.latitude.push(curLat),t.longitude.push(curLng)}return t},dqTrip2geoJson:function(t,r,n){var o=t.longitude,i=t.latitude,s=r+"_gpsTrace",u=null;return _.isUndefined(o)||_.isUndefined(i)||(u=e(i,o,s,n)),u},dqTrip2Csv:function(e){for(var t="latitude,longitude\n",r=0;r<e.longitude.length;r++)t=t+e.latitude[r]+","+e.longitude[r]+"\n";return t},hereMm2geoJson:function(t,r,n){if(_.isUndefined(t))return{};if(t=={})return{};if(_.isUndefined(t.RouteLinks))return{};for(var o,i,s=[],u=[],p=0;p<t.RouteLinks.length;p++)for(var a=t.RouteLinks[p].shape.split(" "),l=0;l<a.length;l+=2)o=Number(a[l]),s.push(o),i=Number(a[l+1]),u.push(i);return e(s,u,r+"_here",n)},graphHopper2geoJson:function(e,t,r,n){var o={};if(e.paths){for(var i=0;i<e.paths.length;i++){var s=e.paths[i];if(s.points_encoded){var u=graphhopper.util.decodePath(s.points,void 0);s.points={type:"LineString",coordinates:u}}}o={type:"FeatureCollection",features:[{type:"Feature",geometry:e.paths[0].points,properties:{style:{color:geoJsonColors[n],weight:4,opacity:.9},description:'<span style="color: '+geoJsonColors[n]+'">'+t+"_mapMatch_"+r+"</span>"}}]}}return o}}}();function Point(e,t,r){this.label=e,this.x=360*(r+180),this.y=180*(t+90),this.distance=function(e){var t=e.x-this.x,r=e.y-this.y;return Math.sqrt(t*t+r*r)},this.slope=function(e){var t=e.x-this.x;return(e.y-this.y)/t},this.toString=function(){return this.label}}function Points(e){return this.points=e,upper=function(e){for(var t=e[0],r=1;r<e.length;r++){var n=e[r];(n.y>t.y||n.y==t.y&&n.x<t.x)&&(t=n)}return t}(e),{pointSort:function(e,t){if(e==upper)return-1;if(t==upper)return 1;var r=upper.slope(e),n=upper.slope(t);return r==n?e.distance(upper)<t.distance(upper)?-1:1:r<=0&&n>0?-1:r>0&&n<=0?1:r>n?-1:1}}}
$.fn.editableTableWidget=function(e){"use strict";return $(this).each((function(){var t,i,n=$.extend(((i=$.extend({},$.fn.editableTableWidget.defaultOptions)).editor=i.editor.clone(),i),e),o=$(this),r=n.editor.css("position","absolute").hide().appendTo(o.parent()),s=function(e){(t=o.find("td:focus")).length&&(r.val(t.text()).removeClass("error").show().offset(t.offset()).css(t.css(n.cloneProperties)).width(t.width()).height(t.height()).focus(),e&&r.select())},a=function(){var e,i=r.val(),n=$.Event("change");if(t.text()===i||r.hasClass("error"))return!0;e=t.html(),t.text(i).trigger(n,i),!1===n.result&&t.html(e)},d=function(e,t){return 39===t?e.next("td"):37===t?e.prev("td"):38===t?e.parent().prev().children().eq(e.index()):40===t?e.parent().next().children().eq(e.index()):[]};r.blur((function(){a(),r.hide()})).keydown((function(e){if(13===e.which)a(),r.hide(),t.focus(),e.preventDefault(),e.stopPropagation();else if(27===e.which)r.val(t.text()),e.preventDefault(),e.stopPropagation(),r.hide(),t.focus();else if(9===e.which)t.focus();else if(this.selectionEnd-this.selectionStart===this.value.length){var i=d(t,e.which);i.length>0&&(i.focus(),e.preventDefault(),e.stopPropagation())}})).on("input paste",(function(){var e=$.Event("validate");t.trigger(e,r.val()),!1===e.result?r.addClass("error"):r.removeClass("error")})),o.on("click keypress dblclick",s).css("cursor","pointer").keydown((function(e){var t=!0,i=d($(e.target),e.which);i.length>0?i.focus():13===e.which?s(!1):17===e.which||91===e.which||93===e.which?(s(!0),t=!1):t=!1,t&&(e.stopPropagation(),e.preventDefault())})),o.find('td[data-editable="true"]').prop("tabindex",1),$(window).on("resize",(function(){r.is(":visible")&&r.offset(t.offset()).width(t.width()).height(t.height())}))}))},$.fn.editableTableWidget.defaultOptions={cloneProperties:["padding","padding-top","padding-bottom","padding-left","padding-right","text-align","font","font-size","font-family","font-weight","border","border-top","border-bottom","border-left","border-right"],editor:$("<input>")};
var angularModule=angular.module("xCLOUD",["angularjs-gauge","rzSlider","720kb.datepicker","ui.router.state","modules.python-images"]);angularModule.run(["$rootScope",function(a){a.urlBase=urlBase,a.navBarNotification="true"===navBarNotification,a.showNavBar="true"===showNavBar,a.loadingBarStart=function(a){},a.loadingBarStop=function(a){},a.notificationFilterDataValue="",a.listNotifications=[],a.nbNotifications=0,a.pageNumber=1,a.totalPages=1,a.pageNames=[],a.clearAllNotifications=function(t){a.listNotifications=[],a.nbNotifications=0;for(let t=0;t<a.alldatanodes.length;t++)a.alldatanodes[t].__notifications=void 0},a.safeApply=function(t){var o=a.$root.$$phase;"$apply"==o||"$digest"==o||a.$apply()}}]);
/**
 * State-based routing for AngularJS
 * @version v0.4.3
 * @link http://angular-ui.github.com/
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="ui.router"),function(e,t,r){"use strict";var n,a=t.isDefined,i=t.isFunction,o=t.isString,u=t.isObject,s=t.isArray,l=t.forEach,c=t.extend,f=t.copy,p=t.toJson;function h(e,t){return c(new(c((function(){}),{prototype:e})),t)}function v(e){return l(arguments,(function(t){t!==e&&l(t,(function(t,r){e.hasOwnProperty(r)||(e[r]=t)}))})),e}function $(e){if(Object.keys)return Object.keys(e);var t=[];return l(e,(function(e,r){t.push(r)})),t}function d(e,t){if(Array.prototype.indexOf)return e.indexOf(t,Number(arguments[2])||0);var r=e.length>>>0,n=Number(arguments[2])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=r);n<r;n++)if(n in e&&e[n]===t)return n;return-1}function m(e,t,r,n){var a,i=function(e,t){var r=[];for(var n in e.path){if(e.path[n]!==t.path[n])break;r.push(e.path[n])}return r}(r,n),o={},u=[];for(var s in i)if(i[s]&&i[s].params&&(a=$(i[s].params)).length)for(var l in a)d(u,a[l])>=0||(u.push(a[l]),o[a[l]]=e[a[l]]);return c({},o,t)}function g(e,t){var r={};return l(e,(function(e){r[e]=t[e]})),r}function y(e){var t={},r=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));return l(r,(function(r){r in e&&(t[r]=e[r])})),t}function w(e){var t={},r=Array.prototype.concat.apply(Array.prototype,Array.prototype.slice.call(arguments,1));for(var n in e)-1==d(r,n)&&(t[n]=e[n]);return t}function b(e,t){var r=s(e),n=r?[]:{};return l(e,(function(e,a){t(e,a)&&(n[r?n.length:a]=e)})),n}function S(e,t){var r=s(e)?[]:{};return l(e,(function(e,n){r[n]=t(e,n)})),r}function E(e){return e.then(void 0,(function(){}))&&e}function x(e,t){var r={},n=[],i=r,s=c(e.when(r),{$$promises:r,$$values:r});this.study=function(r){if(!u(r))throw new Error("'invocables' must be an object");var f=$(r||{}),p=[],h=[],m={};function g(e){return u(e)&&e.then&&e.$$promises}return l(r,(function e(a,i){if(2!==m[i]){if(h.push(i),1===m[i])throw h.splice(0,d(h,i)),new Error("Cyclic dependency: "+h.join(" -> "));if(m[i]=1,o(a))p.push(i,[function(){return t.get(a)}],n);else{var u=t.annotate(a);l(u,(function(t){t!==i&&r.hasOwnProperty(t)&&e(r[t],t)})),p.push(i,a,u)}h.pop(),m[i]=2}})),r=h=m=null,function(r,n,o){if(g(r)&&void 0===o&&(o=n,n=r,r=null),r){if(!u(r))throw new Error("'locals' must be an object")}else r=i;if(n){if(!g(n))throw new Error("'parent' must be a promise returned by $resolve.resolve()")}else n=s;var h=e.defer(),$=E(h.promise),d=$.$$promises={},m=c({},r),y=1+p.length/3,b=!1;function S(){--y||(b||v(m,n.$$values),$.$$values=m,$.$$promises=$.$$promises||!0,delete $.$$inheritedValues,h.resolve(m))}function x(e){$.$$failure=e,h.reject(e)}if(E($),a(n.$$failure))return x(n.$$failure),$;n.$$inheritedValues&&v(m,w(n.$$inheritedValues,f)),c(d,n.$$promises),n.$$values?(b=v(m,w(n.$$values,f)),$.$$inheritedValues=w(n.$$values,f),S()):(n.$$inheritedValues&&($.$$inheritedValues=w(n.$$inheritedValues,f)),n.then(S,x));for(var P=0,j=p.length;P<j;P+=3)r.hasOwnProperty(p[P])?S():A(p[P],p[P+1],p[P+2]);function A(n,i,u){var s=e.defer(),c=0;function f(e){s.reject(e),x(e)}function p(){if(!a($.$$failure))try{s.resolve(t.invoke(i,o,m)),s.promise.then((function(e){m[n]=e,S()}),f)}catch(e){f(e)}}l(u,(function(e){d.hasOwnProperty(e)&&!r.hasOwnProperty(e)&&(c++,d[e].then((function(t){m[e]=t,--c||p()}),f))})),c||p(),d[n]=E(s.promise)}return $}},this.resolve=function(e,t,r,n){return this.study(e)(t,r,n)}}function P(e,t,r,n){this.fromConfig=function(e,t,r){return a(e.template)?this.fromString(e.template,t):a(e.templateUrl)?this.fromUrl(e.templateUrl,t):a(e.templateProvider)?this.fromProvider(e.templateProvider,t,r):null},this.fromString=function(e,t){return i(e)?e(t):e},this.fromUrl=function(a,o){return i(a)&&(a=a(o)),null==a?null:n?e.get(a,{cache:t,headers:{Accept:"text/html"}}).then((function(e){return e.data})):r.get("$templateRequest")(a)},this.fromProvider=function(e,t,n){return r.invoke(e,null,n||{params:t})}}function j(e,t,r){t=c({params:{}},u(t)?t:{});var a,i,o,s,l=/([:*])([\w\[\]]+)|\{([\w\[\]]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,f=/([:]?)([\w\[\].-]+)|\{([\w\[\].-]+)(?:\:\s*((?:[^{}\\]+|\\.|\{(?:[^{}\\]+|\\.)*\})+))?\}/g,p="^",v=0,$=this.segments=[],d=r?r.params:{},m=this.params=r?r.params.$$new():new n.ParamSet,g=[];function y(t,r,a,i){if(g.push(t),d[t])return d[t];if(!/^\w+([-.]+\w+)*(?:\[\])?$/.test(t))throw new Error("Invalid parameter name '"+t+"' in pattern '"+e+"'");if(m[t])throw new Error("Duplicate parameter name '"+t+"' in pattern '"+e+"'");return m[t]=new n.Param(t,r,a,i),m[t]}function w(e,t,r,n){var a=["",""],i=e.replace(/[\\\[\]\^$*+?.()|{}]/g,"\\$&");if(!t)return i;switch(r){case!1:a=["(",")"+(n?"?":"")];break;case!0:i=i.replace(/\/$/,""),a=["(?:/(",")|/)?"];break;default:a=["("+r+"|",")?"]}return i+a[0]+t+a[1]}function b(r,a){var i,o,u,s,l;return i=r[2]||r[3],l=t.params[i],u=e.substring(v,r.index),(o=a?r[4]:r[4]||("*"==r[1]?".*":null))&&(s=n.type(o)||h(n.type("string"),{pattern:new RegExp(o,t.caseInsensitive?"i":void 0)})),{id:i,regexp:o,segment:u,type:s,cfg:l}}for(this.source=e;(a=l.exec(e))&&!((i=b(a,!1)).segment.indexOf("?")>=0);)o=y(i.id,i.type,i.cfg,"path"),p+=w(i.segment,o.type.pattern.source,o.squash,o.isOptional),$.push(i.segment),v=l.lastIndex;var S=(s=e.substring(v)).indexOf("?");if(S>=0){var E=this.sourceSearch=s.substring(S);if(s=s.substring(0,S),this.sourcePath=e.substring(0,v+S),E.length>0)for(v=0;a=f.exec(E);)o=y((i=b(a,!0)).id,i.type,i.cfg,"search"),v=l.lastIndex}else this.sourcePath=e,this.sourceSearch="";p+=w(s)+(!1===t.strict?"/?":"")+"$",$.push(s),this.regexp=new RegExp(p,t.caseInsensitive?"i":void 0),this.prefix=$[0],this.$$paramNames=g}function A(e){c(this,e)}function C(e,r){var n,u=[],l=null,f=!1;function p(e,t,r){if(!r)return!1;var n=e.invoke(t,t,{$match:r});return!a(n)||n}function h(r,a,i,s,c){var p,h=s.baseHref(),v=r.url();function $(e){if(!e||!e.defaultPrevented){p&&r.url();p=void 0;var t,n=u.length;for(t=0;t<n;t++)if(a(u[t]))return;l&&a(l)}function a(e){var t=e(i,r);return!!t&&(o(t)&&r.replace().url(t),!0)}}function d(){return n=n||a.$on("$locationChangeSuccess",$)}return f||d(),{sync:function(){$()},listen:function(){return d()},update:function(e){e?v=r.url():r.url()!==v&&(r.url(v),r.replace())},push:function(e,t,n){var a=e.format(t||{});null!==a&&t&&t["#"]&&(a+="#"+t["#"]),r.url(a),p=n&&n.$$avoidResync?r.url():void 0,n&&n.replace&&r.replace()},href:function(n,a,i){if(!n.validates(a))return null;var o=e.html5Mode();t.isObject(o)&&(o=o.enabled),o=o&&c.history;var u=n.format(a);if(i=i||{},o||null===u||(u="#"+e.hashPrefix()+u),null!==u&&a&&a["#"]&&(u+="#"+a["#"]),u=function(e,t,r){return"/"===h?e:t?h.slice(0,-1)+e:r?h.slice(1)+e:e}(u,o,i.absolute),!i.absolute||!u)return u;var s=!o&&u?"/":"",l=r.port();return l=80===l||443===l?"":":"+l,[r.protocol(),"://",r.host(),l,s,u].join("")}}}this.rule=function(e){if(!i(e))throw new Error("'rule' must be a function");return u.push(e),this},this.otherwise=function(e){if(o(e)){var t=e;e=function(){return t}}else if(!i(e))throw new Error("'rule' must be a function");return l=e,this},this.when=function(e,t){var n,a=o(t);if(o(e)&&(e=r.compile(e)),!a&&!i(t)&&!s(t))throw new Error("invalid 'handler' in when()");var u={matcher:function(e,t){return a&&(n=r.compile(t),t=["$match",function(e){return n.format(e)}]),c((function(r,n){return p(r,t,e.exec(n.path(),n.search()))}),{prefix:o(e.prefix)?e.prefix:""})},regex:function(e,t){if(e.global||e.sticky)throw new Error("when() RegExp must not be global or sticky");return a&&(n=t,t=["$match",function(e){return t=e,n.replace(/\$(\$|\d{1,2})/,(function(e,r){return t["$"===r?0:Number(r)]}));var t}]),c((function(r,n){return p(r,t,e.exec(n.path()))}),{prefix:(r=e,i=/^\^((?:\\[^a-zA-Z0-9]|[^\\\[\]\^$*+?.()|{}]+)*)/.exec(r.source),null!=i?i[1].replace(/\\(.)/g,"$1"):"")});var r,i}},l={matcher:r.isMatcher(e),regex:e instanceof RegExp};for(var f in l)if(l[f])return this.rule(u[f](e,t));throw new Error("invalid 'what' in when()")},this.deferIntercept=function(e){void 0===e&&(e=!0),f=e},this.$get=h,h.$inject=["$location","$rootScope","$injector","$browser","$sniffer"]}function q(e,r){var p,v,w={},b={},x={parent:function(e){if(a(e.parent)&&e.parent)return P(e.parent);var t=/^(.+)\.[^.]+$/.exec(e.name);return t?P(t[1]):p},data:function(e){return e.parent&&e.parent.data&&(e.data=e.self.data=h(e.parent.data,e.data)),e.data},url:function(e){var t=e.url,n={params:e.params||{}};if(o(t))return"^"==t.charAt(0)?r.compile(t.substring(1),n):(e.parent.navigable||p).url.concat(t,n);if(!t||r.isMatcher(t))return t;throw new Error("Invalid url '"+t+"' in state '"+e+"'")},navigable:function(e){return e.url?e:e.parent?e.parent.navigable:null},ownParams:function(e){var t=e.url&&e.url.params||new n.ParamSet;return l(e.params||{},(function(e,r){t[r]||(t[r]=new n.Param(r,null,e,"config"))})),t},params:function(e){var t=y(e.ownParams,e.ownParams.$$keys());return e.parent&&e.parent.params?c(e.parent.params.$$new(),t):new n.ParamSet},views:function(e){var t={};return l(a(e.views)?e.views:{"":e},(function(r,n){n.indexOf("@")<0&&(n+="@"+e.parent.name),r.resolveAs=r.resolveAs||e.resolveAs||"$resolve",t[n]=r})),t},path:function(e){return e.parent?e.parent.path.concat(e):[]},includes:function(e){var t=e.parent?c({},e.parent.includes):{};return t[e.name]=!0,t},$delegates:{}};function P(e,t){if(e){var r,n=o(e),a=n?e:e.name;if(0===(r=a).indexOf(".")||0===r.indexOf("^")){if(!t)throw new Error("No reference point given for path '"+a+"'");t=P(t);for(var i=a.split("."),u=0,s=i.length,l=t;u<s;u++)if(""!==i[u]||0!==u){if("^"!==i[u])break;if(!l.parent)throw new Error("Path '"+a+"' not valid for state '"+t.name+"'");l=l.parent}else l=t;i=i.slice(u).join("."),a=l.name+(l.name&&i?".":"")+i}var c=w[a];return!c||!n&&(n||c!==e&&c.self!==e)?void 0:c}}function j(t){var r=(t=h(t,{self:t,resolve:t.resolve||{},toString:function(){return this.name}})).name;if(!o(r)||r.indexOf("@")>=0)throw new Error("State must have a valid name");if(w.hasOwnProperty(r))throw new Error("State '"+r+"' is already defined");var n=-1!==r.indexOf(".")?r.substring(0,r.lastIndexOf(".")):o(t.parent)?t.parent:u(t.parent)&&o(t.parent.name)?t.parent.name:"";if(n&&!w[n])return function(e,t){b[e]||(b[e]=[]),b[e].push(t)}(n,t.self);for(var a in x)i(x[a])&&(t[a]=x[a](t,x.$delegates[a]));return w[r]=t,!t.abstract&&t.url&&e.when(t.url,["$match","$stateParams",function(e,r){v.$current.navigable==t&&function(e,t,r){if(!r)for(var n in r=[],e)r.push(n);for(var a=0;a<r.length;a++){var i=r[a];if(e[i]!=t[i])return!1}return!0}(e,r)||v.transitionTo(t,e,{inherit:!0,location:!1})}]),function(e){for(var t=b[e]||[];t.length;)j(t.shift())}(r),t}function A(e,r,b,x,j,A,C,q,O){var k=new Error("transition superseded"),I=E(r.reject(k)),V=E(r.reject(new Error("transition prevented"))),M=E(r.reject(new Error("transition aborted"))),R=E(r.reject(new Error("transition failed")));function F(e,n,a,o,u,c){var f=a?n:g(e.params.$$keys(),n),p={$stateParams:f};u.resolve=j.resolve(e.resolve,p,u.resolve,e);var h=[u.resolve.then((function(e){u.globals=e}))];return o&&h.push(o),r.all(h).then((function(){var n=[];return l(e.views,(function(r,a){var o=r.resolve&&r.resolve!==e.resolve?r.resolve:{};o.$template=[function(){return b.load(a,{view:r,locals:u.globals,params:f,notify:c.notify})||""}],n.push(j.resolve(o,u.globals,u.resolve,e).then((function(n){if(i(r.controllerProvider)||s(r.controllerProvider)){var l=t.extend({},o,u.globals);n.$$controller=x.invoke(r.controllerProvider,null,l)}else n.$$controller=r.controller;n.$$state=e,n.$$controllerAs=r.controllerAs,n.$$resolveAs=r.resolveAs,u[a]=n})))})),r.all(n).then((function(){return u.globals}))})).then((function(e){return u}))}return p.locals={resolve:null,globals:{$stateParams:{}}},(v={params:{},current:p.self,$current:p,transition:null}).reload=function(e){return v.transitionTo(v.current,A,{reload:e||!0,inherit:!1,notify:!0})},v.go=function(e,t,r){return v.transitionTo(e,t,c({inherit:!0,relative:v.$current},r))},v.transitionTo=function(t,i,s){i=i||{},s=c({location:!0,inherit:!1,relative:null,notify:!0,reload:!1,$retry:!1},s||{});var l=v.$current,$=v.params,d=l.path,w=P(t,s.relative),b=i["#"];if(!a(w)){var S={to:t,toParams:i,options:s},j=function(t,n,a,i){var o=e.$broadcast("$stateNotFound",t,n,a);if(o.defaultPrevented)return C.update(),M;if(!o.retry)return null;if(i.$retry)return C.update(),R;var u=v.transition=r.when(o.retry);return u.then((function(){return u!==v.transition?(e.$broadcast("$stateChangeCancel",t.to,t.toParams,n,a),I):(t.options.$retry=!0,v.transitionTo(t.to,t.toParams,t.options))}),(function(){return M})),C.update(),u}(S,l.self,$,s);if(j)return j;if(i=S.toParams,w=P(t=S.to,(s=S.options).relative),!a(w)){if(!s.relative)throw new Error("No such state '"+t+"'");throw new Error("Could not resolve '"+t+"' from state '"+s.relative+"'")}}if(w.abstract)throw new Error("Cannot transition to abstract state '"+t+"'");if(s.inherit&&(i=m(A,i||{},v.$current,w)),!w.params.$$validates(i))return R;i=w.params.$$values(i);var q=(t=w).path,O=0,N=q[O],D=p.locals,U=[];if(s.reload){if(o(s.reload)||u(s.reload)){if(u(s.reload)&&!s.reload.name)throw new Error("Invalid reload state object");var T=!0===s.reload?d[0]:P(s.reload);if(s.reload&&!T)throw new Error("No such reload state '"+(o(s.reload)?s.reload:s.reload.name)+"'");for(;N&&N===d[O]&&N!==T;)D=U[O]=N.locals,O++,N=q[O]}}else for(;N&&N===d[O]&&N.ownParams.$$equals(i,$);)D=U[O]=N.locals,O++,N=q[O];if(function(e,t,r,a,i,o){if(!o.reload&&e===r&&(i===r.locals||!1===e.self.reloadOnSearch&&function(e,t,r){var a=e.params.$$keys().filter((function(t){return"search"!=e.params[t].location})),i=y.apply({},[e.params].concat(a));return new n.ParamSet(i).$$equals(t,r)}(r,a,t)))return!0}(t,i,l,$,D,s))return b&&(i["#"]=b),v.params=i,f(v.params,A),f(g(t.params.$$keys(),A),t.locals.globals.$stateParams),s.location&&t.navigable&&t.navigable.url&&(C.push(t.navigable.url,i,{$$avoidResync:!0,replace:"replace"===s.location}),C.update(!0)),v.transition=null,r.when(v.current);if(i=g(t.params.$$keys(),i||{}),b&&(i["#"]=b),s.notify&&e.$broadcast("$stateChangeStart",t.self,i,l.self,$,s).defaultPrevented)return e.$broadcast("$stateChangeCancel",t.self,i,l.self,$),null==v.transition&&C.update(),V;for(var L=r.when(D),z=O;z<q.length;z++,N=q[z])D=U[z]=h(D),L=F(N,i,N===t,L,D,s);var H=v.transition=L.then((function(){var r,n,a;if(v.transition!==H)return e.$broadcast("$stateChangeCancel",t.self,i,l.self,$),I;for(r=d.length-1;r>=O;r--)(a=d[r]).self.onExit&&x.invoke(a.self.onExit,a.self,a.locals.globals),a.locals=null;for(r=O;r<q.length;r++)(n=q[r]).locals=U[r],n.self.onEnter&&x.invoke(n.self.onEnter,n.self,n.locals.globals);return v.transition!==H?(e.$broadcast("$stateChangeCancel",t.self,i,l.self,$),I):(v.$current=t,v.current=t.self,v.params=i,f(v.params,A),v.transition=null,s.location&&t.navigable&&C.push(t.navigable.url,t.navigable.locals.globals.$stateParams,{$$avoidResync:!0,replace:"replace"===s.location}),s.notify&&e.$broadcast("$stateChangeSuccess",t.self,i,l.self,$),C.update(!0),v.current)})).then(null,(function(n){return n===k?I:v.transition!==H?(e.$broadcast("$stateChangeCancel",t.self,i,l.self,$),I):(v.transition=null,e.$broadcast("$stateChangeError",t.self,i,l.self,$,n).defaultPrevented||C.update(),r.reject(n))}));return E(H),H},v.is=function(e,t,r){var n=P(e,(r=c({relative:v.$current},r||{})).relative);if(a(n))return v.$current===n&&(!t||$(t).reduce((function(e,r){var a=n.params[r];return e&&(!a||a.type.equals(A[r],t[r]))}),!0))},v.includes=function(e,t,r){if(r=c({relative:v.$current},r||{}),o(e)&&e.indexOf("*")>-1){if(!function(e){for(var t=e.split("."),r=v.$current.name.split("."),n=0,a=t.length;n<a;n++)"*"===t[n]&&(r[n]="*");return"**"===t[0]&&(r=r.slice(d(r,t[1]))).unshift("**"),"**"===t[t.length-1]&&(r.splice(d(r,t[t.length-2])+1,Number.MAX_VALUE),r.push("**")),t.length==r.length&&r.join("")===t.join("")}(e))return!1;e=v.$current.name}var n=P(e,r.relative);if(a(n)){if(!a(v.$current.includes[n.name]))return!1;if(!t)return!0;for(var i=$(t),u=0;u<i.length;u++){var s=i[u],l=n.params[s];if(l&&!l.type.equals(A[s],t[s]))return!1}return $(t).reduce((function(e,r){var a=n.params[r];return e&&!a||a.type.equals(A[r],t[r])}),!0)}},v.href=function(e,t,r){var n=P(e,(r=c({lossy:!0,inherit:!0,absolute:!1,relative:v.$current},r||{})).relative);if(!a(n))return null;r.inherit&&(t=m(A,t||{},v.$current,n));var i=n&&r.lossy?n.navigable:n;return i&&void 0!==i.url&&null!==i.url?C.href(i.url,g(n.params.$$keys().concat("#"),t||{}),{absolute:r.absolute}):null},v.get=function(e,t){if(0===arguments.length)return S($(w),(function(e){return w[e].self}));var r=P(e,t||v.$current);return r&&r.self?r.self:null},v}(p=j({name:"",url:"^",views:null,abstract:!0})).navigable=null,this.decorator=function(e,t){if(o(e)&&!a(t))return x[e];if(!i(t)||!o(e))return this;x[e]&&!x.$delegates[e]&&(x.$delegates[e]=x[e]);return x[e]=t,this},this.state=function(e,t){u(e)?t=e:t.name=e;return j(t),this},this.$get=A,A.$inject=["$rootScope","$q","$view","$injector","$resolve","$stateParams","$urlRouter","$location","$urlMatcherFactory"]}function O(){function e(e,t){return{load:function(e,r){var n;return(r=c({template:null,controller:null,view:null,locals:null,notify:!0,async:!0,params:{}},r)).view&&(n=t.fromConfig(r.view,r.params,r.locals)),n}}}this.$get=e,e.$inject=["$rootScope","$templateFactory"]}function k(e,r,n,a,i){var o=r.has?function(e){return r.has(e)?r.get(e):null}:function(e){try{return r.get(e)}catch(e){return null}},u=o("$animator"),s=o("$animate");return{restrict:"ECA",terminal:!0,priority:400,transclude:"element",compile:function(r,o,l){return function(r,o,c){var f,p,h,v,$=c.onload||"",d=c.autoscroll,m=function(e,r){if(s)return{enter:function(e,r,n){t.version.minor>2?s.enter(e,null,r).then(n):s.enter(e,null,r,n)},leave:function(e,r){t.version.minor>2?s.leave(e).then(r):s.leave(e,r)}};if(u){var n=u&&u(r,e);return{enter:function(e,t,r){n.enter(e,null,t),r()},leave:function(e,t){n.leave(e),t()}}}return{enter:function(e,t,r){t.after(e),r()},leave:function(e,t){e.remove(),t()}}}(c,r);o.inheritedData("$uiView");function g(u){var s,g=V(r,c,o,a),y=g&&e.$current&&e.$current.locals[g];if(u||y!==v){s=r.$new(),v=e.$current.locals[g],s.$emit("$viewContentLoading",g);var w=l(s,(function(e){var a=i.defer(),u=i.defer(),s={$animEnter:a.promise,$animLeave:u.promise,$$animLeave:u};e.data("$uiViewAnim",s),m.enter(e,o,(function(){a.resolve(),h&&h.$emit("$viewContentAnimationEnded"),(t.isDefined(d)&&!d||r.$eval(d))&&n(e)})),function(){if(f&&(f.remove(),f=null),h&&(h.$destroy(),h=null),p){var e=p.data("$uiViewAnim");m.leave(p,(function(){e.$$animLeave.resolve(),f=null})),f=p,p=null}}()}));p=w,(h=s).$emit("$viewContentLoaded",g),h.$eval($)}}r.$on("$stateChangeSuccess",(function(){g(!1)})),g(!0)}}}}function I(e,r,n,a){return{restrict:"ECA",priority:-400,compile:function(o){var u=o.html();return o.empty?o.empty():o[0].innerHTML=null,function(o,s,l){var c=n.$current,f=V(o,l,s,a),p=c&&c.locals[f];if(!p)return s.html(u),void e(s.contents())(o);s.data("$uiView",{name:f,state:p.$$state}),s.html(p.$template?p.$template:u);var h=t.extend({},p);o[p.$$resolveAs]=h;var v=e(s.contents());if(p.$$controller){p.$scope=o,p.$element=s;var $=r(p.$$controller,p);p.$$controllerAs&&(o[p.$$controllerAs]=$,o[p.$$controllerAs][p.$$resolveAs]=h),i($.$onInit)&&$.$onInit(),s.data("$ngControllerController",$),s.children().data("$ngControllerController",$)}v(o)}}}}function V(e,t,r,n){var a=n(t.uiView||t.name||"")(e),i=r.inheritedData("$uiView");return a.indexOf("@")>=0?a:a+"@"+(i?i.state.name:"")}function M(e,t){var r,n=e.match(/^\s*({[^}]*})\s*$/);if(n&&(e=t+"("+n[1]+")"),!(r=e.replace(/\n/g," ").match(/^([^(]+?)\s*(\((.*)\))?$/))||4!==r.length)throw new Error("Invalid state ref '"+e+"'");return{state:r[1],paramExpr:r[3]||null}}function R(e){var t=e.parent().inheritedData("$uiView");if(t&&t.state&&t.state.name)return t.state}function F(e){var t="[object SVGAnimatedString]"===Object.prototype.toString.call(e.prop("href")),r="FORM"===e[0].nodeName;return{attr:r?"action":t?"xlink:href":"href",isAnchor:"A"===e.prop("tagName").toUpperCase(),clickable:!r}}function N(e,t,r,n,a){return function(i){var o=i.which||i.button,u=a();if(!(o>1||i.ctrlKey||i.metaKey||i.shiftKey||e.attr("target"))){var s=r((function(){t.go(u.state,u.params,u.options)}));i.preventDefault();var l=n.isAnchor&&!u.href?1:0;i.preventDefault=function(){l--<=0&&r.cancel(s)}}}}function D(e,r){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(n,a,i,o){var u,s=M(i.uiSref,e.current.name),l={state:s.state,href:null,params:null},f=F(a),p=o[1]||o[0],h=null;l.options=c(function(e,t){return{relative:R(e)||t.$current,inherit:!0}}(a,e),i.uiSrefOpts?n.$eval(i.uiSrefOpts):{});var v=function(r){r&&(l.params=t.copy(r)),l.href=e.href(s.state,l.params,l.options),h&&h(),p&&(h=p.$$addStateInfo(s.state,l.params)),null!==l.href&&i.$set(f.attr,l.href)};s.paramExpr&&(n.$watch(s.paramExpr,(function(e){e!==l.params&&v(e)}),!0),l.params=t.copy(n.$eval(s.paramExpr))),v(),f.clickable&&(u=N(a,e,r,f,(function(){return l})),a[a.on?"on":"bind"]("click",u),n.$on("$destroy",(function(){a[a.off?"off":"unbind"]("click",u)})))}}}function U(e,t){return{restrict:"A",require:["?^uiSrefActive","?^uiSrefActiveEq"],link:function(r,n,a,i){var o,u=F(n),s=i[1]||i[0],l="["+[a.uiState,a.uiStateParams||null,a.uiStateOpts||null].map((function(e){return e||"null"})).join(", ")+"]",c={state:null,params:null,options:null,href:null},f=null;function p(t){c.state=t[0],c.params=t[1],c.options=t[2],c.href=e.href(c.state,c.params,c.options),f&&f(),s&&(f=s.$$addStateInfo(c.state,c.params)),c.href&&a.$set(u.attr,c.href)}r.$watch(l,p,!0),p(r.$eval(l)),u.clickable&&(o=N(n,e,t,u,(function(){return c})),n[n.on?"on":"bind"]("click",o),r.$on("$destroy",(function(){n[n.off?"off":"unbind"]("click",o)})))}}}function T(e,t,r){return{restrict:"A",controller:["$scope","$element","$attrs","$timeout",function(t,n,a,i){var s,c,f=[],h={};s=r(a.uiSrefActiveEq||"",!1)(t);try{c=t.$eval(a.uiSrefActive)}catch(e){}function v(r,a,i){var s=e.get(r,R(n)),l=function(e,r){if(!o(e))throw new Error("state should be a string");if(u(r))return e+p(r);if(r=t.$eval(r),u(r))return e+p(r);return e}(r,a),c={state:s||{name:r},params:a,hash:l};return f.push(c),h[l]=i,function(){var e=f.indexOf(c);-1!==e&&f.splice(e,1)}}function $(){for(var t=0;t<f.length;t++)r=f[t].state,a=f[t].params,e.includes(r.name,a)?d(n,h[f[t].hash]):m(n,h[f[t].hash]),g(f[t].state,f[t].params)?d(n,s):m(n,s);var r,a}function d(e,t){i((function(){e.addClass(t)}))}function m(e,t){e.removeClass(t)}function g(t,r){return e.is(t.name,r)}c=c||r(a.uiSrefActive||"",!1)(t),u(c)&&l(c,(function(r,n){if(o(r)){var a=M(r,e.current.name);v(a.state,t.$eval(a.paramExpr),n)}})),this.$$addStateInfo=function(e,t){if(!(u(c)&&f.length>0)){var r=v(e,t,c);return $(),r}},t.$on("$stateChangeSuccess",$),$()}]}}function L(e){var t=function(t,r){return e.is(t,r)};return t.$stateful=!0,t}function z(e){var t=function(t,r,n){return e.includes(t,r,n)};return t.$stateful=!0,t}t.module("ui.router.util",["ng"]),t.module("ui.router.router",["ui.router.util"]),t.module("ui.router.state",["ui.router.router","ui.router.util"]),t.module("ui.router",["ui.router.state"]),t.module("ui.router.compat",["ui.router"]),x.$inject=["$q","$injector"],t.module("ui.router.util").service("$resolve",x),t.module("ui.router.util").provider("$templateFactory",(function(){var e=t.version.minor<3;this.shouldUnsafelyUseHttp=function(t){e=!!t},this.$get=["$http","$templateCache","$injector",function(t,r,n){return new P(t,r,n,e)}]})),j.prototype.concat=function(e,t){var r={caseInsensitive:n.caseInsensitive(),strict:n.strictMode(),squash:n.defaultSquashPolicy()};return new j(this.sourcePath+e+this.sourceSearch,c(r,t),this)},j.prototype.toString=function(){return this.source},j.prototype.exec=function(e,t){var r=this.regexp.exec(e);if(!r)return null;t=t||{};var n,i,o,u,s,l=this.parameters(),c=l.length,f=this.segments.length-1,p={};if(f!==r.length-1)throw new Error("Unbalanced capture group in route '"+this.source+"'");function h(e){function t(e){return e.split("").reverse().join("")}var r=S(t(e).split(/-(?!\\)/),t);return S(r,(function(e){return e.replace(/\\-/g,"-")})).reverse()}for(n=0;n<f;n++){for(o=l[n],u=this.params[o],s=r[n+1],i=0;i<u.replace.length;i++)u.replace[i].from===s&&(s=u.replace[i].to);s&&!0===u.array&&(s=h(s)),a(s)&&(s=u.type.decode(s)),p[o]=u.value(s)}for(;n<c;n++){for(p[o=l[n]]=this.params[o].value(t[o]),u=this.params[o],s=t[o],i=0;i<u.replace.length;i++)u.replace[i].from===s&&(s=u.replace[i].to);a(s)&&(s=u.type.decode(s)),p[o]=u.value(s)}return p},j.prototype.parameters=function(e){return a(e)?this.params[e]||null:this.$$paramNames},j.prototype.validates=function(e){return this.params.$$validates(e)},j.prototype.format=function(e){e=e||{};var t=this.segments,r=this.parameters(),n=this.params;if(!this.validates(e))return null;var a,i=!1,u=t.length-1,l=r.length,c=t[0];function f(e){return encodeURIComponent(e).replace(/-/g,(function(e){return"%5C%"+e.charCodeAt(0).toString(16).toUpperCase()}))}for(a=0;a<l;a++){var p=a<u,h=r[a],v=n[h],$=v.value(e[h]),d=v.isOptional&&v.type.equals(v.value(),$),m=!!d&&v.squash,g=v.type.encode($);if(p){var y=t[a+1],w=a+1===u;if(!1===m)null!=g&&(s(g)?c+=S(g,f).join("-"):c+=encodeURIComponent(g)),c+=y;else if(!0===m){var b=c.match(/\/$/)?/\/?(.*)/:/(.*)/;c+=y.match(b)[1]}else o(m)&&(c+=m+y);w&&!0===v.squash&&"/"===c.slice(-1)&&(c=c.slice(0,-1))}else{if(null==g||d&&!1!==m)continue;if(s(g)||(g=[g]),0===g.length)continue;c+=(i?"&":"?")+h+"="+(g=S(g,encodeURIComponent).join("&"+h+"=")),i=!0}}return c},A.prototype.is=function(e,t){return!0},A.prototype.encode=function(e,t){return e},A.prototype.decode=function(e,t){return e},A.prototype.equals=function(e,t){return e==t},A.prototype.$subPattern=function(){var e=this.pattern.toString();return e.substr(1,e.length-2)},A.prototype.pattern=/.*/,A.prototype.toString=function(){return"{Type:"+this.name+"}"},A.prototype.$normalize=function(e){return this.is(e)?e:this.decode(e)},A.prototype.$asArray=function(e,t){if(!e)return this;if("auto"===e&&!t)throw new Error("'auto' array mode is for query parameters only");return new function(e,t){function r(e,t){return function(){return e[t].apply(e,arguments)}}function n(e){return s(e)?e:a(e)?[e]:[]}function i(e){return!e}function o(e,r){return function(a){if(s(a)&&0===a.length)return a;var o=S(a=n(a),e);return!0===r?0===b(o,i).length:function(e){switch(e.length){case 0:return;case 1:return"auto"===t?e[0]:e;default:return e}}(o)}}var u;this.encode=o(r(e,"encode")),this.decode=o(r(e,"decode")),this.is=o(r(e,"is"),!0),this.equals=(u=r(e,"equals"),function(e,t){var r=n(e),a=n(t);if(r.length!==a.length)return!1;for(var i=0;i<r.length;i++)if(!u(r[i],a[i]))return!1;return!0}),this.pattern=e.pattern,this.$normalize=o(r(e,"$normalize")),this.name=e.name,this.$arrayMode=t}(this,e)},t.module("ui.router.util").provider("$urlMatcherFactory",(function e(){n=this;var r=!1,f=!0,p=!1;function v(e){return null!=e?e.toString().replace(/(~|\/)/g,(function(e){return{"~":"~~","/":"~2F"}[e]})):e}var m,g={},y=!0,w=[],E={string:{encode:v,decode:function(e){return null!=e?e.toString().replace(/(~~|~2F)/g,(function(e){return{"~~":"~","~2F":"/"}[e]})):e},is:function(e){return null==e||!a(e)||"string"==typeof e},pattern:/[^/]*/},int:{encode:v,decode:function(e){return parseInt(e,10)},is:function(e){return null!=e&&this.decode(e.toString())===e},pattern:/-?\d+/},bool:{encode:function(e){return e?1:0},decode:function(e){return 0!==parseInt(e,10)},is:function(e){return!0===e||!1===e},pattern:/0|1/},date:{encode:function(e){if(this.is(e))return[e.getFullYear(),("0"+(e.getMonth()+1)).slice(-2),("0"+e.getDate()).slice(-2)].join("-")},decode:function(e){if(this.is(e))return e;var t=this.capture.exec(e);return t?new Date(t[1],t[2]-1,t[3]):void 0},is:function(e){return e instanceof Date&&!isNaN(e.valueOf())},equals:function(e,t){return this.is(e)&&this.is(t)&&e.toISOString()===t.toISOString()},pattern:/[0-9]{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[1-2][0-9]|3[0-1])/,capture:/([0-9]{4})-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])/},json:{encode:t.toJson,decode:t.fromJson,is:t.isObject,equals:t.equals,pattern:/[^/]*/},any:{encode:t.identity,decode:t.identity,equals:t.equals,pattern:/.*/}};function x(e){return i(e)||s(e)&&i(e[e.length-1])}function P(){for(;w.length;){var e=w.shift();if(e.pattern)throw new Error("You cannot override a type's .pattern at runtime.");t.extend(g[e.name],m.invoke(e.def))}}function C(e){c(this,e||{})}e.$$getDefaultValue=function(e){if(!x(e.value))return e.value;if(!m)throw new Error("Injectable functions cannot be called at configuration time");return m.invoke(e.value)},this.caseInsensitive=function(e){return a(e)&&(r=e),r},this.strictMode=function(e){return a(e)&&(f=e),f},this.defaultSquashPolicy=function(e){if(!a(e))return p;if(!0!==e&&!1!==e&&!o(e))throw new Error("Invalid squash policy: "+e+". Valid policies: false, true, arbitrary-string");return p=e,e},this.compile=function(e,t){return new j(e,c({strict:f,caseInsensitive:r},t))},this.isMatcher=function(e){if(!u(e))return!1;var t=!0;return l(j.prototype,(function(r,n){i(r)&&(t=t&&a(e[n])&&i(e[n]))})),t},this.type=function(e,t,r){if(!a(t))return g[e];if(g.hasOwnProperty(e))throw new Error("A type named '"+e+"' has already been defined.");return g[e]=new A(c({name:e},t)),r&&(w.push({name:e,def:r}),y||P()),this},l(E,(function(e,t){g[t]=new A(c({name:t},e))})),g=h(g,{}),this.$get=["$injector",function(e){return m=e,y=!1,P(),l(E,(function(e,t){g[t]||(g[t]=new A(e))})),this}],this.Param=function(e,r,n,i){var l=this;n=function(e){var t=u(e)?$(e):[];-1===d(t,"value")&&-1===d(t,"type")&&-1===d(t,"squash")&&-1===d(t,"array")&&(e={value:e});return e.$$fn=x(e.value)?e.value:function(){return e.value},e}(n),r=function(r,n,a){if(r.type&&n)throw new Error("Param '"+e+"' has two type configurations.");return n||(r.type?t.isString(r.type)?g[r.type]:r.type instanceof A?r.type:new A(r.type):"config"===a?g.any:g.string)}(n,r,i);var f,h,v=(f={array:"search"===i&&"auto"},h=e.match(/\[\]$/)?{array:!0}:{},c(f,h,n).array);"string"!==(r=v?r.$asArray(v,"search"===i):r).name||v||"path"!==i||void 0!==n.value||(n.value="");var y=void 0!==n.value,w=function(e,t){var r=e.squash;if(!t||!1===r)return!1;if(!a(r)||null==r)return p;if(!0===r||o(r))return r;throw new Error("Invalid squash policy: '"+r+"'. Valid policies: false, true, or arbitrary string")}(n,y),E=function(e,t,r,n){var a,i,u=[{from:"",to:r||t?void 0:""},{from:null,to:r||t?void 0:""}];a=s(e.replace)?e.replace:[],o(n)&&a.push({from:n,to:void 0});return i=S(a,(function(e){return e.from})),b(u,(function(e){return-1===d(i,e.from)})).concat(a)}(n,v,y,w);c(this,{id:e,type:r,location:i,array:v,squash:w,replace:E,isOptional:y,value:function(e){return e=function(e){var t,r=S(b(l.replace,(t=e,function(e){return e.from===t})),(function(e){return e.to}));return r.length?r[0]:e}(e),a(e)?l.type.$normalize(e):function(){if(!m)throw new Error("Injectable functions cannot be called at configuration time");var e=m.invoke(n.$$fn);if(null!=e&&!l.type.is(e))throw new Error("Default value ("+e+") for parameter '"+l.id+"' is not an instance of Type ("+l.type.name+")");return e}()},dynamic:void 0,config:n,toString:function(){return"{Param:"+e+" "+r+" squash: '"+w+"' optional: "+y+"}"}})},C.prototype={$$new:function(){return h(this,c(new C,{$$parent:this}))},$$keys:function(){for(var e=[],t=[],r=this,n=$(C.prototype);r;)t.push(r),r=r.$$parent;return t.reverse(),l(t,(function(t){l($(t),(function(t){-1===d(e,t)&&-1===d(n,t)&&e.push(t)}))})),e},$$values:function(e){var t={},r=this;return l(r.$$keys(),(function(n){t[n]=r[n].value(e&&e[n])})),t},$$equals:function(e,t){var r=!0,n=this;return l(n.$$keys(),(function(a){var i=e&&e[a],o=t&&t[a];n[a].type.equals(i,o)||(r=!1)})),r},$$validates:function(e){var r,n,a,i,o,u=this.$$keys();for(r=0;r<u.length&&(n=this[u[r]],null!=(a=e[u[r]])||!n.isOptional);r++){if(i=n.type.$normalize(a),!n.type.is(i))return!1;if(o=n.type.encode(i),t.isString(o)&&!n.type.pattern.exec(o))return!1}return!0},$$parent:void 0},this.ParamSet=C})),t.module("ui.router.util").run(["$urlMatcherFactory",function(e){}]),C.$inject=["$locationProvider","$urlMatcherFactoryProvider"],t.module("ui.router.router").provider("$urlRouter",C),q.$inject=["$urlRouterProvider","$urlMatcherFactoryProvider"],t.module("ui.router.state").factory("$stateParams",(function(){return{}})).constant("$state.runtime",{autoinject:!0}).provider("$state",q).run(["$injector",function(e){e.get("$state.runtime").autoinject&&e.get("$state")}]),O.$inject=[],t.module("ui.router.state").provider("$view",O),t.module("ui.router.state").provider("$uiViewScroll",(function(){var e=!1;this.useAnchorScroll=function(){e=!0},this.$get=["$anchorScroll","$timeout",function(t,r){return e?t:function(e){return r((function(){e[0].scrollIntoView()}),0,!1)}}]})),k.$inject=["$state","$injector","$uiViewScroll","$interpolate","$q"],I.$inject=["$compile","$controller","$state","$interpolate"],t.module("ui.router.state").directive("uiView",k),t.module("ui.router.state").directive("uiView",I),D.$inject=["$state","$timeout"],U.$inject=["$state","$timeout"],T.$inject=["$state","$stateParams","$interpolate"],t.module("ui.router.state").directive("uiSref",D).directive("uiSrefActive",T).directive("uiSrefActiveEq",T).directive("uiState",U),L.$inject=["$state"],z.$inject=["$state"],t.module("ui.router.state").filter("isState",L).filter("includedByState",z)}(window,window.angular);
angular.module("xCLOUD").service("SessionUser",[function(){return this.setUserId=function(e){sessionStorage.setItem("userId",e)},this.setUserAvatar=function(e){sessionStorage.setItem("userAvatar",e)},this.setLegalConditionsAccepted=function(e){this.setCookie("bLegalConditionsAccepted",e,100)},this.getUserId=function(){return sessionStorage.getItem("userId")},this.getUserName=function(){return sessionStorage.getItem("userName")},this.getToken=function(){return sessionStorage.getItem("token")},this.getUserAvatar=function(){return sessionStorage.getItem("userAvatar")},this.getLegalConditionsAccepted=function(){return this.getCookie("bLegalConditionsAccepted")},this.getUserProfile=function(){return{userName:this.getUserName(),userId:this.getUserId(),token:this.getToken(),userAvatar:this.getUserAvatar()}},this.setExpiredDate=function(){},this.checkSession=function(){},this.setCookie=function(e,t,s){var n=new Date;n.setTime(n.getTime()+24*s*60*60*1e3);var i="expires="+n.toUTCString();document.cookie=e+"="+t+";"+i+";path=/"},this.getCookie=function(e){for(var t=e+"=",s=decodeURIComponent(document.cookie).split(";"),n=0;n<s.length;n++){for(var i=s[n];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""},this}]);
angular.module("xCLOUD").service("ApisFactory",["$http","$rootScope",function(t,e){function n(t,e,n,r){return $.ajax({type:t,contentType:"application/json; charset=utf-8",data:JSON.stringify(n),dataType:"json",crossDomain:!0,url:urlxDashNodeServer+"api/"+e})}return this.saveSettings=function(t){return new Promise((function(e,n){(new FileMngrFct).SendFile("settings",new Blob([JSON.stringify(t)],{type:"application/json"}),e)})).then((function(n){return e.allSettings=t,t}),(function(t){return console.log("saveSettings error "+t),{error:!0,status:401,message:t}}))},this.getSettings=function(){return new Promise((function(t,e){(new FileMngrFct).ReadFile("settings","",t)})).then((function(t){if("File does not exist"==t)return console.log("settings.usr file does not exist on server. Creating new one with default settings"),e.DefaultSettings;var n={};try{n=JSON.parse(t)}catch(n){return e.xDashFullVersion?swal("Unexpected error","unable to load settings.usr\n\n"+t,"error"):swal("Please check and restart the command line","the Flask server is not responding","error"),e.DefaultSettings}return n}),(function(t){return console.log("getSettings error"+t),{error:!0,status:401,message:t}}))},this.postRequest=function(n,r){return e.loadingBarStart(),t.post(xServConfig.urlApi+n,JSON.stringify(r),{contentType:"application/json; charset=utf-8"}).then((function(t){return e.loadingBarStop(),JSON.parse(t.data.d)}),(function(t){return e.loadingBarStop(),t}))},this.GetProjectByName=function(n){return e.loadingBarStart(),t.post(xServConfig.urlApi+"ReadProject",JSON.stringify(n),{contentType:"application/json; charset=utf-8"}).then((function(t){return e.loadingBarStop(),JSON.parse(t.data.d)}),(function(t){return e.loadingBarStop(),t}))},this.deleteFileFromServer=function(n,r){return e.loadingBarStart(),t.post(xServConfig.urlApi+r,JSON.stringify(n),{contentType:"application/json; charset=utf-8"}).then((function(t){return e.loadingBarStop(),JSON.parse(t.data.d)}),(function(t){return e.loadingBarStop(),t}))},this.sentResetPasswordRequest=function(t){return n("PUT","auth/updatepassword",{email:t})},this.sentResetPasswordForm=function(t){return n("POST","auth/updatepassword",t)},this.registerRequest=function(t){return n("POST","auth/register",t)},this.loginWithEmailPasswordAction=function(t){return n("POST","auth/login",{email:t.email,password:t.password})},this.getUserProfileByToken=function(t){return n("GET","users/me?Authorization=Bearer "+t,{})},this.updatePassword=function(t){return n("POST","auth/updatepassword",{email:t.email,password:t.password})},this}]);
angular.module("modules.python-images",[]).config(["$stateProvider",function(e){e.state("modules.python-images",{notAuthenticate:!0,userAuthenticated:!1,abstract:!0,url:"/python-images",templateUrl:""})}]).service("PythonImagesManager",["$http","$rootScope","ApisFactory",function(e,t,a){const n=this;function i(e,t){if("success"!==t)throw Error(e)}function o(e=!0){const t=new Uint32Array(8);window.crypto.getRandomValues(t);let a="";for(let n=0;n<t.length;n++)a+=(n<2||n>5?"":"-")+t[n].toString(e?16:36).slice(-4);return a}function l(){return new Promise((e,t)=>{(new FileMngrFct).GetFileList("pydata",(a,n,i)=>{"success"===i?e(a.FileList.map(e=>e.Python)):t(a)},!1)})}function s(e){return new Promise((t,a)=>{(new FileMngrFct).ReadFile("pydata",e,(e,n,i)=>{var o;"success"===i?t((o=e,decodeURIComponent(Array.prototype.map.call(atob(o),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join("")))):a(e)})})}function r(e,t,a){const n=e.Id;return a&&a(0),new Promise((e,i)=>{(new FileMngrFct).SendText("pydata",n,t,(t,a,n)=>{"success"===n?e(t):i(t)},a)})}this.getImages=async()=>{const e=await l();return e||[]},this.createImage=async(e,t,a)=>{await r(e,t.data,a),(new FileMngrFct).AddPythonInfo(e.Id,i,e.BaseImage,"",e.Name,e.Description,e.FileName,e.FileSize)},this.updateImage=async(e,t,a={},n)=>{e.Hash&&(_.isUndefined(t)||(a.data||t.FileName!==e.FileName||t.BaseImage!==e.BaseImage)&&(e.Hash=void 0)),a.data&&await r(e,a.data,n),(new FileMngrFct).AddPythonInfo(e.Id,i,e.BaseImage,e.Hash,e.Name,e.Description,e.FileName,e.FileSize);const o=await l();if(!o)throw Error("No images defined");const s=o.findIndex(t=>t.Id===e.Id);if(-1===s)throw Error(`Image ${e.Id} does not exist`);o[s]=e},this.deleteImage=async t=>{const a=urlPython+"images/"+t.Id;e.delete(a,{headers:{Authorization:LoginMngr.GetSavedJwt()}}),async function(e){await new Promise((e,t)=>{(new FileMngrFct).GetFileList("pydata",(a,n,i)=>{"success"===i?e(a.FileList.map(e=>e.Name)):t(a)},!1)}),(await n.getImages()).map(e=>e.Id);!function(e){new Promise((t,a)=>{(new FileMngrFct).DeleteFile("pydata",e,(e,n,i)=>{"error"===i?a(e):t(e)})})}(e)}(t.Id)},this.buildImage=async t=>{const a=urlPython+"images/build",n={id:t.Id,baseImage:t.BaseImage,fileData:await s(t.Id),fileName:t.FileName};return(await e.post(a,n,{headers:{Authorization:LoginMngr.GetSavedJwt()}})).data},this.getImageFullStatus=async t=>{const a=urlPython+"images/"+t;return(await e.get(a,{headers:{Authorization:LoginMngr.GetSavedJwt()}})).data},this.getImagesStatus=async t=>{const a=urlPython+"images/list";return(await e.post(a,t,{headers:{Authorization:LoginMngr.GetSavedJwt()}})).data};let c;c=xDashConfig.disablePythonSlim?[{label:"python:3.10",value:"python:3.10"},{label:"python:3.9",value:"python:3.9"},{label:"python:3.8",value:"python:3.8"},{label:"python:3.7",value:"python:3.7"},{label:"python:3.6",value:"python:3.6"}]:[{label:"python:3.10-slim",value:"python:3.10-slim"},{label:"python:3.10",value:"python:3.10"},{label:"python:3.9-slim",value:"python:3.9-slim"},{label:"python:3.9",value:"python:3.9"},{label:"python:3.8-slim",value:"python:3.8-slim"},{label:"python:3.8",value:"python:3.8"},{label:"python:3.7-slim",value:"python:3.7-slim"},{label:"python:3.7",value:"python:3.7"},{label:"python:3.6-slim",value:"python:3.6-slim"},{label:"python:3.6",value:"python:3.6"}];function u(e,t){const a=$('<div style="margin: 10px 0 10px 0"></div>'),n=d("name","Image name",a),i=$('<input type="text">').appendTo(n).change((function(){e.Name=$(this).val(),p(e,t)}));e.Name&&i.val(e.Name);const o=d("desc","Image description",a),l=$('<textarea class="calculated-value-input">').appendTo(o).change((function(){e.Description=$(this).val(),p(e,t)}));e.Description&&l.val(e.Description);const s=d("base","Base image",a),r=$("<select></select>").appendTo($('<div class="styled-select"></div>').appendTo(s));c.forEach(e=>{r.append($(`<option>${e.label}</option>`).attr("value",e.value))}),r.change((function(){e.BaseImage=$(this).val(),p(e,t)})),e.BaseImage&&r.val(e.BaseImage);const u=e.FileName?g(e.FileName,e.FileSize):"",y=$(`<input type="text" id="select_file_path" value="${u}"></input><label class="board-toolbar datasource-input-suffix"><i class="fa-folder-open fa" aria-hidden="true"></i>Browse...</label>`),f=$('<input type="file" style="display: none" id="select_file" accept=".zip, .txt"></input>').appendTo(y);y.mousedown((function(e){e.preventDefault(),$("#select_file").trigger("click")})),f.change((function(a){if(a.target.files.length>0){const n=a.target.files[0],i=n.name;if(n.size>1e9)h("file"),m("file",`File ${i} is too big.`);else{const a=new FileReader;a.addEventListener("load",(function(a){const o=a.target.result,l=n.size;t.data=o.replace(/^data:.+;base64,/,""),e.FileName=i,e.FileSize=l,$("#select_file_path").val(g(i,l)),p(e,t)})),a.readAsDataURL(n)}}}));const v=d("file","Package/requirements",a);return y.appendTo(v),a}function d(e,t,a){var n=$('<div id="setting-row-'+e+'" class="form-row"></div>').appendTo(a);return n.append('<div class="form-label"><label class="control-label">'+t+"</label></div>"),$('<div id="setting-value-container-'+e+'" class="form-value"></div>').appendTo(n)}function p(e,t){var a=!0;return h("name"),0===(e.Name||"").trim().length&&(m("name","This is required"),a=!1),h("file"),(e.FileSize||0)<=0&&(m("file","Either a requirement file or a package is required"),a=!1),h("base"),0===(e.BaseImage||"").trim().length&&(m("base","Base image is mandatory"),a=!1),a}function m(e,t){const a=$('<div class="validation--error"></div>').html(t);$("#setting-value-container-"+e).append(a)}function h(e){$("#setting-value-container-"+e).children(".validation--error").remove()}function g(e,t){var a="";return e&&(a+=e),t&&t>0&&(a+=" ("+y(t)+")"),a}function y(e){if(!e)return"";var t=1,a="";e>1e9?(t=1e9,a="Go"):e>1e6?(t=1e6,a="Mo"):e>1e3&&(t=1e3,a="ko");var n=e/t;return""+(n=Math.round(100*n)/100)+a}this.openOutputDialog=async(e,t)=>{const a=this;const n=await this.getImageFullStatus(e),i=$('<div><pre id="outputText" style="color: white; background-color: black"></div>');new DialogBox(i,"Build output","Close",null,()=>(t&&t(image),!1)),function t(n){if(n.output){const e=$("#outputText");e.text(n.output.replace(/\r\n/g,"\n"));const t=e.parent();t.animate({scrollTop:t.prop("scrollHeight")})}"building"===n.status&&setTimeout(async()=>t(await a.getImageFullStatus(e)),5e3)}(n)},this.openNewImageDialog=()=>{const e={BaseImage:"python:3.8",Id:o(!1)},t={};return $("#editForm").append(u(e,t)),[e,t]},this.openEditImageDialog=e=>{const t=_.clone(e),a={};return $("#editForm").append(u(t,a)),[t,a]},this.checkImageValidity=p,this.imageSizeToText=y}]);
function DatanodeDependency(){var e={},t=new Map,n=new Map,o=new Map,s=new Map,r=new Map,i=[],a=[];function c(e,t){var n,o,s,r=[];[n,o]=l();var i=new Set;if(e.forEach((function(e){let t=new Set(n.getDescendants(e));t.add(e),r.push(t)})),1==e.length&&0==t.length)t.push(r[0]);else for(let e=0;e<r.length;e++){i=r[e];for(let t=e+1;t<r.length;t++){0!=new Set([...i].filter(e=>r[t].has(e))).size&&(i=union(i,r[t]))}if(0==t.length)t.push(i);else{for(let e in t){let n=new Set([...i].filter(n=>t[e].has(n)));if(0!=n.size){n.size<i.size&&(i=union(i,t[e]),t.splice(e,1,i)),s=!0;break}s=!1}s||t.push(i)}i=new Set}let a=0;return t.forEach((function(e){e.id=e.values().next().value+Math.random(),e.index=a,a++})),t}function d(){const e=f();i=c(e,[]),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("All disconnected Graphs: ",i),a=[],i.some((function(e){1==e.size&&e.forEach((function(e,t,n){a.push(t)}))}))}function u(e){return a.includes(e)}function f(){const e=g(),t=e.nodes();let n=[];for(let o in t)(0==e.indegree(t[o])||-1!==t[o].indexOf("pastValue_"))&&n.push(t[o]);return n}function l(){let t=new Graph,n=!1;for(let o in e){let s=o,r=[];e[o].forEach((function(e){r.push(e)})),t.add(s,r);for(let e in r)r[e]===s&&(n=!0)}return[t,n]}function h(){let t=new Graph,n=!1;for(let o in e){let s=o,r=[];e[o].forEach((function(e){let t=!0,n=e.match(/pastValue_(.+)/);if(n){let e=n[1];o==e&&(t=!1)}t&&r.push(e)})),t.add(s,r);for(let e in r)r[e]===s&&(n=!0)}return[t,n]}function g(){let t=new GraphDS;for(let n in e){let o=n;t.addNode(o),e[n].forEach((function(e){t.addEdge(o,e)}))}return t}return{dependencyStructure:e,addNode:function(t){e[t]=new Set},removeNode:function(t){delete e[t];for(let n in e)e[n].has(t)&&e[n].delete(t)},addEdge:function(t,n){e[t].add(n)},removeEdge:function(t,n){e[t].delete(n)},removeMissedDependantDatanodes:function(t,n){for(let o in e)t.has(o)||e[o].has(n)&&e[o].delete(n)},getSuccessors:function(t){return e[t].values()},getPredecessorsSet:function(t){let n=new Set;for(let o in e)e[o].has(t)&&n.add(o);return n},hasSuccessors:function(t){return e[t].size>0},hasPredecessors:function(t){let n=!1;for(let o in e)if(e[o].has(t)){n=!0;break}return n},getSourceNodes:function(){const e=g(),t=e.nodes();let n=[];for(let o in t)0==e.indegree(t[o])&&n.push(t[o]);return n},getSourceNodesWithMemory:f,getDescendantsinBFS:function(e){},getDescendants:function(e,t){let n,o;return[n,o]=t?h():l(),startNodesDesc=new Set,e.forEach((function(e){elemDesc=new Set(n.getDescendants(e)),startNodesDesc=union(startNodesDesc,elemDesc)})),startNodesDesc},getDisconnectedGraphs:c,getBelongingDisconnectedGraph:function(e,t){let n;return t.some((function(t){t.has(e)&&(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("node ",e," is found in disconnected graph: ",t),n=t)})),n},computeAllDisconnectedGraphs:d,getAllDisconnectedGraphs:function(){return i},resetGraphList:function(){i=[],a=[]},isNode:function(t){return!_.isUndefined(e[t])},renameNode:function(t,n){for(let o in e)e[o].has(t)&&(e[o].delete(t),e[o].add(n));const o=e[t];delete e[t],e[n]=o},topologicalSort:function(){let e=g();return e.nodes().forEach((function(t){datanodesManager.foundDatanode(t)||e.removeNode(t)})),e.topologicalSort()},detectCycles:function(){let e,t;return[e,t]=h(),{hasCycle:e.hasCycle(),getCycles:e.getCycles(),hasLoop:t}},getExtraStartNodesList:function(){return t},addExtraStartNodesList:function(e,n){t.has(e)&&xdashNotifications.manageNotification("info",e,e+" is called many consecutif times while scheduler is in progress"),t.set(e,n)},clearExtraStartNodesList:function(){t.clear()},getSetvarList:function(){return n},addSetvarList:function(e,t){n.has(e)&&n.get(e)!==t&&xdashNotifications.manageNotification("warning",e,'Possible undeterminism: setVariable of "'+e+'" is used more than once in other dataNodes as: "'+n.get(e)+'" and "'+t+'"'),n.set(e,t)},clearSetvarList:function(){n.clear()},getProcessedSetvarList:function(){return o},addProcessedSetvarList:function(e){for(const[t,n]of e.entries())o.set(t,n)},clearProcessedSetvarList:function(){o.clear()},getMemorydataNodeList:function(){return s},addMemorydataNodeList:function(e){s.set(e,"memory")},getCurrentGraphList:function(){return r},addCurrentGraphList:function(e,t){r.has(e),r.set(e,t)},clearCurrentGraphList:function(){r.clear()},clearMemorydataNodeList:function(e){_.isUndefined(e)?s.clear():e.forEach(e=>{s.has(e)&&s.delete(e)})},getAllsingletonNodes:function(){return offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("SingletonNodeList: ",a),a},isSingletonNode:u,updateDisconnectedGraphsList:function(e,t){switch(t){case"add":d();break;case"delete":u(e)?function(e){i.some((function(t){if(t.has(e)){t.delete(e);let n=a.indexOf(e);a.splice(n,1)}}))}(e):d();break;case"default":d()}}}}
function GraphVisu(e){var t,n,o,a,r,d=null,i=[],c=[],l={},s=[],u=[];let g=[],p=[],f=[],h=0;function v(e){let t=datanodesManager.getDataNodeByName(e).beautifulString();void 0===t&&(t="NO DATA");var n=document.createElement("div");return n.innerHTML=t,n}function m(e){y();var i={scale:o,offset:{x:t,y:n},animation:{duration:a,easingFunction:r}};d.focus(e,i)}function y(){t=0,n=0,a=1e3,o=3,positionx=300,positiony=300,r="easeInOutQuint"}function b(){y();var e={offset:{x:t,y:n},duration:a,easingFunction:r};d.fit({animation:e})}return $("#inputSearchGraph").on("input",(function(e){var t,n=$(this).val();h=0;for(let e=0;e<u.length;e++)i.update([{id:l[u[e].label],font:{color:"#0843b9",background:"#e3ecff"}}]),u[e].label.toLowerCase().match(n)&&n.length>2&&(i.update([{id:l[u[e].label],font:{color:"white",background:"black"}}]),t=u[e].label,h++);1===h?m(l[t]):b()})),$("#exportGraph").on("click",(function(){var e=document.getElementById("canvas");console.log("mynetworkCanvas",e),e.toBlob((function(e){var t=document.createElement("a");document.body.appendChild(t),t.download="network.png",t.href=window.URL.createObjectURL(e),t.click()}))})),$("#openFullScreen").on("click",(function(){var e=document.getElementById("dependencyGraphBody");e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()})),$("#zoomIn").on("click",(function(){d.setScale(d.getScale()+.3)})),$("#zoomOut").on("click",(function(){d.setScale(d.getScale()-.3)})),{showDepGraph:function(t){let n=datanodesManager.getAllDataNodes(),o=[];for(let e in n)o[e]=n[e].name();let a=[];for(var r=0;r<o.length;r++)a.push({id:r,label:o[r],title:v(o[r]),type:datanodesManager.getDataNodeByName(o[r]).type(),disconnected:e.isSingletonNode(o[r]),widgetConnection:datanodesManager.isConnectedWithWidgt(o[r])[0]}),l[o[r]]=r;u=a;let s=[],p=[];for(var f=0;f<o.length;f++){p=Array.from(e.dependencyStructure[o[f]]);for(var h=0;h<p.length;h++)s.push({from:f,to:l[p[h]],arrows:"to"})}i=new vis.DataSet(a),c=new vis.DataSet(s),function(e,t){var n=$('<div id="dependencyGraphBody" class="modal-body" style="vertical-align: middle; overflow: auto; display: block; margin: auto; width: 938px; height: 625px; border: 1px solid lightgray;"></div>');document.getElementById("dependencyGraph").hasChildNodes()||n.appendTo($("#dependencyGraph"));var o=document.getElementById("dependencyGraphBody");d=new vis.Network(o,e,{layout:{randomSeed:3},nodes:{borderWidth:1,font:{size:15,color:"#0843b9"},color:{border:"#478dec",background:"#e3ecff"},shape:"box",margin:15},edges:{color:"#9fb8ed"},interaction:{hover:!0,zoomView:!0},physics:{forceAtlas2Based:{theta:.2,gravitationalConstant:-65,centralGravity:.015,springLength:70,damping:.7,avoidOverlap:.95},minVelocity:20,solver:"forceAtlas2Based",timestep:.1}}),$("#dependencyGraphBody canvas").attr("id","canvas"),d.on("doubleClick",(function(e){var t=e.nodes[0];let n=datanodesManager.getAllDataNodes();datanodesManager.editNodeFromGraph(n[t])}));var a=document.getElementById("dependencyGraphBody").getElementsByTagName("canvas")[0];d.on("hoverNode",(function(){a.style.cursor="pointer"})),d.on("blurNode",(function(){a.style.cursor="default"})),d.on("stabilizationIterationsDone",(function(){!function(e){if(g=[],"string"==typeof e)i.update([{id:l[e],color:{background:"orange"}}]),m(l[e]);else if("object"==typeof e){e=JSON.parse(e.target.attributes.name.value);for(let t=0;t<e.length;t++)g.push({id:l[e[t]],color:{background:"orangered"}});i.update(g),1===e.length&&m(l[e[0]])}}(t)})),vis.Network.prototype.setScale=function(e){var t={position:{x:0,y:0},scale:e,animation:{duration:300}};t.scale>=0&&this.view.moveTo(t)}}({nodes:i,edges:c},t)},selectNodeFromTagList:function(e){var t=document.getElementById(e),n=[];if(t.classList.contains("active")){t.classList.remove("active");for(let t=0;t<p.length;t++)p[t].type===e&&(p[t].color={background:"#e3ecff"},n.push(p[t]));i.update(p),b(),-1!==s.indexOf(e)&&s.splice(s.indexOf(e),1);for(let e=0;e<n.length;e++)p.splice(p.indexOf(n[e]),1)}else{h=0,-1===s.indexOf(e)&&s.push(e),t.classList.add("active");for(let t=0;t<u.length;t++)u[t].type===e&&(p.push({id:l[u[t].label],type:e,color:{background:"yellow"}}),h++);i.update(p),1===h?m(p[0].id.toString()):b()}},selectConnectedWithWidget:function(e){var t=document.getElementById(e),n=[];if(t.classList.contains("active")){t.classList.remove("active");for(let t=0;t<f.length;t++)"green"===f[t].color.border&&"connectedtowidget"===e&&(f[t].color={border:"#478dec"},f[t].borderWidth=1,n.push(f[t])),"red"===f[t].color.border&&"notconnectedtowidget"===e&&(f[t].color={border:"#478dec"},f[t].borderWidth=1,n.push(f[t]));i.update(f),b();for(let e=0;e<n.length;e++)f.splice(f.indexOf(n[e]),1)}else{h=0,t.classList.add("active");for(let t=0;t<u.length;t++)!0===u[t].widgetConnection&&"connectedtowidget"===e&&(f.push({id:l[u[t].label],borderWidth:3,color:{border:"green"}}),h++),!1===u[t].widgetConnection&&"notconnectedtowidget"===e&&(f.push({id:l[u[t].label],borderWidth:3,color:{border:"red"}}),h++);i.update(f),1===h?m(f[f.length-1].id.toString()):b()}},closeGraph:function(){for(g=[],p=[],f=[],h=0,$("#inputSearchGraph").val("");s.length;){for(var e=0;e<s.length;e++){document.getElementById(s[e]).classList.remove("active")}s.pop()}document.getElementById("connectedtowidget").classList.remove("active"),document.getElementById("notconnectedtowidget").classList.remove("active")}}}
function DatanodesListModel(e,a,t,n){var s=this,r=[];function d(a){var r=new DatanodeModel(s,e,t,n);return r.deserialize(a)?(s.addDatanode(r),!0):(s.error(!0),!1)}this.datanodes=ko.observableArray(),this.datasourceData={},this.processDatanodeUpdate=function(e,a){s.datasourceData[e]=a},this.renameDatanodeData=function(e,a){s.datasourceData[a]=s.datasourceData[e],delete s.datasourceData[e]},this._datanodeTypes=ko.observable(),this.datanodeTypes=ko.computed({read:function(){s._datanodeTypes();var a=[];return _.each(e,(function(e){var t=e.type_name,n=t;_.isUndefined(e.display_name)||(n=e.display_name),a.push({name:t,display_name:n})})),a}}),this.serialize=function(){var e=[];_.each(s.datanodes(),(function(a){e.push(a.serialize())}));var a=angular.element(document.body).scope().$root;return a.alldatanodes=datanodesManager.getAllDataNodes(),a.showNotifications=!1,a.safeApply(),{datanodes:e}},this.deserialize=function(e,a,o){return a&&s.clear(),function(){s.error=ko.observable(!1),r=[];var a,i=[];if(_.isUndefined(e.datanodes)&&(e.datanodes=e.datasources,delete e.datasources),(i=e.datanodes).sort((function(e,a){return"Memory_plugin"===e.type&&"Memory_plugin"!==a.type?1:"Memory_plugin"!==e.type&&"Memory_plugin"===a.type?-1:void 0})),_.each(i,(function(e){if(function(e){for(var a=!1,t=0;t<s.datanodes().length;t++)if(a=!1,s.datanodes()[t].name()==e){a=!0;break}return!!a}(e.name))r.push(e);else if(!d(e))return!1})),0!=r.length&&(a=xdsjson.getDuplicateDataList(r,"Please check data to be loaded after choosing rename or overwite option"),new DialogBoxForDuplicateData(a,"List of duplicate data name","Load","Close",(function(){var e=0;for(e=0;e<r.length;e++)$("#data-checkbox-"+e).is(":checked")&&(r[e].name=$("#data-check-"+e)[0].value);for(e=0;e<r.length;e++)if($("#data-checkbox-"+e).is(":checked"))if(r[e].name=$("#data-check-"+e)[0].value,$("#data-rename-"+e).is(":checked"))d(r[e]);else for(var a=0;a<s.datanodes().length;a++)if(s.datanodes()[a].name()==r[e].name){s.deleteDatanode(s.datanodes()[a]),s.datanodes.remove(s.datanodes()[a]),d(r[e]);break}}))),s.datanodes().length>0){var l=!1,c=Object.keys(t.dependencyStructure).length-i.length;if(0!=c)for(var f in t.dependencyStructure){l=!1;for(var u=0;u<i.length;u++)if(f===i[u].name){l=!0;break}if(!l){var h=Array.from(t.getSuccessors(f));swal("Missed dataNodes!","'"+f+"' is referenced in formula of '"+h+"' but doesn't exist in list of datanodes","error"),c--}if(0==c)break}for(var m=!1,g=!1,p=0,v=0,y=0;y<s.datanodes().length;y++){i=s.datanodes()[y],_.isUndefined(i.settings().refresh)?_.isUndefined(i.settings().refresh_time)?_.isUndefined(i.settings().refresh_rate)?_.isUndefined(i.settings().refreshRate)||(i.settings().sampleTime=i.settings().refreshRate,delete i.settings().refreshRate):(i.settings().sampleTime=i.settings().refresh_rate,delete i.settings().refresh_rate):(i.settings().sampleTime=i.settings().refresh_time,delete i.settings().refresh_time):(i.settings().sampleTime=i.settings().refresh,delete i.settings().refresh);const a=e.version,t=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)$/.exec(a);if(t){const e=parseInt(t[1],10),a=parseInt(t[2],10);(e<2||2===e&&a<890)&&i.settings().explicitTrig&&i.settings().autoStart&&(i.settings().autoStart=!1)}}t.computeAllDisconnectedGraphs();for(y=0;y<s.datanodes().length;y++)i=s.datanodes()[y],_.isUndefined(i.settings().sampleTime)||0==i.settings().sampleTime?(g=!0,v=y):(m=!0,p=y,i.sampleTime(i.settings().sampleTime),n.registerDatanode(i.sampleTime(),i.name(),"globalFirstUpdate"));m&&(i=s.datanodes()[p],n.registerDatanode(i.sampleTime(),i.name())),g&&(i=s.datanodes()[v],s.launchGlobalFirstUpdate(i))}_.isFunction(o)&&o()}(),!s.error()},this.launchGlobalFirstUpdate=function(e){var a=t.getSourceNodesWithMemory();0!=a.length&&e.schedulerStart(a,a[0],"globalFirstUpdate")},this.clear=function(){if(t.clearExtraStartNodesList(),t.clearSetvarList(),t.clearProcessedSetvarList(),t.clearCurrentGraphList(),_.each(s.datanodes(),(function(e){s.deleteDatanode(e)})),Object.keys(t.dependencyStructure).length)for(var e in t.dependencyStructure)t.removeNode(e),console.log("extra nodes are deleted");t.resetGraphList(),s.datanodes.removeAll()},this.load=function(e,t,n){a.showLoadingIndicator(!0),s.deserialize(e,t,(function(){return a.showLoadingIndicator(!1),_.isFunction(n)&&n(),!s.error()}))},this.addDatanode=function(e){for(var a=!1,t=0;t<s.datanodes().length;t++)if(a=!1,s.datanodes()[t].name()==e.name()){a=!0;break}a||s.datanodes.unshift(e)},this.deleteDatanode=function(e){var a=e.name();delete s.datasourceData[a],e.dispose()}}
function FormulaInterpreter(e,t,a,n){var s=this;s.bCalculatedSettings=!0,this.callValueFunction=function(t){return t.call(void 0,e.datasourceData)},this.processCalculatedSetting=function(e,a){var n=!1;let i=a.split("\n");for(let e=0;e<i.length;e++)for(var o=new RegExp("dataNodes.([\\w\\-]{1,}\\.{0,}[\\w\\-]{0,})|dataNodes\\[['\"]([\\w\\\\\\-]{1,})['\"]\\]((\\[['\"]([\\w\\W]){1,}['\"](?=\\])\\])){0,1}","g");matches=o.exec(i[e]);){let a,i;if(_.isUndefined(matches[1])){a=matches[2].split('"]')[0],i=matches[0];let e=1,t=matches[0].split('"]').length-1;if(t>2)for(let a=0;a<t-2;a++)for(i=matches[0].substring(0,matches[0].length-e),e++;!i.endsWith('"]',i.length);)i=matches[0].substring(0,matches[0].length-e),e++}else a=matches[1].split(".")[0],i=matches[0];try{let e=new Function("dataNodes",i);s.callValueFunction(e)}catch(i){t.statusCallback("Error",i.message);const o="var "+a+" in line "+e+" : "+i.message;t.notificationCallback("error",t.settings().name,o,"Error evaluation at datanode : '"+t.name()+"'"),n=!0,s.bCalculatedSettings=!1}}if(!n&&_.isFunction(t.calculatedSettingScripts[e])){let n;try{n=s.callValueFunction(t.calculatedSettingScripts[e])}catch(e){t.statusCallback("Error",e.message),t.notificationCallback("error",t.settings().name,e.message,"Parse error"),n=null,s.bCalculatedSettings=!1}if(!_.isUndefined(t.datanodeInstance)&&_.isFunction(t.datanodeInstance.onCalculatedValueChanged)){if(!_.isEmpty(a))if(_.isUndefined(n)){const a="Parse error while parsing formula in : '"+t.name()+"'";t.notificationCallback("warning",t.settings().name,a,"Parse error"),t.statusCallback("Error","Parse error");try{t.datanodeInstance.onCalculatedValueChanged(e,void 0)}catch(e){console.log(e.toString())}}else if(!_.isNull(n)){const a=!0,s="Success while parsing formula in : '"+t.name()+"'";t.notificationCallback("success",t.settings().name,s,"Parse success",a);try{t.datanodeInstance.onCalculatedValueChanged(e,n)}catch(e){console.log(e.toString())}}}else console.log("datanodeInstance or onCalculatedValueChanged function is not defined")}return!0},this.updateCalculatedSettings=function(e,i,o){if(s.bCalculatedSettings=!0,t.datanodeRefreshNotifications={},t.calculatedSettingScripts={},_.isUndefined(t.type()))return!1;var r=a[t.type()].settings,l=new RegExp("dataNodes.([\\w_-]+)|dataNodes\\[['\"]([^'\"]+)","g");const d=/(setVariables\((\["[^"].*?"\]),\s*(\[.*?\])\))|(setVariables\((\['[^"].*?'\]),\s*(\[.*?\])\))|(setVariable\(('([^"]*?)'),\s*([^)]*)\))|(setVariable\(("([^"]*?)"),\s*([^)]*)\))|(executeDataNode\(("([^"]*)")\))|(executeDataNode\(('([^"]*)')\))|(executeDataNodes\((\["[^"].*?"\])\))|(executeDataNodes\((\['[^"].*?'\])\))|(setVariableProperty\(("([^"]*)"),\s*(\[.*?\])\s*,[^"].*?\))|(setVariableProperty\(('([^"].*?)'),\s*(\[.*?\])\s*,[^"].*?\))/g,c=/(?=["'])(?:"[^"\\]*(?:\\[\s\S][^"\\]*)*"|'[^'\\]*(?:\\[\s\S][^'\\]*)*')|(#.*$)/gm;var u=t.settings(),f=!0;return _.each(r,(function(a){if("calculated"==a.type||"custom2"==a.type){var r=u[a.name];if(!_.isUndefined(r)){if(r=(r=(r="custom2"==a.type?r.replace(c,(function(e,t){return null==t?e:""})):r.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1")).replace(/datasources/g,"dataNodes")).replace(/headersFromDatasourceWS/g,"headersFromDataNodeWS"),_.isArray(r)&&(r="["+r.join(",")+"]"),(r.match(/;/g)||[]).length<=1&&-1==r.indexOf("return"))if(_.isEmpty(r)){if(!_.isUndefined(t.settings().method)&&"POST"==t.settings().method){const e="Cannot have an empty body with a POST method";t.notificationCallback("warning",u.name,e,"Cannot have an empty body with a POST method in datanode : '"+t.name()+"'")}}else r="return "+r;let g,m;if("custom2"!=a.type)try{g=new Function("dataNodes",r)}catch(e){const n=e+".\n Formula interpreted as literal text";t.notificationCallback("warning",u.name,n,"Syntax error at datanode : '"+t.name()+"'");const s=u[a.name].replace(/"/g,'\\"').replace(/[\r\n]/g," \\\n");g=new Function("dataNodes",'return "'+s+'";')}let h=new Set;for(;m=l.exec(r);){const i=m[1]||m[2];if(t.name()===i){const e='DataNode "'+i+'": Please remove from formula the expression dataNodes["'+t.name()+'"].';return t.statusCallback("Error"),swal("Loop detection",e,"error"),s.bCalculatedSettings=!1,void(f=!1)}n.isNode(i)||n.addNode(i);let o=i.match(/pastValue_(.+)/);if(o){let e=o[1];t.name()==e&&(add_edge=!1)}if(n.addEdge(i,t.name()),h.add(i),!e&&!datanodesManager.foundDatanode(i)){const e="DataNode '"+i+"' does not exist in dataNodes list";return t.statusCallback("Error",e),t.notificationCallback("error",t.name(),e,"Error in formula"),void(s.bCalculatedSettings=!1)}let r="";if(n.detectCycles().hasCycle)return n.removeEdge(i,t.name()),r='Cycle detected while computing dataNode "'+i+'" while parsing formula in : "'+t.name()+'"',t.statusCallback("Error"),swal("Cycle detection",r,"error"),s.bCalculatedSettings=!1,void(f=!1);let l=t.datanodeRefreshNotifications[i];_.isUndefined(l)&&(l=[],t.datanodeRefreshNotifications[i]=l),-1==_.indexOf(l,a.name)&&l.push(a.name)}let p=r.split("\n"),C=!1,S=!1;for(let e=0;e<p.length;e++)for(;m=d.exec(p[e]);){let e=[];if(!_.isUndefined(m))if(C=!0,_.isUndefined(m[13]))if(_.isUndefined(m[9]))if(_.isUndefined(m[2]))if(_.isUndefined(m[5]))if(_.isUndefined(m[17]))if(_.isUndefined(m[20]))if(_.isUndefined(m[22]))if(_.isUndefined(m[24]))_.isUndefined(m[27])?_.isUndefined(m[31])||(e[0]=m[31]):e[0]=m[27];else{const t=m[24].replace(/'/g,'"');e=JSON.parse(t)}else{e=JSON.parse(m[22])}else e[0]=m[20];else e[0]=m[17];else{const t=m[5].replace(/'/g,'"');e=JSON.parse(t)}else{e=JSON.parse(m[2])}else e[0]=m[9];else e[0]=m[13];if(o||t.settings().autoStart||!t.settings().explicitTrig)for(const a of e)n.addSetvarList(a,t.name());else offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("init: don't add parsed set var")}for(let e=0;e<p.length;e++)(matches2=p[e].match(/.goToPage|.viewPage|.viewProject/))&&(_.isUndefined(matches2)||(S=!0));if(!C)for(let e=0;e<p.length;e++)if((m=p[e].match(/chalkit(.+)|xDashApi(.+)/))&&!_.isUndefined(m)&&!S){const e="Syntax error in chalkit API.";return t.statusCallback("Error",e),t.notificationCallback("error",t.name(),e),void(s.bCalculatedSettings=!1)}if(n.removeMissedDependantDatanodes(h,t.name()),!o&&!t.settings().autoStart&&t.settings().explicitTrig)return void(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("init: don't process calculate"));if("custom2"!=a.type&&(t.calculatedSettingScripts[a.name]=g,i&&!s.processCalculatedSetting(a.name,r)))return s.bCalculatedSettings=!1,void(f=!1)}}if("option"==a.type&&a.from_datanode){let e=u[a.name];if(!datanodesManager.foundDatanode(e)){const a="DataNode '"+e+"' does not exist in dataNodes list";return t.statusCallback("Error",a),t.notificationCallback("error",t.name(),a),void(s.bCalculatedSettings=!1)}if(t.name()===e){const a='DataNode "'+e+'": Please select another datanode target.';return t.statusCallback("Error"),swal("Loop detection",a,"error"),s.bCalculatedSettings=!1,void(f=!1)}n.isNode(t.name())||n.addNode(t.name());let i=!0,o=t.name().match(/pastValue_(.+)/);if(o){e==o[1]&&(i=!1)}n.addEdge(e,t.name()),n.removeMissedDependantDatanodes(new Set([e]),t.name())}})),f}}
function TimeManager(){var e,n,r=[],i=0,o=0,t=[];function a(e,n){_.isUndefined(n)&&(n=e);var r;if(e<n){var i=e;e=n,n=i}return 0==(r=e%n)?n:a(n,r)}function d(e){var n=e;for(var i in r)n=a(r[i],n),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(o);return n}function l(n){e&&clearInterval(e),e=setInterval((function(){c(!1)}),n),c(!0)}function c(r){if(r)offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(n," timer initialization");else{if(n){var o=datanodesManager.getDataNodeByName(n);o?o.schedulerStart(t,n,"timer"):(clearInterval(e),console.log("initiatorDatanodeModel is undefined"))}else clearInterval(e),console.log("initiatorDatanode is undefined");i+=1}}return{registerDatanode:function(e,a,c){r[a]=e,-1==t.indexOf(a)&&t.push(a),n=t[0],o=d(e),i=0,"globalFirstUpdate"!=c&&l(1e3*o)},unregisterDatanode:function(a){delete r[a];var c=t.indexOf(a);-1!=c?(t.splice(c,1),i=0,0==Object.keys(r).length?(n=void 0,clearInterval(e),e=void 0,o=0):(n=t[0],l(1e3*(o=d())))):offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("error in datanode "+a)},isRegisteredDatanode:function(e){return!_.isUndefined(r[e])},getBasePeriod:function(){return o},getHyperPeriod:function(){},getCurrentTick:function(){return i},getCurrentTime:function(){return i*o}}}
var schedulerProfiling={},schedulerProfilingItem={};function DatanodeScheduler(e,a,t,o,n){if(!_.isUndefined(datanodesManager)){var d=new Set(a),s=new Set,i=new Set,r=new Set,c=new Set,l=new Set;datanodesManager.getAllDataNodes().forEach((function(e){l.add(e.name()),xDashConfig.disableSchedulerProfiling||(schedulerProfiling[e.name()]=[])}));var g=e.getDescendants(a,!0),u=difference(l,g),f=new Set;return u.forEach((function(e){"OK"==datanodesManager.getDataNodeByName(e).status()&&f.add(e)})),{launchSchedule:function(){m()},operationCompleted:function(a,t){let n,c=!0;switch(t){case"OK":i.add(a),s.delete(a),datanodesManager.getDataNodeByName(a).is_specific_exec||e.dependencyStructure[a].forEach((function(e){var a;D(e)&&(p(e)?datanodesManager.getDataNodeByName(e).is_specific_exec?(a=e,i.has(a)||d.add(e)):offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+e+" not added because already executed"):d.add(e))})),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+a+" completed with status "+t),xDashConfig.disableSchedulerProfiling||(schedulerProfilingItem.completion=Date.now(),schedulerProfilingItem.status=t,schedulerProfiling[a].push(schedulerProfilingItem)),d.size&&(c=!1,m());break;case"Error":r.add(a),s.delete(a),n=e.getDescendants([a]),n.forEach((function(e){r.add(e),datanodesManager.getDataNodeByName(e).statusCallback("None"),datanodesManager.getDataNodeByName(e).updateCallback("","None")})),d=difference(d,r),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+a+" completed with status "+t),xDashConfig.disableSchedulerProfiling||(schedulerProfilingItem.completion=Date.now(),schedulerProfilingItem.status=t,schedulerProfiling[a].push(schedulerProfilingItem));break;case"NOP":if("OK"===datanodesManager.getDataNodeByName(a).status()){i.add(a),s.delete(a),e.dependencyStructure[a].forEach((function(e){D(e)&&(p(e)?offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+e+" not added because already executed"):d.add(e))})),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+a+" completed with status "+t),xDashConfig.disableSchedulerProfiling||(schedulerProfilingItem.completion=Date.now(),schedulerProfilingItem.status=t,schedulerProfiling[a].push(schedulerProfilingItem)),d.size&&(c=!1,m());break}"None"===datanodesManager.getDataNodeByName(a).status()||"Error"===datanodesManager.getDataNodeByName(a).status()?(r.add(a),s.delete(a),n=e.getDescendants([a]),n.forEach((function(e){r.add(e)})),d=difference(d,r),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+a+" completed with status "+t),xDashConfig.disableSchedulerProfiling||(schedulerProfilingItem.completion=Date.now(),schedulerProfilingItem.status=t,schedulerProfiling[a].push(schedulerProfilingItem))):console.log("datanode with explicitTrig ended with status ",datanodesManager.getDataNodeByName(a).status());break;default:return{initiatorNode:o,schedulingInstanceTerminated:!1}}return 0==s.size&&0==d.size&&c?{initiatorNode:o,schedulingInstanceTerminated:!0}:{initiatorNode:o,schedulingInstanceTerminated:!1}},stopAllOperations:function(){d.forEach((function(e){d.delete(e)})),s.forEach((function(e){s.delete(e),datanodesManager.getDataNodeByName(e).completeExecution("NOP"),datanodesManager.getDataNodeByName(e).statusCallback("None"),datanodesManager.getDataNodeByName(e).updateCallback(void 0,"None")}));let e=new Set;for(let a in datanodesManager.getAllDataNodes()){datanodesManager.getAllDataNodes()[a].schedulerStatus("Stop");const t=datanodesManager.getAllDataNodes()[a].getXHR();_.isUndefined(t)||e.add(t)}e.forEach((function(a){a.abort(),e.delete(a)})),null!=datanodesManager.getDataNodeByName(o).execInstance()&&datanodesManager.getDataNodeByName(o).schedulerEnd()},stopOperation:function(e){if(s.has(e)){s.delete(e),datanodesManager.getDataNodeByName(e).completeExecution("NOP"),datanodesManager.getDataNodeByName(e).statusCallback("None"),datanodesManager.getDataNodeByName(e).updateCallback(void 0,"None"),datanodesManager.getDataNodeByName(e).schedulerStatus("Stop");const a=datanodesManager.getDataNodeByName(e).getXHR();_.isUndefined(a)||a.abort()}},getInitiatorNode:function(){return o},getSchedulerCallOrigin:function(){return n},clear:function(){}}}function h(e){if(!_.contains(t,e))return"globalFirstUpdate"!==n;switch(n){case"triggerButton":case"vignette":case"memory":case"setValue":case"setVariable":case"setFile":case"unidentified":case"edit":case"refresh":case"globalFirstUpdate":default:return!1}}function N(e){if(!_.contains(t,e))return!1;switch(n){case"triggerButton":case"vignette":case"memory":case"setValue":case"setVariable":case"setFile":case"refresh":return!0;default:return!1}}function m(){var a=!0,o=!1;d.forEach((function(l){if(0!=d.size){if(_.isUndefined(datanodesManager.getDataNodeByName(l)))return offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(l+" is not treated because it does not exist"),d.delete(l),void r.add(l);if(datanodesManager.getDataNodeByName(l).is_specific_exec&&!function(e){if(!_.contains(t,e))return!1;switch(n){case"unidentified":case"edit":case"setVariable":case"globalFirstUpdate":return!0;default:return!1}}(l))return console.log(l+" is a memory and will be treated at the end of schedule."),d.delete(l),e.addMemorydataNodeList(l),c.add(l),void datanodesManager.getDataNodeByName(l).completeExecution("NOP");switch(datanodesManager.getDataNodeByName(l).statusForScheduler()){case"Ready":if(datanodesManager.foundDatanode(l)){let t=D(l);datanodesManager.getDataNodeByName(l).is_specific_exec&&(t=!0),t?(d.delete(l),s.add(l),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+l+" released"),xDashConfig.disableSchedulerProfiling||(schedulerProfilingItem={release:Date.now()}),a=h(l),o=N(l),datanodesManager.getDataNodeByName(l).updateNow(a,o,t,n)):(d.delete(l),c.add(l),"refresh"==n||"triggerButton"==n?(swal("Update is not available","Predecessors: "+function(a){let t="[";const o=e.getPredecessorsSet(a),n=union(i,f);return difference(o,n).forEach(e=>{t=t+' "'+e+'" '}),t+" ]"}(l)+' of operation "'+l+'" need to be executed first.',"info"),datanodesManager.getDataNodeByName(l).completeExecution("NOP")):"edit"==n||"unidentified"==n?(c.delete(l),s.add(l),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+l+" released"),xDashConfig.disableSchedulerProfiling||(schedulerProfilingItem={release:Date.now()}),a=h(l),o=N(l),datanodesManager.getDataNodeByName(l).updateNow(a,o,t,n)):(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+l+" is ready but cannot be executed because of its predecessors."),datanodesManager.getDataNodeByName(l).completeExecution("NOP")))}else{const a=Array.from(e.getSuccessors(l));offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(l+" is referenced in '"+a+"' but not defined as a datanode."),datanodesManager.getDataNodeByName(l).completeExecution("NOP")}break;case"Wait":d.delete(l),c.add(l),D(l)?offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+l+" is waiting for initialization to be done."):offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+l+" cannot be executed because of its predecessors."),datanodesManager.getDataNodeByName(l).completeExecution("NOP");break;case"NotReady":case"Stop":d.delete(l),r.add(l),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+l+" cannot not be scheduled because it needs initialization.");e.getDescendants([l]).forEach((function(e){r.add(e)})),d=difference(d,r),datanodesManager.getDataNodeByName(l).completeExecution("Error")}}else offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(l+" is already treated")}))}function D(a){const t=e.getPredecessorsSet(a),o=union(i,f);return!!isSuperset(o,t)}function p(e){return!!union(i,f).has(e)}}
function DataPreviewFormat(){"undefined"==typeof execOutsideEditor?this.execOutsideEditor=!1:execOutsideEditor?this.execOutsideEditor=!0:this.execOutsideEditor=!1,this.format=function(e){var t="",i="";if("string"==typeof e){if(e.match("base64ImageDetected")){var a=e.replace("base64ImageDetected","");return this.execOutsideEditor||(i='<img src="data:image/jpeg;base64,'+a+'"/>'),e=a,{newData:a,previewData:i}}return e.match("<div>\n<style scoped>\n")?(this.execOutsideEditor||(t=e),{newData:e,previewData:t}):(this.execOutsideEditor||(t=syntaxHighlight(JSON.stringify(e,void 0,4))),{newData:e,previewData:t})}return this.execOutsideEditor||(t=syntaxHighlight(JSON.stringify(e,void 0,4))),{newData:e,previewData:t}}}
DatanodeModel=function(e,t,a,n){var o=this;function s(){_.isUndefined(o.datanodeInstance)||(_.isFunction(o.datanodeInstance.onDispose)&&o.datanodeInstance.onDispose(),o.datanodeInstance=void 0)}this.datanodeRefreshNotifications={},this.calculatedSettingScripts={},this.formulaInterpreter=new FormulaInterpreter(e,o,t,a),this.execInstance=ko.observable(null),this.dataPreviewFormat=new DataPreviewFormat,this.is_specific_exec=!1,this.name=ko.observable(),this.latestData=ko.observable(),this.beautifulString=ko.observable(),this.status=ko.observable("None"),this.last_updated=ko.observable("never"),this.last_error=ko.observable(),this.last_error_msg=ko.observable("none"),this.error=ko.observable(),this.isSchedulerStartSafe=ko.observable(!1),this.sampleTime=ko.observable(0),this.statusForScheduler=ko.observable("Ready"),this.schedulerStatus=ko.observable("Running"),this.iconType=ko.observable(),this.settings=ko.observable({}),this.settings.subscribe((function(e){if(!_.isUndefined(o.datanodeInstance)&&_.isFunction(o.datanodeInstance.onSettingsChanged)){if(!o.formulaInterpreter.updateCalculatedSettings(!0,!1,!1))return void o.error(!0);o.datanodeInstance.onSettingsChanged(e,o.status())?o.error(!1):o.error(!0)}})),this.completeExecution=function(e){const t=o.name();var a,n={};_.isUndefined(datanodesManager.getDataNodeByName(t))||"Stop"==datanodesManager.getDataNodeByName(t).schedulerStatus()&&"NOP"!==e||(a=_.isUndefined(e)?o.status():e,null!==o.execInstance()?n=o.execInstance().operationCompleted(t,a):"Error"===a?offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("scheduling is already terminated. "+t+" is ended with status = "+o.status()):(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("statusCallback of "+t+" is called before scheduling instance created. Status = "+o.status()),n={schedulingInstanceTerminated:!1}),n.schedulingInstanceTerminated&&(null==o.execInstance()?offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("scheduling is already terminated. "+t+" is ended with status = "+o.status()):datanodesManager.getDataNodeByName(n.initiatorNode).schedulerEnd()))},this.statusCallback=function(e,t){o.status(e),"OK"==e?(o.last_error_msg("No error message"),$('[data-toggle="tooltip"]').tooltip("fixTitle")):"Pending"!==e&&"None"!==e&&"Running"!==e&&o.completeExecution(),_.isUndefined(t)||"Error"!=e||(o.last_error_msg(t),$('[data-toggle="tooltip"]').tooltip("fixTitle"))},this.statusForSchedulerCallback=function(e){o.statusForScheduler(e),"Ready"===e?(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(o.name()+" is ready now."),o.schedulerStart([o.name()],o.name(),"ReadyNow")):"NotReady"===e?(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("initialization of "+o.name()+" is interrupted due to error."),o.status("Error"),o.updateCallback(void 0,"Error")):"Stop"===e&&(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("initialization of "+o.name()+" need to be redone due to stop."),o.status("None"),o.updateCallback("","None"))},this.notificationCallback=function(e,t,a,n,o){xdashNotifications?xdashNotifications.manageNotification(e,t,a,o):(console.log("no notification lib was found. "),_.isUndefined(n)||_.isNull(n)||swal(n,a,e))},this.updateCallback=function(t,a){let n=o.name();const s=new Date;var i=o.dataPreviewFormat.format(t);t=i.newData,o.beautifulString(i.previewData),e.processDatanodeUpdate(n,t),o.latestData(t),o.last_updated(s.toLocaleTimeString()),"Error"!==a&&"None"!==a&&"Running"!==a&&o.completeExecution();let r=angular.element(document.body).scope().$root;r.alldatanodes=datanodesManager.getAllDataNodes(),r.safeApply(),widgetConnector.refreshDatanodeConsumers(t,o.name(),o.status(),o.last_updated())},this.type=ko.observable(),this.type.subscribe((function(e){if(s(),e in t&&_.isFunction(t[e].newInstance)){var n=t[e],i=!0;function r(){const e=o.name();return a.isNode(e)||a.addNode(e),n.newInstance(o.settings(),(function(e){if(o.datanodeInstance=e,!o.formulaInterpreter.updateCalculatedSettings(!0,!1,!1))return i=!1,!1}),o.updateCallback,o.statusCallback,o.notificationCallback,o.statusForSchedulerCallback)||(i=!1),!!i}let s=!1;_.isUndefined(n.external_scripts)||_.isUndefined(n.external_scripts[0])||""!==n.external_scripts[0]&&(s=!0),s?head.js(n.external_scripts.slice(0),r):r(),i||o.error(!0)}else swal("DataNode Plugin Error","The required '"+e+"' plugin does not exist in this Chalk'it version !","error"),o.error(!0)})),this.serialize=function(){return{name:o.name(),type:o.type(),settings:o.settings()}},this.deserialize=function(e){o.settings(e.settings),o.name(e.name),o.type(e.type),"Memory_plugin"===e.type&&(o.is_specific_exec=!0);let a="icn-";return _.isUndefined(t[e.type])?a+="json-variable":a+=t[e.type].icon_type.replace(/\.[^/.]+$/,""),o.iconType(a),o.error(),!0},this.getDataRepresentation=function(e){return new Function("data","return "+e+";").call(void 0,o.latestData())},this.schedulerStart=function(e,t,s){var i,r,d=o.name();offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("schedulerStart with sourceNodesArg:",e," and initiatorNodeArg:",t),_.isUndefined(e)?(i=[d],r=d):(i=e,r=t),_.isUndefined(s)&&(s="unidentified");let l=_fillRunningList(i);l.disconSourceNodes.forEach((function(t,o){if(a.addCurrentGraphList(l.disconSourceNodes,o),datanodesManager.foundDatanode(t[0]))if(null==datanodesManager.getDataNodeByName(t[0]).execInstance()){let e=Object.assign({},t);i=_updateSourceNodes(t,s),r=i[0],offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("new scheduler instance with sourceNodes:",i," and initiator:",r);var d=new DatanodeScheduler(a,i,e,r,s);if(currentGraph=l.disconGraphs[o],null!=currentGraph?currentGraph.forEach((function(e){if(!datanodesManager.foundDatanode(e))return text="Datanode '"+e+"' does not exist but referenced in another datanode",void(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(text));{const t=a.getMemorydataNodeList();if(t.size){const e=Array.from(t.keys()).filter(e=>currentGraph.has(e));e.length>0&&(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("Start schedule from memory datanodes list: "+e),a.clearMemorydataNodeList(e),datanodesManager.getDataNodeByName(e[0]).updateNow(!0,!0,!0,"memory"))}null!=datanodesManager.getDataNodeByName(e).execInstance()?offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("Instance of ",e," is already running"):(datanodesManager.getDataNodeByName(e).execInstance(d),datanodesManager.getDataNodeByName(e).schedulerStatus("Running"))}})):offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("error in building disconnected graphs"),!offSchedLogUser&&!xDashConfig.disableSchedulerLog){console.log("scheduling instance created, clkTick:"+n.getCurrentTick()+", clkTime(s):"+n.getCurrentTime());let e=datanodesManager.getDataNodeByName(i[0]).execInstance().getInitiatorNode();console.log("scheduling instance of started with "+e)}datanodesManager.getDataNodeByName(i[0]).execInstance().launchSchedule()}else if("globalFirstUpdate"===s&&0!=n.getCurrentTick())for(var c in e)offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+e[c]+", called from "+s+", is added to extraStartNodes list"),a.addExtraStartNodesList(e[c],s);else"timer"===s&&0!=n.getCurrentTick()?offSchedLogUser||xDashConfig.disableSchedulerLog||(console.log("Execution of operation "+t[0]+" is ignored at clkTick:"+n.getCurrentTick()+" because scheduling instance is not terminated yet"),console.log("Try to increase sample time of operation "+t[0])):"timer"!==s&&"globalFirstUpdate"!==s&&(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("operation "+t[0]+", called from "+s+", is added to extraStartNodes list"),a.addExtraStartNodesList(t[0],s));else offSchedLogUser||xDashConfig.disableSchedulerLog||(text="Datanode '"+t[0]+"' does not exist but referenced in another datanode",console.log(text))}))},this.schedulerEnd=function(){o.name()!==o.execInstance().getInitiatorNode()&&(offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("scheduling instance will not be terminated by the initiator "+o.execInstance().getInitiatorNode()));const e=o.execInstance().getSchedulerCallOrigin();if(null!=o.execInstance()){const t=a.getAllDisconnectedGraphs();offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("get belonging disconnected graph (from schedulerEnd)"),graph=a.getBelongingDisconnectedGraph(o.name(),t),null!=graph&&graph.forEach((function(e){datanodesManager.foundDatanode(e)?null==datanodesManager.getDataNodeByName(e).execInstance()?offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("Instance of ",e," is already terminated"):(datanodesManager.getDataNodeByName(e).execInstance(null),datanodesManager.getDataNodeByName(e).isSchedulerStartSafe(!0)):offSchedLogUser||xDashConfig.disableSchedulerLog||(text="Datanode '"+e+"' does not exist but referenced in another datanode",console.log(text))})),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("scheduling instance terminated by "+o.name());const n=a.getMemorydataNodeList(),s=a.getSetvarList(),i=a.getProcessedSetvarList(),r=new Map(Array.from(s).filter(([e])=>!i.has(e)));let d=!0;const l=a.getCurrentGraphList(),c=Array.from(l.keys()),g=l.get(c[0]);if(l.size&&(d=!1,g===c[0].length-1&&(d=!0)),d)if("timer"!==e&&a.clearCurrentGraphList(),r.size){offSchedLogUser||xDashConfig.disableSchedulerLog||(console.log("Start schedule from setVariable list: "+Array.from(r.keys())),console.log("triggered by : "+Array.from(r.values())));const e=Array.from(r.keys());if(a.addProcessedSetvarList(r),a.clearSetvarList(),n.size){const e=Array.from(n.keys()).filter(e=>r.has(e));a.clearMemorydataNodeList(e)}o.schedulerStart(e,e[0],"setVariable")}else{a.clearSetvarList(),a.clearProcessedSetvarList();const e=a.getExtraStartNodesList();if(e.size){offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("Start schedule from extraStartNodesList:"+Array.from(e.keys()));const t=Array.from(e.keys()),n=e.get(t[0]);a.clearExtraStartNodesList(),o.schedulerStart(t,t[0],n)}}else offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("Problem : request for ending a scheduling instance whereas no instance exists")}},this.updateNow=function(e,t,s,i){var r=!1;if(o.sampleTime()<1&&o.sampleTime()>=.1?Math.floor(10*n.getCurrentTime())%(10*o.sampleTime())==0&&(r=!0):o.sampleTime()>=1?n.getCurrentTime()%o.sampleTime()==0&&(r=!0):0!=o.sampleTime()&&console.log("sampleTime cannot be lesser than 0.1s"),0==o.sampleTime()||r){if(!function(e,t,a){return e&&o.settings().explicitTrig?(o.completeExecution("NOP"),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("Called from predecessor, but ExplicitTrigger of ",o.settings().name+" is true"),!1):"timer"===a&&o.settings().explicitTrig?(o.completeExecution("NOP"),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("Called from timer, but ExplicitTrigger of ",o.settings().name+" is true"),!1):!!(_.isUndefined(o.settings().autoStart)||o.settings().autoStart||t||e||"timer"===a&&"OK"===o.status())||(o.completeExecution("NOP"),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("AutoStart of ",o.settings().name+" is false"),!1)}(e,t,i))return;if(!_.isUndefined(o.datanodeInstance)&&_.isFunction(o.datanodeInstance.updateNow)){if(!o.formulaInterpreter.updateCalculatedSettings(!1,s,t))return void o.error(!0);if(s)if(o.formulaInterpreter.bCalculatedSettings){let e=Array.from(a.getPredecessorsSet(o.name()));var d=o.datanodeInstance.updateNow(t,e);_.isUndefined(d)||d.notTobeExecuted&&o.completeExecution("NOP")}else o.notificationCallback("info",o.settings().name,"Scheduling of this operation is interrupted because of its last error","Scheduler interruption"),o.updateCallback(void 0,"Error");else o.settings().explicitTrig&&!o.settings().autoStart||swal("Update is not available",'Predecessors of operation "'+o.settings().name+'" need to be executed first.',"info"),o.completeExecution("NOP"),o.updateCallback(void 0,"None")}}else offSchedLogUser||xDashConfig.disableSchedulerLog||console.log(o.name()+" is not executed because currentTime: "+n.getCurrentTime()+" is not multiple of sampleTime: "+o.sampleTime()),o.completeExecution("NOP")},this.dispose=function(){const e=o.name();a.removeNode(e),o.sampleTime()&&n.unregisterDatanode(e),null!=o.execInstance()&&(e!==o.execInstance().getInitiatorNode()?o.execInstance().stopOperation(e):(o.notificationCallback("info",e,"Scheduling is aborted because datanode "+e+" is part of scheduling operations","Scheduler stop"),o.execInstance().stopAllOperations())),s()},this.isSetValueValid=function(){return o.datanodeInstance.isSetValueValid()},this.isSetFileValid=function(){return o.datanodeInstance.isSetFileValid()},this.setValue=function(e,t,a){_.isFunction(o.datanodeInstance.getValue)?t!=o.datanodeInstance.getValue(e)&&setDirtyFlagSafe(!0):setDirtyFlagSafe(!0),o.datanodeInstance.setValue(e,t),a||o.schedulerStart([o.name()],o.name(),"setValue")},this.setValueSpec=function(t,a){const n=o.name();o.setValue(t,a),newData=JSON.parse(o.settings().json_var);var s=new Date,i=o.dataPreviewFormat.format(newData);newData=i.newData,o.beautifulString(i.previewData),e.processDatanodeUpdate(n,newData),o.latestData(newData),o.last_updated(s.toLocaleTimeString()),setDirtyFlagSafe(!0)},this.setFile=function(e){o.datanodeInstance.setFile(e)&&(o.schedulerStart([o.name()],o.name(),"setFile"),setDirtyFlagSafe(!0))},this.isSettingNameChanged=function(e){if(!_.isUndefined(o.datanodeInstance))return o.datanodeInstance.isSettingNameChanged(e)},this.getSavedSettings=function(){if(!_.isUndefined(o.datanodeInstance)&&_.isFunction(o.datanodeInstance.getSavedSettings))return o.datanodeInstance.getSavedSettings()},this.isSettingSampleTimeChanged=function(e){if(!_.isUndefined(o.datanodeInstance)&&_.isFunction(o.datanodeInstance.isSettingSampleTimeChanged))return o.datanodeInstance.isSettingSampleTimeChanged(e)},this.getXHR=function(){if(!_.isUndefined(o.datanodeInstance)&&_.isFunction(o.datanodeInstance.getXHR))return o.datanodeInstance.getXHR()},_fillRunningList=function(e){let t={disconSourceNodes:[],disconGraphs:[],indicesDisconGraphs:[]};const n=a.getAllDisconnectedGraphs();return e.forEach((function(e){offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("get belonging disconnected graph (from schedulerStart)"),graph=a.getBelongingDisconnectedGraph(e,n),null!=graph?t.indicesDisconGraphs.includes(graph.index)?t.disconSourceNodes[t.indicesDisconGraphs.indexOf(graph.index)].push(e):(t.indicesDisconGraphs.push(graph.index),t.disconSourceNodes.push([e]),t.disconGraphs.push(graph)):offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("error in building disconnected graphs")})),a.addCurrentGraphList(t.disconSourceNodes,0),t},_updateSourceNodes=function(e,t){let n=new Set(e);if(descendants=a.getDescendants(e),descendants.forEach(e=>{-1!==e.indexOf("pastValue_")&&descendants.delete(e)}),"setVariable"===t){let e=new Set,t=new Set;n.forEach(t=>{t.startsWith("pastValue_")||e.add(t)}),n.forEach(a=>{if(a.startsWith("pastValue_")){let n=a.substring(10);e.has(n)&&(t.add(a),t.add(n))}}),t.forEach(e=>{descendants.delete(e)})}return new Set(Array.from(descendants).filter(e=>n.has(e))).forEach((function(t){e.splice(e.indexOf(t),1)})),e.sort((e,t)=>(meetsCondition_a=-1!==e.indexOf("pastValue_"),meetsCondition_b=-1!==t.indexOf("pastValue_"),meetsCondition_a&&!meetsCondition_b?-1:!meetsCondition_a&&meetsCondition_b?1:0))}};
function DialogBox(e,c,i,n,t,o){var a,d,l=$('<div class="modalDialog modalDialogOpen" style="z-index:1000"></div>');_.isUndefined($(".code-mirror-wrapper")[0])||($(l)[0].style.zIndex=6e3),_.isUndefined($(".showSweetAlert")[0])||($(l)[0].style.zIndex=99999);var s=$('<div class="modalDialog__wrapper"></div>');function p(){$(document).unbind("keydown",h),l.fadeOut(200,(function(){$(this).remove()}))}function h(e){27===e.keyCode&&(n||r())}$(document).on("keydown",h),s.append('<div class="modalDialog__header"><h2>'+c+"</h2></div>"),$('<div class="modalDialog__content"></div>').appendTo(s).append(e);var u=$('<div class="modalDialog__footer"></div>').appendTo(s);function r(){var e=!1;_.isFunction(t)&&(e=a?t(a):d?t(d):t()),e||p()}n&&($('<input id="dialog-cancel" type="button" class="btn btn-rounded-fill cancel"  value="'+n+'"></input>').appendTo(u).click((function(){_.isFunction(o)?o():_.isUndefined(o)||(a=o),p()})),_.isUndefined(o)||_.isFunction(o)||(d=o)),i&&$('<input id="dialog-ok" type="button" class="btn btn-rounded-fill primary" value="'+i+'"></input>').appendTo(u).click(r),l.append(s),$("body").append(l),l.fadeIn(200)}function DialogBoxForToolboxEdit(e,c,i,n,t){DialogBox(e,c,i,n,t)}function DialogBoxForData(e,c,i,n,t){DialogBox(e,c,i,n,t),_.isUndefined($("#check-all"))||($("#check-all").click((function(e){this.checked&&($(".check-option1").each((function(){this.checked=!0})),$("#uncheck-all")[0].checked=!1)})),$("#uncheck-all").click((function(e){this.checked&&($(".check-option1").each((function(){this.checked=!1})),$("#check-all")[0].checked=!1)})),$(".check-option1").click((function(){$("#check-all")[0].checked=!1,$("#uncheck-all")[0].checked=!1})))}function DialogBoxForDuplicateData(e,c,i,n,t){if(DialogBoxForData(e,c,i,n,t),!_.isUndefined($(".data-check-input")[0])){$(".data-check-input").each((function(){$(".data-check-input").on("change paste input",(function(e){for(var c=this.id.substring(this.id.length-1,this.id.length),i=!1,n=0;n<datanodesManager.getAllDataNodes().length;n++)if(datanodesManager.getAllDataNodes()[n].name()==this.value){i=!0;break}i?($("#data-overwrite-"+c)[0].checked=!0,$("#data-checkbox-"+c)[0].checked=!1):($("#data-rename-"+c)[0].checked=!0,$("#data-checkbox-"+c)[0].checked=!0)}))}))}}function copyURLtoClipboard(){document.getElementById("swal-input").select(),document.execCommand("copy"),$("#swal-p")[0].style.visibility="visible",setTimeout((function(){$("#swal-p")[0].style.visibility="hidden"}),1500)}function DialogBoxForHtmlExport(e,c,i,n,t,o){DialogBox(e,c,i,n,t,o),_.isUndefined(o)?($("#select-export-settings")[0].value=htmlExport.exportOptions,$("#check-scale-export")[0].checked=htmlExport.checkExportOptions):($("#select-export-settings")[0].value=o[0].exportOptions,$("#check-scale-export")[0].checked=o[0].checkExportOptions,$("#check-scale-export").attr("disabled",!0))}
PluginEditor=function(jsEditor){function _displayValidationError(e,t){var n,i=$('<div class="validation--error"></div>').html(t);_.isUndefined($("#setting-value-container-data_path")[0])||(n=$("#setting-value-container-data_path")[0].childNodes[$("#setting-value-container-data_path")[0].childNodes.length-1]),"data_path"==e&&(_.isUndefined(n)||(n.style.display="table-cell"),i[0].style.display="table-cell",i[0].style.height="25px"),"name"!=e&&"url"!=e||(_.isUndefined(n)||(n.style.display=""),i[0].style.display=""),$("#setting-value-container-"+e).append(i)}function _isNumerical(e){return!isNaN(parseFloat(e))&&isFinite(e)}function _appendCalculatedSettingRow(e,t,n,i,a,s){var l=$('<textarea autocorrect="off" autocomplete="off" spellcheck="false" class="calculated-value-input" style="display:none; width:78%"></textarea>');n.multi_input?l.change((function(){var i=[];$(e).find("textarea").each((function(){var e=$(this).val();e&&(i=i.concat(e))})),t.settings[n.name]=i})):l.change((function(){t.settings[n.name]=$(this).val()})),i&&l.val(i);var r=$('<div class="codemirror-wrapper__top"></div>'),o=$('<div class="calculated-setting-row codemirror-wrapper"></div>');o.append(r);var d=jsEditor.displayMiniJSEditor(o,l.val(),t,(function(e){l.val(e),l.change()}));o.append(l);var c=$('<a>Full Screen view<i class="basic icn-full-screen""></i></a>').mousedown((function(e){e.preventDefault(),jsEditor.displayJSEditor(l.val(),t,n,s,(function(e){d.setValue(e),l.val(e),l.change()}))}));if(r.append(c),a){var p=$('<li class="remove-setting-row"><i class="icon-minus icon"></i><label></label></li>').mousedown((function(t){t.preventDefault(),o.remove(),$(e).find("textarea:first").change()}));r.prepend(p)}$(e).append(o),_.isUndefined(n.description1)||$(e).append($('<div class="setting-description" style="display:block;">'+n.description1+"</div>"))}function saveSettings(e,t,n){$(".validation--error").remove(),newSettings=t;for(var i=0;i<e.settings.length;i++){var a=e.settings[i];if(a.required&&(_.isUndefined(newSettings.settings[a.name])||""==newSettings.settings[a.name]))return _displayValidationError(a.name,"This is required."),!0;if("integer"==a.type&&newSettings.settings[a.name]%1!=0)return _displayValidationError(a.name,"Must be a whole number."),!0;if("number"==a.type&&!_isNumerical(newSettings.settings[a.name]))return _displayValidationError(a.name,"Must be a number."),!0;if("text"==a.type&&"name"==a.name){if(-1!==newSettings.settings[a.name].indexOf("\\"))return _displayValidationError(a.name,"Backslash '\\' is forbidden."),!0;if((-1!==newSettings.settings[a.name].indexOf("pastValue_")||-1!==newSettings.settings[a.name].indexOf("past."))&&"Memory_plugin"!==newSettings.type)return _displayValidationError(a.name,"'pastValue_' is forbidden. It is dedicated to memory dataNode."),!0}}if("JSON_var_plugin"==newSettings.type){datanodesManager.getJsonEd().updateVal()}return"Map_matching_from_datanode"!=newSettings.type||navigator.onLine?_.isFunction(n)?!1!==n(newSettings):void 0:(swal("Need internet connection for '"+newSettings.settings.name+"'","Please verify your connection then reload the page","error"),!1)}var newSettings={type:"",iconType:"",settings:{}};function createPluginEditor(pluginTypes,currentTypeName,currentSettingsValues,flag){function createSettingRow(e,t){let n=$('<div id="setting-row-'+e+'" class="form-row"></div>').appendTo("#data-form-content");return n.append('<div class="form-label"><label class="control-label">'+t+"</label></div>"),$('<div id="setting-value-container-'+e+'" class="form-value"></div>').appendTo(n)}function removeRows(){let e=$("#data-form-content")[0];for(;e.firstChild;)e.removeChild(e.firstChild)}function typeSelectChange(e){(newSettings.type=e,newSettings.settings={},$(".input-wrapper-current").remove(),selectedType=pluginTypes[e],newSettings.iconType=selectedType.icon_type,_.isUndefined(selectedType))||(angular.element(document.body).scope().$root.dataNodeDescription=selectedType.description,_.isUndefined(selectedType.preFillBody)?createSettingsFromDefinition(selectedType.settings,selectedType.typeahead_source,selectedType.typeahead_data_segment):createSettingsFromDefinition(selectedType.settings,selectedType.typeahead_source,selectedType.typeahead_data_segment,selectedType.preFillBody))}var selectedType;if(newSettings={type:currentTypeName,iconType:"",settings:{}},_.isUndefined(flag)){for(var labels=[{name:"JSON",searchString:["Variable"]},{name:"Python",searchString:["Pyodide"]},{name:"JavaScript",searchString:["client-side"]},{name:"APIs",searchString:["REST"]},{name:"Files",searchString:["Generic","CSV file","Unzip"]},{name:"Streams & Real-time",searchString:["Clock","Delay","Memory","WebSocket","MQTT","Geoloc"]},{name:"Others",searchString:""}],typeOptGp=[],i=0;i<labels.length;i++)typeOptGp[labels[i].name]=[];if(_.each(pluginTypes,(function(e){let t=labels.length-1;for(let i=0;i<labels.length;i++){var n=!1;for(let a=0;a<labels[i].searchString.length;a++)if(-1!=e.display_name.search(labels[i].searchString[a])){t=i,n=!0;break}if(n)break}typeOptGp[labels[t].name].push({name:e.display_name,type:e.type_name})})),1==$("#datanode-list")[0].childNodes.length){$("#datanode-list")[0].innerHTML="",$('<div class="panel--content--top"><h1>New</h1><button ng-click="editorView.newDatanodePanel.view=!editorView.newDatanodePanel.view" class="btn btn-icon-only"><i class="basic icn-miniarrowleft"></i></button></div>').appendTo($("#datanode-list"));for(let e=0;e<labels.length;e++)if(typeOptGp[labels[e].name].length>0){var datanodeWrap=$('<div class="add__new__datanode--list--wrap"></div>').appendTo($("#datanode-list"));$("<span>"+labels[e].name+"</span>").appendTo(datanodeWrap);let t=$("<ul></ul>").appendTo(datanodeWrap);for(let n=0;n<typeOptGp[labels[e].name].length;n++)a=$('<a title="Open '+labels[e].name+" : "+typeOptGp[labels[e].name][n].name+' dataNode" ng-click="openDataNodeTypePlugin(\''+typeOptGp[labels[e].name][n].type+"')\"></a>").appendTo($("<li></li>").appendTo(t)),a.text(typeOptGp[labels[e].name][n].name),$('<i class="basic icn-miniarrowright"></i>').appendTo(a)}let e=angular.element(document.body),t=e.scope().$root;t.myDataNodeHTML=$("#datanode-list").html()}}else typeSelectChange(flag);function createSettingsFromDefinition(settingsDefs,typeaheadSource,typeaheadDataSegment,preFillBody){removeRows(),_.each(settingsDefs,(function(settingDef){!_.isUndefined(settingDef.default_value)&&_.isUndefined(currentSettingsValues[settingDef.name])&&(currentSettingsValues[settingDef.name]=settingDef.default_value),"body"==settingDef.name&&1==currentSettingsValues.bodyPrefill&&(_.isUndefined(settingDef.default_value)?currentSettingsValues[settingDef.name]="":""===currentSettingsValues[settingDef.name]&&(currentSettingsValues[settingDef.name]=settingDef.default_value));var displayName=settingDef.name,valueCell;switch(_.isUndefined(settingDef.display_name)||(displayName=settingDef.display_name),valueCell=createSettingRow(settingDef.name,displayName),settingDef.type){case"array":{var containerDiv=$('<div style="display:inline-table"></div>').appendTo(valueCell),subTableDiv=$('<div class="form-table-value-subtable" style="width:80%"></div>').appendTo(containerDiv),subTable=$('<table class="sub-table"></table>').appendTo(subTableDiv),subTableHead=$("<thead></thead>").hide().appendTo(subTable),subTableHeadRow=$("<tr></tr>").appendTo(subTableHead),subTableBody=$("<tbody></tbody>").appendTo(subTable),currentSubSettingValues=[];function processHeaderVisibility(){newSettings.settings[settingDef.name].length>0?subTableHead.show():subTableHead.hide()}function createSubsettingRow(e){var t=$("<tr></tr>").appendTo(subTableBody),n={},i=!1;_.isArray(newSettings.settings[settingDef.name])||(newSettings.settings[settingDef.name]=[],i=!0);var a=2*newSettings.settings[settingDef.name].length;newSettings.settings[settingDef.name].push(n),_.each(settingDef.settings,(function(s){var l=$("<td></td>").appendTo(t),r="";_.isUndefined(e[s.name])||(r=e[s.name]),n[s.name]=r;var o="table-row-value-"+settingDef.name+a;$("<input id="+o+' class="table--row-value" type="text">').appendTo(l).val(r).change((function(){n[s.name]=$(this).val()})),i&&$("input#"+o)[0].setAttribute("readonly","readonly"),a++})),i?t.append($('<td class="table-row-operation"></td>').append($('<ul class="board-toolbar"></ul>').append($("<li></li>").append($('<i class=" icon"></i>'))))):t.append($('<td class="table-row-operation"></td>').append($('<ul class="board-toolbar"></ul>').append($("<li></li>").append($('<i class="icon-trash icon"></i>').click((function(){var e=newSettings.settings[settingDef.name].indexOf(n);-1!=e&&(newSettings.settings[settingDef.name].splice(e,1),t.remove(),processHeaderVisibility())})))))),subTableDiv.scrollTop(subTableDiv[0].scrollHeight),processHeaderVisibility()}if(_.each(settingDef.settings,(function(e){var t=e.name;_.isUndefined(e.display_name)||(t=e.display_name),$("<th>"+t+"</th>").appendTo(subTableHeadRow)})),settingDef.name in currentSettingsValues&&(currentSubSettingValues=currentSettingsValues[settingDef.name]),$('<label class="board-toolbar datasource-input-suffix"><i class="fa-plus fa"></i>ADD</label>').appendTo(containerDiv).click((function(){var e={};_.each(settingDef.settings,(function(t){e[t.name]=""})),createSubsettingRow(e)})),_.each(currentSubSettingValues,(function(e,t){createSubsettingRow(e)})),0==currentSubSettingValues.length){var newSubsettingValue={};_.each(settingDef.settings,(function(e){newSubsettingValue[e.name]=""})),newSettings.settings.req_data_type="none",$("select#select-option-req_data_type")[0].value="none",createSubsettingRow(newSubsettingValue)}break}case"boolean":{newSettings.settings[settingDef.name]=currentSettingsValues[settingDef.name];let e=$("<div></div>").appendTo(valueCell);var onOffSwitch=$('<div class="onoffswitch" style="display:inline-block"><label class="onoffswitch-label" for="'+settingDef.name+'-onoff"><div class="onoffswitch-inner"><span class="on">YES</span><span class="off">NO</span></div><div class="onoffswitch-switch"></div></label></div>').appendTo(e),input=$('<input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="'+settingDef.name+'-onoff">').prependTo(onOffSwitch).change((function(){newSettings.settings[settingDef.name]=this.checked}));settingDef.name in currentSettingsValues&&input.prop("checked",currentSettingsValues[settingDef.name]);break}case"browseText":newSettings.settings[settingDef.name]=currentSettingsValues[settingDef.name],newSettings.settings.content=currentSettingsValues.content;var input=$('<input type="text" id="select_file_path" style="float:left"></input><input type="file" style="display: none" id="select_file"></input><label class="board-toolbar datasource-input-suffix"><i class="fa-folder-open fa"></i>Browse...</label>');if(input.mousedown((function(e){e.preventDefault(),$("#select_file").change((function(e){var t=this.value,n=Path2FileName(t);$("#select_file_path").val(n);var i=new FileReader;i.addEventListener("load",(function(e){var t=e.target;text=t.result,newSettings.settings.content=text})),i.readAsText(e.target.files[0])})),$("#select_file").trigger("click")})),input.appendTo(valueCell).change((function(){newSettings.settings[settingDef.name]=Path2FileName($(this).val())})),settingDef.name in currentSettingsValues){var fakeFilePath=currentSettingsValues[settingDef.name],fileName=Path2FileName(fakeFilePath);$("#select_file_path").val(fileName)}break;case"browseBinary":newSettings.settings[settingDef.name]=currentSettingsValues[settingDef.name],newSettings.settings.content=currentSettingsValues.content;var input=$('<input type="text" id="select_file_path" style="float:left"></input><input type="file" style="display: none" id="select_file"></input><label class="board-toolbar datasource-input-suffix"><i class="fa-folder-open fa"></i>Browse...</label>');if(input.mousedown((function(e){e.preventDefault(),$("#select_file").change((function(e){var t=this.value,n=Path2FileName(t);$("#select_file_path").val(n);var i=new FileReader;i.addEventListener("load",(function(e){const t=e.target.result;newSettings.settings.content=btoa([].reduce.call(new Uint8Array(t),(function(e,t){return e+String.fromCharCode(t)}),""))})),i.readAsArrayBuffer(e.target.files[0])})),$("#select_file").trigger("click")})),input.appendTo(valueCell).change((function(){newSettings.settings[settingDef.name]=Path2FileName($(this).val())})),settingDef.name in currentSettingsValues){var fakeFilePath=currentSettingsValues[settingDef.name],fileName=Path2FileName(fakeFilePath);$("#select_file_path").val(fileName)}break;case"unzip":newSettings.settings[settingDef.name]=currentSettingsValues[settingDef.name],newSettings.settings.content=currentSettingsValues.content;var input=$('<input type="text" id="select_file_path" style="float:left"></input><input type="file" style="display: none" id="select_file" accept="application/x-zip-compressed"></input><label class="board-toolbar datasource-input-suffix"><i class="fa-folder-open fa"></i>Browse...</label>');if(input.mousedown((function(event){event.preventDefault(),$("#select_file").change((async function(event){const freeboardUIInst=new FreeboardUI,file=event.target.files[0],fileSize=file.size;let fileSizeFormat="";fileSizeFormat=fileSize<1024?fileSize+" bytes":fileSize<1048576?(fileSize/1024).toFixed(1)+" KB":(fileSize/1048576).toFixed(1)+" MB";const result={type:file.type,size:fileSizeFormat,name:file.name,content:""},fileExtension=file.name.split(".").pop(),extensionsText=["txt","json","xprjson","xml","svg","html","css","js","ts","md","csv"],fileTypes=["","application/json"],zipContent=[];fileExtension&&fileTypes.includes(result.type)&&(result.type=fileExtension);try{freeboardUIInst.showLoadingIndicator(!0);const zip=await JSZip.loadAsync(file);for(const relativePath in zip.files){const zipEntry=zip.files[relativePath],isDir=zipEntry.dir;if(isDir)continue;const fileExtension=relativePath.split(".").pop(),fileSize=zipEntry._data.uncompressedSize;if(!(fileSize>73400320))if(fileExtension&&extensionsText.includes(fileExtension)){const fileData=await zipEntry.async("string");zipContent.push({name:relativePath,content:["json","xprjson"].includes(fileExtension)?JSON.parse(JSON.stringify(eval("("+fileData+")")),null,2):fileData})}else{const e=await zipEntry.async("uint8array");zipContent.push({name:relativePath,content:btoa([].reduce.call(new Uint8Array(e),(e,t)=>e+String.fromCharCode(t),""))})}}result.content=zipContent}catch(e){const t=new PNotify({title:"Unzip file",text:"Error reading "+file.name+": "+e,type:"error",styling:"bootstrap3"});$(".ui-pnotify-container").on("click",()=>t.remove()),console.error("Error reading "+file.name+": "+e)}finally{freeboardUIInst.showLoadingIndicator(!1)}newSettings.settings.content=result;const fakeFilePath=this.value,fileName=Path2FileName(fakeFilePath);$("#select_file_path").val(fileName)})),$("#select_file").trigger("click")})),input.appendTo(valueCell).change((function(){newSettings.settings[settingDef.name]=Path2FileName($(this).val())})),settingDef.name in currentSettingsValues){var fakeFilePath=currentSettingsValues[settingDef.name],fileName=Path2FileName(fakeFilePath);$("#select_file_path").val(fileName)}break;case"json":if(newSettings.settings[settingDef.name]=currentSettingsValues[settingDef.name],newSettings.settings.content=currentSettingsValues.content,_.isUndefined($("#var-body")[0])){var input=$('<input type="text" title="'+settingDef.display_name+'" class="input__wrapper--text" id="var-body" autocorrect="off" autocomplete="off" spellcheck="false" />');if(input.appendTo(valueCell).change((function(){if(newSettings.settings[settingDef.name]=$(this).val(),!settingDef.short_display){let e=datanodesManager.getJsonEditor();datanodesManager.getJsonEd().updateEditor(e,$(this).val())}})),!settingDef.short_display){$('<div class="btn-wrapper btn-wrapper--no-label input-wrapper-current" id="btn-json">').appendTo($("#data-form-content")),$('<div class="tree__preview__container input-wrapper-current" style="height:unset"><div id="full-screen-json" class="tree__preview__container--top"><a><p>Full Screen view</p><i class="basic icn-full-screen"></i></a></div><div id="tree-preview" style="height: 36vh;"></div></div>').appendTo($("#data-form-content")),$("#full-screen-json").on("click",(function(){var e=document.getElementById("tree-preview");e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}));var json=datanodesManager.getJsonEd();json.displayJSONEdit(input.val(),(function(e){input.val(e),input.change()}))}}if(settingDef.name in currentSettingsValues&&($("#var-body").val(currentSettingsValues[settingDef.name]),!settingDef.short_display)){let e=datanodesManager.getJsonEditor(),t=datanodesManager.getJsonEd();t.updateEditor(e,currentSettingsValues[settingDef.name])}break;case"option":var defaultValue=currentSettingsValues[settingDef.name],selectId="select-option-"+settingDef.name,input=$('<select id="'+selectId+'"></select>').appendTo($('<div class="styled-select"></div>').appendTo(valueCell)).change((function(){newSettings.settings[settingDef.name]=$(this).val(),newSettings.settings.name="pastValue_"+$(this).val(),$("#value-dn_name")[0].value="pastValue_"+$(this).val(),("FMI_webservice"===settingDef.name&&newSettings.settings.bodyPrefill||"req_data_type"===settingDef.name)&&preFillBody()}));if(settingDef.from_datanode){let e=datanodesManager.getAllDataNodes();e.length&&(e=e.filter(e=>"Memory_plugin"!==e.type()),e.sort((e,t)=>e.name().localeCompare(t.name())),e.some(e=>e.name()===defaultValue)||(defaultValue=void 0),_.each(e,(function(e){let t=e.name(),n=e.name();_.isUndefined(defaultValue)&&(defaultValue=n),$("<option></option>").text(t).attr("value",n).appendTo(input)})),newSettings.settings.name="pastValue_"+defaultValue,$("#value-dn_name")[0].value="pastValue_"+defaultValue)}else _.each(settingDef.options,(function(e){let t,n;_.isObject(e)?(t=e.name,n=e.value):t=e,_.isUndefined(n)&&(n=t),_.isUndefined(defaultValue)&&(defaultValue=n),$("<option></option>").text(t).attr("value",n).appendTo(input)}));newSettings.settings[settingDef.name]=defaultValue,settingDef.name in currentSettingsValues&&input.val(currentSettingsValues[settingDef.name]);break;case"custom1":case"custom2":newSettings.settings[settingDef.name]=currentSettingsValues[settingDef.name],settingDef.implementation(valueCell,settingDef,currentSettingsValues,newSettings);break;default:var input;if(newSettings.settings[settingDef.name]=currentSettingsValues[settingDef.name],"calculated"==settingDef.type){if(settingDef.name in currentSettingsValues){var currentValue=currentSettingsValues[settingDef.name];if(settingDef.multi_input&&_.isArray(currentValue))for(var includeRemove=!1,i=0;i<currentValue.length;i++)_appendCalculatedSettingRow(valueCell,newSettings,settingDef,currentValue[i],includeRemove),includeRemove=!0;else _appendCalculatedSettingRow(valueCell,newSettings,settingDef,currentValue,!1)}else _appendCalculatedSettingRow(valueCell,newSettings,settingDef,null,!1);if(settingDef.multi_input){var inputAdder=$('<ul class="board-toolbar"><li class="add-setting-row"><i class="fa-plus fa"></i><label>ADD</label></li></ul>').mousedown((function(e){e.preventDefault(),_appendCalculatedSettingRow(valueCell,newSettings,settingDef,null,!0)}));$(valueCell).siblings(".form-label").append(inputAdder)}}else{let e="";if(e=settingDef.disabled?'<input type="text" id="value-dn_name" title="'+settingDef.display_name+'" class="input__wrapper--text disabled" disabled />':'<input type="text" title="'+settingDef.display_name+'" class="input__wrapper--text" />',input=$(e).appendTo(valueCell).change((function(){if("name"==settingDef.name&&($('<input type="text">')[0].maxLength=40),"number"==settingDef.type)newSettings.settings[settingDef.name]=Number($(this).val());else{var e=!1,t="";for(var t in widgetConnector.widgetsConnection){for(var n in widgetConnector.widgetsConnection[t].sliders)if("None"!=widgetConnector.widgetsConnection[t].sliders[n].name&&!_.isUndefined(widgetConnector.widgetsConnection[t].sliders[n].connectedDataNodeS)&&widgetConnector.widgetsConnection[t].sliders[n].connectedDataNodeS===newSettings.settings[settingDef.name]){e=!0;break}if(e)break}e&&swal("'"+newSettings.settings[settingDef.name]+"' is now missing","Connections with widget '"+widgetConnector.widgetsConnection[t].modelJsonId+"' may be removed!","warning"),newSettings.settings[settingDef.name]=$(this).val()}})),settingDef.name in currentSettingsValues&&input.val(currentSettingsValues[settingDef.name]),typeaheadSource&&settingDef.typeahead_data_field&&input.addClass("typeahead_data_field-"+settingDef.typeahead_data_field),typeaheadSource&&settingDef.typeahead_field){var typeaheadValues=[];input.keyup((function(e){e.which>=65&&e.which<=91&&input.trigger("change")})),$(input).autocomplete({source:typeaheadValues,select:function(e,t){input.val(t.item.value),input.trigger("change")}}),input.change((function(e){var t=input.val(),n=_.template(typeaheadSource)({input:t});$.get(n,(function(e){if(typeaheadDataSegment&&(e=e[typeaheadDataSegment]),e=_.select(e,(function(e){return e[settingDef.typeahead_field][0]==t[0]})),typeaheadValues=_.map(e,(function(e){return e[settingDef.typeahead_field]})),$(input).autocomplete("option","source",typeaheadValues),1==e.length)for(var n in e=e[0])if(e.hasOwnProperty(n)){var i=$(_.template("input.typeahead_data_field-<%= field %>")({field:n}));i&&(i.val(e[n]),i.val()!=input.val()&&i.trigger("change"))}}))}))}}}_.isUndefined(settingDef.suffix)||valueCell.append($('<div class="input--suffix">'+settingDef.suffix+"</div>")),_.isUndefined(settingDef.description)||valueCell.append($('<div class="setting-description">'+settingDef.description+"</div>"))}))}}return{createPluginEditor:function(e,t,n,i){createPluginEditor(e,t,n,i)},getNewSettings:function(){return newSettings},saveSettings:function(e,t,n){return saveSettings(e,t,n)}}};
JSONEdit=function(){var e,o="code";return{displayJSONEdit:function(t,n){$('<button class = "btn btn-rounded" onclick="var json = datanodesManager.getJsonEd();json.loadJSON()"> <i class = "basic icn-upload"></i>Import Json</button>').appendTo($("#btn-json")),$('<button class = "btn btn-rounded" onclick="var json = datanodesManager.getJsonEd();json.saveJSON()"> <i class = "basic icn-download"></i>Export Json</button>').appendTo($("#btn-json")),$('<div id="jsonedit"style="height:100%"></div>').appendTo($("#tree-preview")),function(t,n){function r(){var o={};try{o=e.get();var t=JSON.stringify(o);n(t)}catch(e){return void swal("Error",e.message,"error")}}var a=$("#jsonedit");$("#jsonedit")[0].innerHTML="";var s={mode:"code",modes:["code","tree"],onError:function(e){swal("Error",e.toString(),"error")},onModeChange:function(e,t){"tree"==e?($("#var-body").prop("disabled",!0),$("#jsonedit").off("focusout"),o="tree"):"code"==e&&($("#var-body").prop("disabled",!1),$("#jsonedit").on("focusout",r),o="code")},language:"en"};e=new JSONEditor(a[0],s),datanodesManager.setJsonEditor(e);try{t&&e.set(JSON.parse(t))}catch(e){swal("JSON Parse error",e.message,"error")}$("#jsonedit").on("focusout",r)}(t,n)},loadJSON:function(){if(e=datanodesManager.getJsonEditor(),window.File&&window.FileReader&&window.FileList&&window.Blob){var o=document.createElement("input");o.type="file",o.setAttribute("accept",".json"),$(o).on("change",(function(o){var t=o.target.files;if(t&&t.length>0){var n=t[0],r=new FileReader;r.addEventListener("load",(function(o){try{e.setText(o.target.result);var t=e.get(),n=JSON.stringify(t);$("#var-body").val(n),$("#var-body").change()}catch(e){swal("JSON Parse error",e.message,"error")}})),r.readAsText(n)}})),$(o).trigger("click")}else swal("Unable to load a file in this browser.","","error")},saveJSON:function(){e=datanodesManager.getJsonEditor(),swal({title:"Export JSON",text:"Save as ...",type:"input",showConfirmButton:!1,showConfirmButton1:!0,showCancelButton:!0,confirmButtonText:"Save",closeOnConfirm:!1,closeOnConfirm1:!1,inputPlaceholder:"please write JSON file name here ..."},(function(o){if(!1===o)return!1;if(""===o)return swal.showInputError("JSON file name is required!"),!1;if(null!=o){var t=o;-1==t.indexOf(".")?t+=".json":"json"==t.split(".").pop().toLowerCase()||(t=t.split(".")[0]+".json");var n=new Blob([e.getText()],{type:"application/json;charset=utf-8"});saveAs(n,t),swal.close()}}))},getJsonEd:function(){return e},updateEditor:function(e,o){datanodesManager.setJsonEditor(e);try{o&&e.set(JSON.parse(o))}catch(e){swal("JSON Parse error",e.message,"error")}},updateVal:function(){if("tree"==o){var t=e.get(),n=JSON.stringify(t);$("#var-body").val(n),$("#var-body").change()}}}};
JSEditor=function(){function e(e){e}function t(e,t,o,n,i){var a=t.settings.name,d="";"JSON_formula_plugin"===t.type?d='// Example: Convert temp from C to F and truncate to 2 decimal places.\n// return (dataNodes["MyDataNode"].sensor.tempInF * 1.8 + 32).toFixed(2);':"Python_inline_plugin"===t.type&&(d="//example: create 2 datanodes py_a a,d py_b then use them as follow:\n//return {'a':dataNodes[\"py_a\"],'b':dataNodes[\"py_b\"]}; \n//simple example:\nreturn {'key':'value'}; \n "),e||(e=d);var r=$('<div id="code-window-js" class="code-window cancel__box cancel__box--xl"></div>'),c=$('<div class="code-mirror-wrapper" id="codeWrapper"></div>'),l=$('<div class="cancel__box__bottom"></div>'),s=$('<div class="cancel__box__body"></div>'),p=$('<div class="cancel__box__top"><div class="code-window-header cm-s-ambiance"><span>This javaScript code will be re-evaluated any time this dataNode is updated, and the value you <code><span class="cm-keyword">return</span></code> will update the workspace. You can assume this code is wrapped in a function of the form <code><span class="cm-keyword">function</span>(<span class="cm-def">dataNodes</span>)</code> where dataNodes is a collection of javaScript objects (keyed by their name) defining the workspace. <br>Press <code><span class="cm-keyword">ctrl-space</span></code> to activate dataNodes autocompletion, <code><span class="cm-keyword">Tab</span></code> to go deeper into JSON and <code><span class="cm-keyword">Escape</span></code> to leave it.<br>Press <code><span class="cm-keyword">ctrl-K</span></code> to autoformat (beautify) selection. </span></div></div>'),g=$('<div class="cancel__box__container"></div>');s.append([c]),g.append([p,s,l]),r.append([g]);var u=$('<div id="codeWindowContainer" class="cancel__container open"></div>');u.append($('<div class="cancel__overlay"></div>')),u.append(r),$("body").append(u);var m=[],w=checkES6(),h=checkES7(),v=checkES8(),C=checkES9(),f=checkES10(),b=5;function y(){E.operation((function(){for(var e=0;e<m.length;++e)E.removeLineWidget(m[e]);m.length=0;var t="/*jshint esversion:"+b+"*/\n"+E.getValue();JSHINT(t);for(e=0;e<JSHINT.errors.length;++e){var o=JSHINT.errors[e];if(o){var n=document.createElement("div"),i=n.appendChild(document.createElement("span"));i.innerHTML="!!",i.className="lint-error-icon",n.appendChild(document.createTextNode(o.reason)),n.className="lint-error",m.push(E.addLineWidget(o.line-1,n,{coverGutter:!1,noHScroll:!0}))}}JSHINT.errors.length&&E.focus()}));var e=E.getScrollInfo(),t=E.charCoords({line:E.getCursor().line+1,ch:0},"local").top;e.top+e.clientHeight<t&&E.scrollTo(null,t-e.clientHeight+3)}function S(e,t){t.pick(),e.execCommand("autocomplete")}w&&(b=6),h&&(b=7),v&&(b=8),C&&(b=9),f&&(b=10);var N,k=datanodesManager.getAllDataNodes().sort((e,t)=>e.name().localeCompare(t.name())),x=CodeMirror(c.get(0),{value:e,mode:{name:"javascript",globalVars:!0},theme:"eclipse",indentUnit:4,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,lineWrapping:!0,showCursorWhenSelecting:!0,extraKeys:{"Ctrl-Space":"autocomplete","Alt-C":e=>e.toggleComment(),"Ctrl-K":e=>e.autoFormatRange(e.getCursor(!0),e.getCursor(!1))},hintOptions:{hint:JSEditorCompletion.createCompletionFct(k),completeSingle:!1,extraKeys:{Tab:S,Right:S,Left:function(e,t){const o=e.getCursor(),n=o.line,i=e.getLine(n),a=o.ch,d=JSEditorCompletion.getPrecedingPathLength(i,a);d&&(e.replaceRange("",CodeMirror.Pos(n,a-d),CodeMirror.Pos(n,a)),t.close(),e.execCommand("autocomplete"))}}}}),E=x.doc.cm;if(E.on("change",(function(){clearTimeout(N),N=setTimeout(y,500)})),setTimeout(y,100),[bFoundConnection,prop]=datanodesManager.isConnectedWithWidgt(a),bFoundConnection){var T='<div style="display: table-cell; padding: 10px"><span>Connected widget(s): </span></div>';_.each(prop,e=>{T=T+'<div style="display: table-cell; padding: 10px"><input type="radio" id="'+e+'_radio" name="dataWidgetRadio" value="'+e+'" onchange="datanodesManager.previewWidget(this.value)"><label for="'+e+'_radio">'+e+"</label></div>"});var j=$('<button id="dialog-widget" class="btn btn-rounded-fill primary" js-reset-toggle="">Show widget</button>').click((function(){if("Show widget"==$("#dialog-widget").text()){$("#code-window-js").width("80%"),$("#dialog-widget").text("Hide widget");var e="";_.each(prop,t=>{e=e+'<div id="widget-preview-zone-'+t+'" style="background-color:white; border:1px dashed rgba(0, 0, 0, 0.5)" ></div>'});var t=$('<div id="code-widget-window-js"  style="width: 49%;float: right;z-index:5000;overflow:auto;height:100%"><div id="widgets-selection-header" class="code-window-header cm-s-ambiance" style="position:relative"><div style="display: table-row">'+T+'</div></div><div id="widgets-preview-top" class="code-widget-window-preview"> '+e+"</div></div>");c.append(t),$("#"+prop[0]+"_radio").prop("checked",!0);_.each(prop,e=>{!function(e){var t=[];$("#widgets-preview-top > div").each((e,o)=>{t.push(o.id),$("#"+o.id).hide()}),$("#widget-preview-zone-"+e).show();var o=Math.min($("#"+e).height(),$("#code-widget-window-js").height()-40-$("#widgets-selection-header").height()),n=Math.min($("#"+e).width(),$("#code-widget-window-js").width()-40);$("#widget-preview-zone-"+e).width(n),$("#widget-preview-zone-"+e).height(o);var i=e.substring(0,e.length-1),a=widgetsPluginsHandler.copyWidget("widget-preview-zone-"+e,i,null,e,!0);null!=widgetConnector.widgetsConnection[e]&&(widgetConnector.widgetsConnection[e].widgetObjEdit=null,widgetConnector.widgetsConnection[e].widgetObjConnect=a)}(e)});var o=prop[0];datanodesManager.previewWidget(o),$(".code-mirror-wrapper")[0].childNodes[0].style.float="left",$(".code-mirror-wrapper")[0].childNodes[0].style.width="50%"}else $("#dialog-widget").text("Show widget"),_.each(prop,e=>{null!=widgetConnector.widgetsConnection[e]&&(widgetConnector.widgetsConnection[e].widgetObjEdit=null,widgetConnector.widgetsConnection[e].widgetObjConnect=null)}),$("#code-widget-window-js").remove(),$("#code-window-js").width("80%"),$(".code-mirror-wrapper")[0].childNodes[0].style.float="unset",$(".code-mirror-wrapper")[0].childNodes[0].style.width="unset"}));l.append(j);var H=$('<button id="apply-widget" class="btn btn-rounded-fill primary" js-reset-toggle="">Apply</button>').click((function(){t.settings[o.name]=x.getValue(),angular.element(document.getElementById("dash-datanode-ctrl")).scope().saveDataNodeSettings(!0)}));l.append(H)}var J=$('<button id="dialog-cancel" class="btn btn-rounded-fill primary" js-reset-toggle="">Close </button>').click((function(){if(i){var e=x.getValue();i(e),"Hide widget"==$("#dialog-widget").text()&&(instanceId=prop[0],null!=widgetConnector.widgetsConnection[instanceId]&&(widgetConnector.widgetsConnection[instanceId].widgetObjEdit=null,widgetConnector.widgetsConnection[instanceId].widgetObjConnect=null))}$("#codeWindowContainer").remove()}));l.append(J)}return{displayJSEditor:function(e,o,n,i,a){t(e,o,n,0,a)},displayMiniJSEditor:function(e,t,o,n){return function(e,t,o,n){o.settings.name;var i="";"JSON_formula_plugin"===o.type?i='// Example: Convert temp from C to F and truncate to 2 decimal places.\n// return (dataNodes["MyDataNode"].sensor.tempInF * 1.8 + 32).toFixed(2);':"Python_inline_plugin"===o.type&&(i=""),t||(t=i);var a=$('<div class="codemirror-wrapper__content"></div>');e.append(a);var d=[],r=checkES6(),c=checkES7(),l=checkES8(),s=checkES9(),p=checkES10(),g=5;function u(){C.operation((function(){for(var e=0;e<d.length;++e)C.removeLineWidget(d[e]);d.length=0;var t="/*jshint esversion:"+g+"*/\n"+C.getValue();JSHINT(t);for(e=0;e<JSHINT.errors.length;++e){var o=JSHINT.errors[e];if(o){var n=document.createElement("div"),i=n.appendChild(document.createElement("span"));i.innerHTML="!!",i.className="lint-error-icon",n.appendChild(document.createTextNode(o.reason)),n.className="lint-error",d.push(C.addLineWidget(o.line-1,n,{coverGutter:!1,noHScroll:!0}))}}JSHINT.errors.length&&C.focus()}));var e=C.getScrollInfo(),t=C.charCoords({line:C.getCursor().line+1,ch:0},"local").top;e.top+e.clientHeight<t&&C.scrollTo(null,t-e.clientHeight+3)}function m(e,t){t.pick(),e.execCommand("autocomplete")}r&&(g=6),c&&(g=7),l&&(g=8),s&&(g=9),p&&(g=10);var w,h=datanodesManager.getAllDataNodes().sort((e,t)=>e.name().localeCompare(t.name())),v=CodeMirror(a.get(0),{value:t,mode:{name:"javascript",globalVars:!0},theme:"eclipse",indentUnit:4,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,lineWrapping:!0,showCursorWhenSelecting:!0,extraKeys:{"Ctrl-Space":"autocomplete","Alt-C":e=>e.toggleComment(),"Ctrl-K":e=>e.autoFormatRange(e.getCursor(!0),e.getCursor(!1))},hintOptions:{hint:JSEditorCompletion.createCompletionFct(h),completeSingle:!1,extraKeys:{Tab:m,Right:m,Left:function(e,t){const o=e.getCursor(),n=o.line,i=e.getLine(n),a=o.ch,d=JSEditorCompletion.getPrecedingPathLength(i,a);d&&(e.replaceRange("",CodeMirror.Pos(n,a-d),CodeMirror.Pos(n,a)),t.close(),e.execCommand("autocomplete"))}}}}),C=v.doc.cm;C.on("change",(function(){clearTimeout(w),w=setTimeout(u,500);var e=v.getValue();n(e)})),w=setTimeout(u,500);var f=v.getValue();return setTimeout((function(){v.refresh()}),1),n(f),v}(e,t,o,n)},setAssetRoot:function(t){e(t)}}};
JSEditorCompletion=function(){function t(t,o,c){const a=i(o,c,!0);if(a){if(c<a.end)return n(t,a.start,a.end);{const n=u(o,a.end,c);if(n){const o=f(t,a.name);if(o){const t=l(o,n.path);let i=[];return Array.isArray(t)?i=[...t.keys()].map(e=>r(`[${e}]`,t[e])):"object"!=typeof t&&"function"!=typeof t||null===t||(i=Object.keys(t).map(n=>r(`[${e(n)}]`,t[n]))),{list:i,from:n.completionStart,to:n.completionEnd}}return}}}const d=s(o,c);if(d){const e=t.filter(t=>t.name().startsWith(d.prefix));return n(e.length>0?e:t,d.start,d.end)}const p=o.substring(0,c),h=/(?<=[^\w]|^)d(?:a(?:t(?:a(?:N(?:o(?:d(?:es?)?)?)?)?)?)?)?$/.exec(p);return h?n(t,h.index,c):n(t,c)}function e(t){return JSON.stringify(t)}function n(t,n,o){return void 0===o&&(o=n),{list:t.map(t=>r(`dataNodes[${e(t.name())}]`,t.latestData())),from:n,to:o}}function r(t,e){return{text:t,render:function(n,r,i){const s=document.createElement("div"),c=document.createElement("b");if(c.innerText=t,s.appendChild(c),void 0!==e){const t=document.createElement("span");t.innerText=" - ",s.appendChild(t);const n=document.createElement("i");n.innerText=o(e,75),s.appendChild(n)}n.appendChild(s)}}}function o(t,e=75){let n=JSON.stringify(t);if(n.length>e){let r;r=Array.isArray(t)?"...]":"object"!=typeof t&&"function"!=typeof t||null===t?"string"==typeof t||t instanceof String?'..."':"...":"...}",n=n.substr(0,e-r.length)+r}return n}function i(t,e,n=!1){const r=/dataNodes\s*\[\s*(["'])((?:(?=(\\?))\3.)*?)\1\s*\]/g;let o,i;for(;o=r.exec(t);){const t=o[0],n=o.index,r=n+t.length;if(i={name:c(o[2]),start:n,end:r},e>=n&&e<=r)return i}return n&&i&&i.end<=e?i:void 0}function s(t,e){const n=t.substring(0,e),r=/dataNodes\s*\[\s*["']([^"']*)/g;let o;for(;o=r.exec(n);){const t=o[0],n=o.index,r=n+t.length;if(r===e)return{prefix:o[1],start:n,end:r}}}function c(t){if(t){let e="",n=!1;for(let r of t)n?(n=!1,e+="b"===r?"\b":"f"===r?"\f":"n"===r?"\n":"r"===r?"\r":"t"===r?"\t":"v"===r?"\v":r):"\\"===r?n=!0:e+=r;return e}return t}function a(t){const e=/^\s*\[\s*(?:([0-9]+)|(["'])((?:(?=(\\?))\4.)*?)\2)\s*\]/,n=[];let r,o=0;for(;r=e.exec(t);){if(r[1])try{n.push(parseInt(r[1],10))}catch(e){return void console.error(`Invalid number '${r[1]}' in path '${t}'`)}else{if(!r[3])return void console.error(`No matched group in match '${r[0]}' in path '${t}'`);n.push(c(r[3]))}const e=r[0];o+=e.length,t=t.substring(e.length)}return{path:n,length:o}}function u(t,e,n){const r=t.substring(e,n),o=a(r);if(o){const t=o.length,n=e+t,i=r.substr(t);let s;if(s=/^\s*(?:\[\s*(?:["']\s*)?)?$/.exec(i))return{completionStart:n,completionEnd:n+s[0].length,path:o.path}}}function f(t,e){const n=t.find(t=>t.name()===e);return n?n.latestData():void 0}function l(t,e){let n=t;for(let t of e){if(null==n||"string"==typeof n||n instanceof String)return;n=n[t]}return n}return{getPrecedingPathLength:function(t,e){const n=t.substring(0,e);let r;if(r=/^.*(\s*\[\s*(?:[0-9]+|(["'])(?:(?=(\\?))\3.)*?)\2\s*\]\s*)$/.exec(n)){let n=r[1].length;const o="dataNodes";return t.substring(0,e-n).endsWith(o)&&(n+=o.length),n}},createCompletionFct:function(e){return function(n,r){if(!e||0===e.length)return;const o=n.getCursor(),i=o.line,s=n.getLine(i),c=o.ch,a=t(e,s,c);return a&&(a.from=CodeMirror.Pos(i,a.from),a.to=CodeMirror.Pos(i,a.to)),a}},_locateDataNodes:i,_locateDataNodesPrefix:s,_decodePath:a,_locatePath:u,_getDsData:f,_resolvePath:l,_quoteString:e,_valueToText:o,_complete:t}}();
var datanodesManager=function(){var e,n={},t=new DatanodeDependency;"undefined"==typeof execOutsideEditor?this.execOutsideEditor=!1:execOutsideEditor?this.execOutsideEditor=!0:this.execOutsideEditor=!1,this.execOutsideEditor||(e=new GraphVisu(t));var a=new TimeManager,o=new FreeboardUI,i=new DatanodesListModel(n,o,t,a),s=new JSONEdit,d={},r=new JSEditor,c=new PluginEditor(r);function l(e){if(e.sampleTime()&&a.unregisterDatanode(e.name()),t.hasSuccessors(e.name())){let n=Array.from(t.getSuccessors(e.name())).toString();n=n.replaceAll(",",", "),swal("Deleting dataNode side effects",'This dataNode "'+e.name()+'" is still used in dataNode(s) "'+n+'".\n It must be changed.',"warning")}var n=angular.element(document.body).scope().$root;i.deleteDatanode(e),i.datanodes.remove(e),n.alldatanodes=datanodesManager.getAllDataNodes(),n.filtredNodes=n.alldatanodes.length,n.showNotifications=!1,n.updateFlagDirty(!0),n.safeApply(),t.updateDisconnectedGraphsList(e.name(),"delete"),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("All disconnected Graphs after delete: ",t.getAllDisconnectedGraphs())}function u(e){var n=!1,t=[];for(var a in widgetConnector.widgetsConnection)for(var o in widgetConnector.widgetsConnection[a].sliders)"None"!=widgetConnector.widgetsConnection[a].sliders[o].name&&widgetConnector.widgetsConnection[a].sliders[o].dataNode===e&&(n=!0,t.push(a));return n||(t=[]),[n,_.uniq(t)]}function g(e,n,t){if([bFoundConnection,prop]=u(e.name()),"datanode"==n&&bFoundConnection){let n=[];for(let e=0;e<prop.length;e++)n.push(widgetConnector.widgetsConnection[prop[e]].instanceId);swal({title:"Are you sure?",text:"This dataNode will be deleted and connections with widget(s) '"+n.join("\n")+"' may be removed!",type:"warning",showCancelButton:!0,showConfirmButton:!1,showConfirmButton1:!0,confirmButtonText:"Yes",cancelButtonText:"Abandon",closeOnConfirm:!0,closeOnConfirm1:!0,closeOnCancel:!0},(function(n){if(n){if(l(e),angular.element(document.body).scope().$root.bIsPlayMode)for(key in widgetConnector.widgetsConnection)widgetPreview.plotConstantData(key,!1)}}))}else{var a=angular.element(document.body).scope().$root;a.isPopupWindow=!0,a.popupTitle="Confirm Delete",a.popupText="Are you sure you want to delete this "+t,a.popupAction=function(){"datanode"==n&&l(e)}}}return ko.bindingHandlers.pluginEditor={init:function(e,t,a,o,i){var s=ko.unwrap(t()),d="";"datanode"==s.type&&(n,d="DataNode"),$(e).click((function(n){if("delete"==s.operation)g(o,s.type,d);else if("refresh"==s.operation)o.schedulerStart(void 0,void 0,"refresh");else if("stop"==s.operation)null!=o.execInstance()&&o.execInstance().stopOperation(o.name());else if("showTooltip"==s.operation)"datanode"==s.type&&($(e).tooltip("fixTitle"),$(e).tooltip("show"));else if("hide"==s.operation)"data-preview"==s.type&&$(e).parent().parent().parent().remove();else{"datanode"==s.type&&("add"==s.operation?{}:(o.type(),o.settings().name=o.name()))}}))}},ko.virtualElements.allowedBindings.datanodeTypeSettings=!0,ko.bindingHandlers.datanodeTypeSettings={update:function(e,n,t,a,o){processPluginSettings(e,n,t,a,o)}},{initialize:function(e){ko.applyBindings(i),o.showLoadingIndicator(!1),document.querySelectorAll(".docsLink").forEach((function(e){e.href=xDashConfig.urlDoc+"index.html"})),urlQueryEntry.process(e)},load:function(e,n,t){return i.load(e,n,t),!i.error()},serialize:function(){return i.serialize()},loadDatanodePlugin:function(e){_.isUndefined(e.display_name)&&(e.display_name=e.type_name),"Memory_plugin"!==e.type_name?e.settings.unshift({name:"name",display_name:"Name",type:"text",required:!0}):e.settings.unshift({name:"name",display_name:"Generated memory name",type:"text",disabled:!0}),n[e.type_name]=e,i._datanodeTypes.valueHasMutated()},getDataNodePluginTypes:function(){return n},setAssetRoot:function(e){r.setAssetRoot(e)},showLoadingIndicator:function(e){o.showLoadingIndicator(e)},foundDatanode:function(e){var n=i.datanodes();return datanode=_.find(n,(function(n){return n.name()===e})),!!datanode},getDataNodeByName:function(e){var n=i.datanodes();if(datanode=_.find(n,(function(n){return n.name()===e})),datanode)return datanode},getDatasourceByName:function(e){return datanodesManager.getDataNodeByName(e)},getAllDataNodes:function(){return i.datanodes()},getAllDataSources:function(){return datanodesManager.getAllDataNodes()},clear:function(){return schedulerProfiling={},i.clear()},showDepGraph:function(n){e.showDepGraph(n),angular.element(document.getElementById("dependency__graph--container")).scope().getUniqTypes()},editNodeFromGraph:function(e){angular.element(document.getElementById("dependency__graph--container")).scope().editNodeFromGraph(e)},selectNodeFromTagList:function(n){e.selectNodeFromTagList(n)},selectConnectedWithWidget:function(n){e.selectConnectedWithWidget(n)},closeGraph:function(){e.closeGraph()},isSingletonNode:function(e){return t.isSingletonNode(e)},RemoveUnusedDatanodes:function(){var e=[],n=t.getAllsingletonNodes();for(let t in n)[bFoundConnection,prop]=u(n[t]),bFoundConnection||e.push(n[t]);offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("zombie: ",e);var a=[],o=xdsjson.getDataList(e,"Unused data is a singleton node that is not connected to any widget.<br>Please check data to be deleted : ");new DialogBoxForData(o,"List of unused data","Delete","Cancel",(function(){for(var n=0;n<e.length;n++)$("#data-checkbox-"+n).is(":checked")&&(a[n]=e[n],l(datanodesManager.getDataNodeByName(e[n])),!0)}))},stopSchedule:function(){var e=i.datanodes();for(var n in t.clearExtraStartNodesList(),t.clearSetvarList(),t.clearProcessedSetvarList(),t.clearCurrentGraphList(),e)if(null!=e[n].execInstance()){e[n].execInstance().stopAllOperations(),swal("Scheduler progress","scheduler is stopped!","success");break}},isConnectedWithWidgt:u,previewWidget:function(e){var n=[];$("#widgets-preview-top > div").each((e,t)=>{n.push(t.id),$("#"+t.id).hide()}),$("#widget-preview-zone-"+e).show()},deleteDataNode:function(e,n,t){g(e,n,t)},createPluginEditor:function(e,n,t,a){!function(e,n,t,a){c.createPluginEditor(e,n,t,a)}(e,n,t,a)},settingsSavedCallback:function(e,o,s,d){return!!c.saveSettings(d,s,(function(){return function(e,o,s){var d;if("add"==o.operation){if("datanode"==o.type){if(datanodesManager.foundDatanode(s.settings.name))return swal("A dataNode with name '"+s.settings.name+"' adready exists.","Please specify a different name","error"),!0;(d=new DatanodeModel(i,n,t,a)).name(s.settings.name),d.settings(s.settings),d.type(s.type),"Memory_plugin"===s.type&&(d.is_specific_exec=!0);const e="icn-"+s.iconType.replace(/\.[^/.]+$/,"");if(d.iconType(e),d.error())return!0;d.isSchedulerStartSafe(!0),i.addDatanode(d),t.updateDisconnectedGraphsList(d.name(),"add"),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("All disconnected Graphs after add: ",t.getAllDisconnectedGraphs()),_.isUndefined(s.settings.sampleTime)||0==s.settings.sampleTime?d.schedulerStart(void 0,void 0,"unidentified"):(d.sampleTime(s.settings.sampleTime),a.registerDatanode(d.sampleTime(),d.name(),"unidentified")),angular.element(document.body).injector().invoke(["$rootScope",function(e){}]);var r=angular.element(document.body).scope().$root;r.alldatanodes=datanodesManager.getAllDataNodes(),r.showNotifications=!1,r.safeApply()}}else if("edit"==o.operation){if("datanode"==o.type){if(e.isSettingNameChanged(s.settings.name)){if(datanodesManager.foundDatanode(s.settings.name))return swal("A dataNode with name '"+s.settings.name+"' adready exists.","Please specify a different name","error"),!0;if(t.hasSuccessors(e.name())){var c=Array.from(t.getSuccessors(e.name()));swal("Renaming dataNode side effects",'Old name "'+e.name()+'" is used in dataNode(s) "'+c+'" and should be changed by the new one "'+s.settings.name+'".',"warning"),t.addNode(e.name())}null!=e.execInstance()&&e.execInstance().stopOperation(e.name()),e.name()!==s.settings.name&&i.renameDatanodeData(e.name(),s.settings.name)}e.name()!==s.settings.name&&t.renameNode(e.name(),s.settings.name),e.name(s.settings.name),_.isUndefined(s.settings.sampleTime)||e.isSettingSampleTimeChanged(s.settings.sampleTime)&&e.sampleTime(s.settings.sampleTime)}e.type(s.type),e.settings(s.settings);const n="icn-"+s.iconType.replace(/\.[^/.]+$/,"");if(e.iconType(n),e.error())return!0;"datanode"==o.type&&(t.computeAllDisconnectedGraphs(),offSchedLogUser||xDashConfig.disableSchedulerLog||console.log("All disconnected Graphs after rename: ",t.getAllDisconnectedGraphs()),_.isUndefined(s.settings.sampleTime)?e.schedulerStart(void 0,void 0,"edit"):0!=e.sampleTime()?a.registerDatanode(e.sampleTime(),e.name(),"edit"):a.isRegisteredDatanode(e.name())&&(a.unregisterDatanode(e.name()),e.schedulerStart(void 0,void 0,"edit")))}return!1}(e,o,s)}))},getOldSettingsCallback:function(e){!function(e){if(_.isFunction(e.getSavedSettings)){var n=e.getSavedSettings();if(!_.isUndefined(n))e.settings(n[1]),e.statusCallback(n[0]),e.name()!==n[1].name&&(i.renameDatanodeData(e.name(),n[1].name),t.renameNode(e.name(),n[1].name)),e.name(n[1].name),n[1]}}(e)},getDataNodeNewSettings:function(){return c.getNewSettings()},getJsonEd:function(){return s},setJsonEditor:function(e){d=e},getJsonEditor:function(){return d}}}();
/* @license
Papa Parse
v5.3.0
https://github.com/mholt/PapaParse
License: MIT
*/
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,(function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{};var i=!t.document&&!!t.postMessage,r=i&&/blob:/i.test((t.location||{}).protocol),n={},s=0,a={parse:function(i,r){var o=(r=r||{}).dynamicTyping||!1;C(o)&&(r.dynamicTypingFunction=o,o={});if(r.dynamicTyping=o,r.transform=!!C(r.transform)&&r.transform,r.worker&&a.WORKERS_SUPPORTED){var h=function(){if(!a.WORKERS_SUPPORTED)return!1;var i=(o=t.URL||t.webkitURL||null,h=e.toString(),a.BLOB_URL||(a.BLOB_URL=o.createObjectURL(new Blob(["(",h,")();"],{type:"text/javascript"})))),r=new t.Worker(i);var o,h;return r.onmessage=m,r.id=s++,n[r.id]=r,r}();return h.userStep=r.step,h.userChunk=r.chunk,h.userComplete=r.complete,h.userError=r.error,r.step=C(r.step),r.chunk=C(r.chunk),r.complete=C(r.complete),r.error=C(r.error),delete r.worker,void h.postMessage({input:i,config:r,workerId:h.id})}var p=null;if(i===a.NODE_STREAM_INPUT&&"undefined"==typeof PAPA_BROWSER_CONTEXT)return(p=new c(r)).getStream();"string"==typeof i?p=r.download?new u(r):new d(r):!0===i.readable&&C(i.read)&&C(i.on)?p=new l(r):(t.File&&i instanceof File||i instanceof Object)&&(p=new f(r));return p.stream(i)},unparse:function(e,t){var i=!1,r=!0,n=",",s="\r\n",o='"',h=o+o,u=!1,f=null,d=!1;!function(){if("object"!=typeof t)return;"string"!=typeof t.delimiter||a.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(n=t.delimiter);("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(i=t.quotes);"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(u=t.skipEmptyLines);"string"==typeof t.newline&&(s=t.newline);"string"==typeof t.quoteChar&&(o=t.quoteChar);"boolean"==typeof t.header&&(r=t.header);if(Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");f=t.columns}void 0!==t.escapeChar&&(h=t.escapeChar+o);"boolean"==typeof t.escapeFormulae&&(d=t.escapeFormulae)}();var l=new RegExp(_(o),"g");"string"==typeof e&&(e=JSON.parse(e));if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return c(null,e,u);if("object"==typeof e[0])return c(f||Object.keys(e[0]),e,u)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),c(e.fields||[],e.data||[],u);throw new Error("Unable to serialize unrecognized input");function c(e,t,i){var a="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var o=Array.isArray(e)&&e.length>0,h=!Array.isArray(t[0]);if(o&&r){for(var u=0;u<e.length;u++)u>0&&(a+=n),a+=p(e[u],u);t.length>0&&(a+=s)}for(var f=0;f<t.length;f++){var d=o?e.length:t[f].length,l=!1,c=o?0===Object.keys(t[f]).length:0===t[f].length;if(i&&!o&&(l="greedy"===i?""===t[f].join("").trim():1===t[f].length&&0===t[f][0].length),"greedy"===i&&o){for(var _=[],g=0;g<d;g++){var m=h?e[g]:g;_.push(t[f][m])}l=""===_.join("").trim()}if(!l){for(var y=0;y<d;y++){y>0&&!c&&(a+=n);var v=o&&h?e[y]:y;a+=p(t[f][v],y)}f<t.length-1&&(!i||d>0&&!c)&&(a+=s)}}return a}function p(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);!0===d&&"string"==typeof e&&null!==e.match(/^[=+\-@].*$/)&&(e="'"+e);var r=e.toString().replace(l,h);return"boolean"==typeof i&&i||"function"==typeof i&&i(e,t)||Array.isArray(i)&&i[t]||function(e,t){for(var i=0;i<t.length;i++)if(e.indexOf(t[i])>-1)return!0;return!1}(r,a.BAD_DELIMITERS)||r.indexOf(n)>-1||" "===r.charAt(0)||" "===r.charAt(r.length-1)?o+r+o:r}}};if(a.RECORD_SEP=String.fromCharCode(30),a.UNIT_SEP=String.fromCharCode(31),a.BYTE_ORDER_MARK="\ufeff",a.BAD_DELIMITERS=["\r","\n",'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!i&&!!t.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=g,a.ParserHandle=p,a.NetworkStreamer=u,a.FileStreamer=f,a.StringStreamer=d,a.ReadableStreamStreamer=l,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(a.DuplexStreamStreamer=c),t.jQuery){var o=t.jQuery;o.fn.parse=function(e){var i=e.config||{},r=[];return this.each((function(e){if(!("INPUT"===o(this).prop("tagName").toUpperCase()&&"file"===o(this).attr("type").toLowerCase()&&t.FileReader)||!this.files||0===this.files.length)return!0;for(var n=0;n<this.files.length;n++)r.push({file:this.files[n],inputElem:this,instanceConfig:o.extend({},i)})})),n(),this;function n(){if(0!==r.length){var t,i,n,h,u=r[0];if(C(e.before)){var f=e.before(u.file,u.inputElem);if("object"==typeof f){if("abort"===f.action)return t="AbortError",i=u.file,n=u.inputElem,h=f.reason,void(C(e.error)&&e.error({name:t},i,n,h));if("skip"===f.action)return void s();"object"==typeof f.config&&(u.instanceConfig=o.extend(u.instanceConfig,f.config))}else if("skip"===f)return void s()}var d=u.instanceConfig.complete;u.instanceConfig.complete=function(e){C(d)&&d(e,u.file,u.inputElem),s()},a.parse(u.file,u.instanceConfig)}else C(e.complete)&&e.complete()}function s(){r.splice(0,1),n()}}}function h(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=k(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new p(t),this._handle.streamer=this,this._config=t}.call(this,e),this.parseChunk=function(e,i){if(this.isFirstChunk&&C(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(e);void 0!==n&&(e=n)}this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+e;this._partialLine="";var o=this._handle.parse(s,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var h=o.meta.cursor;this._finished||(this._partialLine=s.substring(h-this._baseIndex),this._baseIndex=h),o&&o.data&&(this._rowCount+=o.data.length);var u=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)t.postMessage({results:o,workerId:a.WORKER_ID,finished:u});else if(C(this._config.chunk)&&!i){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);o=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!u||!C(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(e){C(this._config.error)?this._config.error(e):r&&this._config.error&&t.postMessage({workerId:a.WORKER_ID,error:e,finished:!1})}}function u(e){var t;(e=e||{}).chunkSize||(e.chunkSize=a.RemoteChunkSize),h.call(this,e),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),i||(t.onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var n=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+n)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}i&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||t.status>=400?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");if(null===t)return-1;return parseInt(t.substring(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var i=t.statusText||e;this._sendError(new Error(i))}}function f(e){var t,i;(e=e||{}).chunkSize||(e.chunkSize=a.LocalChunkSize),h.call(this,e);var r="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,i=e.slice||e.webkitSlice||e.mozSlice,r?((t=new FileReader).onload=b(this._chunkLoaded,this),t.onerror=b(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var n=Math.min(this._start+this._config.chunkSize,this._input.size);e=i.call(e,this._start,n)}var s=t.readAsText(e,this._config.encoding);r||this._chunkLoaded({target:{result:s}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function d(e){var t;e=e||{},h.call(this,e),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,i=this._config.chunkSize;return i?(e=t.substring(0,i),t=t.substring(i)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function l(e){e=e||{},h.call(this,e);var t=[],i=!0,r=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){r&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=b((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=b((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=b((function(){this._streamCleanUp(),r=!0,this._streamData("")}),this),this._streamCleanUp=b((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function c(e){var t=require("stream").Duplex,i=k(e),r=!0,n=!1,s=[],a=null;this._onCsvData=function(e){var t=e.data;a.push(t)||this._handle.paused()||this._handle.pause()},this._onCsvComplete=function(){a.push(null)},i.step=b(this._onCsvData,this),i.complete=b(this._onCsvComplete,this),h.call(this,i),this._nextChunk=function(){n&&1===s.length&&(this._finished=!0),s.length?s.shift()():r=!0},this._addToParseQueue=function(e,t){s.push(b((function(){if(this.parseChunk("string"==typeof e?e:e.toString(i.encoding)),C(t))return t()}),this)),r&&(r=!1,this._nextChunk())},this._onRead=function(){this._handle.paused()&&this._handle.resume()},this._onWrite=function(e,t,i){this._addToParseQueue(e,i)},this._onWriteComplete=function(){n=!0,this._addToParseQueue("")},this.getStream=function(){return a},(a=new t({readableObjectMode:!0,decodeStrings:!1,read:b(this._onRead,this),write:b(this._onWrite,this)})).once("finish",b(this._onWriteComplete,this))}function p(e){var t,i,r,n=Math.pow(2,53),s=-n,o=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)(e[-+]?\d+)?\s*$/,h=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,u=this,f=0,d=0,l=!1,c=!1,p=[],m={data:[],errors:[],meta:{}};if(C(e.step)){var y=e.step;e.step=function(t){if(m=t,E())b();else{if(b(),0===m.data.length)return;f+=t.data.length,e.preview&&f>e.preview?i.abort():(m.data=m.data[0],y(m,u))}}}function v(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function b(){if(m&&r&&(R("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),r=!1),e.skipEmptyLines)for(var t=0;t<m.data.length;t++)v(m.data[t])&&m.data.splice(t--,1);return E()&&function(){if(!m)return;function t(t,i){C(e.transformHeader)&&(t=e.transformHeader(t,i)),p.push(t)}if(Array.isArray(m.data[0])){for(var i=0;E()&&i<m.data.length;i++)m.data[i].forEach(t);m.data.splice(0,1)}else m.data.forEach(t)}(),function(){if(!m||!e.header&&!e.dynamicTyping&&!e.transform)return m;function t(t,i){var r,n=e.header?{}:[];for(r=0;r<t.length;r++){var s=r,a=t[r];e.header&&(s=r>=p.length?"__parsed_extra":p[r]),e.transform&&(a=e.transform(a,s)),a=w(s,a),"__parsed_extra"===s?(n[s]=n[s]||[],n[s].push(a)):n[s]=a}return e.header&&(r>p.length?R("FieldMismatch","TooManyFields","Too many fields: expected "+p.length+" fields but parsed "+r,d+i):r<p.length&&R("FieldMismatch","TooFewFields","Too few fields: expected "+p.length+" fields but parsed "+r,d+i)),n}var i=1;!m.data.length||Array.isArray(m.data[0])?(m.data=m.data.map(t),i=m.data.length):m.data=t(m.data,0);e.header&&m.meta&&(m.meta.fields=p);return d+=i,m}()}function E(){return e.header&&0===p.length}function w(t,i){return function(t){return e.dynamicTypingFunction&&void 0===e.dynamicTyping[t]&&(e.dynamicTyping[t]=e.dynamicTypingFunction(t)),!0===(e.dynamicTyping[t]||e.dynamicTyping)}(t)?"true"===i||"TRUE"===i||"false"!==i&&"FALSE"!==i&&(function(e){if(o.test(e)){var t=parseFloat(e);if(t>s&&t<n)return!0}return!1}(i)?parseFloat(i):h.test(i)?new Date(i):""===i?null:i):i}function R(e,t,i,r){var n={type:e,code:t,message:i};void 0!==r&&(n.row=r),m.errors.push(n)}this.parse=function(n,s,o){var h=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var i=new RegExp(_(t)+"([^]*?)"+_(t),"gm"),r=(e=e.replace(i,"")).split("\r"),n=e.split("\n"),s=n.length>1&&n[0].length<r[0].length;if(1===r.length||s)return"\n";for(var a=0,o=0;o<r.length;o++)"\n"===r[o][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(n,h)),r=!1,e.delimiter)C(e.delimiter)&&(e.delimiter=e.delimiter(n),m.meta.delimiter=e.delimiter);else{var u=function(t,i,r,n,s){var o,h,u,f;s=s||[",","\t","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var d=0;d<s.length;d++){var l=s[d],c=0,p=0,_=0;u=void 0;for(var m=new g({comments:n,delimiter:l,newline:i,preview:10}).parse(t),y=0;y<m.data.length;y++)if(r&&v(m.data[y]))_++;else{var k=m.data[y].length;p+=k,void 0!==u?k>0&&(c+=Math.abs(k-u),u=k):u=k}m.data.length>0&&(p/=m.data.length-_),(void 0===h||c<=h)&&(void 0===f||p>f)&&p>1.99&&(h=c,o=l,f=p)}return e.delimiter=o,{successful:!!o,bestDelimiter:o}}(n,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);u.successful?e.delimiter=u.bestDelimiter:(r=!0,e.delimiter=a.DefaultDelimiter),m.meta.delimiter=e.delimiter}var f=k(e);return e.preview&&e.header&&f.preview++,t=n,i=new g(f),m=i.parse(t,s,o),b(),l?{meta:{paused:!0}}:m||{meta:{paused:!1}}},this.paused=function(){return l},this.pause=function(){l=!0,i.abort(),t=C(e.chunk)?"":t.substring(i.getCharIndex())},this.resume=function(){u.streamer._halted?(l=!1,u.streamer.parseChunk(t,!0)):setTimeout(u.resume,3)},this.aborted=function(){return c},this.abort=function(){c=!0,i.abort(),m.meta.aborted=!0,C(e.complete)&&e.complete(m),t=""}}function _(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(e){var t,i=(e=e||{}).delimiter,r=e.newline,n=e.comments,s=e.step,o=e.preview,h=e.fastMode,u=t=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(u=e.escapeChar),("string"!=typeof i||a.BAD_DELIMITERS.indexOf(i)>-1)&&(i=","),n===i)throw new Error("Comment character same as delimiter");!0===n?n="#":("string"!=typeof n||a.BAD_DELIMITERS.indexOf(n)>-1)&&(n=!1),"\n"!==r&&"\r"!==r&&"\r\n"!==r&&(r="\n");var f=0,d=!1;this.parse=function(e,a,l){if("string"!=typeof e)throw new Error("Input must be a string");var c=e.length,p=i.length,g=r.length,m=n.length,y=C(s);f=0;var v=[],k=[],b=[],E=0;if(!e)return z();if(h||!1!==h&&-1===e.indexOf(t)){for(var w=e.split(r),R=0;R<w.length;R++){if(b=w[R],f+=b.length,R!==w.length-1)f+=r.length;else if(l)return z();if(!n||b.substring(0,m)!==n){if(y){if(v=[],I(b.split(i)),M(),d)return z()}else I(b.split(i));if(o&&R>=o)return v=v.slice(0,o),z(!0)}}return z()}for(var S=e.indexOf(i,f),O=e.indexOf(r,f),x=new RegExp(_(u)+_(t),"g"),T=e.indexOf(t,f);;)if(e[f]!==t)if(n&&0===b.length&&e.substring(f,f+m)===n){if(-1===O)return z();f=O+g,O=e.indexOf(r,f),S=e.indexOf(i,f)}else if(-1!==S&&(S<O||-1===O))b.push(e.substring(f,S)),f=S+p,S=e.indexOf(i,f);else{if(-1===O)break;if(b.push(e.substring(f,O)),j(O+g),y&&(M(),d))return z();if(o&&v.length>=o)return z(!0)}else for(T=f,f++;;){if(-1===(T=e.indexOf(t,T+1)))return l||k.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:f}),F();if(T===c-1)return F(e.substring(f,T).replace(x,t));if(t!==u||e[T+1]!==u){if(t===u||0===T||e[T-1]!==u){-1!==S&&S<T+1&&(S=e.indexOf(i,T+1)),-1!==O&&O<T+1&&(O=e.indexOf(r,T+1));var A=L(-1===O?S:Math.min(S,O));if(e[T+1+A]===i){b.push(e.substring(f,T).replace(x,t)),f=T+1+A+p,e[T+1+A+p]!==t&&(T=e.indexOf(t,f)),S=e.indexOf(i,f),O=e.indexOf(r,f);break}var D=L(O);if(e.substring(T+1+D,T+1+D+g)===r){if(b.push(e.substring(f,T).replace(x,t)),j(T+1+D+g),S=e.indexOf(i,f),T=e.indexOf(t,f),y&&(M(),d))return z();if(o&&v.length>=o)return z(!0);break}k.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:f}),T++}}else T++}return F();function I(e){v.push(e),E=f}function L(t){var i=0;if(-1!==t){var r=e.substring(T+1,t);r&&""===r.trim()&&(i=r.length)}return i}function F(t){return l||(void 0===t&&(t=e.substring(f)),b.push(t),f=c,I(b),y&&M()),z()}function j(t){f=t,I(b),b=[],O=e.indexOf(r,f)}function z(e){return{data:v,errors:k,meta:{delimiter:i,linebreak:r,aborted:d,truncated:!!e,cursor:E+(a||0)}}}function M(){s(z()),v=[],k=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return f}}function m(e){var t=e.data,i=n[t.workerId],r=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var s={abort:function(){r=!0,y(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:v,resume:v};if(C(i.userStep)){for(var a=0;a<t.results.data.length&&(i.userStep({data:t.results.data[a],errors:t.results.errors,meta:t.results.meta},s),!r);a++);delete t.results}else C(i.userChunk)&&(i.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!r&&y(t.workerId,t.results)}function y(e,t){var i=n[e];C(i.userComplete)&&i.userComplete(t),i.terminate(),delete n[e]}function v(){throw new Error("Not implemented.")}function k(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var i in e)t[i]=k(e[i]);return t}function b(e,t){return function(){e.apply(t,arguments)}}function C(e){return"function"==typeof e}return r&&(t.onmessage=function(e){var i=e.data;void 0===a.WORKER_ID&&i&&(a.WORKER_ID=i.workerId);if("string"==typeof i.input)t.postMessage({workerId:a.WORKER_ID,results:a.parse(i.input,i.config),finished:!0});else if(t.File&&i.input instanceof File||i.input instanceof Object){var r=a.parse(i.input,i.config);r&&t.postMessage({workerId:a.WORKER_ID,results:r,finished:!0})}}),u.prototype=Object.create(h.prototype),u.prototype.constructor=u,f.prototype=Object.create(h.prototype),f.prototype.constructor=f,d.prototype=Object.create(d.prototype),d.prototype.constructor=d,l.prototype=Object.create(h.prototype),l.prototype.constructor=l,"undefined"==typeof PAPA_BROWSER_CONTEXT&&(c.prototype=Object.create(h.prototype),c.prototype.constructor=c),a}));
function truncateLongArray(e,r){for(var t in e)if("object"==typeof e[t]){var n=e[t];_.isNull(n)||_.isUndefined(n)||n.length>r&&(n.length=r,n[n.length-1]="... [preview truncated due to data big size]"),truncateLongArray(n,r)}}function syntaxHighlight(e){if(!_.isUndefined(e)){var r=JSON.parse(e);truncateLongArray(r,20);var t=!1;return(e=JSON.stringify(r,null,2)).length>1e5&&(e=e.substring(0,1e5),t=!0),e=(e=(e=(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,(function(e){var r="number";return/^"/.test(e)?r=/:$/.test(e)?"key":"string":/true|false/.test(e)?r="boolean":/null/.test(e)&&(r="null"),'<span class="'+r+' vignette">'+e+"</span>"}))).replace(/    /g,"&nbsp;&nbsp;&nbsp;&nbsp;")).replace(/\n/g,"<br/>"),t&&(e+="<b>... [preview truncated due to data big size]</b><br/>"),e}}function base64ArrayBuffer(e){for(var r,t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=new Uint8Array(e),o=a.byteLength,i=o%3,u=o-i,f=0;f<u;f+=3)t+=n[(16515072&(r=a[f]<<16|a[f+1]<<8|a[f+2]))>>18]+n[(258048&r)>>12]+n[(4032&r)>>6]+n[63&r];return 1==i?t+=n[(252&(r=a[u]))>>2]+n[(3&r)<<4]+"==":2==i&&(t+=n[(64512&(r=a[u]<<8|a[u+1]))>>10]+n[(1008&r)>>4]+n[(15&r)<<2]+"="),t}function String2Uint8Array(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t++)r.set([e.charCodeAt(t)],t);return r}function String2Int8Array(e){for(var r=new Int8Array(e.length),t=0;t<e.length;t++)r.set([e.charCodeAt(t)],t);return r}function Path2FileName(e){if(_.isUndefined(e))return"";if(_.isEmpty(e))return"";var r=e.lastIndexOf("\\");return r<e.length?e.substring(r+1,e.length):e}function getRealMimeType(e){for(var r,t=new Uint8Array(e).subarray(0,4),n="",a=0;a<t.length;a++)n+=t[a].toString(16);switch(n){case"89504e47":r="image/png";break;case"47494638":r="image/gif";break;case"ffd8ffDB":case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":r="image/jpeg";break;default:r="unknown"}return r}function rmUnit(e){return Number(e.substring(0,e.length-2))}function findGetParameter(e){for(var r=null,t=[],n=location.search.substr(1).split("&"),a=0;a<n.length;a++)(t=n[a].split("="))[0]===e&&(r=decodeURIComponent(t[1]));return r}function nFormatter(e,r){var t,n=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(t=n.length-1;t>0&&!(e>=n[t].value);t--);return(e/n[t].value).toFixed(r).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+n[t].symbol}function isSuperset(e,r){for(var t of r)if(!e.has(t))return!1;return!0}function union(e,r){var t=new Set(e);for(var n of r)t.add(n);return t}function intersection(e,r){var t=new Set;for(var n of r)e.has(n)&&t.add(n);return t}function difference(e,r){var t=new Set(e);for(var n of r)t.delete(n);return t}function detectBrowser(){var e=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;if(e)return"Opera";if("undefined"!=typeof InstallTrigger)return"Firefox";if(/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||"undefined"!=typeof safari&&safari.pushNotification).toString())return"Safari";var r=!!document.documentMode;if(r)return"IE";if(!r&&!!window.StyleMedia)return"Edge";var t=!(!window.chrome||!window.chrome.webstore&&!window.chrome.runtime);if(t)return"Chrome";(t||e)&&window.CSS}function checkES6(){"use strict";try{eval("var foo = (x)=>x+1")}catch(e){return!1}return!0}function checkES7(){"use strict";try{eval("2**3")}catch(e){return!1}return!0}function checkES8(){"use strict";try{eval("async function f() { var a = await Promise.resolve(42); return a; } f();")}catch(e){return!1}return!0}function checkES9(){"use strict";try{eval("var a = {a:1}, b = {b:2}, c = { ...a, ...b }; var { ...d } = c;")}catch(e){return!1}return!0}function checkES10(){"use strict";try{eval("try { throw '' } catch { return true; }")}catch(e){return!1}return!0}function ab2str(e){return String.fromCharCode.apply(null,new Uint16Array(e))}function str2ab(e){for(var r=new ArrayBuffer(2*e.length),t=new Uint16Array(r),n=0,a=e.length;n<a;n++)t[n]=e.charCodeAt(n);return r}$.ajaxTransport("+binary",(function(e,r,t){if(window.FormData&&(e.dataType&&"binary"==e.dataType||e.data&&(window.ArrayBuffer&&e.data instanceof ArrayBuffer||window.Blob&&e.data instanceof Blob)))return{send:function(r,t){var n=new XMLHttpRequest,a=e.url,o=e.type,i=e.async||!0,u=e.responseType||"blob",f=e.data||null,s=e.username||null,c=e.password||null;for(var l in n.addEventListener("load",(function(){var r={};r[e.dataType]=n.response,t(n.status,n.statusText,r,n.getAllResponseHeaders())})),n.open(o,a,i,s,c),r)n.setRequestHeader(l,r[l]);n.responseType=u,n.send(f)},abort:function(){}}})),function(){function e(r,t,n){return void 0===n||0==+n?Math[r](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!=0?NaN:t<0?-e(r,-t,n):(t=t.toString().split("e"),+((t=(t=Math[r](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}Math.round10||(Math.round10=function(r,t){return e("round",r,t)}),Math.floor10||(Math.floor10=function(r,t){return e("floor",r,t)}),Math.ceil10||(Math.ceil10=function(r,t){return e("ceil",r,t)})}();
!function(){var n=!1;datanodesManager.loadDatanodePlugin({type_name:"JSON_var_plugin",display_name:"Variable",icon_type:"json-variable.svg",description:"JavaScript workspace variable",external_scripts:[""],settings:[{name:"json_var",display_name:"Variable",type:"json",description:"JSON, array or primitive data type variable (with read/write permissions)"}],newInstance:function(r,t,a,i){return t(new e(r,a,i)),!n}});var e=function(e,r,t){n=!1;var a=this,i={},s=e,o=e,u="None";a.onSettingsChanged=function(n){return s=n,a.isJsonParsingSuccess()},a.isJsonParsingSuccess=function(){t("Pending");try{return i=JSON.parse(s.json_var),!0}catch(n){return swal("JSON Parse error",n.message,"error"),t("Error","Error in JSON parse"),!1}},a.isSettingNameChanged=function(n){return s.name!=n},a.getSavedSettings=function(){return[u,o]},a.updateNow=function(){return t("OK"),u="OK",o=s,s.json_var=JSON.stringify(i),r(i),!0},a.onDispose=function(){},this.isSetValueValid=function(){return!0},a.isSetFileValid=function(){return!0},a.isInternetNeeded=function(){return!1},a.setFile=function(n){return"application/json"===n.type?n.isBinary?s.json_var=atob(n.content):s.json_var=n.content:s.json_var=JSON.stringify(n),a.isJsonParsingSuccess()},a.setValue=function(n,e){if(0!=n.length)if(1==n.length)i[n[0]]=e;else{for(var r,t=0;t<n.length-1;t++)r=0==t?i[n[t]]:r[n[t]];r[n[n.length-1]]=e}else i=e},a.getValue=function(n){if(0==n.length)return i;if(1==n.length)return i[n[0]];for(var e,r=0;r<n.length-1;r++)e=0==r?i[n[r]]:e[n[r]];return e[n[n.length-1]]};try{i=JSON.parse(s.json_var),n=!1}catch(e){swal("JSON Parse error",e.message,"error"),n=!0}}}();
!function(){var e=!1;datanodesManager.loadDatanodePlugin({type_name:"JSON_delay_plugin",display_name:"Delay",icon_type:"delay.svg",description:"JavaScript one-step delay operator",external_scripts:[""],settings:[{name:"json_init",display_name:"init value",type:"json",description:"Initial value (JSON, array or primitive data type)"},{name:"json_input",display_name:"Input signal",type:"calculated",description1:"Write JavaScript formula to define JSON, array or primitive data type input to be delayed.",description2:"Browse and select a dataNode from workspace to use it in the formula."}],newInstance:function(n,r,a,i){return r(new t(n,a,i)),!e}});var t=function(t,n,r){e=!1;var a={},i={},o={},s=!0,u=t;this.onSettingsChanged=function(e){u=e;try{a=JSON.parse(u.json_init),u}catch(e){return swal("JSON Parse error",e.message,"error"),r("Error"),!1}return!0},this.isSettingNameChanged=function(e){return u.name!=e},this.updateNow=function(){if(r("Pending"),s)try{s=!1,a=JSON.parse(u.json_init)}catch(e){return swal("JSON Parse error",e.message,"error"),r("Error"),n(void 0,"Error"),!1}return i=a,a="object"==typeof o?jQuery.extend(!0,{},o):o,r("OK"),n(i),"OK",u,!0},this.onDispose=function(){},this.isSetValueValid=function(){return!1},this.isSetFileValid=function(){return!1},this.isInternetNeeded=function(){return!1},this.onCalculatedValueChanged=function(e,t){o=t}}}();
!function(){var e=!1;datanodesManager.loadDatanodePlugin({type_name:"Memory_plugin",display_name:"Memory",icon_type:"memory.png",description:"Memory operator (past value)",external_scripts:[""],settings:[{name:"value_init",display_name:"initial value",type:"json",short_display:!0,default_value:0,description:"Initial value (number, boolean, JSON or array)"},{name:"datanode_origin",display_name:"DataNode origin",type:"option",from_datanode:!0,options:[],description:"Select the datanode origin for your past value"}],newInstance:function(n,a,r,i){return a(new t(n,r,i)),!e}});var t=function(t,n,a){e=!1;var r={},i=!0,o=t;this.onSettingsChanged=function(e){o=e;try{r=JSON.parse(o.value_init),o}catch(e){return swal("JSON Parse error",e.message,"error"),a("Error"),!1}return!0},this.isSettingNameChanged=function(e){return o.name!=e},this.updateNow=function(){if(a("Pending"),i)try{return i=!1,r=JSON.parse(o.value_init),a("OK"),n(r),"OK",o,!0}catch(e){return swal("JSON Parse error",e.message,"error"),a("Error"),n(void 0,"Error"),!1}r;let e=o.datanode_origin;if(!datanodesManager.foundDatanode(e)){const t="DataNode '"+e+"' does not exist in dataNodes list";return datanodeModel.statusCallback("Error",t),datanodeModel.notificationCallback("error",datanodeModel.name(),t),!1}let t=datanodesManager.getDataNodeByName(e).latestData();return r="object"==typeof t?jQuery.extend(!0,{},t):t,a("OK"),n(r),"OK",o,!0},this.onDispose=function(){},this.isSetValueValid=function(){return!0},this.isSetFileValid=function(){return!1},this.isInternetNeeded=function(){return!1},this.isSpecificExecution=function(){return!0},this.setValue=function(e,t){if(i=!0,0==e.length)return r=t,void(o.value_init=JSON.stringify(r));if(1==e.length)r[e[0]]=t;else{for(var n,a=0;a<e.length-1;a++)n=0==a?r[e[a]]:n[e[a]];n[e[e.length-1]]=t}o.value_init=JSON.stringify(r)}}}();
!function(){var t=!1;datanodesManager.loadDatanodePlugin({type_name:"JSON_formula_plugin",display_name:"Script (client-side)",icon_type:"json-formula.svg",description:"JavaScript Script (client-side) plugin",external_scripts:[""],settings:[{name:"autoStart",display_name:"AUTO START",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0},{name:"explicitTrig",display_name:"Explicit trigger",description:"DataNode is executed only if triggered explicitly (no execution when its predecessors are updated). It is executed automatically once when AutoStart is “YES”.",type:"boolean",default_value:!1},{name:"json_var_formula",display_name:"Javascript formula",type:"calculated",description1:"Write Javascript formula that returns a JSON, array or primitive data type ouptput",description2:"Browse and select a dataNode from workspace to use it in the formula."}],newInstance:function(i,n,a,r,o){if(!n(new e(i,a,r,o)))return!t}});var e=function(e,i,n,a){t=!1;var r={},o=e,s=e,u="None";this.onSettingsChanged=function(t){return o=t,!0},this.isSettingNameChanged=function(t){return o.name!=t},this.getSavedSettings=function(){return[u,s]},this.updateNow=function(){return n("Pending"),_.isNull(r)||_.isUndefined(r)?(t=!0,text="Formula is null or undefined",n("Error",text),i(r,"Error"),!1):_.isObject(r)&&_.isEmpty(r)&&_.isEmpty(o.json_var_formula)?(t=!0,text="Formula is empty",a("warning",o.name,text,"Formula error"),n("Error",text),i(r,"Error"),!1):(t=!1,u="OK",s=o,n("OK"),i(r),!0)},this.onDispose=function(){},this.isSetValueValid=function(){return!1},this.isSetFileValid=function(){return!1},this.isInternetNeeded=function(){return!1},this.onCalculatedValueChanged=function(t,e){r=e}}}();
!function(){var e=!1;datanodesManager.loadDatanodePlugin({type_name:"Generic_file_reader_plugin",display_name:"Generic text file reader",icon_type:"text-file-reader.svg",description:"Read text files",external_scripts:[""],settings:[{name:"data_path",display_name:"Data file",description:"Browse to select file.",type:"browseText",required:!0}],newInstance:function(t,i,r,a){return i(new n(t,r,a)),!e}});var n=function(n,t,i){e=!1;var r,a=this,o=n,u=n,s="None";a.onSettingsChanged=function(e,n){return"OK"===n&&(s=n,u=o),o=e,a.isFileReadingSuccess()},a.isFileReadingSuccess=function(){return i("Pending"),null==(r=a.readFileContent())?(i("Error","Error in file struct"),!1):(u=o,!0)},a.isSettingNameChanged=function(e){return o.name!=e},a.getSavedSettings=function(){return[s,u]},a.updateNow=function(){return s="OK",i("OK"),t(r),!0},a.onDispose=function(){},a.isSetValueValid=function(){return!1},a.isSetFileValid=function(){return!0},a.isInternetNeeded=function(){return!1},a.readFileContent=function(){return _.isUndefined(o.content)?null:{content:o.content}},a.setFile=function(e){return o.content=e.content,o.data_path=e.name,a.isFileReadingSuccess()},r=a.readFileContent(),e=null==r}}();
!function(){var e=!1;datanodesManager.loadDatanodePlugin({type_name:"Generic_binary_file_reader",display_name:"Generic binary file reader",icon_type:"file-reader.svg",description:"Read binary files",external_scripts:[""],settings:[{name:"data_path",display_name:"Data file",description:"Browse to select file.",type:"browseBinary",required:!0}],newInstance:function(t,i,r,a){return i(new n(t,r,a)),!e}});var n=function(n,t,i){e=!1;var r,a=this,o=n,s=n,u="None";a.onSettingsChanged=function(e,n){return"OK"===n&&(u=n,s=o),o=e,a.isFileReadingSuccess()},a.isFileReadingSuccess=function(){return i("Pending"),null==(r=a.readFileContent())?(i("Error","Error in file struct"),!1):(s=o,!0)},a.isSettingNameChanged=function(e){return o.name!=e},a.getSavedSettings=function(){return[u,s]},a.updateNow=function(){return u="OK",i("OK"),t(r),!0},a.onDispose=function(){},a.isSetValueValid=function(){return!1},a.isSetFileValid=function(){return!0},a.isInternetNeeded=function(){return!1},a.readFileContent=function(){return _.isUndefined(o.content)?null:{content:o.content}},a.setFile=function(e){return o.content=e,o.data_path=e.name,a.isFileReadingSuccess()},r=a.readFileContent(),e=null==r}}();
!function(){var e=!1;datanodesManager.loadDatanodePlugin({type_name:"CSV_file_reader_plugin",display_name:"CSV file reader",icon_type:"csv-reader.svg",description:"Read CSV files",external_scripts:[],settings:[{name:"data_path",display_name:"Data file",description:"Browse to select CSV data file.",type:"browseText",required:!0},{name:"delimiter",display_name:"Delimiter",description:"The delimiting character. Leave auto to auto-detect.",type:"option",options:[{name:"auto",value:""},{name:"comma",value:","},{name:"semi-colon",value:";"},{name:"colon",value:":"},{name:"tabulation",value:"\t"},{name:"space",value:" "}]},{name:"eol",display_name:"Line endings",description:"The newline sequence. Leave auto to auto-detect.",type:"option",options:[{name:"auto",value:""},{name:"\\n",value:"\n"},{name:"\\r",value:"\r"},{name:"\\r\\n",value:"\r\n"}]},{name:"quote_char",display_name:"Quote Char",description:"The character used to quote fields. The quoting of all fields is not mandatory. Any field which is not quoted will correctly read.",type:"option",options:[{name:'"',value:'"'},{name:"'",value:"'"},{name:"empty",value:""}]},{name:"head",display_name:"Header line",description:"If true, the first row after metaData of parsed data will be interpreted as field names.",type:"boolean",default_value:!0},{name:"nb_meta_lines",display_name:"Number of metaData lines",type:"number",default_value:0,description:"If 0 no metaData exist before the header line. Otherwise metaData will be placed inside 'meta' object."},{name:"nb_subheader_lines",display_name:"Number of subheader lines",type:"number",default_value:0,description:"If 0 no subheader exist after the header line. Otherwise subheader will be placed inside 'subheader' object."},{name:"skip_empty_lines",display_name:"Skip empty lines",type:"boolean",default_value:!0},{name:"dynamic_typing",display_name:"Dynamic typing",description:"If true, numeric and boolean data will be converted to their type instead of remaining strings.",type:"boolean",default_value:!0},{name:"pluck",display_name:"Row to array",description:"If true, each row will be placed in an array.",type:"boolean",default_value:!0},{name:"embedding_object",display_name:"Embedd in content object",description:"If true, parsed file will be placed inside a top level 'content' object. It's true when metaData exist.",type:"boolean",default_value:!1}],newInstance:function(a,t,i,r){return t(new n(a,i,r)),!e}});var n=function(n,a,t){e=!1;var i,r=this,s=n,l=n,o="None";r.onSettingsChanged=function(e,n){return"OK"===n&&(o=n,l=s),s=e,r.isFileParsingSuccess()},r.isFileParsingSuccess=function(){return t("Pending"),null==(i=r.parseFileContent())?(t("Error","Error in file parse"),!1):(l=s,!0)},r.isSettingNameChanged=function(e){return s.name!=e},r.getSavedSettings=function(){return[o,l]},r.updateNow=function(){return o="OK",t("OK"),a(i),!0},r.onDispose=function(){},r.isSetValueValid=function(){return!1},r.isSetFileValid=function(){return!0},r.isInternetNeeded=function(){return!1},r.parseFileContent=function(){papaSettings={delimiter:s.delimiter,newline:s.eol,quoteChar:s.quote_char,header:s.head,dynamicTyping:s.dynamic_typing,skipEmptyLines:s.skip_empty_lines};var e={},n={},a=s.content;if(_.isUndefined(a))return null;if(_.isUndefined(s.nb_meta_lines)&&(s.nb_meta_lines=0),_.isUndefined(s.nb_subheader_lines)&&(s.nb_subheader_lines=0),s.nb_meta_lines>0){let n=a.split("\n");var t=n.splice(0,s.nb_meta_lines);for(let n=0;n<t.length;n++)e["metaLine"+n]=t[n];a=n.join("\n")}if(s.nb_subheader_lines>0){let e=a.split("\n");var i=e.splice(1,s.nb_subheader_lines);for(let e=0;e<i.length;e++)n["subheaderLine"+e]=i[e],""!==s.delimiter&&(n["subheaderLine"+e]=n["subheaderLine"+e].split(s.delimiter));a=e.join("\n")}if(r.parserResults=Papa.parse(a,papaSettings),0==r.parserResults.errors.length){var l=r.parserResults.data,o={};if(s.pluck)for(let e=0;e<r.parserResults.meta.fields.length;e++)colName=r.parserResults.meta.fields[e],o[colName]=_.pluck(l,colName);else o=l;return(s.embedding_object||s.nb_meta_lines>0||s.nb_subheader_lines>0)&&(o={content:o},s.embedding_object=!0,s.nb_meta_lines>0&&(o.meta=e),s.nb_subheader_lines>0&&(o.subheader=n)),o}return _.isUndefined(r.parserResults.errors[0].row)?swal("Parser error : "+r.parserResults.errors[0].type,r.parserResults.errors[0].message+" in '"+s.data_path+"'.","error"):swal("Parser error : "+r.parserResults.errors[0].type,r.parserResults.errors[0].message+" in line '"+r.parserResults.errors[0].row+"' of "+s.data_path+"'.","error"),null},r.setFile=function(e){return s.data_path=e.name,e.isBinary?s.content=atob(e.content):s.content=e.content,r.isFileParsingSuccess()},i=r.parseFileContent(),e=null==i}}();
!function(){var e=!1;datanodesManager.loadDatanodePlugin({type_name:"CSV_file_player_plugin",display_name:"CSV file player",icon_type:"csv-player.svg",description:"Play csv files",external_scripts:[],settings:[{name:"data_path",display_name:"Data file",description:"Browse to select CSV data file.",type:"browseText",required:!0},{name:"delimiter",display_name:"Delimiter",description:"The delimiting character. Leave auto to auto-detect.",type:"option",options:[{name:"auto",value:""},{name:"comma",value:","},{name:"semi-colon",value:";"},{name:"colon",value:":"},{name:"tabulation",value:"\t"},{name:"space",value:" "}]},{name:"eol",display_name:"Line endings",description:"The newline sequence. Leave auto to auto-detect.",type:"option",options:[{name:"auto",value:""},{name:"\\n",value:"\n"},{name:"\\r",value:"\r"},{name:"\\r\\n",value:"\r\n"}]},{name:"quote_char",display_name:"Quote Char",description:"The character used to quote fields. The quoting of all fields is not mandatory. Any field which is not quoted will correctly read.",type:"option",options:[{name:'"',value:'"'},{name:"'",value:"'"},{name:"empty",value:""}]},{name:"head",display_name:"Header line",description:"If true, the first row after metaData of parsed data will be interpreted as field names.",type:"boolean",default_value:!0},{name:"nb_meta_lines",display_name:"Number of metaData lines",type:"number",default_value:0,description:"If 0 no metaData exist before the header line. Otherwise metaData will be placed inside 'meta' object."},{name:"nb_subheader_lines",display_name:"Number of subheader lines",type:"number",default_value:0,description:"If 0 no subheader exist after the header line. Otherwise subheader will be placed inside 'subheader' object."},{name:"skip_empty_lines",display_name:"Skip empty lines",type:"boolean",default_value:!0},{name:"dynamic_typing",display_name:"Dynamic typing",description:"If true, numeric and boolean data will be converted to their type instead of remaining strings.",type:"boolean",default_value:!0},{name:"sampleTime",display_name:"Sample time",type:"number",suffix:"seconds",default_value:1},{name:"time_included",display_name:"Time included",description:"If true, the first row will be considered as time vector.",type:"boolean",default_value:!1},{name:"playback",display_name:"Playback",description:"If true, data will be played back.",type:"boolean",default_value:!0}],newInstance:function(a,t,i,r){return t(new n(a,i,r)),!e}});var n=function(n,a,t){e=!1;var i,r=this,s=n,l=n,o="None",u={},d=0,p=0,m={},c=0;r.onSettingsChanged=function(e,n){return"OK"===n&&(o=n,l=s),s=e,r.isFileParsingSuccess()},r.isFileParsingSuccess=function(){return c=0,t("Pending"),null==(i=r.parseFileContent())?(t("Error","Error in file parse"),!1):(l=s,!0)},r.isSettingNameChanged=function(e){return s.name!=e},this.isSettingSampleTimeChanged=function(e){return s.sampleTime!=e},r.getSavedSettings=function(){return[o,l]},r.updateNow=function(){return function(){for(var e=0;e<d;e++)s.nb_meta_lines>0||s.nb_subheader_lines>0?m[u[e]]=i.content[u[e]][c]:m[u[e]]=i[u[e]][c];c<p-1?c++:s.playback&&(c=0),o="OK",t("OK");var n={};s.nb_meta_lines>0&&(n.content=m,n.meta=i.meta),s.nb_subheader_lines>0&&(n.content=m,n.subheader=i.subheader),s.nb_meta_lines>0||s.nb_subheader_lines>0?a(n):a(m)}(),!0},r.onDispose=function(){},r.isSetValueValid=function(){return!1},r.isSetFileValid=function(){return!0},r.isInternetNeeded=function(){return!1},r.parseFileContent=function(){papaSettings={delimiter:s.delimiter,newline:s.eol,quoteChar:s.quote_char,header:s.head,dynamicTyping:s.dynamic_typing,skipEmptyLines:s.skip_empty_lines};var e={},n={},a=s.content;if(_.isUndefined(a))return null;if(_.isUndefined(s.nb_meta_lines)&&(s.nb_meta_lines=0),_.isUndefined(s.nb_subheader_lines)&&(s.nb_subheader_lines=0),s.nb_meta_lines>0){let n=a.split("\n");var t=n.splice(0,s.nb_meta_lines);for(let n=0;n<t.length;n++)e["metaLine"+n]=t[n];a=n.join("\n")}if(s.nb_subheader_lines>0){let e=a.split("\n");var l=e.splice(1,s.nb_subheader_lines);for(let e=0;e<l.length;e++)n["subheaderLine"+e]=l[e],""!==s.delimiter&&(n["subheaderLine"+e]=n["subheaderLine"+e].split(s.delimiter));a=e.join("\n")}if(r.parserResults=Papa.parse(a,papaSettings),0==r.parserResults.errors.length){var o=r.parserResults.data;d=r.parserResults.meta.fields.length,i={},m={},d>0&&(p=o.length);for(let e=0;e<d;e++){var c=r.parserResults.meta.fields[e];i[c]=_.pluck(o,c),u[e]=c}return s.nb_meta_lines>0&&(i.content=i,i.meta=e),s.nb_subheader_lines>0&&(i.content=i,i.subheader=n),i}return _.isUndefined(r.parserResults.errors[0].row)?swal("Parser error : "+r.parserResults.errors[0].type,r.parserResults.errors[0].message+" in '"+s.data_path+"'.","error"):swal("Parser error : "+r.parserResults.errors[0].type,r.parserResults.errors[0].message+" in line '"+r.parserResults.errors[0].row+"' of "+s.data_path+"'.","error"),null},r.setFile=function(e){return s.content=e,s.data_path=e.name,r.isFileParsingSuccess()},i=r.parseFileContent(),e=null==i}}();
!function(){var n=!1;datanodesManager.loadDatanodePlugin({type_name:"Unzip_file_plugin",display_name:"Unzip file",icon_type:"file-reader.svg",description:"unzip files",external_scripts:[""],settings:[{name:"data_path",display_name:"Data file",description:"Browse to select zipped file.",type:"unzip",required:!0}],newInstance:function(t,i,r,a){return i(new e(t,r,a)),!n}});var e=function(e,t,i){n=!1;var r,a=this,u=e,o=e,s="None";a.onSettingsChanged=function(n,e){return"OK"===e&&(s=e,o=u),u=n,a.isFileReadingSuccess()},a.isFileReadingSuccess=function(){return i("Pending"),null==(r=a.readFileContent())?(i("Error","Error in file struct"),!1):(o=u,!0)},a.isSettingNameChanged=function(n){return u.name!=n},a.getSavedSettings=function(){return[s,o]},a.updateNow=function(){return s="OK",i("OK"),t(r),!0},a.onDispose=function(){},a.isSetValueValid=function(){return!1},a.isSetFileValid=function(){return!0},a.isInternetNeeded=function(){return!1},a.readFileContent=function(){return _.isUndefined(u.content)?null:u.content},a.setFile=function(n){return u.content=n.content,u.data_path=n.name,a.isFileReadingSuccess()},r=a.readFileContent(),n=null==r}}();
!function(){var e=function(e,n,t,r,a){var o,i="",s=e,c=!0,l=new Array,E=!0,d="",y=!1,u=!0,A={debug:!0,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:4,binaryType:"arraybuffer"},f=function(){console.info("Connected to server ",i),r("success",s.name,"Connected to server "+i),y=!0,u=!0,_.isUndefined(s.init_value)||(c=!0),a("Ready")},p=function(){console.info("WebSocket Connection is closed..."),r("info",s.name,"WebSocket Connection is closed..."),y&&a("Stop"),y=!1},S=function(e){console.debug("WebSocket  (%s) OnError ",i,e),u&&(r("error",s.name,"WebSocket  ("+i+") error"),u=!1),a("NotReady"),y=!1},T=function(e){d=e.data,E?(E=!1,console.info("WebSocket received ",e.data),l="string"==typeof e.data||e.data instanceof String?e.data:g(e.data,s.decoding_options),t("OK"),n(l),console.info("Data processed ",l)):a("Ready")};function R(){o&&o.close(),console.log(s),i="ws://"+s.host+":"+s.port,(o=new ReconnectingWebSocket(i,[],A)).onopen=f,o.onerror=S,o.onmessage=T,o.onclose=p}function m(e,n=!0){_.isUndefined(o)||1!==o.readyState||(1==n?o.send(JSON.stringify(e)):o.send(e))}function g(e,n){if("JSON"===n.toUpperCase()){try{e=JSON.parse(e)}catch(e){console.log(e)}return e}var t,r,a,o=e.byteLength,i=new DataView(e),s=0,c=0;switch(n.toUpperCase()){case"ARRAYBUFFER2STRING":r=String.fromCharCode.apply(null,new Uint8Array(e));break;case"INT8ARRAY":for(a=Int8Array.BYTES_PER_ELEMENT,t=o/Int8Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getInt8(c);break;case"UINT8ARRAY":for(a=Uint8Array.BYTES_PER_ELEMENT,t=o/Uint8Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getUint8(c);break;case"INT16ARRAY":for(a=Int16Array.BYTES_PER_ELEMENT,t=o/Int16Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getInt16(c,!0);break;case"UINT16ARRAY":for(a=Uint16Array.BYTES_PER_ELEMENT,t=o/Uint16Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getUint16(c,!0);break;case"INT32ARRAY":for(a=Int32Array.BYTES_PER_ELEMENT,t=o/Int32Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getInt32(c,!0);break;case"UINT32ARRAY":for(a=Uint32Array.BYTES_PER_ELEMENT,t=o/Uint32Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getUint32(c,!0);break;case"FLOAT32ARRAY":for(a=Float32Array.BYTES_PER_ELEMENT,t=o/Float32Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getFloat32(c,!0);break;case"FLOAT64ARRAY":for(a=Float64Array.BYTES_PER_ELEMENT,t=o/Float64Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getFloat64(c,!0);break;default:for(a=Uint8Array.BYTES_PER_ELEMENT,t=o/Uint8Array.BYTES_PER_ELEMENT,t=Math.floor(t),r=new Array(t),s=0,c=0;s<t;s++,c+=a)r[s]=i.getUint8(c)}return r}this.onSettingsChanged=function(e,n){return"OK"===n&&(n,s),s.host!=e.host||s.port!=e.port||!y||!_.isUndefined(e.init_value)&&s.init_value!=e.init_value?(s=e,E=!0,a("Wait"),R()):s=e,s,!0},this.isSettingNameChanged=function(e){return s.name!=e},this.updateNow=function(){var e;if(E){if(1===o.readyState&&(t("Pending"),!_.isUndefined(s.init_value)&&c&&(c=!1,"none"!=s.init_value)))if(function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(s.init_value)){try{e=jQuery.extend(!0,{},JSON.parse(s.init_value))}catch(e){return r("error",s.name,"JSON Parse error"+e.message),t("Error","JSON Parse error"),n(void 0,"Error"),!1}m(e,!0)}else m(e=s.init_value,!1)}else t("Pending"),console.info("WebSocket received ",d),l="string"==typeof d||d instanceof String?d:g(d,s.decoding_options),t("OK"),n(l),console.info("Data processed ",l);return!0},this.onDispose=function(){o&&o.close()},this.onstop=function(){o&&o.close()},this.isSetValueValid=function(){return!1},this.isSetFileValid=function(){return!1},a("Wait"),E=!0,R()};datanodesManager.loadDatanodePlugin({type_name:"WS-receive-plugin",display_name:"WebSocket Receive",icon_type:"websocket.svg",description:"Websocket client to receive data in Chalk'it",external_scripts:[""],settings:[{name:"host",display_name:"Remote IP address",type:"text",description:"IP address or hostname of your remote WebSocket sender.",required:!0},{name:"port",display_name:"Remote IP port",type:"number",description:"The port to connect to your remote WebSocket sender.",required:!0},{name:"autoStart",display_name:"AUTO START",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0},{name:"init_value",display_name:"initializing token",type:"option",description:"This token is sent before the exchange begin. Normally only used if send to xMOD",options:[{name:"None",value:"none"},{name:"xMOD",value:"ws_init"}]},{name:"decoding_options",display_name:"Decoding options",description:"Decoding options applied on Response data.",type:"option",options:[{name:"JSON",value:"JSON"},{name:"Int8Array",value:"Int8Array"},{name:"Uint8Array",value:"Uint8Array"},{name:"Int16Array",value:"Int16Array"},{name:"Uint16Array",value:"Uint16Array"},{name:"Int32Array",value:"Int32Array"},{name:"Uint32Array",value:"Uint32Array"},{name:"Float32Array",value:"Float32Array"},{name:"Float64Array",value:"Float64Array"},{name:"Text",value:"Text"},{name:"ArrayBuffer2String",value:"ArrayBuffer2String"}]}],newInstance:function(n,t,r,a,o,i){return t(new e(n,r,a,o,i)),!0}})}();
!function(){var e=function(e,t,i,o,r){var a,s="",c=e,d=!0,l={},u=!1,p=!0,m={debug:!0,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3,maxReconnectAttempts:4,binaryType:"arraybuffer"},f=function(){console.info("Connected to server ",s),o("success",c.name,"Connected to server "+s),p=!0,u=!0,_.isUndefined(c.init_value)||(d=!0),r("Ready")},y=function(){console.info("WebSocket Connection is closed..."),o("info",c.name,"WebSocket Connection is closed..."),u&&r("Stop"),u=!1},g=function(e){console.debug("WebSocket  (%s) OnError ",s,e),p&&(o("error",c.name,"WebSocket  ("+s+") error"),p=!1),r("NotReady")},h=function(e){};function S(){a&&a.close(),console.log(c),s="ws://"+c.host+":"+c.port,(a=new ReconnectingWebSocket(s,[],m)).onopen=f,a.onerror=g,a.onmessage=h,a.onclose=y}function v(e,n=!0){_.isUndefined(a)||1!==a.readyState||a.send(e)}this.onSettingsChanged=function(e,n){return"OK"===n&&(n,c),c.host!=e.host||c.port!=e.port||!u||!_.isUndefined(e.init_value)&&c.init_value!=e.init_value?(c=e,r("Wait"),S()):c=e,c,!0},this.isSettingNameChanged=function(e){return c.name!=e},this.isSettingSampleTimeChanged=function(e){return c.sampleTime!=e},this.updateNow=function(e){var r;if(e&&c.sampleTime>0&&c.explicitTrig&&(o("warning",c.name,'Explicit Trigger option is turned off (False) because "'+c.name+'" is periodic and was triggered explicitly'),c.explicitTrig=!1),1===a.readyState){if(i("Pending"),!_.isUndefined(c.init_value)&&d&&(d=!1,"none"!=c.init_value))if(function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(c.init_value)){try{r=jQuery.extend(!0,{},JSON.parse(c.init_value))}catch(e){return o("error",c.name,"Data Parse error"+e.message),i("Error","Data Parse error"),t(void 0,"Error"),!1}v(r,!0)}else v(r=c.init_value,!1);if(_.isNull(l)||_.isUndefined(l))return i("Error","script is null or undefined"),o("error",c.name,"script is null or undefined."),!1;if(_.isObject(l)&&_.isEmpty(l)&&_.isEmpty(c.json_input))return i("Error","JS script error"),n=!0,o("error",c.name,"JS script error: script cannot be empty."),!1;v(l),i("OK"),t(l)}return!0},this.onDispose=function(){a&&a.close()},this.onstop=function(){a&&a.close()},this.isSetValueValid=function(){return!1},this.isSetFileValid=function(){return!1},this.isInternetNeeded=function(){return!0},this.onCalculatedValueChanged=function(e,n){l=JSON.stringify(n)},r("Wait"),S()},n=!1;datanodesManager.loadDatanodePlugin({type_name:"WS-send-plugin",display_name:"WebSocket Send",icon_type:"websocket.svg",description:"Websocket client to send data to Chalk'it",external_scripts:[""],settings:[{name:"host",display_name:"Remote IP address",type:"text",description:"IP address or hostname of your remote WebSocket receiver.",required:!0},{name:"port",display_name:"Remote IP port",type:"number",description:"The port to connect to your remote WebSocket receiver.",required:!0},{name:"sampleTime",display_name:"Sample time",type:"number",default_value:0,suffix:"seconds",description:"Refresh rate for sending data. Data will be sent even if control values are not changed"},{name:"autoStart",display_name:"AUTO START",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0},{name:"explicitTrig",display_name:"Explicit trigger",description:"DataNode is executed only if triggered explicitly (no execution when its predecessors are updated). It is executed automatically once when AutoStart is “YES”.",type:"boolean",default_value:!1},{name:"init_value",display_name:"initializing token",type:"option",description:"This token is sent before the exchange begin. Normally only used if exchange with xMOD",options:[{name:"None",value:"none"},{name:"xMOD",value:"ws_init"}]},{name:"json_input",display_name:"JSON/Javascript input",type:"calculated",description1:"Can be literal JSON. Input to be sent.",description2:"Browse and select a dataNode from workspace to send it by web socket."}],newInstance:function(t,i,o,r,a,s){return i(new e(t,o,r,a,s)),!n}})}();
"true"!=xDashConfig.xDashBasicVersion&&function(){var o=function(o,t,n,i,a){error=!1;this.errorState=!1;var r,s,c,l=o,u=o,d="None",g={lat:0,lng:0};function p(o){g={lat:o.coords.latitude,lng:o.coords.longitude},console.log(g),a("Ready")}function h(o){var e;1==o.code?(console.log("Error: Access is denied !"),e="Error: Access is denied !",i("error",l.name,e),a("NotReady")):2==o.code?(console.log("Error: Position is unavailable !"),e="Error: Position is unavailable !",i("error",l.name,e),a("NotReady")):3==o.code&&(console.log("Error: Timeout expired !"),e="Error: Timeout expired !",i("error",l.name,e),a("NotReady"))}this.onSettingsChanged=function(o,e){return"OK"===e&&(d=e,u=l),l=o,!0},this.isSettingNameChanged=function(o){return l.name!=o},this.getSavedSettings=function(){return[d,u]},this.updateNow=function(){n("Pending"),"watchPosition"==c&&(n("OK"),t(g))},this.onDispose=function(){"watchPosition"==c&&s.clearWatch(r)},this.isSetValueValid=function(){return!1},function(){if(s=navigator.geolocation){a("Wait");r=s.watchPosition(p,h,{maximumAge:0,timeout:5e3,enableHighAccuracy:!0}),c="watchPosition"}else console.log("Sorry, browser does not support geolocation"),swal("Browser support","Sorry, browser does not support geolocation","error"),e=!0}()},e=!1;datanodesManager.loadDatanodePlugin({type_name:"Geolocation-plugin",display_name:"Geolocation",icon_type:"geolocation.svg",description:"A geolocation plugin",external_scripts:[""],settings:[{name:"autoStart",display_name:"Auto start",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0}],newInstance:function(t,n,i,a,r,s){return n(new o(t,i,a,r,s)),!e}})}();
!function(){var e=!1;function t(e,t,n,a){var o=t.settings.name;e||(e='#example: create 2 datanodes py_a a,d py_b then use them as follow:\n# Example: add the values of 2 datanodes.\n# return dataNodes["py_a"] + dataNodes["py_b"];\n');var i=$('<div id="code-window-js" class="code-window cancel__box cancel__box--xl"></div>'),r=$('<div class="code-mirror-wrapper" id="codeWrapper"></div>'),d=$('<div class="cancel__box__bottom"></div>'),s=$('<div class="cancel__box__body"></div>'),l=$('<div class="cancel__box__top"><div class="code-window-header cm-s-ambiance">This Python script will be re-evaluated according to Chalk\'it execution engine rules, if one of the referenced input <code><span class="cm-def">dataNodes</span></code> is updated. The value you <code><span class="cm-keyword">return</span></code> will update the Chalk\'it workspace. You can assume this script is wrapped in a function with a <code><span class="cm-def">dataNodes</span></code> parameter containing the defined input dataNodes. <br>Press <code><span class="cm-keyword">ctrl-space</span></code> to activate autocompletion.</div>'),c=$('<div class="cancel__box__container"></div>');s.append([r]),c.append([l,s,d]),i.append([c]);var p=$('<div id="codeWindowContainer" class="cancel__container open"></div>');function u(e,t){t.pick(),e.execCommand("autocomplete")}p.append($('<div class="cancel__overlay"></div>')),p.append(i),$("body").append(p);var g=datanodesManager.getAllDataNodes().sort((e,t)=>e.name().localeCompare(t.name())),m=CodeMirror(r.get(0),{value:e,mode:{name:"python",globalVars:!0},theme:"eclipse",version:3,indentUnit:2,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,lineWrapping:!1,showCursorWhenSelecting:!0,extraKeys:{"Ctrl-Space":"autocomplete","Alt-C":e=>e.toggleComment()},hintOptions:{hint:JSEditorCompletion.createCompletionFct(g),completeSingle:!1,extraKeys:{Tab:u,Right:u,Left:function(e,t){const n=e.getCursor(),a=n.line,o=e.getLine(a),i=n.ch,r=JSEditorCompletion.getPrecedingPathLength(o,i);r&&(e.replaceRange("",CodeMirror.Pos(a,i-r),CodeMirror.Pos(a,i)),t.close(),e.execCommand("autocomplete"))}}}});if([bFoundConnection,prop]=datanodesManager.isConnectedWithWidgt(o),bFoundConnection){var h='<div style="display: table-cell; padding: 10px"><span>Connected widget(s): </span></div>';_.each(prop,e=>{h=h+'<div style="display: table-cell; padding: 10px"><input type="radio" id="'+e+'_radio" name="dataWidgetRadio" value="'+e+'" onchange="datanodesManager.previewWidget(this.value)"><label for="'+e+'_radio">'+e+"</label></div>"});var w=$('<button id="dialog-widget" class="btn btn-rounded-fill primary" js-reset-toggle="">Show widget</button>').click((function(){if("Show widget"==$("#dialog-widget").text()){$("#code-window-js").width("80%"),$("#dialog-widget").text("Hide widget");var e="";_.each(prop,t=>{e=e+'<div id="widget-preview-zone-'+t+'" ></div>'});var t=$('<div id="code-widget-window-js"  style="width: 49%;float: right;z-index:5000;overflow:auto;height:100%"><div id="widgets-selection-header" class="code-window-header cm-s-ambiance" style="position:relative"><div style="display: table-row">'+h+'</div></div><div id="widgets-preview-top" class="code-widget-window-preview" style="display:flex; justify-content:center; background-color:white; border:1px dashed rgba(0, 0, 0, 0.5);"> '+e+"</div></div>");r.append(t),$("#"+prop[0]+"_radio").prop("checked",!0);_.each(prop,e=>{!function(e){var t=[];$("#widgets-preview-top > div").each((e,n)=>{t.push(n.id),$("#"+n.id).hide()}),$("#widget-preview-zone-"+e).show();var n=Math.min($("#"+e).height(),$("#code-widget-window-js").height()-40-$("#widgets-selection-header").height()),a=Math.min($("#"+e).width(),$("#code-widget-window-js").width()-100);$("#widget-preview-zone-"+e).width(a),$("#widget-preview-zone-"+e).height(n);var o=e.substring(0,e.length-1),i=widgetsPluginsHandler.copyWidget("widget-preview-zone-"+e,o,null,e,!0);null!=widgetConnector.widgetsConnection[e]&&(widgetConnector.widgetsConnection[e].widgetObjEdit=null,widgetConnector.widgetsConnection[e].widgetObjConnect=i)}(e)});var n=prop[0];datanodesManager.previewWidget(n),$(".code-mirror-wrapper")[0].childNodes[0].style.float="left",$(".code-mirror-wrapper")[0].childNodes[0].style.width="50%"}else $("#dialog-widget").text("Show widget"),_.each(prop,e=>{null!=widgetConnector.widgetsConnection[e]&&(widgetConnector.widgetsConnection[e].widgetObjEdit=null,widgetConnector.widgetsConnection[e].widgetObjConnect=null)}),$("#code-widget-window-js").remove(),$("#code-window-js").width("80%"),$(".code-mirror-wrapper")[0].childNodes[0].style.float="unset",$(".code-mirror-wrapper")[0].childNodes[0].style.width="unset"}));d.append(w);var v=$('<button id="apply-widget" class="btn btn-rounded-fill primary" js-reset-toggle="">Apply</button>').click((function(){t.settings[n.name]=m.getValue(),angular.element(document.getElementById("dash-datanode-ctrl")).scope().saveDataNodeSettings(!0)}));d.append(v)}var y=$('<button id="dialog-cancel" class="btn btn-rounded-fill primary" js-reset-toggle="">Close </button>').click((function(){if(a){var e=m.getValue();a(e),i.remove()}$("#codeWindowContainer").remove()}));d.append(y)}datanodesManager.loadDatanodePlugin({type_name:"Python_pyodide_plugin",display_name:"Script (Pyodide)",icon_type:"python.svg",description:"Python script (in client-side) plugin",external_scripts:[],settings:[{name:"autoStart",display_name:"AUTO START",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0},{name:"explicitTrig",display_name:"Explicit trigger",description:"DataNode is executed only if triggered explicitly (no execution when its predecessors are updated). It is executed automatically once when AutoStart is “YES”.",type:"boolean",default_value:!1},{name:"content",display_name:"Python script",type:"custom2",implementation:function(e,n,a,o){var i=$('<textarea autocorrect="off" autocomplete="off" spellcheck="false" class="calculated-value-input" style="display:none; width:78%"></textarea>');i.change((function(){o.settings[n.name]=$(this).val()})),i.val(""),n.name in a&&i.val(a[n.name]);var r=$('<div class="codemirror-wrapper__top"></div>'),d=$('<div class="calculated-setting-row codemirror-wrapper"></div>');d.append(r);var s=function(e,t,n){t||(t='#example: create 2 datanodes py_a a,d py_b then use them as follow:\n# Example: add the values of 2 datanodes.\n# return dataNodes["py_a"] + dataNodes["py_b"];\n');var a=$('<div class="codemirror-wrapper__content"></div>');function o(e,t){t.pick(),e.execCommand("autocomplete")}e.append(a);var i=datanodesManager.getAllDataNodes().sort((e,t)=>e.name().localeCompare(t.name())),r=CodeMirror(a.get(0),{value:t,mode:{name:"python",globalVars:!0},theme:"eclipse",version:3,indentUnit:2,lineNumbers:!0,matchBrackets:!0,autoCloseBrackets:!0,lineWrapping:!1,showCursorWhenSelecting:!0,extraKeys:{"Ctrl-Space":"autocomplete","Alt-C":e=>e.toggleComment()},hintOptions:{hint:JSEditorCompletion.createCompletionFct(i),completeSingle:!1,extraKeys:{Tab:o,Right:o,Left:function(e,t){const n=e.getCursor(),a=n.line,o=e.getLine(a),i=n.ch,r=JSEditorCompletion.getPrecedingPathLength(o,i);r&&(e.replaceRange("",CodeMirror.Pos(a,i-r),CodeMirror.Pos(a,i)),t.close(),e.execCommand("autocomplete"))}}}});r.doc.cm.on("change",(function(){var e=r.getValue();n(e)}));var d=r.getValue();return setTimeout((function(){r.refresh()}),1),n(d),r}(d,i.val(),(function(e){i.val(e),i.change()}));d.append(i),n.name in a&&i.val(a[n.name]);var l=$('<a>Full Screen view<i class="basic icn-full-screen""></i></a>').mousedown((function(e){e.preventDefault(),t(i.val(),o,n,(function(e){s.setValue(e),i.val(e),i.change()}))}));r.append(l),$(e).append(d)},description:"Python script to evaluate."}],newInstance:function(t,a,o,i,r){if(!a(new n(t,o,i,r)))return!e}});var n=function(t,n,a,o){var i,r=this,d=t;r.onSettingsChanged=function(t,n){return"OK"===n&&(n,d),d=t,r.runScriptSettings(),!e&&(d,!0)},r.isSettingNameChanged=function(e){return d.name!=e},r.updateNow=function(t,s){a("Pending");let l={};for(let e of s)l[e]=datanodesManager.getDataNodeByName(e).latestData();if(_.isUndefined(l)){return o("error",d.name,"The value of arguments is undefined"),a("Error","Arguments error"),n(void 0,"Error"),e=!0,!1}return r.runScript(i,l),!0},r.runScriptSettings=function(){if(e=!1,_.isEmpty(d.args))i=d.content;else{let e=d.args;e+="\n",i=e+d.content,d.content=i,d.args=""}return(_.isNull(i)||_.isUndefined(i)||""==i)&&(e=!0,swal("Script error","No python script was provided.","error")),angular.element(document.body).injector().invoke(["$rootScope",function(e){return!e.UserProfile}])||(i=i.replaceAll("datasources","dataNodes")),!0},r.errorAllTheThings=function(e,t=null,i="error",s="Error"){o(i,d.name,e),a(s,t||e),n(void 0,s),r.error=!0,r.pastStatus="Error"},r.runScript=async function(e,t){if(_.isEmpty(d.args))e=d.content;else{let t=d.args.replaceAll("return","args=");t+="\n",e=t+d.content}var i="";i=function(e,t,n,a){return e+="def runScript(dataNodes):\n",e+=function(e){return e.split(/\r?\n/).map(e=>"  "+e).join("\n")+"\n"}(t="global globalScope\n"+t+"\n"),e+="import json\n",e+="import js\n",_.isEmpty(n)?e+="dataNodes = {};\n":(e+="dataNodes = {}\n",_.each(_.keys(n),t=>{"Python_pyodide_plugin"==datanodesManager.getDataNodeByName(t).type()?t!=a&&(e=e+'dataNodes["'+t+'"] = globalScope["'+t+'"]\n'):e=e+'dataNodes["'+t+'"] = json.loads(js.JSON.stringify(js.datanodesManager.getDataNodeByName("'+t+'").latestData()))\n'})),e=e+"\nimport os\nimport sys\nimport json\n\ndef is_jsonable(x):\n  try:\n    json.dumps(x)\n    return True\n  except (TypeError, OverflowError):\n    return False\n\nsys.stdout = open(os.devnull,'w')\nresult = runScript(dataNodes);\nsys.stdout = sys.__stdout__\nglobalScope['"+a+"']=result\nif is_jsonable(result):\n  resRet = json.dumps(result)\nelse:\n  if (str(type(result)) == \"<class 'pandas.core.frame.DataFrame'>\"):\n    resRet =  json.dumps(result.to_html(notebook=True, max_rows=4))\n  else :\n    resRet = json.dumps(str(type(result)));\n\nresRet\n"}(i,e=e.replaceAll("datasources","dataNodes"),t,d.name);const{standardLibs:s,micropipLibs:l}=pyodideManager.getProjectLibs(),c=_.isEqual(s,["matplotlib"]),p=_.isEqual(l,["plotly"]);if(c&&p||c&&!l.length||p&&!s.length||!l.length&&!s.length){const e=pyodideManager.getDefaultLibs();await pyodideManager.loadPyodideLibs(e)}try{i=(i=i.replace("xDashApi","js.xDashApi")).replace("chalkit","js.chalkit");const e=await pyodideManager.runPythonScript(i);u=e,data={},_.isUndefined(u)||("PyProxyClass"==u.constructor.name?data=u.toJs():data=JSON.parseMore(u)),"Stop"==datanodesManager.getDataNodeByName(d.name).schedulerStatus()?(a("None","Request is aborted"),n(void 0,"None"),o("info",d.name,"Response status 0 : abort")):(o("success",d.name,""),a("OK"),n(data),r.error=!1,r.pastStatus="OK",r.pastSettings=d)}catch(e){!function(e){const t=e;let n=t;n=t,"abort"===e?r.errorAllTheThings(n,t,"info","None"):r.errorAllTheThings(n,t)}(e)}var u;return!0},r.onDispose=function(){},this.getXHR=function(){},this.isSetValueValid=function(){return!1},r.isSetFileValid=function(){return!1},r.onCalculatedValueChanged=function(e,t){calculatedValue=t},r.runScriptSettings()}}();
!function(){var e=function(e,a,s,r,n){t=!1;var o,i,d=e,u="JSON",l="",p="",c="",y={};function m(){var e=d.url;switch(p=d.url,d.resp_data_type){case"JSON":u="json";break;case"binary":u="binary";break;case"text":u="text"}if(_.isUndefined(d.use_jsonp)||(d.use_jsonp=!1),d.use_jsonp&&(u="JSONP"),_.isUndefined(d.use_thingproxy)||(d.use_thingproxy?d.use_xproxy=!0:d.use_xproxy=!1),d.use_xproxy)switch(d.method){case"GET":p=xServConfig.urlxProxy+"Get";break;case"POST":p=xServConfig.urlxProxy+"Post";break;case"PUT":p=xServConfig.urlxProxy+"Put";break;case"DELETE":p=xServConfig.urlxProxy+"Delete"}if("calculated"!=r&&(l=d.body),l){try{y=JSON.parse(l),"GET"==d.method&&(l="")}catch(e){return swal("JSON Parse error",e.message,"error"),!1}_.isUndefined(y)||_.isNull(y)||_.isUndefined(y.urlAppend)||(d.use_xproxy?e=d.url+y.urlAppend:p+=y.urlAppend)}if(d.use_xproxy){var a={};if(_.each(d.headers,(function(e){var t=e.name,s=e.value;a[t]=s})),!_.isUndefined(y)&&!_.isNull(y)&&(_.isUndefined(y.headersFromDatasourceWS)||(y.headersFromDataNodeWS=y.headersFromDatasourceWS,delete y.headersFromDatasourceWS),!_.isUndefined(y.headersFromDataNodeWS)))for(var t in y.headersFromDataNodeWS)a[t]=y.headersFromDataNodeWS[t];var s="";if(l){let e=JSON.parse(l);_.isUndefined(e)||_.isNull(e)||(_.isUndefined(e.headersFromDatasourceWS)||delete e.headersFromDatasourceWS,_.isUndefined(e.headersFromDataNodeWS)||delete e.headersFromDataNodeWS),_.isUndefined(e)||_.isNull(e)||_.isUndefined(e.urlAppend)||delete e.urlAppend,s=JSON.stringify(e)}l={URL:e,Body:s,Headers:JSON.stringify(a)},l=JSON.stringify(l)}else if(l)try{let e=JSON.parse(l);_.isUndefined(e)||_.isNull(e)||(_.isUndefined(e.headersFromDatasourceWS)||delete e.headersFromDatasourceWS,_.isUndefined(e.headersFromDataNodeWS)||delete e.headersFromDataNodeWS),_.isUndefined(e)||_.isNull(e)||_.isUndefined(e.urlAppend)||delete e.urlAppend,l=JSON.stringify(e)}catch(e){return swal("Data Parse error",e.message,"error"),!1}function n(){let e=JSON.parse(l),a=JSON.parse(e.Headers);a["ProxyCode-Hash"]=d.proxyHash,a["ProxyCode-Sig"]=d.proxySig,e.Headers=JSON.stringify(a),l=JSON.stringify(e)}if(d.use_xproxy&&(u="JSON"),d.use_xproxy){_.isUndefined(d.proxyHash)&&(d.proxyHash=""),_.isUndefined(d.proxySig)&&(d.proxySig="");let a=new FileMngrFct;if(proxyHashTemp=a.Hash4Proxy(e,"xdash"),""!==d.proxyHash&&d.proxyHash.localeCompare(proxyHashTemp))n();else{d.proxyHash=proxyHashTemp;let e=JSON.stringify({Hash:d.proxyHash});i=$.ajax({url:xServConfig.urlxProxy+"Sign",type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:e,success:function(e){var a=jQuery.parseJSON(e.d);return a.Success?(d.proxySig=a.Msg,n(),!0):(swal("Proxy signing error",a.Msg,"error"),d.proxySig="",!1)},error:function(e,a,t){return swal("Proxy signing error",e.statusText,"error"),d.proxySig="",!1}})}}return!0}function f(e,t,r){var i=null,u="",l=d.method;d.use_xproxy&&(l="POST"),o=$.ajax({url:e,dataType:t,type:l||"GET",data:r,responseType:"arraybuffer",beforeSend:function(e){try{if(d.use_xproxy)e.setRequestHeader("Content-Type","application/json");else if(_.each(d.headers,(function(a){var t=a.name,s=a.value;_.isUndefined(t)||_.isUndefined(s)||e.setRequestHeader(t,s)})),!_.isUndefined(y)&&!_.isNull(y)&&(_.isUndefined(y.headersFromDatasourceWS)||(y.headersFromDataNodeWS=y.headersFromDatasourceWS,delete y.headersFromDatasourceWS),!_.isUndefined(y.headersFromDataNodeWS)))for(var a in y.headersFromDataNodeWS)e.setRequestHeader(a,y.headersFromDataNodeWS[a])}catch(e){swal("Error",e.message,"error")}},success:function(e,t,r){if("Stop"==datanodesManager.getDataNodeByName(d.name).schedulerStatus())return s("None","Request is aborted"),a(void 0,"None"),n("info",d.name,"Response status 0 : abort"),!1;o=void 0;var i=r.getResponseHeader("Content-Type");if(_.isNull(i))return s("OK"),a(null),"OK",!0;if(i.match("application/json")){c=e;var l=[],p=0;for(var y in e)l[p]=y,p++;if(1==l.length&&"d"==l[0]){try{e=JSON.parseMore(e.d)}catch(e){return s("Error","Data parse error"),"Error",n("error",d.name,"Data parse error : "+e.message),void(bFinishTick=!0)}if(d.use_xproxy){if(!e.Success){var m="";return m=_.isUndefined(e.Message)?'xProxy returned error at dataNode "'+d.name+'"':'xProxy returned error at dataNode "'+d.name+'" : "'+e.Message+'"',u="Response status "+r.status+" :"+m,n("error",d.name,u),"Error",s("Error",u),!1}if(!_.isUndefined(e.Body))if(_.isUndefined(e.Headers["Content-Type"])){if(_.isNull(e.Body))return s("OK"),a(null),n("success",d.name,e.Message),"OK",!0}else{var f=e.Headers["Content-Type"];if(f.match("application/json"))try{e=JSON.parseMore(e.Body)}catch(e){return s("Error","Data parse error"),"Error",n("error",d.name,"Data parse error : "+e.message),void(bFinishTick=!0)}else if(f.match("text"))e={content:e.Body,type:f};else if(f.match("image")){e="base64ImageDetected"+e.Body}else e={content:e.Body,type:f};u="Response status "+r.status+" : "+r.statusText,n("success",d.name,u)}}else u="Response status "+r.status+" : "+r.statusText,n("success",d.name,u)}else u="Response status "+r.status+" : "+r.statusText,n("success",d.name,u)}else if(i.match("image")){e="base64ImageDetected"+base64ArrayBuffer(e),u="Response status "+r.status+" : "+r.statusText,n("success",d.name,u)}else if(i.match("text"))e={content:e,type:i},u="Response status "+r.status+" : "+r.statusText,n("success",d.name,u);else{e={content:base64ArrayBuffer(e),type:i},u="Response status "+r.status+" : "+r.statusText,n("success",d.name,u)}return s("OK"),a(e),"OK",!0},error:function(e,t,r){var i="error",l="Error";if(o=void 0,"abort"===t&&(i="info",l="None"),u=(u="Response status "+e.status+" : "+e.statusText)+". Ajax status: "+t,"Error",_.isUndefined(e.responseText))n(i,d.name,u);else{var p="",c=e.responseText.search("type"),y=e.responseText.search(">");p=-1!=c&&-1!=y?e.responseText.slice(c,y):e.responseText,n(i,d.name,u+". "+p)}return s(l,u),a(void 0,l),!1},complete:function(e,a){clearInterval(i)}}),i=setInterval((function(){navigator.onLine||_.isUndefined(o)||(datanodesManager.getDataNodeByName(d.name).completeExecution("NOP"),datanodesManager.getDataNodeByName(d.name).schedulerStatus("Stop"),n("error",d.name,"Internet is disconnected. Request of '"+d.name+"' wil be aborted"),o.abort())}),1e3)}this.getRestResponseData=function(){return c},this.updateNow=function(e){return e&&d.sampleTime>0&&d.explicitTrig&&(n("warning",d.name,'Explicit Trigger option is turned off (False) because "'+d.name+'" is periodic and was triggered explicitly'),d.explicitTrig=!1),s("Pending"),function(e,a,t){o&&4!=o.readyState&&o.abort();i&&4!=i.readyState?i.done((function(){f(e,a,t=l)})):f(e,a,t)}(p,u,l),!0},this.onDispose=function(){},this.onSettingsChanged=function(e,a){"OK"===a&&(a,d),d=e;for(var t=0;t<d.headers.length;t++)""===d.headers[t].name&&d.headers.splice(t,t+1);var s=m();return s&&d,s},this.isSettingNameChanged=function(e){return d.name!=e},this.isSettingSampleTimeChanged=function(e){return d.sampleTime!=e},this.getXHR=function(){return o},this.isSetValueValid=function(){return!1},this.isSetFileValid=function(){return!1},this.isInternetNeeded=function(){return!0},t=!m(),"calculated"==r&&(this.onCalculatedValueChanged=function(e,a){l=JSON.stringify(a),m()})};function a(){if(_.isUndefined($("input#table-row-value-headers0")[0]))console.log("headers table is empty");else{var e=$("input#table-row-value-headers0"),a=$("input#table-row-value-headers1");switch($("select#select-option-req_data_type").val()){case"JSON":e[0].value="Content-Type",a[0].value="application/json";break;case"none":e[0].value="",a[0].value=""}var t=new CustomEvent("change");$("input#table-row-value-headers0")[0].dispatchEvent(t),$("input#table-row-value-headers1")[0].dispatchEvent(t)}}var t=!1;datanodesManager.loadDatanodePlugin({type_name:"REST_web-service_from_datasource",display_name:"REST Web-service",icon_type:"web-service-datasource.svg",description:"REST Web-service from dataNode workspace",settings:[{name:"url",display_name:"URL",type:"text",required:!0},{name:"use_xproxy",display_name:"Use xProxy",description:"xProxy allows your browser to call cross-domain REST APIs (which solves browser CORS policy issues). Keep this parameter to true, unless your distant REST API allows your browser to be called in a cross-origin context.",type:"boolean",default_value:!0},{name:"sampleTime",display_name:"Sample time",type:"number",suffix:"seconds",default_value:0},{name:"autoStart",display_name:"AUTO START",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0},{name:"explicitTrig",display_name:"Explicit trigger",description:"DataNode is executed only if triggered explicitly (no execution when its predecessors are updated). It is executed automatically once when AutoStart is “YES”.",type:"boolean",default_value:!1},{name:"req_data_type",display_name:"Request data-type",type:"option",description:"Choose the web-service request data-type that prefill automatically the first header.",options:[{name:"JSON",value:"JSON"},{name:"none",value:"none"}]},{name:"resp_data_type",display_name:"Response data-type",type:"option",description:"Choose the response data-type expected from the web-service.",options:[{name:"JSON",value:"JSON"},{name:"binary",value:"binary"},{name:"text",value:"text"}]},{name:"method",display_name:"Method",type:"option",options:[{name:"GET",value:"GET"},{name:"POST",value:"POST"},{name:"PUT",value:"PUT"},{name:"DELETE",value:"DELETE"}]},{name:"body",display_name:"Body",type:"calculated",description1:"Insert the body of the request. Normally only used if method is POST. If the method is GET, the content of urlAppend object will be appended to the URL. The content of headersFromDataNodeWS will be injected to headers",description2:"Browse and select a dataNode from workspace to use it in the body."},{name:"headers",display_name:"Headers",type:"array",settings:[{name:"name",display_name:"Name",type:"text"},{name:"value",display_name:"Value",type:"text"}],default_value:[{name:"Content-Type",value:"application/json"}],description:"The first header is 'READ ONLY' and reserved for Request Data-Type."}],newInstance:function(a,s,r,n,o){return s(new e(a,r,n,"calculated",o)),!t},preFillBody:function(){a()}}),xDashConfig.jsonEditorDatanodes&&datanodesManager.loadDatanodePlugin({type_name:"REST_web-service_from_JSON_editor",display_name:"REST Web-service from JSON editor",icon_type:"web-service-json-editor.svg",description:"REST Web-service from JSON editor",settings:[{name:"url",display_name:"URL",type:"text",required:!0},{name:"use_xproxy",display_name:"Use xProxy",description:"If that also fails due to CORS policy, you can use xProxy, which can solve many connection problems to APIs.",type:"boolean",default_value:!0},{name:"sampleTime",display_name:"Sample time",type:"number",suffix:"seconds",default_value:0},{name:"autoStart",display_name:"AUTO START",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0},{name:"req_data_type",display_name:"Request data-type",type:"option",description:"Choose the web-service request data-type that prefill automatically the first header.",options:[{name:"JSON",value:"JSON"},{name:"none",value:"none"}]},{name:"resp_data_type",display_name:"Response data-type",type:"option",description:"Choose the response data-type expected from the web-service.",options:[{name:"JSON",value:"JSON"},{name:"binary",value:"binary"},{name:"text",value:"text"}]},{name:"method",display_name:"Method",type:"option",options:[{name:"GET",value:"GET"},{name:"POST",value:"POST"},{name:"PUT",value:"PUT"},{name:"DELETE",value:"DELETE"}]},{name:"body",display_name:"Body",type:"json",description:'The body of the request. Normally only used if method is POST. If the method is GET, the content of "urlAppend" object it will be appended to the URL.'},{name:"headers",display_name:"Headers",type:"array",settings:[{name:"name",display_name:"Name",type:"text"},{name:"value",display_name:"Value",type:"text"}],default_value:[{name:"Content-Type",value:"application/json"}],description:"The first header is 'READ ONLY' and reserved for Request Data-Type."}],newInstance:function(a,s,r,n,o){return s(new e(a,r,n,"JSON",o)),!t},preFillBody:function(){a()}})}();
!function(){var e=function(e,n,i){t=!1;var a=e;this.updateNow=function(){i("Pending");var e=new Date,t={numeric_value:e.getTime(),full_string_value:e.toLocaleString(),date_string_value:e.toLocaleDateString(),time_string_value:e.toLocaleTimeString(),date_object:e};return i("OK"),n(t),!0},this.onDispose=function(){},this.onSettingsChanged=function(e,t){return"OK"===t&&(t,a),a=e,!0},this.isSettingNameChanged=function(e){return a.name!=e},this.isSettingSampleTimeChanged=function(e){return a.sampleTime!=e},this.isSetValueValid=function(){return!1},this.isSetFileValid=function(){return!1},this.isInternetNeeded=function(){return!1}},t=!1;datanodesManager.loadDatanodePlugin({type_name:"Clock_web-service",display_name:"Clock",icon_type:"clock.svg",description:"Clock trigger",settings:[{name:"sampleTime",display_name:"Sample time",type:"number",suffix:"seconds",default_value:1},{name:"autoStart",display_name:"AUTO START",description:"DataNode is executed automatically at start (project load, its creation/modification).",type:"boolean",default_value:!0}],newInstance:function(n,i,a,o){return i(new e(n,a,o)),!t}})}();
/*!
 * Flat UI Free v2.2.2 (http://designmodo.github.io/Flat-UI/)
 * Copyright 2013-2014 Designmodo, Inc.
 */
/*!
 * jQuery UI Core 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
/*!
 * Bootstrap v3.2.0 (http://getbootstrap.com)
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
if(function(t,e){var i,n,s=0,o=/^ui-id-\d+$/;function r(e,i){var n,s,o,r=e.nodeName.toLowerCase();return"area"===r?(s=(n=e.parentNode).name,!(!e.href||!s||"map"!==n.nodeName.toLowerCase())&&(!!(o=t("img[usemap=#"+s+"]")[0])&&a(o))):(/input|select|textarea|button|object/.test(r)?!e.disabled:"a"===r&&e.href||i)&&a(e)}function a(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter((function(){return"hidden"===t.css(this,"visibility")})).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:(i=t.fn.focus,function(e,n){return"number"==typeof e?this.each((function(){var i=this;setTimeout((function(){t(i).focus(),n&&n.call(i)}),e)})):i.apply(this,arguments)}),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter((function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))})).eq(0):this.parents().filter((function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))})).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,n,s=t(this[0]);s.length&&s[0]!==document;){if(("absolute"===(i=s.css("position"))||"relative"===i||"fixed"===i)&&(n=parseInt(s.css("zIndex"),10),!isNaN(n)&&0!==n))return n;s=s.parent()}return 0},uniqueId:function(){return this.each((function(){this.id||(this.id="ui-id-"+ ++s)}))},removeUniqueId:function(){return this.each((function(){o.test(this.id)&&t(this).removeAttr("id")}))}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo((function(e){return function(i){return!!t.data(i,e)}})):function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return r(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var i=t.attr(e,"tabindex"),n=isNaN(i);return(n||i>=0)&&r(e,!n)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],(function(e,i){var n="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),o={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};function r(e,i,s,o){return t.each(n,(function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)})),i}t.fn["inner"+i]=function(e){return void 0===e?o["inner"+i].call(this):this.each((function(){t(this).css(s,r(this,e)+"px")}))},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?o["outer"+i].call(this,e):this.each((function(){t(this).css(s,r(this,e,!0,n)+"px")}))}})),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=(n=t.fn.removeData,function(e){return arguments.length?n.call(this,t.camelCase(e)):n.call(this)})),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",(function(t){t.preventDefault()}))},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,i,n){var s,o=t.ui[e].prototype;for(s in n)o.plugins[s]=o.plugins[s]||[],o.plugins[s].push([i,n[s]])},call:function(t,e,i){var n,s=t.plugins[e];if(s&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(n=0;n<s.length;n++)t.options[s[n][0]]&&s[n][1].apply(t.element,i)}},hasScroll:function(e,i){if("hidden"===t(e).css("overflow"))return!1;var n,s=i&&"left"===i?"scrollLeft":"scrollTop";return e[s]>0||(e[s]=1,n=e[s]>0,e[s]=0,n)}})}(jQuery),
/*!
 * jQuery UI Widget 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
function(t,e){var i=0,n=Array.prototype.slice,s=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(t){}s(e)},t.widget=function(e,i,n){var s,o,r,a,l={},h=e.split(".")[0];e=e.split(".")[1],s=h+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][s.toLowerCase()]=function(e){return!!t.data(e,s)},t[h]=t[h]||{},o=t[h][e],r=t[h][e]=function(t,e){if(!this._createWidget)return new r(t,e);arguments.length&&this._createWidget(t,e)},t.extend(r,o,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),(a=new i).options=t.widget.extend({},a.options),t.each(n,(function(e,n){var s,o;t.isFunction(n)?l[e]=(s=function(){return i.prototype[e].apply(this,arguments)},o=function(t){return i.prototype[e].apply(this,t)},function(){var t,e=this._super,i=this._superApply;return this._super=s,this._superApply=o,t=n.apply(this,arguments),this._super=e,this._superApply=i,t}):l[e]=n})),r.prototype=t.widget.extend(a,{widgetEventPrefix:o&&a.widgetEventPrefix||e},l,{constructor:r,namespace:h,widgetName:e,widgetFullName:s}),o?(t.each(o._childConstructors,(function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,r,i._proto)})),delete o._childConstructors):i._childConstructors.push(r),t.widget.bridge(e,r)},t.widget.extend=function(e){for(var i,s,o=n.call(arguments,1),r=0,a=o.length;r<a;r++)for(i in o[r])s=o[r][i],o[r].hasOwnProperty(i)&&void 0!==s&&(t.isPlainObject(s)?e[i]=t.isPlainObject(e[i])?t.widget.extend({},e[i],s):t.widget.extend({},s):e[i]=s);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(o){var r="string"==typeof o,a=n.call(arguments,1),l=this;return o=!r&&a.length?t.widget.extend.apply(null,[o].concat(a)):o,r?this.each((function(){var i,n=t.data(this,s);return n?t.isFunction(n[o])&&"_"!==o.charAt(0)?(i=n[o].apply(n,a))!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0:t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")})):this.each((function(){var e=t.data(this,s);e?e.option(o||{})._init():t.data(this,s,new i(o,this))})),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,s,o,r=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(r={},n=e.split("."),e=n.shift(),n.length){for(s=r[e]=t.widget.extend({},this.options[e]),o=0;o<n.length-1;o++)s[n[o]]=s[n[o]]||{},s=s[n[o]];if(e=n.pop(),1===arguments.length)return void 0===s[e]?null:s[e];s[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];r[e]=i}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var s,o=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=s=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),t.each(n,(function(n,r){function a(){if(e||!0!==o.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof r?o[r]:r).apply(o,arguments)}"string"!=typeof r&&(a.guid=r.guid=r.guid||a.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?s.delegate(c,h,a):i.bind(h,a)}))},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){var i=this;return setTimeout((function(){return("string"==typeof t?i[t]:t).apply(i,arguments)}),e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var s,o,r=this.options[e];if(n=n||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(s in o)s in i||(i[s]=o[s]);return this.element.trigger(i,n),!(t.isFunction(r)&&!1===r.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,i){t.Widget.prototype["_"+e]=function(n,s,o){"string"==typeof s&&(s={effect:s});var r,a=s?!0===s||"number"==typeof s?i:s.effect||i:e;"number"==typeof(s=s||{})&&(s={duration:s}),r=!t.isEmptyObject(s),s.complete=o,s.delay&&n.delay(s.delay),r&&t.effects&&t.effects.effect[a]?n[e](s):a!==e&&n[a]?n[a](s.duration,s.easing,o):n.queue((function(i){t(this)[e](),o&&o.call(n[0]),i()}))}}))}(jQuery),
/*!
 * jQuery UI Mouse 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 *
 * Depends:
 *	jquery.ui.widget.js
 */
function(t,e){var i=!1;t(document).mouseup((function(){i=!1})),t.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).bind("click."+this.widgetName,(function(i){if(!0===t.data(i.target,e.widgetName+".preventClickEvent"))return t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!i){this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var n=this,s=1===e.which,o=!("string"!=typeof this.options.cancel||!e.target.nodeName)&&t(e.target).closest(this.options.cancel).length;return!(s&&!o&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){n.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),i=!0,!0))}},_mouseMove:function(e){return t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),
/*!
 * jQuery UI Position 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */
function(t,e){t.ui=t.ui||{};var i,n=Math.max,s=Math.abs,o=Math.round,r=/left|center|right/,a=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,h=/^\w+/,c=/%$/,u=t.fn.position;function d(t,e,i){return[parseFloat(t[0])*(c.test(t[0])?e/100:1),parseFloat(t[1])*(c.test(t[1])?i/100:1)]}function p(e,i){return parseInt(t.css(e,i),10)||0}function f(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}t.position={scrollbarWidth:function(){if(void 0!==i)return i;var e,n,s=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return t("body").append(s),e=o.offsetWidth,s.css("overflow","scroll"),e===(n=o.offsetWidth)&&(n=s[0].clientWidth),s.remove(),i=e-n},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),n=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),s="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&e.height<e.element[0].scrollHeight?t.position.scrollbarWidth():0,height:s?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),n=t.isWindow(i[0]);return{element:i,isWindow:n,isDocument:!!i[0]&&9===i[0].nodeType,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},t.fn.position=function(e){if(!e||!e.of)return u.apply(this,arguments);e=t.extend({},e);var i,c,m,g,v,b,y=t(e.of),w=t.position.getWithinInfo(e.within),C=t.position.getScrollInfo(w),x=(e.collision||"flip").split(" "),S={};return b=f(y),y[0].preventDefault&&(e.at="left top"),c=b.width,m=b.height,g=b.offset,v=t.extend({},g),t.each(["my","at"],(function(){var t,i,n=(e[this]||"").split(" ");1===n.length&&(n=r.test(n[0])?n.concat(["center"]):a.test(n[0])?["center"].concat(n):["center","center"]),n[0]=r.test(n[0])?n[0]:"center",n[1]=a.test(n[1])?n[1]:"center",t=l.exec(n[0]),i=l.exec(n[1]),S[this]=[t?t[0]:0,i?i[0]:0],e[this]=[h.exec(n[0])[0],h.exec(n[1])[0]]})),1===x.length&&(x[1]=x[0]),"right"===e.at[0]?v.left+=c:"center"===e.at[0]&&(v.left+=c/2),"bottom"===e.at[1]?v.top+=m:"center"===e.at[1]&&(v.top+=m/2),i=d(S.at,c,m),v.left+=i[0],v.top+=i[1],this.each((function(){var r,a,l=t(this),h=l.outerWidth(),u=l.outerHeight(),f=p(this,"marginLeft"),b=p(this,"marginTop"),_=h+f+p(this,"marginRight")+C.width,E=u+b+p(this,"marginBottom")+C.height,k=t.extend({},v),T=d(S.my,l.outerWidth(),l.outerHeight());"right"===e.my[0]?k.left-=h:"center"===e.my[0]&&(k.left-=h/2),"bottom"===e.my[1]?k.top-=u:"center"===e.my[1]&&(k.top-=u/2),k.left+=T[0],k.top+=T[1],t.support.offsetFractions||(k.left=o(k.left),k.top=o(k.top)),r={marginLeft:f,marginTop:b},t.each(["left","top"],(function(n,s){t.ui.position[x[n]]&&t.ui.position[x[n]][s](k,{targetWidth:c,targetHeight:m,elemWidth:h,elemHeight:u,collisionPosition:r,collisionWidth:_,collisionHeight:E,offset:[i[0]+T[0],i[1]+T[1]],my:e.my,at:e.at,within:w,elem:l})})),e.using&&(a=function(t){var i=g.left-k.left,o=i+c-h,r=g.top-k.top,a=r+m-u,d={target:{element:y,left:g.left,top:g.top,width:c,height:m},element:{element:l,left:k.left,top:k.top,width:h,height:u},horizontal:o<0?"left":i>0?"right":"center",vertical:a<0?"top":r>0?"bottom":"middle"};c<h&&s(i+o)<c&&(d.horizontal="center"),m<u&&s(r+a)<m&&(d.vertical="middle"),n(s(i),s(o))>n(s(r),s(a))?d.important="horizontal":d.important="vertical",e.using.call(this,t,d)}),l.offset(t.extend(k,{using:a}))}))},t.ui.position={fit:{left:function(t,e){var i,s=e.within,o=s.isWindow?s.scrollLeft:s.offset.left,r=s.width,a=t.left-e.collisionPosition.marginLeft,l=o-a,h=a+e.collisionWidth-r-o;e.collisionWidth>r?l>0&&h<=0?(i=t.left+l+e.collisionWidth-r-o,t.left+=l-i):t.left=h>0&&l<=0?o:l>h?o+r-e.collisionWidth:o:l>0?t.left+=l:h>0?t.left-=h:t.left=n(t.left-a,t.left)},top:function(t,e){var i,s=e.within,o=s.isWindow?s.scrollTop:s.offset.top,r=e.within.height,a=t.top-e.collisionPosition.marginTop,l=o-a,h=a+e.collisionHeight-r-o;e.collisionHeight>r?l>0&&h<=0?(i=t.top+l+e.collisionHeight-r-o,t.top+=l-i):t.top=h>0&&l<=0?o:l>h?o+r-e.collisionHeight:o:l>0?t.top+=l:h>0?t.top-=h:t.top=n(t.top-a,t.top)}},flip:{left:function(t,e){var i,n,o=e.within,r=o.offset.left+o.scrollLeft,a=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,h=t.left-e.collisionPosition.marginLeft,c=h-l,u=h+e.collisionWidth-a-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];c<0?((i=t.left+d+p+f+e.collisionWidth-a-r)<0||i<s(c))&&(t.left+=d+p+f):u>0&&((n=t.left-e.collisionPosition.marginLeft+d+p+f-l)>0||s(n)<u)&&(t.left+=d+p+f)},top:function(t,e){var i,n,o=e.within,r=o.offset.top+o.scrollTop,a=o.height,l=o.isWindow?o.scrollTop:o.offset.top,h=t.top-e.collisionPosition.marginTop,c=h-l,u=h+e.collisionHeight-a-l,d="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,p="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,f=-2*e.offset[1];c<0?(n=t.top+d+p+f+e.collisionHeight-a-r,t.top+d+p+f>c&&(n<0||n<s(c))&&(t.top+=d+p+f)):u>0&&(i=t.top-e.collisionPosition.marginTop+d+p+f-l,t.top+d+p+f>u&&(i>0||s(i)<u)&&(t.top+=d+p+f))}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}},function(){var e,i,n,s,o,r=document.getElementsByTagName("body")[0],a=document.createElement("div");for(o in e=document.createElement(r?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&t.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"}),n)e.style[o]=n[o];e.appendChild(a),(i=r||document.documentElement).insertBefore(e,i.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",s=t(a).offset().left,t.support.offsetFractions=s>10&&s<11,e.innerHTML="",i.removeChild(e)}()}(jQuery),
/*!
 * jQuery UI Button 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/button/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
function(t,e){var i,n="ui-button ui-widget ui-state-default ui-corner-all",s="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",o=function(){var e=t(this);setTimeout((function(){e.find(":ui-button").button("refresh")}),1)},r=function(e){var i=e.name,n=e.form,s=t([]);return i&&(i=i.replace(/'/g,"\\'"),s=n?t(n).find("[name='"+i+"']"):t("[name='"+i+"']",e.ownerDocument).filter((function(){return!this.form}))),s};t.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,o),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var e=this,s=this.options,a="checkbox"===this.type||"radio"===this.type,l=a?"":"ui-state-active";null===s.label&&(s.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(n).attr("role","button").bind("mouseenter"+this.eventNamespace,(function(){s.disabled||this===i&&t(this).addClass("ui-state-active")})).bind("mouseleave"+this.eventNamespace,(function(){s.disabled||t(this).removeClass(l)})).bind("click"+this.eventNamespace,(function(t){s.disabled&&(t.preventDefault(),t.stopImmediatePropagation())})),this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}}),a&&this.element.bind("change"+this.eventNamespace,(function(){e.refresh()})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,(function(){if(s.disabled)return!1})):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,(function(){if(s.disabled)return!1;t(this).addClass("ui-state-active"),e.buttonElement.attr("aria-pressed","true");var i=e.element[0];r(i).not(i).map((function(){return t(this).button("widget")[0]})).removeClass("ui-state-active").attr("aria-pressed","false")})):(this.buttonElement.bind("mousedown"+this.eventNamespace,(function(){if(s.disabled)return!1;t(this).addClass("ui-state-active"),i=this,e.document.one("mouseup",(function(){i=null}))})).bind("mouseup"+this.eventNamespace,(function(){if(s.disabled)return!1;t(this).removeClass("ui-state-active")})).bind("keydown"+this.eventNamespace,(function(e){if(s.disabled)return!1;e.keyCode!==t.ui.keyCode.SPACE&&e.keyCode!==t.ui.keyCode.ENTER||t(this).addClass("ui-state-active")})).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,(function(){t(this).removeClass("ui-state-active")})),this.buttonElement.is("a")&&this.buttonElement.keyup((function(e){e.keyCode===t.ui.keyCode.SPACE&&t(this).click()}))),this._setOption("disabled",s.disabled),this._resetButton()},_determineButtonType:function(){var t,e,i;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button","checkbox"===this.type||"radio"===this.type?(t=this.element.parents().last(),e="label[for='"+this.element.attr("id")+"']",this.buttonElement=t.find(e),this.buttonElement.length||(t=t.length?t.siblings():this.element.siblings(),this.buttonElement=t.filter(e),this.buttonElement.length||(this.buttonElement=t.find(e))),this.element.addClass("ui-helper-hidden-accessible"),(i=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(n+" ui-state-active "+s).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(t,e){if(this._super(t,e),"disabled"===t)return this.element.prop("disabled",!!e),void(e&&this.buttonElement.removeClass("ui-state-focus"));this._resetButton()},refresh:function(){var e=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");e!==this.options.disabled&&this._setOption("disabled",e),"radio"===this.type?r(this.element[0]).each((function(){t(this).is(":checked")?t(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):t(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")})):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"!==this.type){var e=this.buttonElement.removeClass(s),i=t("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),n=this.options.icons,o=n.primary&&n.secondary,r=[];n.primary||n.secondary?(this.options.text&&r.push("ui-button-text-icon"+(o?"s":n.primary?"-primary":"-secondary")),n.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+n.primary+"'></span>"),n.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+n.secondary+"'></span>"),this.options.text||(r.push(o?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",t.trim(i)))):r.push("ui-button-text-only"),e.addClass(r.join(" "))}else this.options.label&&this.element.val(this.options.label)}}),t.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(t,e){"disabled"===t&&this.buttons.button("option",t,e),this._super(t,e)},refresh:function(){var e="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map((function(){return t(this).button("widget")[0]})).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(e?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(e?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map((function(){return t(this).button("widget")[0]})).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),
/*!
 * jQuery UI Slider 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/slider/
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
function(t,e){t.widget("ui.slider",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,i,n=this.options,s=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o=[];for(i=n.values&&n.values.length||1,s.length>i&&(s.slice(i).remove(),s=s.slice(0,i)),e=s.length;e<i;e++)o.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=s.add(t(o.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each((function(e){t(this).data("ui-slider-handle-index",e)}))},_createRange:function(){var e=this.options,i="";e.range?(!0===e.range&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var i,n,s,o,r,a,l,h=this,c=this.options;return!c.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},n=this._normValueFromMouse(i),s=this._valueMax()-this._valueMin()+1,this.handles.each((function(e){var i=Math.abs(n-h.values(e));(s>i||s===i&&(e===h._lastChangedValue||h.values(e)===c.min))&&(s=i,o=t(this),r=e)})),!1!==this._start(e,r)&&(this._mouseSliding=!0,this._handleIndex=r,o.addClass("ui-state-active").focus(),a=o.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-a.left-o.width()/2,top:e.pageY-a.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,r,n),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,n,s,o;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(n=i/e)>1&&(n=1),n<0&&(n=0),"vertical"===this.orientation&&(n=1-n),s=this._valueMax()-this._valueMin(),o=this._valueMin()+n*s,this._trimAlignValue(o)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var n,s,o;this.options.values&&this.options.values.length?(n=this.values(e?0:1),2===this.options.values.length&&!0===this.options.range&&(0===e&&i>n||1===e&&i<n)&&(i=n),i!==this.values(e)&&((s=this.values())[e]=i,o=this._trigger("slide",t,{handle:this.handles[e],value:i,values:s}),n=this.values(e?0:1),!1!==o&&this.values(e,i))):i!==this.value()&&!1!==(o=this._trigger("slide",t,{handle:this.handles[e],value:i}))&&this.value(i)},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var n,s,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(n=this.options.values,s=arguments[0],o=0;o<n.length;o+=1)n[o]=this._trimAlignValue(s[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,i){var n,s=0;switch("range"===e&&!0===this.options.range&&("min"===i?(this.options.value=this._values(0),this.options.values=null):"max"===i&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(s=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),n=0;n<s;n+=1)this._change(null,n);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,n;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(i=this.options.values.slice(),n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(i[n]);return i}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,n=t-i;return 2*Math.abs(i)>=e&&(n+=i>0?e:-e),parseFloat(n.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,n,s,o,r=this.options.range,a=this.options,l=this,h=!this._animateOff&&a.animate,c={};this.options.values&&this.options.values.length?this.handles.each((function(n){i=(l.values(n)-l._valueMin())/(l._valueMax()-l._valueMin())*100,c["horizontal"===l.orientation?"left":"bottom"]=i+"%",t(this).stop(1,1)[h?"animate":"css"](c,a.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===n&&l.range.stop(1,1)[h?"animate":"css"]({left:i+"%"},a.animate),1===n&&l.range[h?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:a.animate})):(0===n&&l.range.stop(1,1)[h?"animate":"css"]({bottom:i+"%"},a.animate),1===n&&l.range[h?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:a.animate}))),e=i})):(n=this.value(),s=this._valueMin(),o=this._valueMax(),i=o!==s?(n-s)/(o-s)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=i+"%",this.handle.stop(1,1)[h?"animate":"css"](c,a.animate),"min"===r&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:i+"%"},a.animate),"max"===r&&"horizontal"===this.orientation&&this.range[h?"animate":"css"]({width:100-i+"%"},{queue:!1,duration:a.animate}),"min"===r&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:i+"%"},a.animate),"max"===r&&"vertical"===this.orientation&&this.range[h?"animate":"css"]({height:100-i+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var i,n,s,o=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass("ui-state-active"),!1===this._start(e,o)))return}switch(s=this.options.step,i=n=this.options.values&&this.options.values.length?this.values(o):this.value(),e.keyCode){case t.ui.keyCode.HOME:n=this._valueMin();break;case t.ui.keyCode.END:n=this._valueMax();break;case t.ui.keyCode.PAGE_UP:n=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/5);break;case t.ui.keyCode.PAGE_DOWN:n=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/5);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(i===this._valueMax())return;n=this._trimAlignValue(i+s);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i===this._valueMin())return;n=this._trimAlignValue(i-s)}this._slide(e,o,n)},click:function(t){t.preventDefault()},keyup:function(e){var i=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,i),this._change(e,i),t(e.target).removeClass("ui-state-active"))}}})}(jQuery),
/*!
 * jQuery UI Effects 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/effects-core/
 */
function(t,e){var i;t.effects={effect:{}},
/*!
     * jQuery Color Animations v2.1.2
     * https://github.com/jquery/jquery-color
     *
     * Copyright 2013 jQuery Foundation and other contributors
     * Released under the MIT license.
     * http://jquery.org/license
     *
     * Date: Wed Jan 16 08:47:09 2013 -0600
     */
function(t,e){var i,n=/^([\-+])=\s*(\d+\.?\d*)/,s=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],o=t.Color=function(e,i,n,s){return new t.Color.fn.parse(e,i,n,s)},r={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},a={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},l=o.support={},h=t("<p>")[0],c=t.each;function u(t,e,i){var n=a[e.type]||{};return null==t?i||!e.def?null:e.def:(t=n.floor?~~t:parseFloat(t),isNaN(t)?e.def:n.mod?(t+n.mod)%n.mod:0>t?0:n.max<t?n.max:t)}function d(e){var n=o(),a=n._rgba=[];return e=e.toLowerCase(),c(s,(function(t,i){var s,o=i.re.exec(e),l=o&&i.parse(o),h=i.space||"rgba";if(l)return s=n[h](l),n[r[h].cache]=s[r[h].cache],a=n._rgba=s._rgba,!1})),a.length?("0,0,0,0"===a.join()&&t.extend(a,i.transparent),n):i[e]}function p(t,e,i){return 6*(i=(i+1)%1)<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}h.style.cssText="background-color:rgba(1,1,1,.5)",l.rgba=h.style.backgroundColor.indexOf("rgba")>-1,c(r,(function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}})),o.fn=t.extend(o.prototype,{parse:function(e,n,s,a){if(void 0===e)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=t(e).css(n),n=void 0);var l=this,h=t.type(e),p=this._rgba=[];return void 0!==n&&(e=[e,n,s,a],h="array"),"string"===h?this.parse(d(e)||i._default):"array"===h?(c(r.rgba.props,(function(t,i){p[i.idx]=u(e[i.idx],i)})),this):"object"===h?(c(r,e instanceof o?function(t,i){e[i.cache]&&(l[i.cache]=e[i.cache].slice())}:function(i,n){var s=n.cache;c(n.props,(function(t,i){if(!l[s]&&n.to){if("alpha"===t||null==e[t])return;l[s]=n.to(l._rgba)}l[s][i.idx]=u(e[t],i,!0)})),l[s]&&t.inArray(null,l[s].slice(0,3))<0&&(l[s][3]=1,n.from&&(l._rgba=n.from(l[s])))}),this):void 0},is:function(t){var e=o(t),i=!0,n=this;return c(r,(function(t,s){var o,r=e[s.cache];return r&&(o=n[s.cache]||s.to&&s.to(n._rgba)||[],c(s.props,(function(t,e){if(null!=r[e.idx])return i=r[e.idx]===o[e.idx]}))),i})),i},_space:function(){var t=[],e=this;return c(r,(function(i,n){e[n.cache]&&t.push(i)})),t.pop()},transition:function(t,e){var i=o(t),n=i._space(),s=r[n],l=0===this.alpha()?o("transparent"):this,h=l[s.cache]||s.to(l._rgba),d=h.slice();return i=i[s.cache],c(s.props,(function(t,n){var s=n.idx,o=h[s],r=i[s],l=a[n.type]||{};null!==r&&(null===o?d[s]=r:(l.mod&&(r-o>l.mod/2?o+=l.mod:o-r>l.mod/2&&(o-=l.mod)),d[s]=u((r-o)*e+o,n)))})),this[n](d)},blend:function(e){if(1===this._rgba[3])return this;var i=this._rgba.slice(),n=i.pop(),s=o(e)._rgba;return o(t.map(i,(function(t,e){return(1-n)*s[e]+n*t})))},toRgbaString:function(){var e="rgba(",i=t.map(this._rgba,(function(t,e){return null==t?e>2?1:0:t}));return 1===i[3]&&(i.pop(),e="rgb("),e+i.join()+")"},toHslaString:function(){var e="hsla(",i=t.map(this.hsla(),(function(t,e){return null==t&&(t=e>2?1:0),e&&e<3&&(t=Math.round(100*t)+"%"),t}));return 1===i[3]&&(i.pop(),e="hsl("),e+i.join()+")"},toHexString:function(e){var i=this._rgba.slice(),n=i.pop();return e&&i.push(~~(255*n)),"#"+t.map(i,(function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t})).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),o.fn.parse.prototype=o.fn,r.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,i,n=t[0]/255,s=t[1]/255,o=t[2]/255,r=t[3],a=Math.max(n,s,o),l=Math.min(n,s,o),h=a-l,c=a+l,u=.5*c;return e=l===a?0:n===a?60*(s-o)/h+360:s===a?60*(o-n)/h+120:60*(n-s)/h+240,i=0===h?0:u<=.5?h/c:h/(2-c),[Math.round(e)%360,i,u,null==r?1:r]},r.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,i=t[1],n=t[2],s=t[3],o=n<=.5?n*(1+i):n+i-n*i,r=2*n-o;return[Math.round(255*p(r,o,e+1/3)),Math.round(255*p(r,o,e)),Math.round(255*p(r,o,e-1/3)),s]},c(r,(function(e,i){var s=i.props,r=i.cache,a=i.to,l=i.from;o.fn[e]=function(e){if(a&&!this[r]&&(this[r]=a(this._rgba)),void 0===e)return this[r].slice();var i,n=t.type(e),h="array"===n||"object"===n?e:arguments,d=this[r].slice();return c(s,(function(t,e){var i=h["object"===n?t:e.idx];null==i&&(i=d[e.idx]),d[e.idx]=u(i,e)})),l?((i=o(l(d)))[r]=d,i):o(d)},c(s,(function(i,s){o.fn[i]||(o.fn[i]=function(o){var r,a=t.type(o),l="alpha"===i?this._hsla?"hsla":"rgba":e,h=this[l](),c=h[s.idx];return"undefined"===a?c:("function"===a&&(o=o.call(this,c),a=t.type(o)),null==o&&s.empty?this:("string"===a&&(r=n.exec(o))&&(o=c+parseFloat(r[2])*("+"===r[1]?1:-1)),h[s.idx]=o,this[l](h)))})}))})),o.hook=function(e){var i=e.split(" ");c(i,(function(e,i){t.cssHooks[i]={set:function(e,n){var s,r,a="";if("transparent"!==n&&("string"!==t.type(n)||(s=d(n)))){if(n=o(s||n),!l.rgba&&1!==n._rgba[3]){for(r="backgroundColor"===i?e.parentNode:e;(""===a||"transparent"===a)&&r&&r.style;)try{a=t.css(r,"backgroundColor"),r=r.parentNode}catch(t){}n=n.blend(a&&"transparent"!==a?a:"_default")}n=n.toRgbaString()}try{e.style[i]=n}catch(t){}}},t.fx.step[i]=function(e){e.colorInit||(e.start=o(e.elem,i),e.end=o(e.end),e.colorInit=!0),t.cssHooks[i].set(e.elem,e.start.transition(e.end,e.pos))}}))},o.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),t.cssHooks.borderColor={expand:function(t){var e={};return c(["Top","Right","Bottom","Left"],(function(i,n){e["border"+n+"Color"]=t})),e}},i=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){var e,i=["add","remove","toggle"],n={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function s(e){var i,n,s=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,o={};if(s&&s.length&&s[0]&&s[s[0]])for(n=s.length;n--;)"string"==typeof s[i=s[n]]&&(o[t.camelCase(i)]=s[i]);else for(i in s)"string"==typeof s[i]&&(o[i]=s[i]);return o}t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],(function(e,i){t.fx.step[i]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,i,t.end),t.setAttr=!0)}})),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,o,r,a){var l=t.speed(o,r,a);return this.queue((function(){var o,r=t(this),a=r.attr("class")||"",h=l.children?r.find("*").addBack():r;h=h.map((function(){return{el:t(this),start:s(this)}})),(o=function(){t.each(i,(function(t,i){e[i]&&r[i+"Class"](e[i])}))})(),h=h.map((function(){return this.end=s(this.el[0]),this.diff=function(e,i){var s,o,r={};for(s in i)o=i[s],e[s]!==o&&(n[s]||!t.fx.step[s]&&isNaN(parseFloat(o))||(r[s]=o));return r}(this.start,this.end),this})),r.attr("class",a),h=h.map((function(){var e=this,i=t.Deferred(),n=t.extend({},l,{queue:!1,complete:function(){i.resolve(e)}});return this.el.animate(this.diff,n),i.promise()})),t.when.apply(t,h.get()).done((function(){o(),t.each(arguments,(function(){var e=this.el;t.each(this.diff,(function(t){e.css(t,"")}))})),l.complete.call(r[0])}))}))},t.fn.extend({addClass:(e=t.fn.addClass,function(i,n,s,o){return n?t.effects.animateClass.call(this,{add:i},n,s,o):e.apply(this,arguments)}),removeClass:function(e){return function(i,n,s,o){return arguments.length>1?t.effects.animateClass.call(this,{remove:i},n,s,o):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(e){return function(i,n,s,o,r){return"boolean"==typeof n||void 0===n?s?t.effects.animateClass.call(this,n?{add:i}:{remove:i},s,o,r):e.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},n,s,o)}}(t.fn.toggleClass),switchClass:function(e,i,n,s,o){return t.effects.animateClass.call(this,{add:i,remove:e},n,s,o)}})}(),function(){function e(e,i,n,s){return t.isPlainObject(e)&&(i=e,e=e.effect),e={effect:e},null==i&&(i={}),t.isFunction(i)&&(s=i,n=null,i={}),("number"==typeof i||t.fx.speeds[i])&&(s=n,n=i,i={}),t.isFunction(n)&&(s=n,n=null),i&&t.extend(e,i),n=n||i.duration,e.duration=t.fx.off?0:"number"==typeof n?n:n in t.fx.speeds?t.fx.speeds[n]:t.fx.speeds._default,e.complete=s||i.complete,e}function i(e){return!(e&&"number"!=typeof e&&!t.fx.speeds[e])||("string"==typeof e&&!t.effects.effect[e]||(!!t.isFunction(e)||"object"==typeof e&&!e.effect))}var n;t.extend(t.effects,{version:"1.10.4",save:function(t,e){for(var i=0;i<e.length;i++)null!==e[i]&&t.data("ui-effects-"+e[i],t[0].style[e[i]])},restore:function(t,e){var i,n;for(n=0;n<e.length;n++)null!==e[n]&&(void 0===(i=t.data("ui-effects-"+e[n]))&&(i=""),t.css(e[n],i))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var i,n;switch(t[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case"left":n=0;break;case"center":n=.5;break;case"right":n=1;break;default:n=t[1]/e.width}return{x:n,y:i}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var i={width:e.outerWidth(!0),height:e.outerHeight(!0),float:e.css("float")},n=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),s={width:e.width(),height:e.height()},o=document.activeElement;try{o.id}catch(t){o=document.body}return e.wrap(n),(e[0]===o||t.contains(e[0],o))&&t(o).focus(),n=e.parent(),"static"===e.css("position")?(n.css({position:"relative"}),e.css({position:"relative"})):(t.extend(i,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],(function(t,n){i[n]=e.css(n),isNaN(parseInt(i[n],10))&&(i[n]="auto")})),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(s),n.css(i).show()},removeWrapper:function(e){var i=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===i||t.contains(e[0],i))&&t(i).focus()),e},setTransition:function(e,i,n,s){return s=s||{},t.each(i,(function(t,i){var o=e.cssUnit(i);o[0]>0&&(s[i]=o[0]*n+o[1])})),s}}),t.fn.extend({effect:function(){var i=e.apply(this,arguments),n=i.mode,s=i.queue,o=t.effects.effect[i.effect];if(t.fx.off||!o)return n?this[n](i.duration,i.complete):this.each((function(){i.complete&&i.complete.call(this)}));function r(e){var n=t(this),s=i.complete,r=i.mode;function a(){t.isFunction(s)&&s.call(n[0]),t.isFunction(e)&&e()}(n.is(":hidden")?"hide"===r:"show"===r)?(n[r](),a()):o.call(n[0],i,a)}return!1===s?this.each(r):this.queue(s||"fx",r)},show:(n=t.fn.show,function(t){if(i(t))return n.apply(this,arguments);var s=e.apply(this,arguments);return s.mode="show",this.effect.call(this,s)}),hide:function(t){return function(n){if(i(n))return t.apply(this,arguments);var s=e.apply(this,arguments);return s.mode="hide",this.effect.call(this,s)}}(t.fn.hide),toggle:function(t){return function(n){if(i(n)||"boolean"==typeof n)return t.apply(this,arguments);var s=e.apply(this,arguments);return s.mode="toggle",this.effect.call(this,s)}}(t.fn.toggle),cssUnit:function(e){var i=this.css(e),n=[];return t.each(["em","px","%","pt"],(function(t,e){i.indexOf(e)>0&&(n=[parseFloat(i),e])})),n}})}(),i={},t.each(["Quad","Cubic","Quart","Quint","Expo"],(function(t,e){i[e]=function(e){return Math.pow(e,t+2)}})),t.extend(i,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(i,(function(e,i){t.easing["easeIn"+e]=i,t.easing["easeOut"+e]=function(t){return 1-i(1-t)},t.easing["easeInOut"+e]=function(t){return t<.5?i(2*t)/2:1-i(-2*t+2)/2}}))}(jQuery),
/*!
 * jQuery UI Touch Punch 0.2.2
 *
 * Copyright 2011, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
function(t){if(t.support.touch="ontouchend"in document,t.support.touch){var e,i=t.ui.mouse.prototype,n=i._mouseInit;i._touchStart=function(t){!e&&this._mouseCapture(t.originalEvent.changedTouches[0])&&(e=!0,this._touchMoved=!1,s(t,"mouseover"),s(t,"mousemove"),s(t,"mousedown"))},i._touchMove=function(t){e&&(this._touchMoved=!0,s(t,"mousemove"))},i._touchEnd=function(t){e&&(s(t,"mouseup"),s(t,"mouseout"),this._touchMoved||s(t,"click"),e=!1)},i._mouseInit=function(){this.element.bind("touchstart",t.proxy(this,"_touchStart")).bind("touchmove",t.proxy(this,"_touchMove")).bind("touchend",t.proxy(this,"_touchEnd")),n.call(this)}}function s(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var i=t.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)}}}(jQuery),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");!function(t){"use strict";t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one("bsTransitionEnd",(function(){i=!0}));return setTimeout((function(){i||t(n).trigger(t.support.transition.end)}),e),this},t((function(){t.support.transition=function(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]};return!1}(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}})}))}(jQuery),function(t){"use strict";var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.VERSION="3.2.0",i.prototype.close=function(e){var i=t(this),n=i.attr("data-target");n||(n=(n=i.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,""));var s=t(n);function o(){s.detach().trigger("closed.bs.alert").remove()}e&&e.preventDefault(),s.length||(s=i.hasClass("alert")?i:i.parent()),s.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(150):o())};var n=t.fn.alert;t.fn.alert=function(e){return this.each((function(){var n=t(this),s=n.data("bs.alert");s||n.data("bs.alert",s=new i(this)),"string"==typeof e&&s[e].call(n)}))},t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.bs.alert.data-api",e,i.prototype.close)}(jQuery),function(t){"use strict";var e=function(i,n){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,n),this.isLoading=!1};function i(i){return this.each((function(){var n=t(this),s=n.data("bs.button"),o="object"==typeof i&&i;s||n.data("bs.button",s=new e(this,o)),"toggle"==i?s.toggle():i&&s.setState(i)}))}e.VERSION="3.2.0",e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(e){var i="disabled",n=this.$element,s=n.is("input")?"val":"html",o=n.data();e+="Text",null==o.resetText&&n.data("resetText",n[s]()),n[s](null==o[e]?this.options[e]:o[e]),setTimeout(t.proxy((function(){"loadingText"==e?(this.isLoading=!0,n.addClass(i).attr(i,i)):this.isLoading&&(this.isLoading=!1,n.removeClass(i).removeAttr(i))}),this),0)},e.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var i=this.$element.find("input");"radio"==i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}t&&this.$element.toggleClass("active")};var n=t.fn.button;t.fn.button=i,t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=n,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',(function(e){var n=t(e.target);n.hasClass("btn")||(n=n.closest(".btn")),i.call(n,"toggle"),e.preventDefault()}))}(jQuery),function(t){"use strict";var e=function(e,i){this.$element=t(e).on("keydown.bs.carousel",t.proxy(this.keydown,this)),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};function i(i){return this.each((function(){var n=t(this),s=n.data("bs.carousel"),o=t.extend({},e.DEFAULTS,n.data(),"object"==typeof i&&i),r="string"==typeof i?i:o.slide;s||n.data("bs.carousel",s=new e(this,o)),"number"==typeof i?s.to(i):r?s[r]():o.interval&&s.pause().cycle()}))}e.VERSION="3.2.0",e.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},e.prototype.keydown=function(t){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()},e.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},e.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},e.prototype.to=function(e){var i=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(!(e>this.$items.length-1||e<0))return this.sliding?this.$element.one("slid.bs.carousel",(function(){i.to(e)})):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",t(this.$items[e]))},e.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},e.prototype.next=function(){if(!this.sliding)return this.slide("next")},e.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},e.prototype.slide=function(e,i){var n=this.$element.find(".item.active"),s=i||n[e](),o=this.interval,r="next"==e?"left":"right",a="next"==e?"first":"last",l=this;if(!s.length){if(!this.options.wrap)return;s=this.$element.find(".item")[a]()}if(s.hasClass("active"))return this.sliding=!1;var h=s[0],c=t.Event("slide.bs.carousel",{relatedTarget:h,direction:r});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=t(this.$indicators.children()[this.getItemIndex(s)]);u&&u.addClass("active")}var d=t.Event("slid.bs.carousel",{relatedTarget:h,direction:r});return t.support.transition&&this.$element.hasClass("slide")?(s.addClass(e),s[0].offsetWidth,n.addClass(r),s.addClass(r),n.one("bsTransitionEnd",(function(){s.removeClass([e,r].join(" ")).addClass("active"),n.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout((function(){l.$element.trigger(d)}),0)})).emulateTransitionEnd(1e3*n.css("transition-duration").slice(0,-1))):(n.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(d)),o&&this.cycle(),this}};var n=t.fn.carousel;t.fn.carousel=i,t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=n,this},t(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",(function(e){var n,s=t(this),o=t(s.attr("data-target")||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var r=t.extend({},o.data(),s.data()),a=s.attr("data-slide-to");a&&(r.interval=!1),i.call(o,r),a&&o.data("bs.carousel").to(a),e.preventDefault()}})),t(window).on("load",(function(){t('[data-ride="carousel"]').each((function(){var e=t(this);i.call(e,e.data())}))}))}(jQuery),function(t){"use strict";var e=function(i,n){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};function i(i){return this.each((function(){var n=t(this),s=n.data("bs.collapse"),o=t.extend({},e.DEFAULTS,n.data(),"object"==typeof i&&i);!s&&o.toggle&&"show"==i&&(i=!i),s||n.data("bs.collapse",s=new e(this,o)),"string"==typeof i&&s[i]()}))}e.VERSION="3.2.0",e.DEFAULTS={toggle:!0},e.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},e.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e=t.Event("show.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.$parent&&this.$parent.find("> .panel > .in");if(n&&n.length){var s=n.data("bs.collapse");if(s&&s.transitioning)return;i.call(n,"hide"),s||n.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return r.call(this);var a=t.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",t.proxy(r,this)).emulateTransitionEnd(350)[o](this.$element[0][a])}}},e.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!t.support.transition)return n.call(this);this.$element[i](0).one("bsTransitionEnd",t.proxy(n,this)).emulateTransitionEnd(350)}}},e.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var n=t.fn.collapse;t.fn.collapse=i,t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=n,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',(function(e){var n,s=t(this),o=s.attr("data-target")||e.preventDefault()||(n=s.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,""),r=t(o),a=r.data("bs.collapse"),l=a?"toggle":s.data(),h=s.attr("data-parent"),c=h&&t(h);a&&a.transitioning||(c&&c.find('[data-toggle="collapse"][data-parent="'+h+'"]').not(s).addClass("collapsed"),s[r.hasClass("in")?"addClass":"removeClass"]("collapsed")),i.call(r,l)}))}(jQuery),function(t){"use strict";var e='[data-toggle="dropdown"]',i=function(e){t(e).on("click.bs.dropdown",this.toggle)};function n(i){i&&3===i.which||(t(".dropdown-backdrop").remove(),t(e).each((function(){var e=s(t(this)),n={relatedTarget:this};e.hasClass("open")&&(e.trigger(i=t.Event("hide.bs.dropdown",n)),i.isDefaultPrevented()||e.removeClass("open").trigger("hidden.bs.dropdown",n))})))}function s(e){var i=e.attr("data-target");i||(i=(i=e.attr("href"))&&/#[A-Za-z]/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&t(i);return n&&n.length?n:e.parent()}i.VERSION="3.2.0",i.prototype.toggle=function(e){var i=t(this);if(!i.is(".disabled, :disabled")){var o=s(i),r=o.hasClass("open");if(n(),!r){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",n);var a={relatedTarget:this};if(o.trigger(e=t.Event("show.bs.dropdown",a)),e.isDefaultPrevented())return;i.trigger("focus"),o.toggleClass("open").trigger("shown.bs.dropdown",a)}return!1}},i.prototype.keydown=function(i){if(/(38|40|27)/.test(i.keyCode)){var n=t(this);if(i.preventDefault(),i.stopPropagation(),!n.is(".disabled, :disabled")){var o=s(n),r=o.hasClass("open");if(!r||r&&27==i.keyCode)return 27==i.which&&o.find(e).trigger("focus"),n.trigger("click");var a=" li:not(.divider):visible a",l=o.find('[role="menu"]'+a+', [role="listbox"]'+a);if(l.length){var h=l.index(l.filter(":focus"));38==i.keyCode&&h>0&&h--,40==i.keyCode&&h<l.length-1&&h++,~h||(h=0),l.eq(h).trigger("focus")}}}};var o=t.fn.dropdown;t.fn.dropdown=function(e){return this.each((function(){var n=t(this),s=n.data("bs.dropdown");s||n.data("bs.dropdown",s=new i(this)),"string"==typeof e&&s[e].call(n)}))},t.fn.dropdown.Constructor=i,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=o,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",(function(t){t.stopPropagation()})).on("click.bs.dropdown.data-api",e,i.prototype.toggle).on("keydown.bs.dropdown.data-api",e+', [role="menu"], [role="listbox"]',i.prototype.keydown)}(jQuery),function(t){"use strict";var e=function(e,i){this.options=i,this.$body=t(document.body),this.$element=t(e),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy((function(){this.$element.trigger("loaded.bs.modal")}),this))};function i(i,n){return this.each((function(){var s=t(this),o=s.data("bs.modal"),r=t.extend({},e.DEFAULTS,s.data(),"object"==typeof i&&i);o||s.data("bs.modal",o=new e(this,r)),"string"==typeof i?o[i](n):r.show&&o.show(n)}))}e.VERSION="3.2.0",e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},e.prototype.show=function(e){var i=this,n=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.backdrop((function(){var n=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:e});n?i.$element.find(".modal-dialog").one("bsTransitionEnd",(function(){i.$element.trigger("focus").trigger(s)})).emulateTransitionEnd(300):i.$element.trigger("focus").trigger(s)})))},e.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.$body.removeClass("modal-open"),this.resetScrollbar(),this.escape(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},e.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy((function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")}),this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",t.proxy((function(t){27==t.which&&this.hide()}),this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop((function(){t.$element.trigger("hidden.bs.modal")}))},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(e){var i=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=t.support.transition&&n;if(this.$backdrop=t('<div class="modal-backdrop '+n+'" />').appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy((function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))}),this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;s?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(150):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(150):o()}else e&&e()},e.prototype.checkScrollbar=function(){document.body.clientWidth>=window.innerWidth||(this.scrollbarWidth=this.scrollbarWidth||this.measureScrollbar())},e.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",t+this.scrollbarWidth)},e.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},e.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var n=t.fn.modal;t.fn.modal=i,t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=n,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',(function(e){var n=t(this),s=n.attr("href"),o=t(n.attr("data-target")||s&&s.replace(/.*(?=#[^\s]+$)/,"")),r=o.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(s)&&s},o.data(),n.data());n.is("a")&&e.preventDefault(),o.one("show.bs.modal",(function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",(function(){n.is(":visible")&&n.trigger("focus")}))})),i.call(o,r,this)}))}(jQuery),function(t){"use strict";var e=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};e.VERSION="3.2.0",e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},e.prototype.init=function(e,i,n){this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&t(this.options.viewport.selector||this.options.viewport);for(var s=this.options.trigger.split(" "),o=s.length;o--;){var r=s[o];if("click"==r)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=r){var a="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(e){return(e=t.extend({},this.getDefaults(),this.$element.data(),e)).delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},e.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,(function(t,n){i[t]!=n&&(e[t]=n)})),e},e.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout((function(){"in"==i.hoverState&&i.show()}),i.options.delay.show)},e.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i)),clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout((function(){"out"==i.hoverState&&i.hide()}),i.options.delay.hide)},e.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(document.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var n=this,s=this.tip(),o=this.getUID(this.type);this.setContent(),s.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&s.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,l=a.test(r);l&&(r=r.replace(a,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element);var h=this.getPosition(),c=s[0].offsetWidth,u=s[0].offsetHeight;if(l){var d=r,p=this.$element.parent(),f=this.getPosition(p);r="bottom"==r&&h.top+h.height+u-f.scroll>f.height?"top":"top"==r&&h.top-f.scroll-u<0?"bottom":"right"==r&&h.right+c>f.width?"left":"left"==r&&h.left-c<f.left?"right":r,s.removeClass(d).addClass(r)}var m=this.getCalculatedOffset(r,h,c,u);this.applyPlacement(m,r);var g=function(){n.$element.trigger("shown.bs."+n.type),n.hoverState=null};t.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",g).emulateTransitionEnd(150):g()}},e.prototype.applyPlacement=function(e,i){var n=this.tip(),s=n[0].offsetWidth,o=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(a)&&(a=0),e.top=e.top+r,e.left=e.left+a,t.offset.setOffset(n[0],t.extend({using:function(t){n.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),n.addClass("in");var l=n[0].offsetWidth,h=n[0].offsetHeight;"top"==i&&h!=o&&(e.top=e.top+o-h);var c=this.getViewportAdjustedDelta(i,e,l,h);c.left?e.left+=c.left:e.top+=c.top;var u=c.left?2*c.left-s+l:2*c.top-o+h,d=c.left?"left":"top",p=c.left?"offsetWidth":"offsetHeight";n.offset(e),this.replaceArrow(u,n[0][p],d)},e.prototype.replaceArrow=function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},e.prototype.hide=function(){var e=this,i=this.tip(),n=t.Event("hide.bs."+this.type);function s(){"in"!=e.hoverState&&i.detach(),e.$element.trigger("hidden.bs."+e.type)}if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(n),!n.isDefaultPrevented())return i.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",s).emulateTransitionEnd(150):s(),this.hoverState=null,this},e.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(e){var i=(e=e||this.$element)[0],n="BODY"==i.tagName;return t.extend({},"function"==typeof i.getBoundingClientRect?i.getBoundingClientRect():null,{scroll:n?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop(),width:n?t(window).width():e.outerWidth(),height:n?t(window).height():e.outerHeight()},n?{top:0,left:0}:e.offset())},e.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},e.prototype.getViewportAdjustedDelta=function(t,e,i,n){var s={top:0,left:0};if(!this.$viewport)return s;var o=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-o-r.scroll,l=e.top+o-r.scroll+n;a<r.top?s.top=r.top-a:l>r.top+r.height&&(s.top=r.top+r.height-l)}else{var h=e.left-o,c=e.left+o+i;h<r.left?s.left=r.left-h:c>r.width&&(s.left=r.left+r.width-c)}return s},e.prototype.getTitle=function(){var t=this.$element,e=this.options;return t.attr("data-original-title")||("function"==typeof e.title?e.title.call(t[0]):e.title)},e.prototype.getUID=function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},e.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(e){var i=this;e&&((i=t(e.currentTarget).data("bs."+this.type))||(i=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,i))),i.tip().hasClass("in")?i.leave(i):i.enter(i)},e.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each((function(){var n=t(this),s=n.data("bs.tooltip"),o="object"==typeof i&&i;(s||"destroy"!=i)&&(s||n.data("bs.tooltip",s=new e(this,o)),"string"==typeof i&&s[i]())}))},t.fn.tooltip.Constructor=e,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.VERSION="3.2.0",e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),(e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype)).constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").empty()[this.options.html?"string"==typeof i?"html":"append":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},e.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var i=t.fn.popover;t.fn.popover=function(i){return this.each((function(){var n=t(this),s=n.data("bs.popover"),o="object"==typeof i&&i;(s||"destroy"!=i)&&(s||n.data("bs.popover",s=new e(this,o)),"string"==typeof i&&s[i]())}))},t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),function(t){"use strict";function e(i,n){var s=t.proxy(this.process,this);this.$body=t("body"),this.$scrollElement=t(i).is("body")?t(window):t(i),this.options=t.extend({},e.DEFAULTS,n),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",s),this.refresh(),this.process()}function i(i){return this.each((function(){var n=t(this),s=n.data("bs.scrollspy"),o="object"==typeof i&&i;s||n.data("bs.scrollspy",s=new e(this,o)),"string"==typeof i&&s[i]()}))}e.VERSION="3.2.0",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e="offset",i=0;t.isWindow(this.$scrollElement[0])||(e="position",i=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var n=this;this.$body.find(this.selector).map((function(){var n=t(this),s=n.data("target")||n.attr("href"),o=/^#./.test(s)&&t(s);return o&&o.length&&o.is(":visible")&&[[o[e]().top+i,s]]||null})).sort((function(t,e){return t[0]-e[0]})).each((function(){n.offsets.push(this[0]),n.targets.push(this[1])}))},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),n=this.options.offset+i-this.$scrollElement.height(),s=this.offsets,o=this.targets,r=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=n)return r!=(t=o[o.length-1])&&this.activate(t);if(r&&e<=s[0])return r!=(t=o[0])&&this.activate(t);for(t=s.length;t--;)r!=o[t]&&e>=s[t]&&(!s[t+1]||e<=s[t+1])&&this.activate(o[t])},e.prototype.activate=function(e){this.activeTarget=e,t(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=t(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var n=t.fn.scrollspy;t.fn.scrollspy=i,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=n,this},t(window).on("load.bs.scrollspy.data-api",(function(){t('[data-spy="scroll"]').each((function(){var e=t(this);i.call(e,e.data())}))}))}(jQuery),function(t){"use strict";var e=function(e){this.element=t(e)};function i(i){return this.each((function(){var n=t(this),s=n.data("bs.tab");s||n.data("bs.tab",s=new e(this)),"string"==typeof i&&s[i]()}))}e.VERSION="3.2.0",e.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.data("target");if(n||(n=(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var s=i.find(".active:last a")[0],o=t.Event("show.bs.tab",{relatedTarget:s});if(e.trigger(o),!o.isDefaultPrevented()){var r=t(n);this.activate(e.closest("li"),i),this.activate(r,r.parent(),(function(){e.trigger({type:"shown.bs.tab",relatedTarget:s})}))}}},e.prototype.activate=function(e,i,n){var s=i.find("> .active"),o=n&&t.support.transition&&s.hasClass("fade");function r(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),o?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),n&&n()}o?s.one("bsTransitionEnd",r).emulateTransitionEnd(150):r(),s.removeClass("in")};var n=t.fn.tab;t.fn.tab=i,t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=n,this},t(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',(function(e){e.preventDefault(),i.call(t(this),"show")}))}(jQuery),function(t){"use strict";var e=function(i,n){this.options=t.extend({},e.DEFAULTS,n),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(i),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};function i(i){return this.each((function(){var n=t(this),s=n.data("bs.affix"),o="object"==typeof i&&i;s||n.data("bs.affix",s=new e(this,o)),"string"==typeof i&&s[i]()}))}e.VERSION="3.2.0",e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0,target:window},e.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(e.RESET).addClass("affix");var t=this.$target.scrollTop(),i=this.$element.offset();return this.pinnedOffset=i.top-t},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=t(document).height(),n=this.$target.scrollTop(),s=this.$element.offset(),o=this.options.offset,r=o.top,a=o.bottom;"object"!=typeof o&&(a=r=o),"function"==typeof r&&(r=o.top(this.$element)),"function"==typeof a&&(a=o.bottom(this.$element));var l=!(null!=this.unpin&&n+this.unpin<=s.top)&&(null!=a&&s.top+this.$element.height()>=i-a?"bottom":null!=r&&n<=r&&"top");if(this.affixed!==l){null!=this.unpin&&this.$element.css("top","");var h="affix"+(l?"-"+l:""),c=t.Event(h+".bs.affix");this.$element.trigger(c),c.isDefaultPrevented()||(this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(e.RESET).addClass(h).trigger(t.Event(h.replace("affix","affixed"))),"bottom"==l&&this.$element.offset({top:i-this.$element.height()-a}))}}};var n=t.fn.affix;t.fn.affix=i,t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=n,this},t(window).on("load",(function(){t('[data-spy="affix"]').each((function(){var e=t(this),n=e.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),i.call(e,n)}))}))}(jQuery),function(){var t=[].slice;!function(e,i){"use strict";var n;n=function(){function t(t,i){var n;null==i&&(i={}),this.$element=e(t),this.options=e.extend({},e.fn.bootstrapSwitch.defaults,{state:this.$element.is(":checked"),size:this.$element.data("size"),animate:this.$element.data("animate"),disabled:this.$element.is(":disabled"),readonly:this.$element.is("[readonly]"),indeterminate:this.$element.data("indeterminate"),onColor:this.$element.data("on-color"),offColor:this.$element.data("off-color"),onText:this.$element.data("on-text"),offText:this.$element.data("off-text"),labelText:this.$element.data("label-text"),baseClass:this.$element.data("base-class"),wrapperClass:this.$element.data("wrapper-class"),radioAllOff:this.$element.data("radio-all-off")},i),this.$wrapper=e("<div>",{class:(n=this,function(){var t;return(t=[""+n.options.baseClass].concat(n._getClasses(n.options.wrapperClass))).push(n.options.state?n.options.baseClass+"-on":n.options.baseClass+"-off"),null!=n.options.size&&t.push(n.options.baseClass+"-"+n.options.size),n.options.animate&&t.push(n.options.baseClass+"-animate"),n.options.disabled&&t.push(n.options.baseClass+"-disabled"),n.options.readonly&&t.push(n.options.baseClass+"-readonly"),n.options.indeterminate&&t.push(n.options.baseClass+"-indeterminate"),n.$element.attr("id")&&t.push(n.options.baseClass+"-id-"+n.$element.attr("id")),t.join(" ")})()}),this.$container=e("<div>",{class:this.options.baseClass+"-container"}),this.$on=e("<span>",{html:this.options.onText,class:this.options.baseClass+"-handle-on "+this.options.baseClass+"-"+this.options.onColor}),this.$off=e("<span>",{html:this.options.offText,class:this.options.baseClass+"-handle-off "+this.options.baseClass+"-"+this.options.offColor}),this.$label=e("<label>",{html:this.options.labelText,class:this.options.baseClass+"-label"}),this.options.indeterminate&&this.$element.prop("indeterminate",!0),this.$element.on("init.bootstrapSwitch",function(e){return function(){return e.options.onInit.apply(t,arguments)}}(this)),this.$element.on("switchChange.bootstrapSwitch",function(e){return function(){return e.options.onSwitchChange.apply(t,arguments)}}(this)),this.$container=this.$element.wrap(this.$container).parent(),this.$wrapper=this.$container.wrap(this.$wrapper).parent(),this.$element.before(this.$on).before(this.$label).before(this.$off).trigger("init.bootstrapSwitch"),this._elementHandlers(),this._handleHandlers(),this._labelHandlers(),this._formHandler()}return t.prototype._constructor=t,t.prototype.state=function(t,e){return void 0===t?this.options.state:(this.options.disabled||this.options.readonly||this.options.indeterminate||this.options.state&&!this.options.radioAllOff&&this.$element.is(":radio")||(t=!!t,this.$element.prop("checked",t).trigger("change.bootstrapSwitch",e)),this.$element)},t.prototype.toggleState=function(t){return this.options.disabled||this.options.readonly||this.options.indeterminate?this.$element:this.$element.prop("checked",!this.options.state).trigger("change.bootstrapSwitch",t)},t.prototype.size=function(t){return void 0===t?this.options.size:(null!=this.options.size&&this.$wrapper.removeClass(this.options.baseClass+"-"+this.options.size),t&&this.$wrapper.addClass(this.options.baseClass+"-"+t),this.options.size=t,this.$element)},t.prototype.animate=function(t){return void 0===t?this.options.animate:(t=!!t,this.$wrapper[t?"addClass":"removeClass"](this.options.baseClass+"-animate"),this.options.animate=t,this.$element)},t.prototype.disabled=function(t){return void 0===t?this.options.disabled:(t=!!t,this.$wrapper[t?"addClass":"removeClass"](this.options.baseClass+"-disabled"),this.$element.prop("disabled",t),this.options.disabled=t,this.$element)},t.prototype.toggleDisabled=function(){return this.$element.prop("disabled",!this.options.disabled),this.$wrapper.toggleClass(this.options.baseClass+"-disabled"),this.options.disabled=!this.options.disabled,this.$element},t.prototype.readonly=function(t){return void 0===t?this.options.readonly:(t=!!t,this.$wrapper[t?"addClass":"removeClass"](this.options.baseClass+"-readonly"),this.$element.prop("readonly",t),this.options.readonly=t,this.$element)},t.prototype.toggleReadonly=function(){return this.$element.prop("readonly",!this.options.readonly),this.$wrapper.toggleClass(this.options.baseClass+"-readonly"),this.options.readonly=!this.options.readonly,this.$element},t.prototype.indeterminate=function(t){return void 0===t?this.options.indeterminate:(t=!!t,this.$wrapper[t?"addClass":"removeClass"](this.options.baseClass+"-indeterminate"),this.$element.prop("indeterminate",t),this.options.indeterminate=t,this.$element)},t.prototype.toggleIndeterminate=function(){return this.$element.prop("indeterminate",!this.options.indeterminate),this.$wrapper.toggleClass(this.options.baseClass+"-indeterminate"),this.options.indeterminate=!this.options.indeterminate,this.$element},t.prototype.onColor=function(t){var e;return e=this.options.onColor,void 0===t?e:(null!=e&&this.$on.removeClass(this.options.baseClass+"-"+e),this.$on.addClass(this.options.baseClass+"-"+t),this.options.onColor=t,this.$element)},t.prototype.offColor=function(t){var e;return e=this.options.offColor,void 0===t?e:(null!=e&&this.$off.removeClass(this.options.baseClass+"-"+e),this.$off.addClass(this.options.baseClass+"-"+t),this.options.offColor=t,this.$element)},t.prototype.onText=function(t){return void 0===t?this.options.onText:(this.$on.html(t),this.options.onText=t,this.$element)},t.prototype.offText=function(t){return void 0===t?this.options.offText:(this.$off.html(t),this.options.offText=t,this.$element)},t.prototype.labelText=function(t){return void 0===t?this.options.labelText:(this.$label.html(t),this.options.labelText=t,this.$element)},t.prototype.baseClass=function(t){return this.options.baseClass},t.prototype.wrapperClass=function(t){return void 0===t?this.options.wrapperClass:(t||(t=e.fn.bootstrapSwitch.defaults.wrapperClass),this.$wrapper.removeClass(this._getClasses(this.options.wrapperClass).join(" ")),this.$wrapper.addClass(this._getClasses(t).join(" ")),this.options.wrapperClass=t,this.$element)},t.prototype.radioAllOff=function(t){return void 0===t?this.options.radioAllOff:(this.options.radioAllOff=t,this.$element)},t.prototype.onInit=function(t){return void 0===t?this.options.onInit:(t||(t=e.fn.bootstrapSwitch.defaults.onInit),this.options.onInit=t,this.$element)},t.prototype.onSwitchChange=function(t){return void 0===t?this.options.onSwitchChange:(t||(t=e.fn.bootstrapSwitch.defaults.onSwitchChange),this.options.onSwitchChange=t,this.$element)},t.prototype.destroy=function(){var t;return(t=this.$element.closest("form")).length&&t.off("reset.bootstrapSwitch").removeData("bootstrap-switch"),this.$container.children().not(this.$element).remove(),this.$element.unwrap().unwrap().off(".bootstrapSwitch").removeData("bootstrap-switch"),this.$element},t.prototype._elementHandlers=function(){return this.$element.on({"change.bootstrapSwitch":(t=this,function(i,n){var s;if(i.preventDefault(),i.stopImmediatePropagation(),(s=t.$element.is(":checked"))!==t.options.state)return t.options.state=s,t.$wrapper.removeClass(s?t.options.baseClass+"-off":t.options.baseClass+"-on").addClass(s?t.options.baseClass+"-on":t.options.baseClass+"-off"),n?void 0:(t.$element.is(":radio")&&e("[name='"+t.$element.attr("name")+"']").not(t.$element).prop("checked",!1).trigger("change.bootstrapSwitch",!0),t.$element.trigger("switchChange.bootstrapSwitch",[s]))}),"focus.bootstrapSwitch":function(t){return function(e){return e.preventDefault(),t.$wrapper.addClass(t.options.baseClass+"-focused")}}(this),"blur.bootstrapSwitch":function(t){return function(e){return e.preventDefault(),t.$wrapper.removeClass(t.options.baseClass+"-focused")}}(this),"keydown.bootstrapSwitch":function(t){return function(e){if(e.which&&!t.options.disabled&&!t.options.readonly&&!t.options.indeterminate)switch(e.which){case 37:return e.preventDefault(),e.stopImmediatePropagation(),t.state(!1);case 39:return e.preventDefault(),e.stopImmediatePropagation(),t.state(!0)}}}(this)});var t},t.prototype._handleHandlers=function(){var t;return this.$on.on("click.bootstrapSwitch",(t=this,function(e){return t.state(!1),t.$element.trigger("focus.bootstrapSwitch")})),this.$off.on("click.bootstrapSwitch",function(t){return function(e){return t.state(!0),t.$element.trigger("focus.bootstrapSwitch")}}(this))},t.prototype._labelHandlers=function(){return this.$label.on({"mousemove.bootstrapSwitch touchmove.bootstrapSwitch":(t=this,function(e){var i;if(t.isLabelDragging)return e.preventDefault(),t.isLabelDragged=!0,i=((e.pageX||e.originalEvent.touches[0].pageX)-t.$wrapper.offset().left)/t.$wrapper.width()*100,t.options.animate&&t.$wrapper.removeClass(t.options.baseClass+"-animate"),i<25?i=25:i>75&&(i=75),t.$container.css("margin-left",i-75+"%"),t.$element.trigger("focus.bootstrapSwitch")}),"mousedown.bootstrapSwitch touchstart.bootstrapSwitch":function(t){return function(e){if(!(t.isLabelDragging||t.options.disabled||t.options.readonly||t.options.indeterminate))return e.preventDefault(),t.isLabelDragging=!0,t.$element.trigger("focus.bootstrapSwitch")}}(this),"mouseup.bootstrapSwitch touchend.bootstrapSwitch":function(t){return function(e){if(t.isLabelDragging)return e.preventDefault(),t.isLabelDragged?(t.isLabelDragged=!1,t.state(parseInt(t.$container.css("margin-left"),10)>-t.$container.width()/6),t.options.animate&&t.$wrapper.addClass(t.options.baseClass+"-animate"),t.$container.css("margin-left","")):t.state(!t.options.state),t.isLabelDragging=!1}}(this),"mouseleave.bootstrapSwitch":function(t){return function(e){return t.$label.trigger("mouseup.bootstrapSwitch")}}(this)});var t},t.prototype._formHandler=function(){var t;if(!(t=this.$element.closest("form")).data("bootstrap-switch"))return t.on("reset.bootstrapSwitch",(function(){return i.setTimeout((function(){return t.find("input").filter((function(){return e(this).data("bootstrap-switch")})).each((function(){return e(this).bootstrapSwitch("state",this.checked)}))}),1)})).data("bootstrap-switch",!0)},t.prototype._getClasses=function(t){var i,n,s,o;if(!e.isArray(t))return[this.options.baseClass+"-"+t];for(n=[],s=0,o=t.length;s<o;s++)i=t[s],n.push(this.options.baseClass+"-"+i);return n},t}(),e.fn.bootstrapSwitch=function(){var i,s,o;return s=arguments[0],i=2<=arguments.length?t.call(arguments,1):[],o=this,this.each((function(){var t,r;if((r=(t=e(this)).data("bootstrap-switch"))||t.data("bootstrap-switch",r=new n(this,s)),"string"==typeof s)return o=r[s].apply(r,i)})),o},e.fn.bootstrapSwitch.Constructor=n,e.fn.bootstrapSwitch.defaults={state:!0,size:null,animate:!0,disabled:!1,readonly:!1,indeterminate:!1,onColor:"primary",offColor:"default",onText:"ON",offText:"OFF",labelText:"&nbsp;",baseClass:"bootstrap-switch",wrapperClass:"wrapper",radioAllOff:!1,onInit:function(){},onSwitchChange:function(){}}}(window.jQuery,window)}.call(this),function(t){"use strict";var e={tagClass:function(t){return"label label-info"},itemValue:function(t){return t?t.toString():t},itemText:function(t){return this.itemValue(t)},freeInput:!0,addOnBlur:!0,maxTags:void 0,maxChars:void 0,confirmKeys:[13,44],onTagExists:function(t,e){e.hide().fadeIn()},trimValue:!1,allowDuplicates:!1};function i(e,i){this.itemsArray=[],this.$element=t(e),this.$element.hide(),this.isSelect="SELECT"===e.tagName,this.multiple=this.isSelect&&e.hasAttribute("multiple"),this.objectItems=i&&i.itemValue,this.placeholderText=e.hasAttribute("placeholder")?this.$element.attr("placeholder"):"",this.inputSize=Math.max(1,this.placeholderText.length),this.$container=t('<div class="bootstrap-tagsinput"></div>'),this.$input=t('<input type="text" placeholder="'+this.placeholderText+'"/>').appendTo(this.$container),this.$element.after(this.$container);var n=(this.inputSize<3?3:this.inputSize)+"em";this.$input.get(0).style.cssText="width: "+n+" !important;",this.build(i)}function n(t,e){if("function"!=typeof t[e]){var i=t[e];t[e]=function(t){return t[i]}}}function s(t,e){if("function"!=typeof t[e]){var i=t[e];t[e]=function(){return i}}}i.prototype={constructor:i,add:function(e,i){var n=this;if(!(n.options.maxTags&&n.itemsArray.length>=n.options.maxTags)&&(!1===e||e)){if("string"==typeof e&&n.options.trimValue&&(e=t.trim(e)),"object"==typeof e&&!n.objectItems)throw"Can't add objects when itemValue option is not set";if(!e.toString().match(/^\s*$/)){if(n.isSelect&&!n.multiple&&n.itemsArray.length>0&&n.remove(n.itemsArray[0]),"string"==typeof e&&"INPUT"===this.$element[0].tagName){var s=e.split(",");if(s.length>1){for(var o=0;o<s.length;o++)this.add(s[o],!0);return void(i||n.pushVal())}}var a=n.options.itemValue(e),l=n.options.itemText(e),h=n.options.tagClass(e),c=t.grep(n.itemsArray,(function(t){return n.options.itemValue(t)===a}))[0];if(!c||n.options.allowDuplicates){if(!(n.items().toString().length+e.length+1>n.options.maxInputLength)){var u=t.Event("beforeItemAdd",{item:e,cancel:!1});if(n.$element.trigger(u),!u.cancel){n.itemsArray.push(e);var d=t('<span class="tag '+r(h)+'">'+r(l)+'<span data-role="remove"></span></span>');if(d.data("item",e),n.findInputWrapper().before(d),d.after(" "),n.isSelect&&!t('option[value="'+encodeURIComponent(a)+'"]',n.$element)[0]){var p=t("<option selected>"+r(l)+"</option>");p.data("item",e),p.attr("value",a),n.$element.append(p)}i||n.pushVal(),n.options.maxTags!==n.itemsArray.length&&n.items().toString().length!==n.options.maxInputLength||n.$container.addClass("bootstrap-tagsinput-max"),n.$element.trigger(t.Event("itemAdded",{item:e}))}}}else if(n.options.onTagExists){var f=t(".tag",n.$container).filter((function(){return t(this).data("item")===c}));n.options.onTagExists(e,f)}}}},remove:function(e,i){var n=this;if(n.objectItems&&(e=(e="object"==typeof e?t.grep(n.itemsArray,(function(t){return n.options.itemValue(t)==n.options.itemValue(e)})):t.grep(n.itemsArray,(function(t){return n.options.itemValue(t)==e})))[e.length-1]),e){var s=t.Event("beforeItemRemove",{item:e,cancel:!1});if(n.$element.trigger(s),s.cancel)return;t(".tag",n.$container).filter((function(){return t(this).data("item")===e})).remove(),t("option",n.$element).filter((function(){return t(this).data("item")===e})).remove(),-1!==t.inArray(e,n.itemsArray)&&n.itemsArray.splice(t.inArray(e,n.itemsArray),1)}i||n.pushVal(),n.options.maxTags>n.itemsArray.length&&n.$container.removeClass("bootstrap-tagsinput-max"),n.$element.trigger(t.Event("itemRemoved",{item:e}))},removeAll:function(){for(t(".tag",this.$container).remove(),t("option",this.$element).remove();this.itemsArray.length>0;)this.itemsArray.pop();this.pushVal()},refresh:function(){var e=this;t(".tag",e.$container).each((function(){var i=t(this),n=i.data("item"),s=e.options.itemValue(n),o=e.options.itemText(n),a=e.options.tagClass(n);(i.attr("class",null),i.addClass("tag "+r(a)),i.contents().filter((function(){return 3==this.nodeType}))[0].nodeValue=r(o),e.isSelect)&&t("option",e.$element).filter((function(){return t(this).data("item")===n})).attr("value",s)}))},items:function(){return this.itemsArray},pushVal:function(){var e=this,i=t.map(e.items(),(function(t){return e.options.itemValue(t).toString()}));e.$element.val(i,!0).trigger("change")},build:function(i){var o=this;if(o.options=t.extend({},e,i),o.objectItems&&(o.options.freeInput=!1),n(o.options,"itemValue"),n(o.options,"itemText"),s(o.options,"tagClass"),o.options.typeahead){var r=o.options.typeahead||{};s(r,"source"),o.$input.typeahead(t.extend({},r,{source:function(e,i){function n(t){for(var e=[],n=0;n<t.length;n++){var r=o.options.itemText(t[n]);s[r]=t[n],e.push(r)}i(e)}this.map={};var s=this.map,a=r.source(e);t.isFunction(a.success)?a.success(n):t.isFunction(a.then)?a.then(n):t.when(a).then(n)},updater:function(t){o.add(this.map[t])},matcher:function(t){return-1!==t.toLowerCase().indexOf(this.query.trim().toLowerCase())},sorter:function(t){return t.sort()},highlighter:function(t){var e=new RegExp("("+this.query+")","gi");return t.replace(e,"<strong>$1</strong>")}}))}if(o.options.typeaheadjs){var l=o.options.typeaheadjs||{};o.$input.typeahead(null,l).on("typeahead:selected",t.proxy((function(t,e){l.valueKey?o.add(e[l.valueKey]):o.add(e),o.$input.typeahead("val","")}),o))}o.$container.on("click",t.proxy((function(t){o.$element.attr("disabled")||o.$input.removeAttr("disabled"),o.$input.focus()}),o)),o.options.addOnBlur&&o.options.freeInput&&o.$input.on("focusout",t.proxy((function(e){0===t(".typeahead, .twitter-typeahead",o.$container).length&&(o.add(o.$input.val()),o.$input.val(""))}),o)),o.$container.on("keydown","input",t.proxy((function(e){var i=t(e.target),n=o.findInputWrapper();if(o.$element.attr("disabled"))o.$input.attr("disabled","disabled");else{switch(e.which){case 8:if(0===a(i[0])){var s=n.prev();s&&o.remove(s.data("item"))}break;case 46:if(0===a(i[0])){var r=n.next();r&&o.remove(r.data("item"))}break;case 37:var l=n.prev();0===i.val().length&&l[0]&&(l.before(n),i.focus());break;case 39:var h=n.next();0===i.val().length&&h[0]&&(h.after(n),i.focus())}var c=i.val().length;Math.ceil(c/5);i.attr("size",Math.max(this.inputSize,i.val().length))}}),o)),o.$container.on("keypress","input",t.proxy((function(e){var i=t(e.target);if(o.$element.attr("disabled"))o.$input.attr("disabled","disabled");else{var n,s,r,a=i.val(),l=o.options.maxChars&&a.length>=o.options.maxChars;o.options.freeInput&&(n=e,s=o.options.confirmKeys,r=!1,t.each(s,(function(t,e){if("number"==typeof e&&n.which===e)return r=!0,!1;if(n.which===e.which){var i=!e.hasOwnProperty("altKey")||n.altKey===e.altKey,s=!e.hasOwnProperty("shiftKey")||n.shiftKey===e.shiftKey,o=!e.hasOwnProperty("ctrlKey")||n.ctrlKey===e.ctrlKey;if(i&&s&&o)return r=!0,!1}})),r||l)&&(o.add(l?a.substr(0,o.options.maxChars):a),i.val(""),e.preventDefault());var h=i.val().length;Math.ceil(h/5);i.attr("size",Math.max(this.inputSize,i.val().length))}}),o)),o.$container.on("click","[data-role=remove]",t.proxy((function(e){o.$element.attr("disabled")||o.remove(t(e.target).closest(".tag").data("item"))}),o)),o.options.itemValue===e.itemValue&&("INPUT"===o.$element[0].tagName?o.add(o.$element.val()):t("option",o.$element).each((function(){o.add(t(this).attr("value"),!0)})))},destroy:function(){this.$container.off("keypress","input"),this.$container.off("click","[role=remove]"),this.$container.remove(),this.$element.removeData("tagsinput"),this.$element.show()},focus:function(){this.$input.focus()},input:function(){return this.$input},findInputWrapper:function(){for(var e=this.$input[0],i=this.$container[0];e&&e.parentNode!==i;)e=e.parentNode;return t(e)}},t.fn.tagsinput=function(e,n){var s=[];return this.each((function(){var o=t(this).data("tagsinput");if(o)if(e||n){if(void 0!==o[e]){var r=o[e](n);void 0!==r&&s.push(r)}}else s.push(o);else o=new i(this,e),t(this).data("tagsinput",o),s.push(o),"SELECT"===this.tagName&&t("option",t(this)).attr("selected","selected"),t(this).val(t(this).val())})),"string"==typeof e?s.length>1?s:s[0]:s},t.fn.tagsinput.Constructor=i;var o=t("<div />");function r(t){return t?o.text(t).html():""}function a(t){var e=0;if(document.selection){t.focus();var i=document.selection.createRange();i.moveStart("character",-t.value.length),e=i.text.length}else(t.selectionStart||"0"==t.selectionStart)&&(e=t.selectionStart);return e}t((function(){t("input[data-role=tagsinput], select[multiple][data-role=tagsinput]").tagsinput()}))}(window.jQuery),function(t,e,i){e.onDomReady=i}(0,this,function(t){"use strict";function e(t){if(!C){if(!r.body)return s(e);for(C=!0;t=x.shift();)s(t)}}function i(t){(y||t.type===l||r[d]===u)&&(n(),e())}function n(){y?(r[b](g,i,h),t[b](l,i,h)):(r[f](v,i),t[f](c,i))}function s(t,e){setTimeout(t,+e>=0?e:1)}function o(t){C?s(t):x.push(t)}null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t,!1),document.readyState="complete"}),!1),document.readyState="loading");var r=t.document,a=r.documentElement,l="load",h=!1,c="on"+l,u="complete",d="readyState",p="attachEvent",f="detachEvent",m="addEventListener",g="DOMContentLoaded",v="onreadystatechange",b="removeEventListener",y=m in r,w=h,C=h,x=[];if(r[d]===u)s(e);else if(y)r[m](g,i,h),t[m](l,i,h);else{r[p](v,i),t[p](c,i);try{w=null==t.frameElement&&a}catch(t){}w&&w.doScroll&&function t(){if(!C){try{w.doScroll("left")}catch(e){return s(t,50)}n(),e()}}()}return o.version="1.4.0",o.isReady=function(){return C},o}(this)),document.querySelectorAll||(document.querySelectorAll=function(t){var e,i=document.createElement("style"),n=[];for(document.documentElement.firstChild.appendChild(i),document._qsa=[],i.styleSheet.cssText=t+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),i.parentNode.removeChild(i);document._qsa.length;)(e=document._qsa.shift()).style.removeAttribute("x-qsa"),n.push(e);return document._qsa=null,n}),document.querySelector||(document.querySelector=function(t){var e=document.querySelectorAll(t);return e.length?e[0]:null}),document.getElementsByClassName||(document.getElementsByClassName=function(t){return t=String(t).replace(/^|\s+/g,"."),document.querySelectorAll(t)}),Object.keys||(Object.keys=function(t){if(t!==Object(t))throw TypeError("Object.keys called on non-object");var e,i=[];for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.push(e);return i}),function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.atob=t.atob||function(t){var i=0,n=[],s=0,o=0;if((t=(t=String(t)).replace(/\s/g,"")).length%4==0&&(t=t.replace(/=+$/,"")),t.length%4==1)throw Error("InvalidCharacterError");if(/[^+/0-9A-Za-z]/.test(t))throw Error("InvalidCharacterError");for(;i<t.length;)s=s<<6|e.indexOf(t.charAt(i)),24===(o+=6)&&(n.push(String.fromCharCode(s>>16&255)),n.push(String.fromCharCode(s>>8&255)),n.push(String.fromCharCode(255&s)),o=0,s=0),i+=1;return 12===o?(s>>=4,n.push(String.fromCharCode(255&s))):18===o&&(s>>=2,n.push(String.fromCharCode(s>>8&255)),n.push(String.fromCharCode(255&s))),n.join("")},t.btoa=t.btoa||function(t){t=String(t);var i,n,s,o,r,a,l,h=0,c=[];if(/[^\x00-\xFF]/.test(t))throw Error("InvalidCharacterError");for(;h<t.length;)o=(i=t.charCodeAt(h++))>>2,r=(3&i)<<4|(n=t.charCodeAt(h++))>>4,a=(15&n)<<2|(s=t.charCodeAt(h++))>>6,l=63&s,h===t.length+2?(a=64,l=64):h===t.length+1&&(l=64),c.push(e.charAt(o),e.charAt(r),e.charAt(a),e.charAt(l));return c.join("")}}(this),function(){function t(e,i,n){e.document;var s,o=e.currentStyle[i].match(/([\d\.]+)(%|cm|em|in|mm|pc|pt|)/)||[0,0,""],r=o[1],a=o[2];return n=n?/%|em/.test(a)&&e.parentElement?t(e.parentElement,"fontSize",null):16:n,s="fontSize"==i?n:/width/i.test(i)?e.clientWidth:e.clientHeight,"%"==a?r/100*s:"cm"==a?.3937*r*96:"em"==a?r*n:"in"==a?96*r:"mm"==a?.3937*r*96/10:"pc"==a?12*r*96/72:"pt"==a?96*r/72:r}function e(t,e){var i="border"==e?"Width":"",n=e+"Top"+i,s=e+"Right"+i,o=e+"Bottom"+i,r=e+"Left"+i;t[e]=(t[n]==t[s]&&t[n]==t[o]&&t[n]==t[r]?[t[n]]:t[n]==t[o]&&t[r]==t[s]?[t[n],t[s]]:t[r]==t[s]?[t[n],t[s],t[o]]:[t[n],t[s],t[o],t[r]]).join(" ")}function i(i){var n,s=this,o=i.currentStyle,r=t(i,"fontSize"),a=function(t){return"-"+t.toLowerCase()};for(n in o)if(Array.prototype.push.call(s,"styleFloat"==n?"float":n.replace(/[A-Z]/,a)),"width"==n)s[n]=i.offsetWidth+"px";else if("height"==n)s[n]=i.offsetHeight+"px";else if("styleFloat"==n)s.float=o[n];else if(/margin.|padding.|border.+W/.test(n)&&"auto"!=s[n])s[n]=Math.round(t(i,n,r))+"px";else if(/^outline/.test(n))try{s[n]=o[n]}catch(t){s.outlineColor=o.color,s.outlineStyle=s.outlineStyle||"none",s.outlineWidth=s.outlineWidth||"0px",s.outline=[s.outlineColor,s.outlineWidth,s.outlineStyle].join(" ")}else s[n]=o[n];e(s,"margin"),e(s,"padding"),e(s,"border"),s.fontSize=Math.round(r)+"px"}window.getComputedStyle||(i.prototype={constructor:i,getPropertyPriority:function(){throw new Error("NotSupportedError: DOM Exception 9")},getPropertyValue:function(t){return this[t.replace(/-\w/g,(function(t){return t[1].toUpperCase()}))]},item:function(t){return this[t]},removeProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},setProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},getPropertyCSSValue:function(){throw new Error("NotSupportedError: DOM Exception 9")}},window.getComputedStyle=Window.prototype.getComputedStyle=function(t){return new i(t)})}(),Object.prototype.hasOwnProperty||(Object.prototype.hasOwnProperty=function(t){var e=this.__proto__||this.constructor.prototype;return t in this&&(!(t in e)||e[t]!==this[t])}),function(t,e){t.augment=function(){"use strict";var t=function(){},e=Array.prototype.slice,i=function(i,n){var s=t.prototype="function"==typeof i?i.prototype:i,o=new t,r=n.apply(o,e.call(arguments,2).concat(s));if("object"==typeof r)for(var a in r)o[a]=r[a];if(!o.hasOwnProperty("constructor"))return o;var l=o.constructor;return l.prototype=o,l};return i.defclass=function(t){var e=t.constructor;return e.prototype=t,e},i.extend=function(t,e){return i(t,(function(t){return this.uber=t,e}))},i}()}(this),function(t,e){function i(t,e,i,o){var r=n(i.substr(i.lastIndexOf(t.domain)),t);r&&s(null,o,r,e)}function n(t,e){for(var i={theme:m(E.settings.themes.gray,null),stylesheets:e.stylesheets,holderURL:[]},n=!1,s=String.fromCharCode(11),o=t.replace(/([^\\])\//g,"$1"+s).split(s),r=/%[0-9a-f]{2}/gi,a=o.length,l=0;a>l;l++){var h=o[l];if(h.match(r))try{h=decodeURIComponent(h)}catch(t){h=o[l]}var c=!1;if(E.flags.dimensions.match(h))n=!0,i.dimensions=E.flags.dimensions.output(h),c=!0;else if(E.flags.fluid.match(h))n=!0,i.dimensions=E.flags.fluid.output(h),i.fluid=!0,c=!0;else if(E.flags.textmode.match(h))i.textmode=E.flags.textmode.output(h),c=!0;else if(E.flags.colors.match(h)){var u=E.flags.colors.output(h);i.theme=m(i.theme,u),c=!0}else if(e.themes[h])e.themes.hasOwnProperty(h)&&(i.theme=m(e.themes[h],null)),c=!0;else if(E.flags.font.match(h))i.font=E.flags.font.output(h),c=!0;else if(E.flags.auto.match(h))i.auto=!0,c=!0;else if(E.flags.text.match(h))i.text=E.flags.text.output(h),c=!0;else if(E.flags.random.match(h)){null==E.vars.cache.themeKeys&&(E.vars.cache.themeKeys=Object.keys(e.themes));var d=E.vars.cache.themeKeys[0|Math.random()*E.vars.cache.themeKeys.length];i.theme=m(e.themes[d],null),c=!0}c&&i.holderURL.push(h)}return i.holderURL.unshift(e.domain),i.holderURL=i.holderURL.join("/"),!!n&&i}function s(t,e,i,n){var s=i.dimensions,r=i.theme,a=s.width+"x"+s.height;if(t=null==t?i.fluid?"fluid":"image":t,null!=i.text&&(r.text=i.text,"object"===e.nodeName.toLowerCase())){for(var h=r.text.split("\\n"),u=0;u<h.length;u++)h[u]=w(h[u]);r.text=h.join("\\n")}var p=i.holderURL,f=m(n,null);i.font&&(r.font=i.font,!f.noFontFallback&&"img"===e.nodeName.toLowerCase()&&E.setup.supportsCanvas&&"svg"===f.renderer&&(f=m(f,{renderer:"canvas"}))),i.font&&"canvas"==f.renderer&&(f.reRender=!0),"background"==t?null==e.getAttribute("data-background-src")&&d(e,{"data-background-src":p}):d(e,{"data-src":p}),i.theme=r,e.holderData={flags:i,renderSettings:f},("image"==t||"fluid"==t)&&d(e,{alt:r.text?(r.text.length>16?r.text.substring(0,16)+"…":r.text)+" ["+a+"]":a}),"image"==t?("html"!=f.renderer&&i.auto||(e.style.width=s.width+"px",e.style.height=s.height+"px"),"html"==f.renderer?e.style.backgroundColor=r.background:(o(t,{dimensions:s,theme:r,flags:i},e,f),i.textmode&&"exact"==i.textmode&&(E.vars.resizableImages.push(e),l(e)))):"background"==t&&"html"!=f.renderer?o(t,{dimensions:s,theme:r,flags:i},e,f):"fluid"==t&&("%"==s.height.slice(-1)?e.style.height=s.height:null!=i.auto&&i.auto||(e.style.height=s.height+"px"),"%"==s.width.slice(-1)?e.style.width=s.width:null!=i.auto&&i.auto||(e.style.width=s.width+"px"),("inline"==e.style.display||""===e.style.display||"none"==e.style.display)&&(e.style.display="block"),c(e),"html"==f.renderer?e.style.backgroundColor=r.background:(E.vars.resizableImages.push(e),l(e)))}function o(t,e,i,n){function s(){var t=null;switch(n.renderer){case"canvas":t=T(l);break;case"svg":t=$(l,n);break;default:throw"Holder: invalid renderer: "+n.renderer}return t}var o;switch(n.renderer){case"svg":if(!E.setup.supportsSVG)return;break;case"canvas":if(!E.setup.supportsCanvas)return;break;default:return}var a={width:e.dimensions.width,height:e.dimensions.height,theme:e.theme,flags:e.flags},l=r(a);if(a.font.size,a.font.family,a.font.weight,null==(o=s()))throw"Holder: couldn't render placeholder";"background"==t?(i.style.backgroundImage="url("+o+")",i.style.backgroundSize=a.width+"px "+a.height+"px"):("img"===i.nodeName.toLowerCase()?d(i,{src:o}):"object"===i.nodeName.toLowerCase()&&(d(i,{data:o}),d(i,{type:"image/svg+xml"})),n.reRender&&setTimeout((function(){var t=s();if(null==t)throw"Holder: couldn't render placeholder";"img"===i.nodeName.toLowerCase()?d(i,{src:t}):"object"===i.nodeName.toLowerCase()&&(d(i,{data:t}),d(i,{type:"image/svg+xml"}))}),100)),d(i,{"data-holder-rendered":!0})}function r(t){function e(t,e,i,n){e.width=i,e.height=n,t.width=Math.max(t.width,e.width),t.height+=e.height,t.add(e)}switch(t.font={family:t.theme.font?t.theme.font:"Arial, Helvetica, Open Sans, sans-serif",size:a(t.width,t.height,t.theme.size?t.theme.size:12),weight:t.theme.fontweight?t.theme.fontweight:"bold"},t.text=t.theme.text?t.theme.text:Math.floor(t.width)+"x"+Math.floor(t.height),t.flags.textmode){case"literal":t.text=t.flags.dimensions.width+"x"+t.flags.dimensions.height;break;case"exact":if(!t.flags.exactDimensions)break;t.text=Math.floor(t.flags.exactDimensions.width)+"x"+Math.floor(t.flags.exactDimensions.height)}var i=new D({width:t.width,height:t.height}),n=i.Shape,s=new n.Rect("holderBg",{fill:t.theme.background});s.resize(t.width,t.height),i.root.add(s);var o=new n.Group("holderTextGroup",{text:t.text,align:"center",font:t.font,fill:t.theme.foreground});o.moveTo(null,null,1),i.root.add(o);var r=o.textPositionData=k(i);if(!r)throw"Holder: staging fallback not supported yet.";o.properties.leading=r.boundingBox.height;var l=null,h=null;if(r.lineCount>1){var c=0,u=0,d=t.width*E.setup.lineWrapRatio,p=0;h=new n.Group("line"+p);for(var f=0;f<r.words.length;f++){var m=r.words[f];l=new n.Text(m.text);var g="\\n"==m.text;(c+m.width>=d||!0===g)&&(e(o,h,c,o.properties.leading),c=0,u+=o.properties.leading,p+=1,(h=new n.Group("line"+p)).y=u),!0!==g&&(l.moveTo(c,0),c+=r.spaceWidth+m.width,h.add(l))}for(var v in e(o,h,c,o.properties.leading),o.children)(h=o.children[v]).moveTo((o.width-h.width)/2,null,null);o.moveTo((t.width-o.width)/2,(t.height-o.height)/2,null),(t.height-o.height)/2<0&&o.moveTo(null,0,null)}else l=new n.Text(t.text),(h=new n.Group("line0")).add(l),o.add(h),o.moveTo((t.width-r.boundingBox.width)/2,(t.height-r.boundingBox.height)/2,null);return i}function a(t,e,i){e=parseInt(e,10),t=parseInt(t,10);var n=Math.max(e,t),s=Math.min(e,t),o=Math.min(.75*s,.75*n*(1/12));return Math.round(Math.max(i,o))}function l(t){var e;for(var i in e=null==t||null==t.nodeType?E.vars.resizableImages:[t])if(e.hasOwnProperty(i)){var n=e[i];if(n.holderData){var s=n.holderData.flags,r=h(n,_.invisibleErrorFn(l));if(r){if(s.fluid&&s.auto){var a=n.holderData.fluidConfig;switch(a.mode){case"width":r.height=r.width/a.ratio;break;case"height":r.width=r.height*a.ratio}}var c={dimensions:r,theme:s.theme,flags:s};s.textmode&&"exact"==s.textmode&&(s.exactDimensions=r,c.dimensions=s.dimensions),o("image",c,n,n.holderData.renderSettings)}}}}function h(t,e){var i={height:t.clientHeight,width:t.clientWidth};return i.height||i.width?(t.removeAttribute("data-holder-invisible"),i):(d(t,{"data-holder-invisible":!0}),void e.call(this,t))}function c(t){if(t.holderData){var e=h(t,_.invisibleErrorFn(c));if(e){var i=t.holderData.flags,n={fluidHeight:"%"==i.dimensions.height.slice(-1),fluidWidth:"%"==i.dimensions.width.slice(-1),mode:null,initialDimensions:e};n.fluidWidth&&!n.fluidHeight?(n.mode="width",n.ratio=n.initialDimensions.width/parseFloat(i.dimensions.height)):!n.fluidWidth&&n.fluidHeight&&(n.mode="height",n.ratio=parseFloat(i.dimensions.width)/n.initialDimensions.height),t.holderData.fluidConfig=n}}}function u(t,e){return null==e?S.createElement(t):S.createElementNS(e,t)}function d(t,e){for(var i in e)t.setAttribute(i,e[i])}function p(t,e,i){if(null==t){t=u("svg",x);var n=u("defs",x);t.appendChild(n)}return t.webkitMatchesSelector&&t.setAttribute("xmlns",x),d(t,{width:e,height:i,viewBox:"0 0 "+e+" "+i,preserveAspectRatio:"none"}),t}function f(t,i){if(e.XMLSerializer){var n=new XMLSerializer,s="",o=i.stylesheets;if(t.querySelector("defs"),i.svgXMLStylesheet){for(var r=(new DOMParser).parseFromString("<xml />","application/xml"),a=o.length-1;a>=0;a--){var l=r.createProcessingInstruction("xml-stylesheet",'href="'+o[a]+'" rel="stylesheet"');r.insertBefore(l,r.firstChild)}var h=r.createProcessingInstruction("xml",'version="1.0" encoding="UTF-8" standalone="yes"');r.insertBefore(h,r.firstChild),r.removeChild(r.documentElement),s=n.serializeToString(r)}var c=n.serializeToString(t);return s+(c=c.replace(/\&amp;(\#[0-9]{2,}\;)/g,"&$1"))}}function m(t,e){var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);if(null!=e)for(var s in e)e.hasOwnProperty(s)&&(i[s]=e[s]);return i}function g(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+":"+t[i]);return e.join(";")}function v(){!function(t){E.vars.debounceTimer||t.call(this),E.vars.debounceTimer&&clearTimeout(E.vars.debounceTimer),E.vars.debounceTimer=setTimeout((function(){E.vars.debounceTimer=null,t.call(this)}),E.setup.debounce)}((function(){l(null)}))}function b(t){var i=null;return"string"==typeof t?i=S.querySelectorAll(t):e.NodeList&&t instanceof e.NodeList?i=t:e.Node&&t instanceof e.Node?i=[t]:e.HTMLCollection&&t instanceof e.HTMLCollection?i=t:null===t&&(i=[]),i}function y(t,e){var i=new Image;i.onerror=function(){e.call(this,!1,t)},i.onload=function(){e.call(this,!0,t)},i.src=t.src}function w(t){for(var e=[],i=0,n=t.length-1;n>=0;n--)i=t[n].charCodeAt(),e.unshift(i>128?["&#",i,";"].join(""):t[n]);return e.join("")}function C(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(e)}))}var x="http://www.w3.org/2000/svg",S=e.document,_={addTheme:function(t,e){return null!=t&&null!=e&&(E.settings.themes[t]=e),delete E.vars.cache.themeKeys,this},addImage:function(t,e){var i=S.querySelectorAll(e);if(i.length)for(var n=0,s=i.length;s>n;n++){var o=u("img");d(o,{"data-src":t}),i[n].appendChild(o)}return this},run:function(t){t=t||{};var o={};E.vars.preempted=!0;var r=m(E.settings,t);o.renderer=r.renderer?r.renderer:E.setup.renderer,-1===E.setup.renderers.join(",").indexOf(o.renderer)&&(o.renderer=E.setup.supportsSVG?"svg":E.setup.supportsCanvas?"canvas":"html"),r.use_canvas?o.renderer="canvas":r.use_svg&&(o.renderer="svg");var a=b(r.images),l=b(r.bgnodes),h=b(r.stylenodes),c=b(r.objects);o.stylesheets=[],o.svgXMLStylesheet=!0,o.noFontFallback=!!r.noFontFallback&&r.noFontFallback;for(var d=0;d<h.length;d++){var p=h[d];if(p.attributes.rel&&p.attributes.href&&"stylesheet"==p.attributes.rel.value){var f=p.attributes.href.value,g=u("a");g.href=f;var v=g.protocol+"//"+g.host+g.pathname+g.search;o.stylesheets.push(v)}}for(d=0;d<l.length;d++){var w=e.getComputedStyle(l[d],null).getPropertyValue("background-image"),C=l[d].getAttribute("data-background-src"),x=null;x=null==C?w:C;var S=null,_="?"+r.domain+"/";if(0===x.indexOf(_))S=x.slice(1);else if(-1!=x.indexOf(_)){var k=x.substr(x.indexOf(_)).slice(1).match(/([^\"]*)"?\)/);null!=k&&(S=k[1])}if(null!=S){var T=n(S,r);T&&s("background",l[d],T,o)}}for(d=0;d<c.length;d++){var $=c[d],D={};try{D.data=$.getAttribute("data"),D.dataSrc=$.getAttribute("data-src")}catch(t){}var A=null!=D.data&&0===D.data.indexOf(r.domain),O=null!=D.dataSrc&&0===D.dataSrc.indexOf(r.domain);A?i(r,o,D.data,$):O&&i(r,o,D.dataSrc,$)}for(d=0;d<a.length;d++){var I=a[d],P={};try{P.src=I.getAttribute("src"),P.dataSrc=I.getAttribute("data-src"),P.rendered=I.getAttribute("data-holder-rendered")}catch(t){}var N=null!=P.src,M=null!=P.dataSrc&&0===P.dataSrc.indexOf(r.domain),L=null!=P.rendered&&"true"==P.rendered;N?0===P.src.indexOf(r.domain)?i(r,o,P.src,I):M&&(L?i(r,o,P.dataSrc,I):y({src:P.src,options:r,renderSettings:o,dataSrc:P.dataSrc,image:I},(function(t,e){t||i(e.options,e.renderSettings,e.dataSrc,e.image)}))):M&&i(r,o,P.dataSrc,I)}return this},invisibleErrorFn:function(){return function(t){if(t.hasAttribute("data-holder-invisible"))throw"Holder: invisible placeholder"}}};_.add_theme=_.addTheme,_.add_image=_.addImage,_.invisible_error_fn=_.invisibleErrorFn;var E={settings:{domain:"holder.js",images:"img",objects:"object",bgnodes:"body .holderjs",stylenodes:"head link.holderjs",stylesheets:[],themes:{gray:{background:"#EEEEEE",foreground:"#AAAAAA"},social:{background:"#3a5a97",foreground:"#FFFFFF"},industrial:{background:"#434A52",foreground:"#C2F200"},sky:{background:"#0D8FDB",foreground:"#FFFFFF"},vine:{background:"#39DBAC",foreground:"#1E292C"},lava:{background:"#F8591A",foreground:"#1C2846",size:12}}},flags:{dimensions:{regex:/^(\d+)x(\d+)$/,output:function(t){var e=this.regex.exec(t);return{width:+e[1],height:+e[2]}}},fluid:{regex:/^([0-9]+%?)x([0-9]+%?)$/,output:function(t){var e=this.regex.exec(t);return{width:e[1],height:e[2]}}},colors:{regex:/(?:#|\^)([0-9a-f]{3,})\:(?:#|\^)([0-9a-f]{3,})/i,output:function(t){var e=this.regex.exec(t);return{foreground:"#"+e[2],background:"#"+e[1]}}},text:{regex:/text\:(.*)/,output:function(t){return this.regex.exec(t)[1].replace("\\/","/")}},font:{regex:/font\:(.*)/,output:function(t){return this.regex.exec(t)[1]}},auto:{regex:/^auto$/},textmode:{regex:/textmode\:(.*)/,output:function(t){return this.regex.exec(t)[1]}},random:{regex:/^random$/}}},k=function(){var t=null,e=null,i=null;return function(n){var s=n.root;if(E.setup.supportsSVG){var o=!1;null==t&&(o=!0),t=p(t,s.properties.width,s.properties.height),o&&(e=u("text",x),i=function(t){return S.createTextNode(t)}(null),d(e,{x:0}),e.appendChild(i),t.appendChild(e),S.body.appendChild(t),t.style.visibility="hidden",t.style.position="absolute",t.style.top="-100%",t.style.left="-100%");var r=s.children.holderTextGroup.properties;d(e,{y:r.font.size,style:g({"font-weight":r.font.weight,"font-size":r.font.size+"px","font-family":r.font.family,"dominant-baseline":"middle"})}),i.nodeValue=r.text;var a=e.getBBox(),l=Math.ceil(a.width/(s.properties.width*E.setup.lineWrapRatio)),h=r.text.split(" "),c=r.text.match(/\\n/g);l+=null==c?0:c.length,i.nodeValue=r.text.replace(/[ ]+/g,"");var f=e.getComputedTextLength(),m=a.width-f,v=Math.round(m/Math.max(1,h.length-1)),b=[];if(l>1){i.nodeValue="";for(var y=0;y<h.length;y++)if(0!==h[y].length){i.nodeValue=C(h[y]);var w=e.getBBox();b.push({text:h[y],width:w.width})}}return{spaceWidth:v,lineCount:l,boundingBox:a,words:b}}return!1}}(),T=function(){var t=u("canvas"),e=null;return function(i){null==e&&(e=t.getContext("2d"));var n=i.root;t.width=E.dpr(n.properties.width),t.height=E.dpr(n.properties.height),e.textBaseline="middle",e.fillStyle=n.children.holderBg.properties.fill,e.fillRect(0,0,E.dpr(n.children.holderBg.width),E.dpr(n.children.holderBg.height));var s=n.children.holderTextGroup;for(var o in s.properties,e.font=s.properties.font.weight+" "+E.dpr(s.properties.font.size)+"px "+s.properties.font.family+", monospace",e.fillStyle=s.properties.fill,s.children){var r=s.children[o];for(var a in r.children){var l=r.children[a],h=E.dpr(s.x+r.x+l.x),c=E.dpr(s.y+r.y+l.y+s.properties.leading/2);e.fillText(l.properties.text,h,c)}}return t.toDataURL("image/png")}}(),$=function(){if(e.XMLSerializer){var t=p(null,0,0),i=u("rect",x);return t.appendChild(i),function(e,n){var s=e.root;p(t,s.properties.width,s.properties.height);for(var o=t.querySelectorAll("g"),r=0;r<o.length;r++)o[r].parentNode.removeChild(o[r]);d(i,{width:s.children.holderBg.width,height:s.children.holderBg.height,fill:s.children.holderBg.properties.fill});var a=s.children.holderTextGroup,l=a.properties,h=u("g",x);for(var c in t.appendChild(h),a.children){var m=a.children[c];for(var v in m.children){var b=m.children[v],y=a.x+m.x+b.x,w=a.y+m.y+b.y+a.properties.leading/2,C=u("text",x),_=S.createTextNode(null);d(C,{x:y,y:w,style:g({fill:l.fill,"font-weight":l.font.weight,"font-family":l.font.family+", monospace","font-size":l.font.size+"px","dominant-baseline":"central"})}),_.nodeValue=b.properties.text,C.appendChild(_),h.appendChild(C)}}return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(f(t,n))))}}}(),D=function(t){var e=1,i=augment.defclass({constructor:function(t){e++,this.parent=null,this.children={},this.id=e,this.name="n"+e,null!=t&&(this.name=t),this.x=0,this.y=0,this.z=0,this.width=0,this.height=0},resize:function(t,e){null!=t&&(this.width=t),null!=e&&(this.height=e)},moveTo:function(t,e,i){this.x=null!=t?t:this.x,this.y=null!=e?e:this.y,this.z=null!=i?i:this.z},add:function(t){var e=t.name;if(null!=this.children[e])throw"SceneGraph: child with that name already exists: "+e;this.children[e]=t,t.parent=this}}),n=augment(i,(function(e){this.constructor=function(){e.constructor.call(this,"root"),this.properties=t}})),s=augment(i,(function(t){function e(e,i){if(t.constructor.call(this,e),this.properties={fill:"#000"},null!=i)!function(t,e){for(var i in e)t[i]=e[i]}(this.properties,i);else if(null!=e&&"string"!=typeof e)throw"SceneGraph: invalid node name"}this.Group=augment.extend(this,{constructor:e,type:"group"}),this.Rect=augment.extend(this,{constructor:e,type:"rect"}),this.Text=augment.extend(this,{constructor:function(t){e.call(this),this.properties.text=t},type:"text"})})),o=new n;return this.Shape=s,this.root=o,this};for(var A in E.flags)E.flags.hasOwnProperty(A)&&(E.flags[A].match=function(t){return t.match(this.regex)});E.setup={renderer:"html",debounce:100,ratio:1,supportsCanvas:!1,supportsSVG:!1,lineWrapRatio:.9,renderers:["html","canvas","svg"]},E.dpr=function(t){return t*E.setup.ratio},E.vars={preempted:!1,resizableImages:[],debounceTimer:null,cache:{}},function(){var t=1,i=1,n=u("canvas"),s=null;n.getContext&&-1!=n.toDataURL("image/png").indexOf("data:image/png")&&(E.setup.renderer="canvas",s=n.getContext("2d"),E.setup.supportsCanvas=!0),E.setup.supportsCanvas&&(t=e.devicePixelRatio||1,i=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1),E.setup.ratio=t/i,S.createElementNS&&S.createElementNS(x,"svg").createSVGRect&&(E.setup.renderer="svg",E.setup.supportsSVG=!0)}(),function(t,e,i){"function"==typeof define&&define.amd?define(t):i[e]=t}(_,"Holder",e),e.onDomReady&&e.onDomReady((function(){E.vars.preempted||_.run(),e.addEventListener?(e.addEventListener("resize",v,!1),e.addEventListener("orientationchange",v,!1)):e.attachEvent("onresize",v),"object"==typeof e.Turbolinks&&e.document.addEventListener("page:change",(function(){_.run()}))}))}(0,this),
/*!
 * typeahead.js 0.10.5
 * https://github.com/twitter/typeahead.js
 * Copyright 2013-2014 Twitter, Inc. and other contributors; Licensed MIT
 */
function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,i){t.each(e,(function(t,e){return i(e,t)}))},map:t.map,filter:t.grep,every:function(e,i){var n=!0;return e?(t.each(e,(function(t,s){if(!(n=i.call(null,s,t,e)))return!1})),!!n):n},some:function(e,i){var n=!1;return e?(t.each(e,(function(t,s){if(n=i.call(null,s,t,e))return!1})),!!n):n},mixin:t.extend,getUniqueId:(i=0,function(){return i++}),templatify:function(e){return t.isFunction(e)?e:function(){return String(e)}},defer:function(t){setTimeout(t,0)},debounce:function(t,e,i){var n,s;return function(){var o,r,a=this,l=arguments;return o=function(){n=null,i||(s=t.apply(a,l))},r=i&&!n,clearTimeout(n),n=setTimeout(o,e),r&&(s=t.apply(a,l)),s}},throttle:function(t,e){var i,n,s,o,r,a;return r=0,a=function(){r=new Date,s=null,o=t.apply(i,n)},function(){var l=new Date,h=e-(l-r);return i=this,n=arguments,h<=0?(clearTimeout(s),s=null,r=l,o=t.apply(i,n)):s||(s=setTimeout(a,h)),o}},noop:function(){}};var i}(),i=function(){"use strict";return{nonword:i,whitespace:t,obj:{nonword:n(i),whitespace:n(t)}};function t(t){return(t=e.toStr(t))?t.split(/\s+/):[]}function i(t){return(t=e.toStr(t))?t.split(/\W+/):[]}function n(t){return function(){var i=[].slice.call(arguments,0);return function(n){var s=[];return e.each(i,(function(i){s=s.concat(t(e.toStr(n[i])))})),s}}}}(),n=function(){"use strict";function i(i){this.maxSize=e.isNumber(i)?i:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function n(){this.head=this.tail=null}function s(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(i.prototype,{set:function(t,e){var i,n=this.list.tail;this.size>=this.maxSize&&(this.list.remove(n),delete this.hash[n.key]),(i=this.hash[t])?(i.val=e,this.list.moveToFront(i)):(i=new s(t,e),this.list.add(i),this.hash[t]=i,this.size++)},get:function(t){var e=this.hash[t];if(e)return this.list.moveToFront(e),e.val},reset:function(){this.size=0,this.hash={},this.list=new n}}),e.mixin(n.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),i}(),s=function(){"use strict";var t,i;try{(t=window.localStorage).setItem("~~~","!"),t.removeItem("~~~")}catch(e){t=null}function n(t){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix))}return i=t&&window.JSON?{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},get:function(e){return this.isExpired(e)&&this.remove(e),r(t.getItem(this._prefix(e)))},set:function(i,n,r){return e.isNumber(r)?t.setItem(this._ttlKey(i),o(s()+r)):t.removeItem(this._ttlKey(i)),t.setItem(this._prefix(i),o(n))},remove:function(e){return t.removeItem(this._ttlKey(e)),t.removeItem(this._prefix(e)),this},clear:function(){var e,i,n=[],s=t.length;for(e=0;e<s;e++)(i=t.key(e)).match(this.keyMatcher)&&n.push(i.replace(this.keyMatcher,""));for(e=n.length;e--;)this.remove(n[e]);return this},isExpired:function(i){var n=r(t.getItem(this._ttlKey(i)));return!!(e.isNumber(n)&&s()>n)}}:{get:e.noop,set:e.noop,remove:e.noop,clear:e.noop,isExpired:e.noop},e.mixin(n.prototype,i),n;function s(){return(new Date).getTime()}function o(t){return JSON.stringify(e.isUndefined(t)?null:t)}function r(t){return JSON.parse(t)}}(),o=function(){"use strict";var i=0,s={},o=6,r=new n(10);function a(i){var s;i=i||{},this.cancelled=!1,this.lastUrl=null,this._send=i.transport?(s=i.transport,function(i,n){var o=t.Deferred();return s(i,n,(function(t){e.defer((function(){o.resolve(t)}))}),(function(t){e.defer((function(){o.reject(t)}))})),o}):t.ajax,this._get=i.rateLimiter?i.rateLimiter(this._get):this._get,this._cache=!1===i.cache?new n(0):r}return a.setMaxPendingRequests=function(t){o=t},a.resetCache=function(){r.reset()},e.mixin(a.prototype,{_get:function(t,e,n){var r,a=this;function l(e){n&&n(null,e),a._cache.set(t,e)}function h(){n&&n(!0)}function c(){i--,delete s[t],a.onDeckRequestArgs&&(a._get.apply(a,a.onDeckRequestArgs),a.onDeckRequestArgs=null)}this.cancelled||t!==this.lastUrl||((r=s[t])?r.done(l).fail(h):i<o?(i++,s[t]=this._send(t,e).done(l).fail(h).always(c)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(t,i,n){var s;return e.isFunction(i)&&(n=i,i={}),this.cancelled=!1,this.lastUrl=t,(s=this._cache.get(t))?e.defer((function(){n&&n(null,s)})):this._get(t,i,n),!!s},cancel:function(){this.cancelled=!0}}),a}(),r=function(){"use strict";function i(e){(e=e||{}).datumTokenizer&&e.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=e.datumTokenizer,this.queryTokenizer=e.queryTokenizer,this.reset()}return e.mixin(i.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var i=this;t=e.isArray(t)?t:[t],e.each(t,(function(t){var s,o;s=i.datums.push(t)-1,o=n(i.datumTokenizer(t)),e.each(o,(function(t){var e,n,o;for(e=i.trie,n=t.split("");o=n.shift();)(e=e.children[o]||(e.children[o]={ids:[],children:{}})).ids.push(s)}))}))},get:function(t){var i,s,o=this;return i=n(this.queryTokenizer(t)),e.each(i,(function(t){var e,i,n,r;if(s&&0===s.length)return!1;for(e=o.trie,i=t.split("");e&&(n=i.shift());)e=e.children[n];if(!e||0!==i.length)return s=[],!1;r=e.ids.slice(0),s=s?function(t,e){var i=0,n=0,s=[];t=t.sort(a),e=e.sort(a);var o=t.length,r=e.length;for(;i<o&&n<r;)t[i]<e[n]?i++:(t[i]>e[n]||(s.push(t[i]),i++),n++);return s;function a(t,e){return t-e}}(s,r):r})),s?e.map(function(t){for(var e={},i=[],n=0,s=t.length;n<s;n++)e[t[n]]||(e[t[n]]=!0,i.push(t[n]));return i}(s),(function(t){return o.datums[t]})):[]},reset:function(){this.datums=[],this.trie={ids:[],children:{}}},serialize:function(){return{datums:this.datums,trie:this.trie}}}),i;function n(t){return t=e.filter(t,(function(t){return!!t})),t=e.map(t,(function(t){return t.toLowerCase()}))}}(),a=function(){"use strict";return{local:function(t){return t.local||null},prefetch:function(i){var n,s;s={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(n=i.prefetch||null)&&(n=e.isString(n)?{url:n}:n,(n=e.mixin(s,n)).thumbprint="0.10.5"+n.thumbprint,n.ajax.type=n.ajax.type||"GET",n.ajax.dataType=n.ajax.dataType||"json",!n.url&&t.error("prefetch requires url to be set"));return n},remote:function(i){var n,s;s={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(n=i.remote||null)&&(n=e.isString(n)?{url:n}:n,(n=e.mixin(s,n)).rateLimiter=/^throttle$/i.test(n.rateLimitBy)?(o=n.rateLimitWait,function(t){return e.throttle(t,o)}):function(t){return function(i){return e.debounce(i,t)}}(n.rateLimitWait),n.ajax.type=n.ajax.type||"GET",n.ajax.dataType=n.ajax.dataType||"json",delete n.rateLimitBy,delete n.rateLimitWait,!n.url&&t.error("remote requires url to be set"));var o;return n}}}();!function(n){"use strict";var l,h;function c(i){var n;i&&(i.local||i.prefetch||i.remote)||t.error("one of local, prefetch, or remote is required"),this.limit=i.limit||5,this.sorter=(n=i.sorter,e.isFunction(n)?function(t){return t.sort(n)}:function(t){return t}),this.dupDetector=i.dupDetector||u,this.local=a.local(i),this.prefetch=a.prefetch(i),this.remote=a.remote(i),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new r({datumTokenizer:i.datumTokenizer,queryTokenizer:i.queryTokenizer}),this.storage=this.cacheKey?new s(this.cacheKey):null}return l=n.Bloodhound,h={data:"data",protocol:"protocol",thumbprint:"thumbprint"},n.Bloodhound=c,c.noConflict=function(){return n.Bloodhound=l,c},c.tokenizers=i,e.mixin(c.prototype,{_loadPrefetch:function(e){var i,n,s=this;return(i=this._readFromStorage(e.thumbprint))?(this.index.bootstrap(i),n=t.Deferred().resolve()):n=t.ajax(e.url,e.ajax).done((function(t){s.clear(),s.add(e.filter?e.filter(t):t),s._saveToStorage(s.index.serialize(),e.thumbprint,e.ttl)})),n},_getFromRemote:function(t,e){var i,n,s=this;if(this.transport)return t=t||"",n=encodeURIComponent(t),i=this.remote.replace?this.remote.replace(this.remote.url,t):this.remote.url.replace(this.remote.wildcard,n),this.transport.get(i,this.remote.ajax,(function(t,i){e(t?[]:s.remote.filter?s.remote.filter(i):i)}))},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(t,e,i){this.storage&&(this.storage.set(h.data,t,i),this.storage.set(h.protocol,location.protocol,i),this.storage.set(h.thumbprint,e,i))},_readFromStorage:function(t){var e,i={};return this.storage&&(i.data=this.storage.get(h.data),i.protocol=this.storage.get(h.protocol),i.thumbprint=this.storage.get(h.thumbprint)),e=i.thumbprint!==t||i.protocol!==location.protocol,i.data&&!e?i.data:null},_initialize:function(){var i,n=this,s=this.local;return i=this.prefetch?this._loadPrefetch(this.prefetch):t.Deferred().resolve(),s&&i.done((function(){n.add(e.isFunction(s)?s():s)})),this.transport=this.remote?new o(this.remote):null,this.initPromise=i.promise()},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){this.index.add(t)},get:function(t,i){var n=this,s=[],o=!1;s=this.index.get(t),(s=this.sorter(s).slice(0,this.limit)).length<this.limit?o=this._getFromRemote(t,(function(t){var o=s.slice(0);e.each(t,(function(t){return!e.some(o,(function(e){return n.dupDetector(t,e)}))&&o.push(t),o.length<n.limit})),i&&i(n.sorter(o))})):this._cancelLastRemoteRequest(),o||(s.length>0||!this.transport)&&i&&i(s)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&o.resetCache()},ttAdapter:function(){return e.bind(this.get,this)}}),c;function u(){return!1}}(this);var l={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'},h=function(){"use strict";var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),e.isMsie()&&e.isMsie()<=7&&e.mixin(t.input,{marginTop:"-1px"}),t}(),c=function(){"use strict";function i(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}return e.mixin(i.prototype,{trigger:function(t){var e=[].slice.call(arguments,1);this.$el.trigger("typeahead:"+t,e)}}),i}(),u=function(){"use strict";var t=/\s+/,e=function(){var t;t=window.setImmediate?function(t){setImmediate((function(){t()}))}:function(t){setTimeout((function(){t()}),0)};return t}();return{onSync:function(t,e,n){return i.call(this,"sync",t,e,n)},onAsync:function(t,e,n){return i.call(this,"async",t,e,n)},off:function(e){var i;if(!this._callbacks)return this;e=e.split(t);for(;i=e.shift();)delete this._callbacks[i];return this},trigger:function(i){var s,o,r,a,l;if(!this._callbacks)return this;i=i.split(t),r=[].slice.call(arguments,1);for(;(s=i.shift())&&(o=this._callbacks[s]);)a=n(o.sync,this,[s].concat(r)),l=n(o.async,this,[s].concat(r)),a()&&e(l);return this}};function i(e,i,n,s){var o;if(!n)return this;for(i=i.split(t),n=s?function(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}(n,s):n,this._callbacks=this._callbacks||{};o=i.shift();)this._callbacks[o]=this._callbacks[o]||{sync:[],async:[]},this._callbacks[o][e].push(n);return this}function n(t,e,i){return function(){for(var n,s=0,o=t.length;!n&&s<o;s+=1)n=!1===t[s].apply(e,i);return!n}}}(),d=function(t){"use strict";var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(n){var s;(n=e.mixin({},i,n)).node&&n.pattern&&(n.pattern=e.isArray(n.pattern)?n.pattern:[n.pattern],s=function(t,i,n){for(var s,o=[],r=0,a=t.length;r<a;r++)o.push(e.escapeRegExChars(t[r]));return s=n?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",i?new RegExp(s):new RegExp(s,"i")}(n.pattern,n.caseSensitive,n.wordsOnly),function t(e,i){for(var n,s=0;s<e.childNodes.length;s++)3===(n=e.childNodes[s]).nodeType?s+=i(n)?1:0:t(n,i)}(n.node,(function(e){var i,o,r;(i=s.exec(e.data))&&(r=t.createElement(n.tagName),n.className&&(r.className=n.className),(o=e.splitText(i.index)).splitText(i[0].length),r.appendChild(o.cloneNode(!0)),e.parentNode.replaceChild(r,o));return!!i})))}}(window.document),p=function(){"use strict";var i;function n(n){var s,o,r,a,l,h=this;(n=n||{}).input||t.error("input is missing"),s=e.bind(this._onBlur,this),o=e.bind(this._onFocus,this),r=e.bind(this._onKeydown,this),a=e.bind(this._onInput,this),this.$hint=t(n.hint),this.$input=t(n.input).on("blur.tt",s).on("focus.tt",o).on("keydown.tt",r),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop),e.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",(function(t){i[t.which||t.keyCode]||e.defer(e.bind(h._onInput,h,t))})):this.$input.on("input.tt",a),this.query=this.$input.val(),this.$overflowHelper=(l=this.$input,t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:l.css("font-family"),fontSize:l.css("font-size"),fontStyle:l.css("font-style"),fontVariant:l.css("font-variant"),fontWeight:l.css("font-weight"),wordSpacing:l.css("word-spacing"),letterSpacing:l.css("letter-spacing"),textIndent:l.css("text-indent"),textRendering:l.css("text-rendering"),textTransform:l.css("text-transform")}).insertAfter(l))}return i={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return(t||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,u,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(t){var e=i[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(t,e){var i,n,o;switch(t){case"tab":n=this.getHint(),o=this.getInputValue(),i=n&&n!==o&&!s(e);break;case"up":case"down":i=!s(e);break;default:i=!1}i&&e.preventDefault()},_shouldTrigger:function(t,e){var i;switch(t){case"tab":i=!s(e);break;default:i=!0}return i},_checkInputValue:function(){var t,e,i,s,o;t=this.getInputValue(),s=t,o=this.query,i=!!(e=n.normalizeQuery(s)===n.normalizeQuery(o))&&this.query.length!==t.length,this.query=t,e?i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(t){this.query=t},getInputValue:function(){return this.$input.val()},setInputValue:function(t,e){this.$input.val(t),e?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,i;i=(t=this.getInputValue())!==(e=this.getHint())&&0===e.indexOf(t),!(""!==t&&i&&!this.hasOverflow())&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,i,n;return t=this.$input.val().length,i=this.$input[0].selectionStart,e.isNumber(i)?i===t:!document.selection||((n=document.selection.createRange()).moveStart("character",-t),t===n.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),n;function s(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}}(),f=function(){"use strict";function i(i){var n,s,o,r;(i=i||{}).templates=i.templates||{},i.source||t.error("missing source"),i.name&&(n=i.name,!/^[_a-zA-Z0-9-]+$/.test(n))&&t.error("invalid dataset name: "+i.name),this.query=null,this.highlight=!!i.highlight,this.name=i.name||e.getUniqueId(),this.source=i.source,this.displayFn=(s=(s=i.display||i.displayKey)||"value",e.isFunction(s)?s:function(t){return t[s]}),this.templates=(o=i.templates,r=this.displayFn,{empty:o.empty&&e.templatify(o.empty),header:o.header&&e.templatify(o.header),footer:o.footer&&e.templatify(o.footer),suggestion:o.suggestion||function(t){return"<p>"+r(t)+"</p>"}}),this.$el=t(l.dataset.replace("%CLASS%",this.name))}return i.extractDatasetName=function(e){return t(e).data("ttDataset")},i.extractValue=function(e){return t(e).data("ttValue")},i.extractDatum=function(e){return t(e).data("ttDatum")},e.mixin(i.prototype,u,{_render:function(i,n){if(this.$el){var s,o,r,a=this;this.$el.empty(),!(s=n&&n.length)&&this.templates.empty?this.$el.html(a.templates.empty({query:i,isEmpty:!0})).prepend(a.templates.header?c():null).append(a.templates.footer?u():null):s&&this.$el.html((o=t(l.suggestions).css(h.suggestions),r=e.map(n,(function(e){var i;return(i=t(l.suggestion).append(a.templates.suggestion(e)).data("ttDataset",a.name).data("ttValue",a.displayFn(e)).data("ttDatum",e)).children().each((function(){t(this).css(h.suggestionChild)})),i})),o.append.apply(o,r),a.highlight&&d({className:"tt-highlight",node:o[0],pattern:i}),o)).prepend(a.templates.header?c():null).append(a.templates.footer?u():null),this.trigger("rendered")}function c(){return a.templates.header({query:i,isEmpty:!s})}function u(){return a.templates.footer({query:i,isEmpty:!s})}},getRoot:function(){return this.$el},update:function(t){var e=this;this.query=t,this.canceled=!1,this.source(t,(function(i){e.canceled||t!==e.query||e._render(t,i)}))},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),i}(),m=function(){"use strict";function i(i){var s,o,r,a=this;(i=i||{}).menu||t.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=e.map(i.datasets,n),s=e.bind(this._onSuggestionClick,this),o=e.bind(this._onSuggestionMouseEnter,this),r=e.bind(this._onSuggestionMouseLeave,this),this.$menu=t(i.menu).on("click.tt",".tt-suggestion",s).on("mouseenter.tt",".tt-suggestion",o).on("mouseleave.tt",".tt-suggestion",r),e.each(this.datasets,(function(t){a.$menu.append(t.getRoot()),t.onSync("rendered",a._onRendered,a)}))}return e.mixin(i.prototype,u,{_onSuggestionClick:function(e){this.trigger("suggestionClicked",t(e.currentTarget))},_onSuggestionMouseEnter:function(e){this._removeCursor(),this._setCursor(t(e.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){this.isEmpty=e.every(this.datasets,(function(t){return t.isEmpty()})),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(t,e){t.first().addClass("tt-cursor"),!e&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(t){var e,i,n,s;this.isOpen&&(i=this._getCursor(),e=this._getSuggestions(),this._removeCursor(),-1!==(n=((n=e.index(i)+t)+1)%(e.length+1)-1)?(n<-1&&(n=e.length-1),this._setCursor(s=e.eq(n)),this._ensureVisible(s)):this.trigger("cursorRemoved"))},_ensureVisible:function(t){var e,i,n,s;i=(e=t.position().top)+t.outerHeight(!0),n=this.$menu.scrollTop(),s=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),e<0?this.$menu.scrollTop(n+e):s<i&&this.$menu.scrollTop(n+(i-s))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(t){this.$menu.css("ltr"===t?h.ltr:h.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(t){var e=null;return t.length&&(e={raw:f.extractDatum(t),value:f.extractValue(t),datasetName:f.extractDatasetName(t)}),e},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(t){e.each(this.datasets,(function(e){e.update(t)}))},empty:function(){e.each(this.datasets,(function(t){t.clear()})),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){this.$menu.off(".tt"),this.$menu=null,e.each(this.datasets,(function(t){t.destroy()}))}}),i;function n(t){return new f(t)}}(),g=function(){"use strict";function i(i){var n,s,o;(i=i||{}).input||t.error("missing input"),this.isActivated=!1,this.autoselect=!!i.autoselect,this.minLength=e.isNumber(i.minLength)?i.minLength:1,this.$node=function(e,i){var n,s,o,r;n=t(e),s=t(l.wrapper).css(h.wrapper),o=t(l.dropdown).css(h.dropdown),(r=n.clone().css(h.hint).css((a=n,{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}))).val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",!0).attr({autocomplete:"off",spellcheck:"false",tabindex:-1}),n.data("ttAttrs",{dir:n.attr("dir"),autocomplete:n.attr("autocomplete"),spellcheck:n.attr("spellcheck"),style:n.attr("style")}),n.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(i?h.input:h.inputWithNoHint);var a;try{!n.attr("dir")&&n.attr("dir","auto")}catch(t){}return n.wrap(s).parent().prepend(i?r:null).append(o)}(i.input,i.withHint),n=this.$node.find(".tt-dropdown-menu"),s=this.$node.find(".tt-input"),o=this.$node.find(".tt-hint"),s.on("blur.tt",(function(t){var i,o,r;i=document.activeElement,o=n.is(i),r=n.has(i).length>0,e.isMsie()&&(o||r)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer((function(){s.focus()})))})),n.on("mousedown.tt",(function(t){t.preventDefault()})),this.eventBus=i.eventBus||new c({el:s}),this.dropdown=new m({menu:n,datasets:i.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new p({input:s,hint:o}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),this._setLanguageDirection()}return e.mixin(i.prototype,{_onSuggestionClicked:function(t,e){var i;(i=this.dropdown.getDatumForSuggestion(e))&&this._select(i)},_onCursorMoved:function(){var t=this.dropdown.getDatumForCursor();this.input.setInputValue(t.value,!0),this.eventBus.trigger("cursorchanged",t.raw,t.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(t,e){var i,n;i=this.dropdown.getDatumForCursor(),n=this.dropdown.getDatumForTopSuggestion(),i?(this._select(i),e.preventDefault()):this.autoselect&&n&&(this._select(n),e.preventDefault())},_onTabKeyed:function(t,e){var i;(i=this.dropdown.getDatumForCursor())?(this._select(i),e.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(t,e){this.input.clearHintIfInvalid(),e.length>=this.minLength?this.dropdown.update(e):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var t;this.dir!==(t=this.input.getLanguageDirection())&&(this.dir=t,this.$node.css("direction",t),this.dropdown.setLanguageDirection(t))},_updateHint:function(){var t,i,n,s,o;(t=this.dropdown.getDatumForTopSuggestion())&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(i=this.input.getInputValue(),n=p.normalizeQuery(i),s=e.escapeRegExChars(n),(o=new RegExp("^(?:"+s+")(.+$)","i").exec(t.value))?this.input.setHint(i+o[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(t){var e,i,n,s;e=this.input.getHint(),i=this.input.getQuery(),n=t||this.input.isCursorAtEnd(),e&&i!==e&&n&&((s=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(s.value),this.eventBus.trigger("autocompleted",s.raw,s.datasetName))},_select:function(t){this.input.setQuery(t.value),this.input.setInputValue(t.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",t.raw,t.datasetName),this.dropdown.close(),e.defer(e.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(t){t=e.toStr(t),this.isActivated?this.input.setInputValue(t):(this.input.setQuery(t),this.input.setInputValue(t,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){var t,i;this.input.destroy(),this.dropdown.destroy(),t=this.$node,i=t.find(".tt-input"),e.each(i.data("ttAttrs"),(function(t,n){e.isUndefined(t)?i.removeAttr(n):i.attr(n,t)})),i.detach().removeData("ttAttrs").removeClass("tt-input").insertAfter(t),t.remove(),this.$node=null}}),i}();!function(){"use strict";var i,n;i=t.fn.typeahead,n={initialize:function(i,n){return n=e.isArray(n)?n:[].slice.call(arguments,1),i=i||{},this.each(s);function s(){var s,o=t(this);e.each(n,(function(t){t.highlight=!!i.highlight})),s=new g({input:o,eventBus:new c({el:o}),withHint:!!e.isUndefined(i.hint)||!!i.hint,minLength:i.minLength,autoselect:i.autoselect,datasets:n}),o.data("ttTypeahead",s)}},open:function(){return this.each((function(){var e,i=t(this);(e=i.data("ttTypeahead"))&&e.open()}))},close:function(){return this.each((function(){var e,i=t(this);(e=i.data("ttTypeahead"))&&e.close()}))},val:function(e){return arguments.length?this.each(i):n(this.first());function i(){var i;(i=t(this).data("ttTypeahead"))&&i.setVal(e)}function n(t){var e,i;return(e=t.data("ttTypeahead"))&&(i=e.getVal()),i}},destroy:function(){return this.each((function(){var e,i=t(this);(e=i.data("ttTypeahead"))&&(e.destroy(),i.removeData("ttTypeahead"))}))}},t.fn.typeahead=function(e){var i;return n[e]&&"initialize"!==e?(i=this.filter((function(){return!!t(this).data("ttTypeahead")})),n[e].apply(i,[].slice.call(arguments,1))):n.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=i,this}}()}(window.jQuery),function(t){void 0===t.fn.each2&&t.extend(t.fn,{each2:function(e){for(var i=t([0]),n=-1,s=this.length;++n<s&&(i.context=i[0]=this[n])&&!1!==e.call(i[0],n,i););return this}})}(jQuery),function(t,e){"use strict";if(void 0===window.Select2){var i,n,s,o,r,a,l,h,c={x:0,y:0},u={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(t){switch(t=t.which?t.which:t){case u.LEFT:case u.RIGHT:case u.UP:case u.DOWN:return!0}return!1},isControl:function(t){switch(t.which){case u.SHIFT:case u.CTRL:case u.ALT:return!0}return!!t.metaKey},isFunctionKey:function(t){return(t=t.which?t.which:t)>=112&&t<=123}},d={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};a=t(document),h=1,o=function(){return h++},i=O(Object,{bind:function(t){var e=this;return function(){t.apply(e,arguments)}},init:function(e){var i,n;this.opts=e=this.prepareOpts(e),this.id=e.id,void 0!==e.element.data("select2")&&null!==e.element.data("select2")&&e.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=t("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body),this.containerId="s2id_"+(e.element.attr("id")||"autogen"+o()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",e.element.attr("title")),this.body=t("body"),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",e.element.attr("style")),this.container.css(D(e.containerCss,this.opts.element)),this.container.addClass(D(e.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",C),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(D(e.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",C),this.results=i=this.container.find(".select2-results"),this.search=n=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",C),this.results.on("mousemove",(function(e){var i=c;void 0!==i&&i.x===e.pageX&&i.y===e.pageY||t(e.target).trigger("mousemove-filtered",e)})),this.dropdown.on("mousemove-filtered",".select2-results",this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",".select2-results",this.bind((function(t){this._touchEvent=!0,this.highlightUnderEvent(t)}))),this.dropdown.on("touchmove",".select2-results",this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",".select2-results",this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind((function(t){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())}))),function(t,e){var i=w(t,(function(t){e.trigger("scroll-debounced",t)}));e.on("scroll",(function(t){m(t.target,e.get())>=0&&i(t)}))}(80,this.results),this.dropdown.on("scroll-debounced",".select2-results",this.bind(this.loadMoreIfNeeded)),t(this.container).on("change",".select2-input",(function(t){t.stopPropagation()})),t(this.dropdown).on("change",".select2-input",(function(t){t.stopPropagation()})),t.fn.mousewheel&&i.mousewheel((function(t,e,n,s){var o=i.scrollTop();s>0&&o-s<=0?(i.scrollTop(0),C(t)):s<0&&i.get(0).scrollHeight-i.scrollTop()+s<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),C(t))})),y(n),n.on("keyup-change input paste",this.bind(this.updateResults)),n.on("focus",(function(){n.addClass("select2-focused")})),n.on("blur",(function(){n.removeClass("select2-focused")})),this.dropdown.on("mouseup",".select2-results",this.bind((function(e){t(e.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(e),this.selectHighlighted(e))}))),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",(function(t){t.stopPropagation()})),this.nextSearchTerm=void 0,t.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==e.maximumInputLength&&this.search.attr("maxlength",e.maximumInputLength);var s=e.element.prop("disabled");void 0===s&&(s=!1),this.enable(!s);var r=e.element.prop("readonly");void 0===r&&(r=!1),this.readonly(r),l=l||function(){var e=t("<div class='select2-measure-scrollbar'></div>");e.appendTo("body");var i={width:e.width()-e[0].clientWidth,height:e.height()-e[0].clientHeight};return e.remove(),i}(),this.autofocus=e.element.prop("autofocus"),e.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",e.searchInputPlaceholder)},destroy:function(){var t=this.opts.element,e=t.data("select2"),i=this;this.close(),t.length&&t[0].detachEvent&&t.each((function(){this.detachEvent("onpropertychange",i._sync)})),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,void 0!==e&&(e.container.remove(),e.liveRegion.remove(),e.dropdown.remove(),t.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?t.attr({tabindex:this.elementTabIndex}):t.removeAttr("tabindex"),t.show()),A.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(t){return t.is("option")?{id:t.prop("value"),text:t.text(),element:t.get(),css:t.attr("class"),disabled:t.prop("disabled"),locked:g(t.attr("locked"),"locked")||g(t.data("locked"),!0)}:t.is("optgroup")?{text:t.attr("label"),children:[],element:t.get(),css:t.attr("class")}:void 0},prepareOpts:function(e){var i,n,s,r,a=this;if("select"===(i=e.element).get(0).tagName.toLowerCase()&&(this.select=n=e.element),n&&t.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],(function(){if(this in e)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")})),"function"!=typeof(e=t.extend({},{populateResults:function(i,n,s){var r,l=this.opts.id,h=this.liveRegion;(r=function(i,n,c){var u,d,p,f,m,g,v,b,y,w,C=[];for(u=0,d=(i=e.sortResults(i,n,s)).length;u<d;u+=1)f=!(m=!0===(p=i[u]).disabled)&&void 0!==l(p),g=p.children&&p.children.length>0,(v=t("<li></li>")).addClass("select2-results-dept-"+c),v.addClass("select2-result"),v.addClass(f?"select2-result-selectable":"select2-result-unselectable"),m&&v.addClass("select2-disabled"),g&&v.addClass("select2-result-with-children"),v.addClass(a.opts.formatResultCssClass(p)),v.attr("role","presentation"),(b=t(document.createElement("div"))).addClass("select2-result-label"),b.attr("id","select2-result-label-"+o()),b.attr("role","option"),void 0!==(w=e.formatResult(p,b,s,a.opts.escapeMarkup))&&(b.html(w),v.append(b)),g&&((y=t("<ul></ul>")).addClass("select2-result-sub"),r(p.children,y,c+1),v.append(y)),v.data("select2-data",p),C.push(v[0]);n.append(C),h.text(e.formatMatches(i.length))})(n,i,0)}},t.fn.select2.defaults,e)).id&&(s=e.id,e.id=function(t){return t[s]}),t.isArray(e.element.data("select2Tags"))){if("tags"in e)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+e.element.attr("id");e.tags=e.element.data("select2Tags")}if(n?(e.query=this.bind((function(t){var e,n,s,o={results:[],more:!1},r=t.term;s=function(e,i){var n;e.is("option")?t.matcher(r,e.text(),e)&&i.push(a.optionToData(e)):e.is("optgroup")&&(n=a.optionToData(e),e.children().each2((function(t,e){s(e,n.children)})),n.children.length>0&&i.push(n))},e=i.children(),void 0!==this.getPlaceholder()&&e.length>0&&(n=this.getPlaceholderOption())&&(e=e.not(n)),e.each2((function(t,e){s(e,o.results)})),t.callback(o)})),e.id=function(t){return t.id}):"query"in e||("ajax"in e?((r=e.element.data("ajax-url"))&&r.length>0&&(e.ajax.url=r),e.query=E.call(e.element,e.ajax)):"data"in e?e.query=k(e.data):"tags"in e&&(e.query=T(e.tags),void 0===e.createSearchChoice&&(e.createSearchChoice=function(e){return{id:t.trim(e),text:t.trim(e)}}),void 0===e.initSelection&&(e.initSelection=function(i,n){var s=[];t(v(i.val(),e.separator)).each((function(){var i={id:this,text:this},n=e.tags;t.isFunction(n)&&(n=n()),t(n).each((function(){if(g(this.id,i.id))return i=this,!1})),s.push(i)})),n(s)}))),"function"!=typeof e.query)throw"query function not defined for Select2 "+e.element.attr("id");if("top"===e.createSearchChoicePosition)e.createSearchChoicePosition=function(t,e){t.unshift(e)};else if("bottom"===e.createSearchChoicePosition)e.createSearchChoicePosition=function(t,e){t.push(e)};else if("function"!=typeof e.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return e},monitorSource:function(){var e,i=this.opts.element,n=this;i.on("change.select2",this.bind((function(t){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()}))),this._sync=this.bind((function(){var t=i.prop("disabled");void 0===t&&(t=!1),this.enable(!t);var e=i.prop("readonly");void 0===e&&(e=!1),this.readonly(e),x(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(D(this.opts.containerCssClass,this.opts.element)),x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(D(this.opts.dropdownCssClass,this.opts.element))})),i.length&&i[0].attachEvent&&i.each((function(){this.attachEvent("onpropertychange",n._sync)})),void 0!==(e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new e((function(e){t.each(e,n._sync)})),this.propertyObserver.observe(i.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(e){var i=t.Event("select2-selecting",{val:this.id(e),object:e,choice:e});return this.opts.element.trigger(i),!i.isDefaultPrevented()},triggerChange:function(e){e=e||{},e=t.extend({},e,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(e),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var t=this._enabled&&!this._readonly,e=!t;return t!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",e),this.close(),this.enabledInterface=t,!0)},enable:function(t){void 0===t&&(t=!0),this._enabled!==t&&(this._enabled=t,this.opts.element.prop("disabled",!t),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(t){void 0===t&&(t=!1),this._readonly!==t&&(this._readonly=t,this.opts.element.prop("readonly",t),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var e,i,n,s,o,r=this.dropdown,a=this.container.offset(),h=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=r.outerHeight(!1),d=t(window),p=d.width(),f=d.height(),m=d.scrollLeft()+p,g=d.scrollTop()+f,v=a.top+h,b=a.left,y=v+u<=g,w=a.top-u>=d.scrollTop(),C=r.outerWidth(!1),x=b+C<=m;r.hasClass("select2-drop-above")?(i=!0,!w&&y&&(n=!0,i=!1)):(i=!1,!y&&w&&(n=!0,i=!0)),n&&(r.hide(),a=this.container.offset(),h=this.container.outerHeight(!1),c=this.container.outerWidth(!1),u=r.outerHeight(!1),m=d.scrollLeft()+p,g=d.scrollTop()+f,v=a.top+h,x=(b=a.left)+(C=r.outerWidth(!1))<=m,r.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(o=t(".select2-results",r)[0],r.addClass("select2-drop-auto-width"),r.css("width",""),(C=r.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:l.width))>c?c=C:C=c,u=r.outerHeight(!1),x=b+C<=m):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(v-=(e=this.body.offset()).top,b-=e.left),x||(b=a.left+this.container.outerWidth(!1)-C),s={left:b,width:c},i?(s.top=a.top-u,s.bottom="auto",this.container.addClass("select2-drop-above"),r.addClass("select2-drop-above")):(s.top=v,s.bottom="auto",this.container.removeClass("select2-drop-above"),r.removeClass("select2-drop-above")),s=t.extend(s,D(this.opts.dropdownCss,this.opts.element)),r.css(s)},shouldOpen:function(){var e;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(e=t.Event("select2-opening"),this.opts.element.trigger(e),!e.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),a.on("mousemove.select2Event",(function(t){c.x=t.pageX,c.y=t.pageY})),!0)},opening:function(){var e,i=this.containerEventName,n="scroll."+i,s="resize."+i,o="orientationchange."+i;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0==(e=t("#select2-drop-mask")).length&&((e=t(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),e.hide(),e.appendTo(this.body),e.on("mousedown touchstart click",(function(i){p(e);var n,s=t("#select2-drop");s.length>0&&((n=s.data("select2")).opts.selectOnBlur&&n.selectHighlighted({noFocus:!0}),n.close(),i.preventDefault(),i.stopPropagation())}))),this.dropdown.prev()[0]!==e[0]&&this.dropdown.before(e),t("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop");let r=this.container[0].childNodes[0].childNodes[1].style.fontSize;this.dropdown.attr("style","font-size:"+r),e.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var a=this;this.container.parents().add(window).each((function(){t(this).on(s+" "+n+" "+o,(function(t){a.opened()&&a.positionDropdown()}))}))},close:function(){if(this.opened()){var e=this.containerEventName,i="scroll."+e,n="resize."+e,s="orientationchange."+e;this.container.parents().add(window).each((function(){t(this).off(i).off(n).off(s)})),this.clearDropdownAlignmentPreference(),t("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),a.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(t.Event("select2-close"))}},externalSearch:function(t){this.open(),this.search.val(t),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return D(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var e,i,n,s,o,r,a,l,h=this.results;(i=this.highlight())<0||(0!=i?(e=this.findHighlightableChoices().find(".select2-result-label"),s=(l=((n=t(e[i])).offset()||{}).top||0)+n.outerHeight(!0),i===e.length-1&&(a=h.find("li.select2-more-results")).length>0&&(s=a.offset().top+a.outerHeight(!0)),s>(o=h.offset().top+h.outerHeight(!0))&&h.scrollTop(h.scrollTop()+(s-o)),(r=l-h.offset().top)<0&&"none"!=n.css("display")&&h.scrollTop(h.scrollTop()+r)):h.scrollTop(0))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(e){for(var i=this.findHighlightableChoices(),n=this.highlight();n>-1&&n<i.length;){var s=t(i[n+=e]);if(s.hasClass("select2-result-selectable")&&!s.hasClass("select2-disabled")&&!s.hasClass("select2-selected")){this.highlight(n);break}}},highlight:function(e){var i,n,s=this.findHighlightableChoices();if(0===arguments.length)return m(s.filter(".select2-highlighted")[0],s.get());e>=s.length&&(e=s.length-1),e<0&&(e=0),this.removeHighlight(),(i=t(s[e])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",i.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(i.text()),(n=i.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(n),choice:n})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(e){var i=t(e.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var n=this.findHighlightableChoices();this.highlight(n.index(i))}else 0==i.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var t=this.results,e=t.find("li.select2-more-results"),i=this.resultsPage+1,n=this,s=this.search.val(),o=this.context;0!==e.length&&e.offset().top-t.offset().top-t.height()<=this.opts.loadMorePadding&&(e.addClass("select2-active"),this.opts.query({element:this.opts.element,term:s,page:i,context:o,matcher:this.opts.matcher,callback:this.bind((function(r){n.opened()&&(n.opts.populateResults.call(this,t,r.results,{term:s,page:i,context:o}),n.postprocessResults(r,!1,!1),!0===r.more?(e.detach().appendTo(t).text(D(n.opts.formatLoadMore,n.opts.element,i+1)),window.setTimeout((function(){n.loadMoreIfNeeded()}),10)):e.remove(),n.positionDropdown(),n.resultsPage=i,n.context=r.context,this.opts.element.trigger({type:"select2-loaded",items:r}))}))}))},tokenize:function(){},updateResults:function(e){var i,n,s,o=this.search,r=this.results,a=this.opts,l=this,h=o.val(),c=t.data(this.container,"select2-last-term");if((!0===e||!c||!g(h,c))&&(t.data(this.container,"select2-last-term",h),!0===e||!1!==this.showSearchInput&&this.opened())){s=++this.queryCount;var u=this.getMaximumSelectionSize();if(!(u>=1&&(i=this.data(),t.isArray(i)&&i.length>=u&&$(a.formatSelectionTooBig,"formatSelectionTooBig"))))return o.val().length<a.minimumInputLength?($(a.formatInputTooShort,"formatInputTooShort")?p("<li class='select2-no-results'>"+D(a.formatInputTooShort,a.element,o.val(),a.minimumInputLength)+"</li>"):p(""),void(e&&this.showSearch&&this.showSearch(!0))):void(a.maximumInputLength&&o.val().length>a.maximumInputLength?$(a.formatInputTooLong,"formatInputTooLong")?p("<li class='select2-no-results'>"+D(a.formatInputTooLong,a.element,o.val(),a.maximumInputLength)+"</li>"):p(""):(a.formatSearching&&0===this.findHighlightableChoices().length&&p("<li class='select2-searching'>"+D(a.formatSearching,a.element)+"</li>"),o.addClass("select2-active"),this.removeHighlight(),null!=(n=this.tokenize())&&null!=n&&o.val(n),this.resultsPage=1,a.query({element:a.element,term:o.val(),page:this.resultsPage,context:null,matcher:a.matcher,callback:this.bind((function(i){var n;s==this.queryCount&&(this.opened()?void 0!==i.hasError&&$(a.formatAjaxError,"formatAjaxError")?p("<li class='select2-ajax-error'>"+D(a.formatAjaxError,a.element,i.jqXHR,i.textStatus,i.errorThrown)+"</li>"):(this.context=void 0===i.context?null:i.context,this.opts.createSearchChoice&&""!==o.val()&&null!=(n=this.opts.createSearchChoice.call(l,o.val(),i.results))&&void 0!==l.id(n)&&null!==l.id(n)&&0===t(i.results).filter((function(){return g(l.id(this),l.id(n))})).length&&this.opts.createSearchChoicePosition(i.results,n),0===i.results.length&&$(a.formatNoMatches,"formatNoMatches")?p("<li class='select2-no-results'>"+D(a.formatNoMatches,a.element,o.val())+"</li>"):(r.empty(),l.opts.populateResults.call(this,r,i.results,{term:o.val(),page:this.resultsPage,context:null}),!0===i.more&&$(a.formatLoadMore,"formatLoadMore")&&(r.append("<li class='select2-more-results'>"+a.escapeMarkup(D(a.formatLoadMore,a.element,this.resultsPage))+"</li>"),window.setTimeout((function(){l.loadMoreIfNeeded()}),10)),this.postprocessResults(i,e),d(),this.opts.element.trigger({type:"select2-loaded",items:i}))):this.search.removeClass("select2-active"))}))})));p("<li class='select2-selection-limit'>"+D(a.formatSelectionTooBig,a.element,u)+"</li>")}function d(){o.removeClass("select2-active"),l.positionDropdown(),r.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?l.liveRegion.text(r.text()):l.liveRegion.text(l.opts.formatMatches(r.find(".select2-result-selectable").length))}function p(t){r.html(t),d()}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){var t;(t=this.search)[0]!==document.activeElement&&window.setTimeout((function(){var e,i=t[0],n=t.val().length;t.focus(),(i.offsetWidth>0||i.offsetHeight>0)&&i===document.activeElement&&(i.setSelectionRange?i.setSelectionRange(n,n):i.createTextRange&&((e=i.createTextRange()).collapse(!1),e.select()))}),0)},selectHighlighted:function(t){if(this._touchMoved)this.clearTouchMoved();else{var e=this.highlight(),i=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");i?(this.highlight(e),this.onSelect(i,t)):t&&t.noFocus&&this.close()}},getPlaceholder:function(){var t;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||(void 0!==(t=this.getPlaceholderOption())?t.text():void 0)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(void 0!==this.opts.placeholderOption)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===t.trim(e.text())&&""===e.val())return e}},initContainerWidth:function(){var e=function(){var e,i,n,s,o;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(void 0!==(e=this.opts.element.attr("style")))for(s=0,o=(i=e.split(";")).length;s<o;s+=1)if(null!==(n=i[s].replace(/\s/g,"").match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&n.length>=1)return n[1];return"resolve"===this.opts.width?(e=this.opts.element.css("width")).indexOf("%")>0?e:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}return t.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==e&&this.container.css("width",e)}}),n=O(i,{createContainer:function(){return t(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1' style=height:"+this.select[0].style.height+">","   <span class='select2-chosen' style='font-size:"+this.select[0].parentNode.style.fontSize+"'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var e,i,n;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(e=this.search.get(0)).createTextRange?((i=e.createTextRange()).collapse(!1),i.select()):e.setSelectionRange&&(n=this.search.val().length,e.setSelectionRange(n,n))),""===this.search.val()&&null!=this.nextSearchTerm&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(t.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){t("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),A.call(this,"selection","focusser")},initContainer:function(){var e,i,n=this.container,s=this.dropdown,r=o();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=e=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),e.find(".select2-chosen").attr("id","select2-chosen-"+r),this.focusser.attr("aria-labelledby","select2-chosen-"+r),this.results.attr("id","select2-results-"+r),this.search.attr("aria-owns","select2-results-"+r),this.focusser.attr("id","s2id_autogen"+r),i=t("label[for='"+this.opts.element.attr("id")+"']"),this.focusser.prev().text(i.text()).attr("for",this.focusser.attr("id"));var a=this.opts.element.attr("title");this.opts.element.attr("title",a||i.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(t("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind((function(t){if(this.isInterfaceEnabled()&&229!=t.keyCode)if(t.which!==u.PAGE_UP&&t.which!==u.PAGE_DOWN)switch(t.which){case u.UP:case u.DOWN:return this.moveHighlight(t.which===u.UP?-1:1),void C(t);case u.ENTER:return this.selectHighlighted(),void C(t);case u.TAB:return void this.selectHighlighted({noFocus:!0});case u.ESC:return this.cancel(t),void C(t)}else C(t)}))),this.search.on("blur",this.bind((function(t){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind((function(){this.opened()&&this.search.focus()})),0)}))),this.focusser.on("keydown",this.bind((function(t){if(this.isInterfaceEnabled()&&t.which!==u.TAB&&!u.isControl(t)&&!u.isFunctionKey(t)&&t.which!==u.ESC){if(!1!==this.opts.openOnEnter||t.which!==u.ENTER){if(t.which==u.DOWN||t.which==u.UP||t.which==u.ENTER&&this.opts.openOnEnter){if(t.altKey||t.ctrlKey||t.shiftKey||t.metaKey)return;return this.open(),void C(t)}return t.which==u.DELETE||t.which==u.BACKSPACE?(this.opts.allowClear&&this.clear(),void C(t)):void 0}C(t)}}))),y(this.focusser),this.focusser.on("keyup-change input",this.bind((function(t){if(this.opts.minimumResultsForSearch>=0){if(t.stopPropagation(),this.opened())return;this.open()}}))),e.on("mousedown touchstart","abbr",this.bind((function(t){var e;this.isInterfaceEnabled()&&(this.clear(),(e=t).preventDefault(),e.stopImmediatePropagation(),this.close(),this.selection.focus())}))),e.on("mousedown touchstart",this.bind((function(i){p(e),this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),C(i)}))),s.on("mousedown touchstart",this.bind((function(){this.opts.shouldFocusInput(this)&&this.search.focus()}))),e.on("focus",this.bind((function(t){C(t)}))),this.focusser.on("focus",this.bind((function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")}))).on("blur",this.bind((function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(t.Event("select2-blur")))}))),this.search.on("focus",this.bind((function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active")}))),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(e){var i=this.selection.data("select2-data");if(i){var n=t.Event("select2-clearing");if(this.opts.element.trigger(n),n.isDefaultPrevented())return;var s=this.getPlaceholderOption();this.opts.element.val(s?s.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==e&&(this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var t=this;this.opts.initSelection.call(null,this.opts.element,(function(e){null!=e&&(t.updateSelection(e),t.close(),t.setPlaceholder(),t.nextSearchTerm=t.opts.nextSearchTerm(e,t.search.val()))}))}},isPlaceholderOptionSelected:function(){var t;return void 0!==this.getPlaceholder()&&(void 0!==(t=this.getPlaceholderOption())&&t.prop("selected")||""===this.opts.element.val()||void 0===this.opts.element.val()||null===this.opts.element.val())},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=t.find("option").filter((function(){return this.selected&&!this.disabled}));e(i.optionToData(n))}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var s=i.val(),o=null;e.query({matcher:function(t,i,n){var r=g(s,e.id(n));return r&&(o=n),r},callback:t.isFunction(n)?function(){n(o)}:t.noop})}),e},getPlaceholder:function(){if(!this.select||void 0!==this.getPlaceholderOption())return this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var t=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&void 0!==t){if(this.select&&void 0===this.getPlaceholderOption())return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(t)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,i,n){var s=0,o=this;if(this.findHighlightableChoices().each2((function(t,e){if(g(o.id(e.data("select2-data")),o.opts.element.val()))return s=t,!1})),!1!==n&&(!0===i&&s>=0?this.highlight(s):this.highlight(0)),!0===i){var r=this.opts.minimumResultsForSearch;r>=0&&this.showSearch(function e(i){var n=0;return t.each(i,(function(t,i){i.children?n+=e(i.children):n++})),n}(e.results)>=r)}},showSearch:function(e){this.showSearchInput!==e&&(this.showSearchInput=e,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!e),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!e),t(this.dropdown,this.container).toggleClass("select2-with-searchbox",e))},onSelect:function(t,e){if(this.triggerSelect(t)){var i=this.opts.element.val(),n=this.data();this.opts.element.val(this.id(t)),this.updateSelection(t),this.opts.element.trigger({type:"select2-selected",val:this.id(t),choice:t}),this.nextSearchTerm=this.opts.nextSearchTerm(t,this.search.val()),this.close(),e&&e.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),g(i,this.id(t))||this.triggerChange({added:t,removed:n})}},updateSelection:function(t){var e,i,n=this.selection.find(".select2-chosen");this.selection.data("select2-data",t),n.empty(),null!==t&&(e=this.opts.formatSelection(t,n,this.opts.escapeMarkup)),void 0!==e&&n.append(e),void 0!==(i=this.opts.formatSelectionCssClass(t,n))&&n.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&void 0!==this.getPlaceholder()&&this.container.addClass("select2-allowclear")},val:function(){var t,e=!1,i=null,n=this,s=this.data();if(0===arguments.length)return this.opts.element.val();if(t=arguments[0],arguments.length>1&&(e=arguments[1]),this.select)this.select.val(t).find("option").filter((function(){return this.selected})).each2((function(t,e){return i=n.optionToData(e),!1})),this.updateSelection(i),this.setPlaceholder(),e&&this.triggerChange({added:i,removed:s});else{if(!t&&0!==t)return void this.clear(e);if(void 0===this.opts.initSelection)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(t),this.opts.initSelection(this.opts.element,(function(t){n.opts.element.val(t?n.id(t):""),n.updateSelection(t),n.setPlaceholder(),e&&n.triggerChange({added:t,removed:s})}))}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(t){var e,i=!1;if(0===arguments.length)return null==(e=this.selection.data("select2-data"))&&(e=null),e;arguments.length>1&&(i=arguments[1]),t?(e=this.data(),this.opts.element.val(t?this.id(t):""),this.updateSelection(t),i&&this.triggerChange({added:t,removed:e})):this.clear(i)}}),s=O(i,{createContainer:function(){return t(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var e=this.parent.prepareOpts.apply(this,arguments),i=this;return"select"===e.element.get(0).tagName.toLowerCase()?e.initSelection=function(t,e){var n=[];t.find("option").filter((function(){return this.selected&&!this.disabled})).each2((function(t,e){n.push(i.optionToData(e))})),e(n)}:"data"in e&&(e.initSelection=e.initSelection||function(i,n){var s=v(i.val(),e.separator),o=[];e.query({matcher:function(i,n,r){var a=t.grep(s,(function(t){return g(t,e.id(r))})).length;return a&&o.push(r),a},callback:t.isFunction(n)?function(){for(var t=[],i=0;i<s.length;i++)for(var r=s[i],a=0;a<o.length;a++){var l=o[a];if(g(r,e.id(l))){t.push(l),o.splice(a,1);break}}n(t)}:t.noop})}),e},selectChoice:function(t){var e=this.container.find(".select2-search-choice-focus");e.length&&t&&t[0]==e[0]||(e.length&&this.opts.element.trigger("choice-deselected",e),e.removeClass("select2-search-choice-focus"),t&&t.length&&(this.close(),t.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",t)))},destroy:function(){t("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),A.call(this,"searchContainer","selection")},initContainer:function(){var e,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=e=this.container.find(i);var n=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",(function(e){n.search[0].focus(),n.selectChoice(t(this))})),this.search.attr("id","s2id_autogen"+o()),this.search.prev().text(t("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("input paste",this.bind((function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())}))),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind((function(i){if(this.isInterfaceEnabled()){++this.keydowns;var n=e.find(".select2-search-choice-focus"),s=n.prev(".select2-search-choice:not(.select2-locked)"),o=n.next(".select2-search-choice:not(.select2-locked)"),r=function(e){var i=0,n=0;if("selectionStart"in(e=t(e)[0]))i=e.selectionStart,n=e.selectionEnd-i;else if("selection"in document){e.focus();var s=document.selection.createRange();n=document.selection.createRange().text.length,s.moveStart("character",-e.value.length),i=s.text.length-n}return{offset:i,length:n}}(this.search);if(n.length&&(i.which==u.LEFT||i.which==u.RIGHT||i.which==u.BACKSPACE||i.which==u.DELETE||i.which==u.ENTER)){var a=n;return i.which==u.LEFT&&s.length?a=s:i.which==u.RIGHT?a=o.length?o:null:i.which===u.BACKSPACE?this.unselect(n.first())&&(this.search.width(10),a=s.length?s:o):i.which==u.DELETE?this.unselect(n.first())&&(this.search.width(10),a=o.length?o:null):i.which==u.ENTER&&(a=null),this.selectChoice(a),C(i),void(a&&a.length||this.open())}if((i.which===u.BACKSPACE&&1==this.keydowns||i.which==u.LEFT)&&0==r.offset&&!r.length)return this.selectChoice(e.find(".select2-search-choice:not(.select2-locked)").last()),void C(i);if(this.selectChoice(null),this.opened())switch(i.which){case u.UP:case u.DOWN:return this.moveHighlight(i.which===u.UP?-1:1),void C(i);case u.ENTER:return this.selectHighlighted(),void C(i);case u.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case u.ESC:return this.cancel(i),void C(i)}if(i.which!==u.TAB&&!u.isControl(i)&&!u.isFunctionKey(i)&&i.which!==u.BACKSPACE&&i.which!==u.ESC){if(i.which===u.ENTER){if(!1===this.opts.openOnEnter)return;if(i.altKey||i.ctrlKey||i.shiftKey||i.metaKey)return}this.open(),i.which!==u.PAGE_UP&&i.which!==u.PAGE_DOWN||C(i),i.which===u.ENTER&&C(i)}}}))),this.search.on("keyup",this.bind((function(t){this.keydowns=0,this.resizeSearch()}))),this.search.on("blur",this.bind((function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),e.stopImmediatePropagation(),this.opts.element.trigger(t.Event("select2-blur"))}))),this.container.on("click",i,this.bind((function(e){this.isInterfaceEnabled()&&(t(e.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.open(),this.focusSearch(),e.preventDefault()))}))),this.container.on("focus",i,this.bind((function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(t.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())}))),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var t=this;this.opts.initSelection.call(null,this.opts.element,(function(e){null!=e&&(t.updateSelection(e),t.close(),t.clearSearch())}))}},clearSearch:function(){var t=this.getPlaceholder(),e=this.getMaxSearchWidth();void 0!==t&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(t).addClass("select2-default"),this.search.width(e>0?e:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),""===this.search.val()&&null!=this.nextSearchTerm&&(this.search.val(this.nextSearchTerm),this.search.select()),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(t.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(e){var i=[],n=[],s=this;t(e).each((function(){m(s.id(this),i)<0&&(i.push(s.id(this)),n.push(this))})),e=n,this.selection.find(".select2-search-choice").remove(),t(e).each((function(){s.addSelectedChoice(this)})),s.postprocessResults()},tokenize:function(){var t=this.search.val();null!=(t=this.opts.tokenizer.call(this,t,this.data(),this.bind(this.onSelect),this.opts))&&null!=t&&(this.search.val(t),t.length>0&&this.open())},onSelect:function(t,e){this.triggerSelect(t)&&""!==t.text&&(this.addSelectedChoice(t),this.opts.element.trigger({type:"selected",val:this.id(t),choice:t}),this.nextSearchTerm=this.opts.nextSearchTerm(t,this.search.val()),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(t,!1,!0===this.opts.closeOnSelect),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):null!=this.nextSearchTerm&&(this.search.val(this.nextSearchTerm),this.updateResults(),this.search.select()),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:t}),e&&e.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(e){var i,n,s=!e.locked,o=t("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),r=t("<li class='select2-search-choice select2-locked'><div></div></li>"),a=s?o:r,l=this.id(e),h=this.getVal();null!=(i=this.opts.formatSelection(e,a.find("div"),this.opts.escapeMarkup))&&a.find("div").replaceWith("<div>"+i+"</div>"),null!=(n=this.opts.formatSelectionCssClass(e,a.find("div")))&&a.addClass(n),s&&a.find(".select2-search-choice-close").on("mousedown",C).on("click dblclick",this.bind((function(e){this.isInterfaceEnabled()&&(this.unselect(t(e.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),C(e),this.close(),this.focusSearch())}))).on("focus",this.bind((function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))}))),a.data("select2-data",e),a.insertBefore(this.searchContainer),h.push(l),this.setVal(h)},unselect:function(e){var i,n,s=this.getVal();if(0===(e=e.closest(".select2-search-choice")).length)throw"Invalid argument: "+e+". Must be .select2-search-choice";if(i=e.data("select2-data")){var o=t.Event("select2-removing");if(o.val=this.id(i),o.choice=i,this.opts.element.trigger(o),o.isDefaultPrevented())return!1;for(;(n=m(this.id(i),s))>=0;)s.splice(n,1),this.setVal(s),this.select&&this.postprocessResults();return e.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(i),choice:i}),this.triggerChange({removed:i}),!0}},postprocessResults:function(t,e,i){var n=this.getVal(),s=this.results.find(".select2-result"),o=this.results.find(".select2-result-with-children"),r=this;s.each2((function(t,e){m(r.id(e.data("select2-data")),n)>=0&&(e.addClass("select2-selected"),e.find(".select2-result-selectable").addClass("select2-selected"))})),o.each2((function(t,e){e.is(".select2-result-selectable")||0!==e.find(".select2-result-selectable:not(.select2-selected)").length||e.addClass("select2-selected")})),-1==this.highlight()&&!1!==i&&r.highlight(0),!this.opts.createSearchChoice&&!s.filter(".select2-result:not(.select2-selected)").length>0&&(!t||t&&!t.more&&0===this.results.find(".select2-no-results").length)&&$(r.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+D(r.opts.formatNoMatches,r.opts.element,r.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-b(this.search)},resizeSearch:function(){var e,i,n,s,o=b(this.search);e=function(e){if(!r){var i=e[0].currentStyle||window.getComputedStyle(e[0],null);(r=t(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),t("body").append(r)}return r.text(e.val()),r.width()}(this.search)+10,i=this.search.offset().left,(s=(n=this.selection.width())-(i-this.selection.offset().left)-o)<e&&(s=n-o),s<40&&(s=n-o),s<=0&&(s=e),this.search.width(Math.floor(s))},getVal:function(){var t;return this.select?null===(t=this.select.val())?[]:t:v(t=this.opts.element.val(),this.opts.separator)},setVal:function(e){var i;this.select?this.select.val(e):(i=[],t(e).each((function(){m(this,i)<0&&i.push(this)})),this.opts.element.val(0===i.length?"":i.join(this.opts.separator)))},buildChangeDetails:function(t,e){e=e.slice(0),t=t.slice(0);for(var i=0;i<e.length;i++)for(var n=0;n<t.length;n++)g(this.opts.id(e[i]),this.opts.id(t[n]))&&(e.splice(i,1),i>0&&i--,t.splice(n,1),n--);return{added:e,removed:t}},val:function(e,i){var n,s=this;if(0===arguments.length)return this.getVal();if((n=this.data()).length||(n=[]),!e&&0!==e)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:n}));if(this.setVal(e),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(n,this.data()));else{if(void 0===this.opts.initSelection)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,(function(e){var o=t.map(e,s.id);s.setVal(o),s.updateSelection(e),s.clearSearch(),i&&s.triggerChange(s.buildChangeDetails(n,s.data()))}))}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var e=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each((function(){e.push(i.opts.id(t(this).data("select2-data")))})),this.setVal(e),this.triggerChange()},data:function(e,i){var n,s,o=this;if(0===arguments.length)return this.selection.children(".select2-search-choice").map((function(){return t(this).data("select2-data")})).get();s=this.data(),e||(e=[]),n=t.map(e,(function(t){return o.opts.id(t)})),this.setVal(n),this.updateSelection(e),this.clearSearch(),i&&this.triggerChange(this.buildChangeDetails(s,this.data()))}}),t.fn.select2=function(){var e,i,n,s,o,r=Array.prototype.slice.call(arguments,0),a=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],l=["opened","isFocused","container","dropdown"],h=["val","data"],c={search:"externalSearch"};return this.each((function(){if(0===r.length||"object"==typeof r[0])(e=0===r.length?{}:t.extend({},r[0])).element=t(this),"select"===e.element.get(0).tagName.toLowerCase()?o=e.element.prop("multiple"):(o=e.multiple||!1,"tags"in e&&(e.multiple=o=!0)),(i=o?new window.Select2.class.multi:new window.Select2.class.single).init(e);else{if("string"!=typeof r[0])throw"Invalid arguments to select2 plugin: "+r;if(m(r[0],a)<0)throw"Unknown method: "+r[0];if(s=void 0,void 0===(i=t(this).data("select2")))return;if("container"===(n=r[0])?s=i.container:"dropdown"===n?s=i.dropdown:(c[n]&&(n=c[n]),s=i[n].apply(i,r.slice(1))),m(r[0],l)>=0||m(r[0],h)>=0&&1==r.length)return!1}})),void 0===s?this:s},t.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(t,e,i,n){var s=[];return S(t.text,i.term,s,n),s.join("")},formatSelection:function(t,e,i){return t?i(t.text):void 0},sortResults:function(t,e,i){return t},formatResultCssClass:function(t){return t.css},formatSelectionCssClass:function(t,e){},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(t){return null==t?null:t.id},matcher:function(t,e){return f(""+e).toUpperCase().indexOf(f(""+t).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:function(t,e,i,n){var s,o,r,a,l,h=t,c=!1;if(n.createSearchChoice&&n.tokenSeparators&&!(n.tokenSeparators.length<1)){for(;;){for(o=-1,r=0,a=n.tokenSeparators.length;r<a&&(l=n.tokenSeparators[r],!((o=t.indexOf(l))>=0));r++);if(o<0)break;if(s=t.substring(0,o),t=t.substring(o+l.length),s.length>0&&null!=(s=n.createSearchChoice.call(this,s,e))&&void 0!==n.id(s)&&null!==n.id(s)){for(c=!1,r=0,a=e.length;r<a;r++)if(g(n.id(s),n.id(e[r]))){c=!0;break}c||i(s)}}return h!==t?t:void 0}},escapeMarkup:_,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(t){return t},adaptDropdownCssClass:function(t){return null},nextSearchTerm:function(t,e){},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(t){return!("ontouchstart"in window||navigator.msMaxTouchPoints>0)||!(t.opts.minimumResultsForSearch<0)}},t.fn.select2.locales=[],t.fn.select2.locales.en={formatMatches:function(t){return 1===t?"One result is available, press enter to select it.":t+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(t,e,i){return"Loading failed"},formatInputTooShort:function(t,e){var i=e-t.length;return"Please enter "+i+" or more character"+(1==i?"":"s")},formatInputTooLong:function(t,e){var i=t.length-e;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(t){return"You can only select "+t+" item"+(1==t?"":"s")},formatLoadMore:function(t){return"Loading more results…"},formatSearching:function(){return"Searching…"}},t.extend(t.fn.select2.defaults,t.fn.select2.locales.en),t.fn.select2.ajaxDefaults={transport:t.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:E,local:k,tags:T},util:{debounce:w,markMatch:S,escapeMarkup:_,stripDiacritics:f},class:{abstract:i,single:n,multi:s}}}function p(e){var i=t(document.createTextNode(""));e.before(i),i.before(e),i.remove()}function f(t){return t.replace(/[^\u0000-\u007E]/g,(function(t){return d[t]||t}))}function m(t,e){for(var i=0,n=e.length;i<n;i+=1)if(g(t,e[i]))return i;return-1}function g(t,e){return t===e||void 0!==t&&void 0!==e&&(null!==t&&null!==e&&(t.constructor===String?t+""==e+"":e.constructor===String&&e+""==t+""))}function v(e,i){var n,s,o;if(null===e||e.length<1)return[];for(s=0,o=(n=e.split(i)).length;s<o;s+=1)n[s]=t.trim(n[s]);return n}function b(t){return t.outerWidth(!1)-t.width()}function y(e){var i="keyup-change-value";e.on("keydown",(function(){void 0===t.data(e,i)&&t.data(e,i,e.val())})),e.on("keyup",(function(){var n=t.data(e,i);void 0!==n&&e.val()!==n&&(t.removeData(e,i),e.trigger("keyup-change"))}))}function w(t,e,i){var n;return i=i||void 0,function(){var s=arguments;window.clearTimeout(n),n=window.setTimeout((function(){e.apply(i,s)}),t)}}function C(t){t.preventDefault(),t.stopPropagation()}function x(e,i,n){var s,o,r=[];(s=t.trim(e.attr("class")))&&t((s=""+s).split(/\s+/)).each2((function(){0===this.indexOf("select2-")&&r.push(this)})),(s=t.trim(i.attr("class")))&&t((s=""+s).split(/\s+/)).each2((function(){0!==this.indexOf("select2-")&&(o=n(this))&&r.push(o)})),e.attr("class",r.join(" "))}function S(t,e,i,n){var s=f(t.toUpperCase()).indexOf(f(e.toUpperCase())),o=e.length;s<0?i.push(n(t)):(i.push(n(t.substring(0,s))),i.push("<span class='select2-match'>"),i.push(n(t.substring(s,s+o))),i.push("</span>"),i.push(n(t.substring(s+o,t.length))))}function _(t){var e={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(t).replace(/[&<>"'\/\\]/g,(function(t){return e[t]}))}function E(e){var i,n=null,s=e.quietMillis||100,o=e.url,r=this;return function(a){window.clearTimeout(i),i=window.setTimeout((function(){var i=e.data,s=o,l=e.transport||t.fn.select2.ajaxDefaults.transport,h={type:e.type||"GET",cache:e.cache||!1,jsonpCallback:e.jsonpCallback||void 0,dataType:e.dataType||"json"},c=t.extend({},t.fn.select2.ajaxDefaults.params,h);i=i?i.call(r,a.term,a.page,a.context):null,s="function"==typeof s?s.call(r,a.term,a.page,a.context):s,n&&"function"==typeof n.abort&&n.abort(),e.params&&(t.isFunction(e.params)?t.extend(c,e.params.call(r)):t.extend(c,e.params)),t.extend(c,{url:s,dataType:e.dataType,data:i,success:function(t){var i=e.results(t,a.page,a);a.callback(i)},error:function(t,e,i){var n={hasError:!0,jqXHR:t,textStatus:e,errorThrown:i};a.callback(n)}}),n=l.call(r,c)}),s)}}function k(e){var i,n,s=e,o=function(t){return""+t.text};t.isArray(s)&&(s={results:n=s}),!1===t.isFunction(s)&&(n=s,s=function(){return n});var r=s();return r.text&&(o=r.text,t.isFunction(o)||(i=r.text,o=function(t){return t[i]})),function(e){var i,n=e.term,r={results:[]};""!==n?(i=function(s,r){var a,l;if((s=s[0]).children){for(l in a={},s)s.hasOwnProperty(l)&&(a[l]=s[l]);a.children=[],t(s.children).each2((function(t,e){i(e,a.children)})),(a.children.length||e.matcher(n,o(a),s))&&r.push(a)}else e.matcher(n,o(s),s)&&r.push(s)},t(s().results).each2((function(t,e){i(e,r.results)})),e.callback(r)):e.callback(s())}}function T(e){var i=t.isFunction(e);return function(n){var s=n.term,o={results:[]},r=i?e(n):e;t.isArray(r)&&(t(r).each((function(){var t=void 0!==this.text,e=t?this.text:this;(""===s||n.matcher(s,e))&&o.results.push(t?this:{id:this,text:this})})),n.callback(o))}}function $(e,i){if(t.isFunction(e))return!0;if(!e)return!1;if("string"==typeof e)return!0;throw new Error(i+" must be a string, function, or falsy value")}function D(e,i){if(t.isFunction(e)){var n=Array.prototype.slice.call(arguments,2);return e.apply(i,n)}return e}function A(){var e=this;t.each(arguments,(function(t,i){e[i].remove(),e[i]=null}))}function O(e,i){var n=function(){};return(n.prototype=new e).constructor=n,n.prototype.parent=e.prototype,n.prototype=t.extend(n.prototype,i),n}}(jQuery),function(t,e){"use strict";var i=function(t,e){this.init("radiocheck",t,e)};i.DEFAULTS={checkboxClass:"custom-checkbox",radioClass:"custom-radio",checkboxTemplate:'<span class="icons"><span class="icon-unchecked"></span><span class="icon-checked"></span></span>',radioTemplate:'<span class="icons"><span class="icon-unchecked"></span><span class="icon-checked"></span></span>'},i.prototype.init=function(t,n,s){this.$element=e(n),this.options=e.extend({},i.DEFAULTS,this.$element.data(),s),"checkbox"==this.$element.attr("type")?(this.$element.addClass(this.options.checkboxClass),this.$element.after(this.options.checkboxTemplate)):"radio"==this.$element.attr("type")&&(this.$element.addClass(this.options.radioClass),this.$element.after(this.options.radioTemplate))},i.prototype.check=function(){this.$element.prop("checked",!0),this.$element.trigger("change.radiocheck").trigger("checked.radiocheck")},i.prototype.uncheck=function(){this.$element.prop("checked",!1),this.$element.trigger("change.radiocheck").trigger("unchecked.radiocheck")},i.prototype.toggle=function(){this.$element.prop("checked",(function(t,e){return!e})),this.$element.trigger("change.radiocheck").trigger("toggled.radiocheck")},i.prototype.indeterminate=function(){this.$element.prop("indeterminate",!0),this.$element.trigger("change.radiocheck").trigger("indeterminated.radiocheck")},i.prototype.determinate=function(){this.$element.prop("indeterminate",!1),this.$element.trigger("change.radiocheck").trigger("determinated.radiocheck")},i.prototype.disable=function(){this.$element.prop("disabled",!0),this.$element.trigger("change.radiocheck").trigger("disabled.radiocheck")},i.prototype.enable=function(){this.$element.prop("disabled",!1),this.$element.trigger("change.radiocheck").trigger("enabled.radiocheck")},i.prototype.destroy=function(){this.$element.removeData().removeClass(this.options.checkboxClass+" "+this.options.radioClass).next(".icons").remove(),this.$element.trigger("destroyed.radiocheck")};var n=e.fn.radiocheck;e.fn.radiocheck=function(n){return this.each((function(){var s=e(this),o=s.data("radiocheck"),r="object"==typeof n&&n;(o||"destroy"!=n)&&(o||s.data("radiocheck",o=new i(this,r)),"string"==typeof n&&o[n](),!0===/mobile|tablet|phone|ip(ad|od)|android|silk|webos/i.test(t.navigator.userAgent)&&s.parent().hover((function(){s.addClass("nohover")}),(function(){s.removeClass("nohover")})))}))},e.fn.radiocheck.Constructor=i,e.fn.radiocheck.noConflict=function(){return e.fn.radiocheck=n,this}}(this,jQuery);
function widgetsPluginsHandlerClass(){var i=[],e=[],n=[],t=[],o=0;function s(i){for(var n in e){var t=_.keys(e[n].pluginDefinition.widgetsDefinitionList);if(_.contains(t,i))return e[n]}}return{loadWidgetPlugin:function(s){var d=s.pluginDefinition;n[o]=d,i[o]=d.name,e[o]=s,_.each(_.keys(d.widgetsDefinitionList),i=>{t[i]=d.widgetsDefinitionList[i]}),o++},createWidget:function(i,e,n,t){var o=s(e);if(!_.isUndefined(o))return o.createWidget(i,e,n,t);console.log(e+" does not exist. Create widget failed")},copyWidget:function(i,e,n,t,o){var d=s(e);if(!_.isUndefined(d))return d.copyWidget(i,e,n,t,o);console.log(e+" does not exist. Copy widget failed")},widgetToolbarDefinitions:t}}var widgetsPluginsHandler=new widgetsPluginsHandlerClass;
let bRescaleNeededForModeSwitch=!1,currentDashboardScrollTop=0;function showEditMode(e,o){"widgets"==tabActive?"edit-dashboard"!=modeActive?("play-dashboard"==modeActive&&(currentDashboardScrollTop=$("#DropperDroitec").scrollTop()),$("#dashboard-preview-div").hide(0,(function(){$("#dashboard-editor-div").show(0,(function(){$("#dashboard-editor-div").removeClass("ng-hide"),switchToEditMode(e,o),setIsPlayModeStatus(!1)}))}))):switchToEditMode(e,o):console.log("showEditMode called while tabActive="+tabActive)}function showPlayMode(e){switchToPlayMode(e)}function switchToEditMode(e,o){if(bFirstExec){const e=getMedia();widgetEditor.setLastMedia(e)}e&&widgetEditor.resizeDashboard(),gridMgr.updateGrid(),document.dispatchEvent(tabWidgetsLoadedEvt),bFirstExec&&(bFirstExec=!1,widgetEditor.computeDropperMaxWidth()),modeActive="edit-dashboard",_.isUndefined(o)||o(),$("#DropperDroite").scrollTop(currentDashboardScrollTop)}function switchToPlayMode(){let e={};"edit-dashboard"==modeActive?(widgetEditor.updateSnapshotDashZoneDims(),e=xdash.serialize(),currentDashboardScrollTop=$("#DropperDroite").scrollTop(),widgetPreview.setScalingInformation(null,widgetEditor.getCurrentDashZoneDims().scalingMethod,layoutMgr.getRows(),layoutMgr.getCols()),widgetEditor.unselectAllWidgets(),$("#dashboard-editor-div").hide(0,(function(){$("#dashboard-preview-div").show(0,(function(){$("#dashboard-preview-div").removeClass("ng-hide");try{widgetPreview.loadPlayMode(e)}catch(e){console.log(e)}layoutMgr.makeColsTrasparent(),modeActive="play-dashboard",setIsPlayModeStatus(!0),$("#DropperDroitec").scrollTop(currentDashboardScrollTop),document.dispatchEvent(tabPlayLoadedEvt)}))}))):console.log("bad modeActive : "+modeActive+". Unable to switch to Play mode")}function setIsPlayModeStatus(e){const o=angular.element(document.body).scope().$root;o.bIsPlayMode!=e&&(o.bIsPlayMode=e,o.$apply())}function setEditPlaySwitchDisableStatus(e){const o=angular.element(document.body).scope().$root;o.bDisableEditPlaySwitch!=e&&(o.bDisableEditPlaySwitch=e,o.$apply())}
var offSchedLogUser=!0,ratioScroll=0,models={};modelsHiddenParams={},modelsTempParams={},modelsParameters={},modelsLayout={};try{var tabWidgetsLoadedEvt=new Event("widgets-tab-loaded"),tabPlayLoadedEvt=new Event("play-tab-loaded")}catch(e){}Date.prototype.today=function(){return(this.getDate()<10?"0":"")+this.getDate()+"/"+(this.getMonth()+1<10?"0":"")+(this.getMonth()+1)+"/"+this.getFullYear()},Date.prototype.timeNow=function(){return(this.getHours()<10?"0":"")+this.getHours()+":"+(this.getMinutes()<10?"0":"")+this.getMinutes()+":"+(this.getSeconds()<10?"0":"")+this.getSeconds()+":"+this.getMilliseconds()};var bFirstExec=!0,ua=navigator.userAgent.toLowerCase(),isAndroid=ua.indexOf("android")>-1;function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}var isTouchDevice=isTouchDevice();function activeTab(){tabActive="widgets",setEditPlaySwitchDisableStatus(!1),"no-dashboard"==modeActive?(bRescaleNeededForModeSwitch=!0,showEditMode(!0,(function(){}))):console.log("tabActive="+tabActive+". modeActive="+modeActive)}function rescaleWidget(e,t){e[t].rescale()}function setDirtyFlagSafe(e){try{if("undefined"!=typeof execOutsideEditor){if(!execOutsideEditor)angular.element(document.body).scope().$root.updateFlagDirty(e)}else angular.element(document.body).scope().$root.updateFlagDirty(e)}catch(e){}}$((function(){$(window).on("resize",(function(){var e=angular.element(document.body).scope().$root;"play"==tabActive?isAndroid||isTouchDevice||widgetPreview.resizeDashboard():e.moduleOpened||"widgets"==tabActive&&("edit-dashboard"==modeActive?(widgetEditor.resizeDashboard(),gridMgr.updateGrid()):"play-dashboard"==modeActive&&widgetPreview.resizeDashboard())})),isAndroid||isTouchDevice||$(window).on("orientationchange",(function(){"play"==tabActive&&widgetPreview.resizeDashboard()}))})),window.mobileAndTabletCheck=function(){let e=!1;var t;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e};
class WidgetPrototypesManager{static SCHEMA_VERSION="http://json-schema.org/draft-07/schema#";static ID_URI_SCHEME="json-schema:";static SCHEMA_ANYTHING={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:anything"};static SCHEMA_STRING={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:string",type:"string"};static SCHEMA_NUMBER={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:number",type:"number"};static SCHEMA_STRING_ARRAY={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:string_array",type:"array",items:{type:"string"}};static SCHEMA_NUMBER_ARRAY={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:number_array",type:"array",items:{type:"number"}};static SCHEMA_NUMBER_ARRAY_2D={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:number_array_2d",type:"array",items:{type:"array",items:{type:"number"}}};static SCHEMA_PRIMITIVE_ARRAY={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:primitives_array",type:"array",items:{anyOf:[{type:"string"},{type:"number"},{type:"boolean"}]}};static SCHEMA_INTEGER={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:integer",type:"integer"};static SCHEMA_BOOLEAN={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:boolean",type:"boolean"};static SCHEMA_ANY_PRIMITIVE={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:primitives",anyOf:[{type:"string"},{type:"number"},{type:"boolean"}]};static SCHEMA_ANY_OBJECT={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:object",type:"object"};static SCHEMA_NUMBER_OR_STRING={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:number_or_string",anyOf:[{type:"string"},{type:"number"}]};constructor(){this.ajv=new ajv7}getOrCompile(t){if(Array.isArray(t)){for(const e of t){const t=e.$id;this.ajv.getSchema(t)||this.ajv.addSchema(e)}return this.ajv.getSchema(t[0].$id)}const e=t.$id,a=this.ajv.getSchema(e);return a||this.ajv.compile(t)}formatErrors(t){const e=this;function a(t){return["anyOf","oneOf","allOf"].includes(t.keyword)}function r(t,e){let a=t.message;return"anyOf"===t.keyword?a="One the the following must be true":"const"===t.keyword&&void 0!==t.params.allowedValue&&(a=`${a} "${t.params.allowedValue}"`),new WidgetActuatorValidationError(t.instancePath?`"${t.instancePath}": ${a}`:a,e)}function s(t,a){return r(t,a=e.formatErrors(a))}let o,i=[];for(t=_.sortBy(t,t=>t.schemaPath.length);o=t.find(a);){const e=o.schemaPath,a=[],r=[];for(const s of t)s!==o&&(s.schemaPath.startsWith(e)?a.push(s):r.push(s));i.push(s(o,a)),t=r}return i=[...i,...t.map(t=>r(t,[]))],i=i.sort((t,e)=>t.compareTo(e)),i.filter((t,e,a)=>0===e||0!==t.compareTo(a[e-1]))}}var widgetPrototypesManager=new WidgetPrototypesManager;
var workOnViewport=!0;function unitW(t){var e=(t*(100/document.documentElement.clientWidth)).toPrecision(23);return e+="vw"}function unitH(t){var e=(t*(100/document.documentElement.clientHeight)).toPrecision(23);return e+="vh"}function convertVwtoPx(t){return(t=rmUnit(t))/100*document.documentElement.clientWidth}function convertVhtoPx(t){return(t=rmUnit(t))/100*document.documentElement.clientHeight}function convertViewportToPx(t){return{left:convertVwtoPx(t.left),top:convertVhtoPx(t.top),width:convertVwtoPx(t.width),height:convertVhtoPx(t.height),minWidth:t.minWidth,minHeight:t.minHeight}}function inheritWcWidthFromPx(t){return(t-2)*(100/document.documentElement.clientWidth)+"vw"}function inheritWcHeightFromPx(t){return(t-2)*(100/document.documentElement.clientHeight)+"vh"}function inheritWcWidthFromIdInst(t){var e=t;return"play"==tabActive&&(e+="c"),inheritWcWidthFromPx($("#"+e).width)}function inheritWcHeightFromIdInst(t){var e=t;return"play"==tabActive&&(e+="c"),inheritWcHeightFromPx($("#"+e).height)}function getMedia(){return window.matchMedia("(min-width: 768px)").matches?"large":"small"}function isMediaChanged(t){var e=!1;return"small"==t&&window.matchMedia("(min-width: 768px)").matches?(t="large",e=!0):"large"==t&&window.matchMedia("(max-width: 767px)").matches?(t="small",e=!0):e=!1,{bChanged:e,lastMedia:t}}function getFontFactor(){return"play"==tabActive?window.matchMedia("(min-width: 768px)").matches?1:widgetPreview.getCols()||1:"widgets"==tabActive?window.matchMedia("(min-width: 768px)").matches?1:layoutMgr.getCols()||1:1}
function basePlugin(i){i&&(this.pluginDefinition=i),this.widgetsCount={},Object.keys(this.pluginDefinition.widgetsDefinitionList).forEach(i=>this.widgetsCount[i]=0),this.createWidget=function(i,t,n,e){this.widgetsCount[t]++;const s=this.pluginDefinition.widgetsDefinitionList[t].factory;return new("function"==typeof s?s:this[s])(i,this.widgetsCount[t],n,e)},this.copyWidget=function(i,t,n,e,s){return this.createWidget(i,t,e,s)},this.clear=function(){Object.keys(this.pluginDefinition.widgetsDefinitionList).forEach(i=>this.widgetsCount[i]=0)}}
function baseWidget(e,o,t,r){this.idDivContainer=e,this.idWidget=o,this.idInstance=t,this.bIsInteractive=r,this.getColorValueFromCSSProperty=function(e){let o=e;if(o.includes("var(--")){const t=e.substring(4,e.length-1);o=window.getComputedStyle(document.documentElement).getPropertyValue(t)}return o},this.setColorValueFromModelParameters=function(e,o){let r=o;_.isUndefined(modelsParameters[t][e])?modelsParameters[t][e]=o:r=modelsParameters[t][e];return this.getColorValueFromCSSProperty(r)},this.labelFontSize=function(){return"font-size: calc(7px + "+modelsParameters[t].labelFontSize*getFontFactor()+"vw + 0.4vh); "},this.valueFontSize=function(){return"font-size: calc(7px + "+modelsParameters[t].valueFontSize*getFontFactor()+"vw + 0.4vh); "},this.valueFormat=function(e){const o=parseInt(modelsParameters[t].decimalDigits,10);if(isNaN(o))return e;let r=e;if(-1!=o&&!isNaN(e)){if(r=parseFloat(e),isNaN(r))return e;r=Math.round10(r,-o)}return r},this.fontSize=function(){return"font-size: calc(7px + "+modelsParameters[t].fontsize*getFontFactor()+"vw + 0.4vh); "},this.labelColor=function(){return"color:"+this.setColorValueFromModelParameters("labelColor","var(--widget-label-color)")+"; "},this.valueColor=function(){return"color:"+this.setColorValueFromModelParameters("valueColor","var(--widget-color)")+"; "},this.labelFontFamily=function(){_.isUndefined(modelsParameters[t].labelFontFamily)&&(modelsParameters[t].labelFontFamily="Helvetica Neue");return"font-family: "+modelsParameters[t].labelFontFamily+", Helvetica, Arial, sans-serif; "},this.valueFontFamily=function(){_.isUndefined(modelsParameters[t].valueFontFamily)&&(modelsParameters[t].valueFontFamily="Helvetica Neue");return"font-family: "+modelsParameters[t].valueFontFamily+", Helvetica, Arial, sans-serif; "},this.border=function(){let e="border: none; ";if(modelsParameters[t].displayBorder){e="border: 2px solid "+this.setColorValueFromModelParameters("borderColor","var(--widget-border-color)")+"; "}else e+=NaN,e+="-moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);",e+="box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);";return e},this.captionHelper=function(e,o,r){o?modelsParameters[t].label=e:r?modelsParameters[t].inheritLabelFromData=!1:modelsParameters[t].label=e},this.backgroundColor=function(){return"background-color:"+this.setColorValueFromModelParameters("backgroundColor","#ffffff")+"; "},this.getTransformedText=function(e){let o=modelsParameters[t][e]||"";if(o){if(!($("<div>").html(o).children().length>0)){o=(new DOMParser).parseFromString("<!doctype html><body>"+o,"text/html").body.textContent}}return o},this.buttonFontFamily=function(){_.isUndefined(modelsParameters[t].buttonFontFamily)&&(modelsParameters[t].buttonFontFamily="Helvetica Neue");return"font-family: "+modelsParameters[t].buttonFontFamily+", Helvetica, Arial, sans-serif; "},this.setButtonColorStyle=function(){const e=this.setColorValueFromModelParameters("buttonDefaultColor","var(--widget-button-color)"),o=this.setColorValueFromModelParameters("buttonHoverColor","var(--widget-button-hover-color)"),l=this.setColorValueFromModelParameters("buttonActiveColor","var(--widget-button-active-color)"),a=this.setColorValueFromModelParameters("buttonTextColor","var(--widget-button-text)"),s="styleNormalFor"+t+"widgetCustomColor";let n=document.getElementById(s);const i="."+t+"widgetCustomColor{ color: "+a+";background-color: "+e+";border-color: "+e+"; }";if(null==n?(n=document.createElement("style"),n.type="text/css",n.id=s,n.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(n)):n.innerHTML=i,r){const e="styleHoverFor"+t+"widgetCustomColor";let r=document.getElementById(e);const a="."+t+"widgetCustomColor:hover{ background-color: "+o+";border-color: "+o+";}";null==r?(r=document.createElement("style"),r.type="text/css",r.id=e,r.innerHTML=a,document.getElementsByTagName("head")[0].appendChild(r)):r.innerHTML=a;const s="styleActiveFor"+t+"widgetCustomColor";let n=document.getElementById(s);const i="."+t+"widgetCustomColor:active{ background-color: "+l+";border-color: "+l+";}";null==n?(n=document.createElement("style"),n.type="text/css",n.id=s,n.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(n)):n.innerHTML=i}},this.displayIcon=function(){return _.isUndefined(modelsParameters[t].displayIcon)&&(modelsParameters[t].displayIcon=!1),modelsParameters[t].displayIcon},this.fontAwesomeIcon=function(){return _.isUndefined(modelsParameters[t].fontAwesomeIcon)&&(modelsParameters[t].fontAwesomeIcon=""),modelsParameters[t].fontAwesomeIcon},this.validationButtonDefaultColor=function(){return"background-color:"+this.setColorValueFromModelParameters("validationBtnDefaultColor","var(--widget-button-primary-color)")+"; "},this.validationButtonHoverColor=function(){return"background-color:"+this.setColorValueFromModelParameters("validationBtnHoverColor","var(--widget-button-hover-color)")+"; "},this.validationButtonActiveColor=function(){return"background-color:"+this.setColorValueFromModelParameters("validationBtnActiveColor","var(--widget-button-active-color)")+"; "},this.validationButtonBorderColor=function(){let e="border: none; ";if(modelsParameters[t].displayBorder){e="border: 2px solid "+this.setColorValueFromModelParameters("validationBtnDefaultColor","var(--widget-border-color)")+"; "}else e+="-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);",e+="-moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);",e+="box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);";return e},this.graphColor=function(){return this.setColorValueFromModelParameters("graphColor","var(--widget-label-color)")},this.subLabelFontFamily=function(){_.isUndefined(modelsParameters[t].subLabelFontFamily)&&(modelsParameters[t].subLabelFontFamily="Helvetica Neue");return"font-family: "+modelsParameters[t].subLabelFontFamily+", Helvetica, Arial, sans-serif; "},this.subLabelColor=function(){return"color:"+this.setColorValueFromModelParameters("subLabelColor","var(--widget-subtext-color)")+"; "},this.subLabelFontSize=function(){return"font-size: calc(7px + "+modelsParameters[t].subLabelFontSize*getFontFactor()+"vw + 0.4vh); "},this.checkedColor=function(){_.isUndefined(modelsParameters[t].checkboxColor)||delete modelsParameters[t].checkboxColor;return"color: "+this.setColorValueFromModelParameters("checkedColor","var(--widget-input-checked-color)")+"; "},this.uncheckedColor=function(){return"color: "+this.setColorValueFromModelParameters("uncheckedColor","var(--widget-input-unchecked-color)")+"; "},this.switchOnColor=function(){return"background-color: "+this.setColorValueFromModelParameters("switchOnColor","var(--widget-input-checked-color)")+"; "},this.switchOffColor=function(){return"background-color: "+this.setColorValueFromModelParameters("switchOffColor","var(--widget-input-unchecked-color)")+"; "},this.switchShadowColor=function(){return"box-shadow: 0 0 1px "+this.setColorValueFromModelParameters("switchOnColor","var(--widget-input-checked-color)")+"; "},this.progressBarRangeColor=function(){return"background-color: "+this.setColorValueFromModelParameters("progressBarRangeColor","var(--widget-range-color)")+"; "},this.progressBarSegmentColor=function(){return"background-color: "+this.setColorValueFromModelParameters("progressBarSegmentColor","var(--widget-segment-color)")+"; "},this.sliderRangeColor=function(){return"background-color: "+this.setColorValueFromModelParameters("sliderRangeColor","var(--widget-range-color)")+"; "},this.sliderSegmentColor=function(){return"background-color: "+this.setColorValueFromModelParameters("sliderSegmentColor","var(--widget-segment-color)")+"; "},this.sliderHandleDefaultColor=function(){return"background-color: "+this.setColorValueFromModelParameters("sliderHandleDefaultColor","var(--widget-handle-default-color)")+"; "},this.sliderHandleHoverColor=function(){return"background-color: "+this.setColorValueFromModelParameters("sliderHandleHoverColor","var(--widget-handle-hover-color)")+"; "},this.sliderHandleActiveColor=function(){return"background-color: "+this.setColorValueFromModelParameters("sliderHandleActiveColor","var(--widget-handle-active-color)")+"; "},this.valueBorderColor=function(){return"border-color: "+this.setColorValueFromModelParameters("valueBorderColor","var(--widget-border-color)")+"; "},this.textSize=function(){return"font-size: calc(7px + "+modelsParameters[t].textSize*getFontFactor()+"vw + 0.4vh); "},this.textColor=function(){return"color: "+this.setColorValueFromModelParameters("textColor","var(--widget-color)")+"; "},this.subTextColor=function(){return"color: "+this.setColorValueFromModelParameters("subTextColor","var(--widget-color)")+"; "},this.browseButtonTextColor=function(){const e=this.setColorValueFromModelParameters("browseButtonTextColor","var(--widget-button-text)");let o=" color: "+e+"; ";return o+=" border-color: "+e+"; ",o},this.browseButtonDefaultColor=function(){return" background-color: "+this.setColorValueFromModelParameters("browseButtonDefaultColor","var(--widget-button-color)")+"; "},this.browseButtonHoverColor=function(){return" background-color: "+this.setColorValueFromModelParameters("browseButtonHoverColor","var(--widget-button-hover-color)")+"; "},this.browseButtonActiveColor=function(){return" background-color: "+this.setColorValueFromModelParameters("browseButtonActiveColor","var(--widget-button-active-color)")+"; "},this.deleteButtonDefaultColor=function(){const e=this.setColorValueFromModelParameters("deleteButtonDefaultColor","var(--widget-delete-button-default-color)");let o=" background-color: "+e+"; ";return o+=" box-shadow: 0 0 2px 3px "+e+"; ",o},this.deleteButtonActiveColor=function(){const e=this.setColorValueFromModelParameters("deleteButtonActiveColor","var(--widget-delete-button-active-color)");let o=" background-color: "+e+"; ";return o+=" box-shadow: 0 0 2px 3px "+e+"; ",o},this.deleteButtonHoverColor=function(){const e=this.setColorValueFromModelParameters("deleteButtonHoverColor","var(--widget-delete-button-hover-color)");let o=" background-color: "+e+"; ";return o+=" box-shadow: 0 0 2px 3px "+e+"; ",o},this.listBackgroundColor=function(){return" background-color: "+this.setColorValueFromModelParameters("listBackgroundColor","var(--widget-select-drop-color)")+"; "},this.selectValueColor=function(){return" color: "+this.setColorValueFromModelParameters("selectValueColor","var(--widget-select-option-highlighted-text)")+"; "},this.selectValueBackgroundColor=function(){return" background-color: "+this.setColorValueFromModelParameters("selectValueBackgroundColor","var(--widget-select-option-highlighted-color)")+"; "},this.valueDefaultColor=function(){return" color: "+this.setColorValueFromModelParameters("valueDefaultColor","var(--widget-label-color)")+"; "},this.valueFocusColor=function(){return" color: "+this.setColorValueFromModelParameters("valueFocusColor","var(--widget-multiselect-checked-text)")+"; "},this.valueHoverColor=function(){return" color: "+this.setColorValueFromModelParameters("valueHoverColor","var(--widget-multiselect-hover-text)")+"; "},this.checkboxDefaultColor=function(){return" background-color: "+this.setColorValueFromModelParameters("checkboxDefaultColor","var(--widget-multiselect-color)")+"; "},this.checkboxFocusColor=function(){return" background-color: "+this.setColorValueFromModelParameters("checkboxFocusColor","var(--widget-multiselect-checked-color)")+"; "},this.checkboxHoverColor=function(){return" background-color: "+this.setColorValueFromModelParameters("checkboxHoverColor","var(--widget-multiselect-hover-color)")+"; "},this.checkboxHoverBorderColor=function(){return" border-color: "+this.setColorValueFromModelParameters("checkboxHoverBorderColor","var(--widget-multiselect-hover-border-color)")+"; "},this.checkboxFocusBorderColor=function(){return" border-color: "+this.setColorValueFromModelParameters("checkboxFocusBorderColor","var(--widget-multiselect-checked-border-color)")+"; "},this.checkboxWidth=function(){_.isUndefined(modelsParameters[t].checkboxWidth)&&(modelsParameters[t].checkboxWidth=7);return" width: "+modelsParameters[t].checkboxWidth+"rem; "},this.checkboxHeight=function(){_.isUndefined(modelsParameters[t].checkboxHeight)&&(modelsParameters[t].checkboxHeight=1.5);return" line-height: "+modelsParameters[t].checkboxHeight+"; "},this.checkboxBorder=function(){let e="border: none; ";if(modelsParameters[t].displayBorder){e=" border: 1.5px solid "+this.setColorValueFromModelParameters("checkboxBorderColor","var(--widget-multiselect-border-color)")+"; "}else e+="-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);",e+="-moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);",e+="box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0);";return e},this.selectFontSize=function(){_.isUndefined(modelsParameters[t].selectValueFontSize)&&(modelsParameters[t].selectValueFontSize=modelsParameters[t].labelFontSize);return"font-size: calc(7px + "+modelsParameters[t].selectValueFontSize*getFontFactor()+"vw + 0.4vh); "},this.selectValueFontFamily=function(){_.isUndefined(modelsParameters[t].selectValueFontFamily)&&(modelsParameters[t].selectValueFontFamily="Helvetica Neue");return"font-family: "+modelsParameters[t].selectValueFontFamily+", Helvetica, Arial, sans-serif; "},this.selectedValueColor=function(){return" color: "+this.setColorValueFromModelParameters("selectedValueColor","var(--widget-select-option-highlighted-text)")+"; "},this.selectedItemDefaultColor=function(){return" background-color: "+this.setColorValueFromModelParameters("selectedItemDefaultColor","var(--widget-select-option-highlighted-color)")+"; "},this.selectedItemHoverColor=function(){return" background-color: "+this.setColorValueFromModelParameters("selectedItemHoverColor","var(--widget-select-option-highlighted-color)")+"; "},this.valueAlign=function(){_.isUndefined(modelsParameters[t].ValueAlign)||delete modelsParameters[t].ValueAlign,_.isUndefined(modelsParameters[t].valueAlign)&&(modelsParameters[t].valueAlign="left");return" text-align: "+modelsParameters[t].valueAlign+"; "},this.tableBackgroundColor=function(e){_.isUndefined(modelsParameters[t].backgroundColor)&&(modelsParameters[t].backgroundColor={primary:"var(--widget-color-0)",secondary:"var(--widget-table-striped-odd)"});return" background-color: "+this.getColorValueFromCSSProperty(modelsParameters[t].backgroundColor[e])+"; "},this.thicknessBackgroundColor=function(){return' background-color="'+this.setColorValueFromModelParameters("thicknessBackgroundColor","var(--widget-segment-color)")+'" '},this.thicknessColor=function(){return' foreground-color="'+this.setColorValueFromModelParameters("thicknessColor","var(--widget-range-color)")+'" '},this.tipBackgroundColor=function(){return this.setColorValueFromModelParameters("tipBackgroundColor","var(--widget-button-color)")},this.tipBorderColor=function(){return this.setColorValueFromModelParameters("tipBorderColor","var(--widget-button-text)")}}baseWidget.prototype.getActuatorDescriptions=function(e=null){return[]},baseWidget.prototype.getByName=function(e){if(this.hasOwnProperty(e))return this[e]},baseWidget.prototype.getInteractive=function(){return this.bIsInteractive},baseWidget.prototype.setInteractive=function(e){e!=this.bIsInteractive&&(this.bIsInteractive=e,this.render())},baseWidget.prototype.rescale=function(){},baseWidget.prototype.render=function(){};class WidgetActuator{setValue(e){}getValue(){}addValueChangedHandler(e){}removeValueChangedHandler(e){}setCaption(e,o){}clearCaption(){}}class WidgetActuatorBase extends WidgetActuator{static NOOP_CALLBACK=function(e,o,t){};constructor(e){super(),this.widget=e}updateCallback=WidgetActuatorBase.NOOP_CALLBACK;addValueChangedHandler(e){this.updateDataFromWidget=e}removeValueChangedHandler(e){this.updateDataFromWidget=WidgetActuatorBase.NOOP_CALLBACK}}class WidgetActuatorDescription{static TRIGGER=0;static READ=1;static WRITE=2;static READ_WRITE=WidgetActuatorDescription.READ|WidgetActuatorDescription.WRITE;static FILE=4;constructor(e,o,t,r=null,l=null){this._name=e,this._summary=o,this._readwrite=t,this._schema=r,this._validator=l}get name(){return this._name}get summary(){return this._summary}get direction(){return this._readwrite}get jsonSchema(){return this._schema}get validator(){return this._validator}}class WidgetActuatorValidationError{constructor(e,o){this._msg=e,this._nested=o||[]}get msg(){return this._msg}get nested(){return this._nested}toString(){return this._print().join("\n")}_print(e=""){return[e+"- "+this._msg,...this._nested.flatMap(o=>o._print(e+"   "))]}compareTo(e){const o=this.msg.localeCompare(e.msg);if(0!==o)return o;const t=this.nested.length,r=t-e.nested.length;if(0!==r)return r;for(let o=0;o<t;o++){const t=this.nested[o].compareTo(e.nested[o]);if(0!==t)return t}return 0}}
function scoringWidgetsPluginClass(){var e=this,r=0;this.scoringFullCircularGauge=function(i,a,t,n){return r++,new e.scoringCircularGaugeWidget(i,r,t,n,"full")},this.scoringSemiCircularGauge=function(i,a,t,n){return r++,new e.scoringCircularGaugeWidget(i,r,t,n,"semi")},this.scoringArchCircularGauge=function(i,a,t,n){return r++,new e.scoringCircularGaugeWidget(i,r,t,n,"arch")},this.clear=function(){r=0},this.scoringCircularGaugeWidget=function(e,r,i,a,t){this.constructor(e,r,i,a,t);var n=this;this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},this.render=function(){var a=document.createElement("div");a.setAttribute("style","text-align: center; height: inherit; width: inherit; cursor: inherit"),a.setAttribute("id","div-for-ng-gauge"+r),$("#"+e).html(a);var o=Math.min($("#div-for-ng-gauge"+r).width(),$("#div-for-ng-gauge"+r).height()),l="gaugeValues.val"+r,u=angular.element('<ng-gauge id="ng-gauge'+r+'" style="'+this.valueColor()+'" size="'+o+'" type="'+t+'" thick="'+modelsParameters[i].thick+'" min="'+modelsParameters[i].min+'" max="'+modelsParameters[i].max+'" value="'+l+'"" cap="round" label="'+modelsParameters[i].label+'" duration="'+modelsParameters[i].duration+'"'+this.thicknessColor()+this.thicknessBackgroundColor()+'" append="'+modelsParameters[i].unit+'"></ng-gauge>'),g=document.getElementById("div-for-ng-gauge"+r);angular.element(g).append(u),angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,a){var t=angular.element(u).scope();a.gaugeValues||(a.gaugeValues={}),a.gaugeValues["val"+r]=modelsHiddenParams[i].value,e(u)(t)}]),this.bIsInteractive?n.enable():n.disable()};const o=new WidgetActuatorDescription("value","Numeric value",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER);this.getActuatorDescriptions=function(){return[o]},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[i].value=e,angular.element(document.body).injector().invoke(["$compile","$rootScope",function(i,a){a.gaugeValues["val"+r]=e,a.safeApply()}])},getValue:function(){return $("#ng-gauge"+r)[0].value},addValueChangedHandler:function(e){this.updateCallback=e,n.enable()},removeValueChangedHandler:function(e){n.disable()},setCaption:function(e,r){modelsParameters[i].inheritLabelFromData&&n.captionHelper(e,n.bIsInteractive,r)},clearCaption:function(){modelsParameters[i].label="",n.render()}},n.render()},this.scoringCircularGaugeWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"scoring",widgetsDefinitionList:{scoringFullCircularGauge:{factory:"scoringFullCircularGauge",title:"Full-circular gauge",icn:"full-circular-gauge",help:"wdg/wdg-scoring-gauge/"},scoringSemiCircularGauge:{factory:"scoringSemiCircularGauge",title:"Semi-circular gauge",icn:"semi-circular-gauge",help:"wdg/wdg-scoring-gauge/"},scoringArchCircularGauge:{factory:"scoringArchCircularGauge",title:"Arch-circular gauge",icn:"widgets icn-arch-circular-gauge",help:"wdg/wdg-scoring-gauge/"}}},this.constructor()}modelsHiddenParams.scoringFullCircularGauge={value:75},modelsHiddenParams.scoringSemiCircularGauge={value:75},modelsHiddenParams.scoringArchCircularGauge={value:75},modelsParameters.scoringFullCircularGauge={label:"",inheritLabelFromData:!0,min:0,max:100,unit:"",valueColor:"var(--widget-color)",thick:10,thicknessColor:"var(--widget-range-color)",duration:1500,thicknessBackgroundColor:"var(--widget-segment-color)"},modelsParameters.scoringSemiCircularGauge={label:"",inheritLabelFromData:!0,min:0,max:100,unit:"",valueColor:"var(--widget-color)",thick:10,thicknessColor:"var(--widget-range-color)",duration:1500,thicknessBackgroundColor:"var(--widget-segment-color)"},modelsParameters.scoringArchCircularGauge={label:"",inheritLabelFromData:!0,min:0,max:100,unit:"",valueColor:"var(--widget-color)",thick:10,thicknessColor:"var(--widget-range-color)",duration:1500,thicknessBackgroundColor:"var(--widget-segment-color)"},modelsLayout.scoringFullCircularGauge={height:"15vh",width:"11vw"},modelsLayout.scoringSemiCircularGauge={height:"15vh",width:"11vw"},modelsLayout.scoringArchCircularGauge={height:"15vh",width:"11vw"},scoringWidgetsPluginClass.prototype=basePlugin.prototype;var scoringWidgetsPlugin=new scoringWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(scoringWidgetsPlugin);
function annotationMarkdownWidgetsPluginClass(){this.markdownAnnotationWidget=function(t,n,e,i){this.constructor(t,n,e,i);var a=this;_.isUndefined(modelsParameters[e].textAlign)&&(modelsHiddenParams[e].textAlign="left"),this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},_.isUndefined(modelsParameters[e].centerVertically)&&(modelsParameters[e].centerVertically=!0),this.hasScrollBar=function(t){return t.get(0).scrollHeight>t.get(0).clientHeight},this.render=function(){var i=document.createElement("div"),o="",r='<div id="annotationMarkdownDiv'+n+'" class="defaultCSS" style="overflow: auto; background-color: transparent; box-shadow: none; width: inherit; height: inherit; color:'+modelsParameters[e].textColor+"; text-align: "+modelsParameters[e].textAlign+"; padding: 4px; resize: inherit; border-radius: 6px; "+this.fontSize()+this.valueFontFamily()+this.border()+'"><div style="'+o+'">'+marked.parse(modelsHiddenParams[e].text)+"</div></div>";i.innerHTML=r,i.setAttribute("style","width: inherit; height: inherit; background-color:"+modelsParameters[e].backgroundColor),$("#"+t).html(i);var d=a.hasScrollBar($("#annotationMarkdownDiv"+n));modelsParameters[e].centerVertically&&!d&&(o=" position: relative; top: 50%; -webkit-transform: translateY(-50%); -ms-transform: translateY(-50%); transform: translateY(-50%);",$("#annotationMarkdownDiv"+n+" div").attr("style",o))};const o=new WidgetActuatorDescription("text","Markdown content",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(){return[o]},this.text={setValue:function(t){modelsHiddenParams[e].text=t,a.render()},getValue:function(){return modelsHiddenParams[e].text},addValueChangedHandler:function(t){a.enable()},removeValueChangedHandler:function(t){a.disable()}},a.render()},this.markdownAnnotationWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"annotation",widgetsDefinitionList:{annotationMarkdown:{factory:"markdownAnnotationWidget",title:"Markdown",icn:"markdown",help:"wdg/wdg-annotation-video/#markdown"}}},this.constructor()}modelsHiddenParams.annotationMarkdown={text:""},modelsParameters.annotationMarkdown={fontsize:.3,backgroundColor:"rgba(0, 0, 0, 0)",textColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",textAlign:"left",displayBorder:!1,centerVertically:!0},modelsLayout.annotationMarkdown={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},annotationMarkdownWidgetsPluginClass.prototype=basePlugin.prototype;var annotationMarkdownWidgetsPlugin=new annotationMarkdownWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(annotationMarkdownWidgetsPlugin);
function genericHtmlWidgetPluginClass(){this.genericHtmlWidget=function(t,e,i,n){this.constructor(t,e,i,n);var r=this;_.isUndefined(modelsParameters[i].textAlign)&&(modelsHiddenParams[i].textAlign="left"),this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},_.isUndefined(modelsParameters[i].centerVertically)&&(modelsParameters[i].centerVertically=!0),this.hasScrollBar=function(t){return t.get(0).scrollHeight>t.get(0).clientHeight},this.render=function(){var n=document.createElement("div"),l="",a='<div id="htmlDiv'+e+'" class="defaultCSS" style="overflow: auto; background-color: transparent; box-shadow: none; width: inherit; height: inherit; color:'+modelsParameters[i].textColor+"; text-align: "+modelsParameters[i].textAlign+"; padding: 4px; resize: inherit; border-radius: 6px; "+this.fontSize()+this.valueFontFamily()+this.border()+'"><div style="'+l+'">'+modelsHiddenParams[i].html+"</div></div>";n.innerHTML=a,n.setAttribute("style","width: inherit; height: inherit; background-color:"+modelsParameters[i].backgroundColor),$("#"+t).html(n);var o=r.hasScrollBar($("#htmlDiv"+e));modelsParameters[i].centerVertically&&!o&&(l=" position: relative; top: 50%; -webkit-transform: translateY(-50%); -ms-transform: translateY(-50%); transform: translateY(-50%);",$("#htmlDiv"+e+" div").attr("style",l))};const l=new WidgetActuatorDescription("html","Html content",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(){return[l]},this.html={setValue:function(t){modelsHiddenParams[i].html=t,r.render()},getValue:function(){return modelsHiddenParams[i].html},addValueChangedHandler:function(t){r.enable()},removeValueChangedHandler:function(t){r.disable()}},r.render()},this.genericHtmlWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"annotation",widgetsDefinitionList:{annotationHtml:{factory:"genericHtmlWidget",title:"Generic html",icn:"generic-html",help:"wdg/wdg-annotation-video/#generic-html"}}},this.constructor()}modelsHiddenParams.annotationHtml={html:""},modelsParameters.annotationHtml={fontsize:.3,backgroundColor:"rgba(0, 0, 0, 0)",textColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",textAlign:"left",displayBorder:!1,centerVertically:!0},modelsLayout.annotationHtml={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},genericHtmlWidgetPluginClass.prototype=basePlugin.prototype;var genericHtmlWidgetPlugin=new genericHtmlWidgetPluginClass;widgetsPluginsHandler.loadWidgetPlugin(genericHtmlWidgetPlugin);
function kpiWidgetsPluginClass(){this.kpiCardWidget=function(e,t,a,i){this.constructor(e,t,a,i);var l=this,r="";this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},this.render=function(){var i=document.createElement("div");modelsParameters[a].borderShadow?i.setAttribute("class","card-kpi-container card-shadow"):i.setAttribute("class","card-kpi-container ");var n='<div class="card-kpi">';n+='<div class="card-body">',n+='<div class="row align-items-center">';var s="";if(modelsParameters[a].displayLabel){const e=this.getTransformedText("label");s=(s+='<h5 class="card-mt-0 text-truncate"')+' style="text-align:center;'+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+'">'+e,s+="</h5>"}var o="";o=(o=o+'<div id="card-value-'+t+'" class="card-value" style="text-align:center;')+this.valueFontSize()+this.valueColor()+this.valueFontFamily()+'"></div>',n="top"==modelsParameters[a].valuePosition?o+s:s+o,n+="</div>",n+="</div>",n+="</div>",i.innerHTML=n,$("#"+e).html(i),$("#card-value-"+t)[0].innerText=l.valueFormat(modelsHiddenParams[a].value),r='<span id ="unit-span'+t+'" style="text-align: left; color: '+modelsParameters[a].unitColor+"; font-size: calc(7px + "+modelsParameters[a].unitFontSize*getFontFactor()+'vw + 0.4vh);">'+modelsParameters[a].unit+"</span>",""!=modelsParameters[a].unit&&modelsParameters[a].displayUnit&&$("#card-value-"+t).append(r),this.bIsInteractive?l.enable():l.disable()};const n=new WidgetActuatorDescription("value","Current value",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_ANY_PRIMITIVE);this.getActuatorDescriptions=function(){return[n]},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[a].value=e,$("#card-value-"+t)[0].innerText=l.valueFormat(modelsHiddenParams[a].value),""!=modelsParameters[a].unit&&modelsParameters[a].displayUnit&&$("#card-value-"+t).append(r)},getValue:function(){return modelsHiddenParams[a].value},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()},setCaption:function(e,t){modelsParameters[a].inheritLabelFromData&&(l.captionHelper(e,l.bIsInteractive,t),l.render())},clearCaption:function(){modelsParameters[a].label="",l.render()}},l.render()},this.kpiCardWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"kpiCard",widgetsDefinitionList:{kpiCard:{factory:"kpiCardWidget",title:"KPI value",icn:"kpi"}}},this.constructor()}modelsHiddenParams.kpiCard={value:"--"},modelsParameters.kpiCard={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valuePosition:"bottom",valueFontSize:2,valueColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",decimalDigits:3,unit:"unitText",displayUnit:!1,unitFontSize:.5,unitColor:"var(--widget-label-color)",borderShadow:!1},modelsLayout.kpiCard={height:"16vh",width:"18vw",minWidth:"64px",minHeight:"32px"},kpiWidgetsPluginClass.prototype=basePlugin.prototype;var kpiWidgetsPlugin=new kpiWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(kpiWidgetsPlugin);
function advancedKpiWidgetsPluginClass(){this.advancedKpiCardWidget=function(a,e,t,i){this.constructor(a,e,t,i);var s=this;this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},this.initEcharts=function(a){modelsTempParams[t].echartsInstance=echarts.init(document.getElementById(a))},this.getEchartsData=function(){let a=Date.now()+1e3;return{name:a.toString(),value:[a,modelsHiddenParams[t].value]}},this.pushEchartsListData=function(a){modelsTempParams[t].echartsListData.push(a)},this.shiftEchartsListData=function(){modelsTempParams[t].echartsListData.shift()},this.getEchartsListData=function(){return modelsTempParams[t].echartsListData},this.getEchartsOptions=function(){return{xAxis:{type:"time",boundaryGap:!1,axisLabel:!1,axisLine:!1,splitLine:{show:!1}},yAxis:{type:"value",boundaryGap:["",""],axisLabel:!1,axisLine:!1,splitLine:{show:!1}},visualMap:{type:"continuous",show:!1,realtime:!0,inRange:{color:s.graphColor()}},grid:{left:0,top:0,right:0,bottom:0},series:[{type:"line",smooth:.25,showSymbol:!1,areaStyle:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:s.graphColor()},{offset:1,color:"#ffffff"}])},data:modelsTempParams[t].echartsListData}],animationDuration:0,animationDurationUpdate:1e3,animationEasing:"linear",animationEasingUpdate:"linear"}},this.initEchartsOptions=function(){let a=this.getEchartsOptions();try{modelsTempParams[t].echartsInstance.setOption(a)}catch(a){console.log(a)}},this.setEchartsOptions=function(a){modelsTempParams[t].echartsInstance.setOption({series:[{data:a}]})},this.updateEcharts=function(a){if(i)_.isUndefined(modelsTempParams[t].windowValue)&&(modelsTempParams[t].windowValue=modelsHiddenParams[t].window),this.initEcharts(a),this.initEchartsOptions(),-1==modelsHiddenParams[t].window?(this.pushEchartsListData(this.getEchartsData()),this.setEchartsOptions(this.getEchartsListData())):modelsHiddenParams[t].window>=0&&(0==modelsTempParams[t].windowValue&&this.shiftEchartsListData(),this.pushEchartsListData(this.getEchartsData()),this.setEchartsOptions(this.getEchartsListData()),0!=modelsTempParams[t].windowValue&&--modelsTempParams[t].windowValue),s.enable();else{this.initEcharts(a),this.initEchartsOptions();var e=modelsTempParams[t].echartsInstance.getDataURL();modelsTempParams[t].echartsInstance.dispose(),$("#"+a).html('<img src="'+e+'"/>'),s.disable()}},this.render=function(){var n=document.createElement("div");modelsParameters[t].borderShadow?n.setAttribute("class","card-kpi-container card-shadow"):n.setAttribute("class","card-kpi-container");var r='<div class="card-kpi">';r=(r+='<div class="card-body">')+'<div id="items-'+e+'" class="row align-items-center">';var d="";d=(d=d+'<h5 id="advanced-card-label-'+e+'" class="card-mt-0 text-truncate"')+' style="text-align:center; margin-bottom: 4rem;'+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+'"></h5>';var o="";o=(o=o+'<div id="advanced-card-value-'+e+'" class="card-value" style="text-align:center; margin-bottom: 1.7rem;')+this.valueFontSize()+this.valueColor()+this.valueFontFamily()+'"></div>';var l="";l=(l=l+'<div id="advanced-card-sub-label-'+e+'" class="card-value" style="text-align:center; margin-bottom: 2rem; ')+this.subLabelFontSize()+this.subLabelColor()+this.subLabelFontFamily()+'"></div>';var c="",h="echarts"+e;if(i&&(h+="c"),c=c+'<div id="'+h+'" style="text-align:left; height: 11.9vh; width: 100%; background-color: transparent"></div>',r="top"==modelsParameters[t].valuePosition?o+l+d+c:d+o+l+c,r+="</div>",r+="</div>",r+="</div>",n.innerHTML=r,$("#"+a).html(n),modelsParameters[t].displayLabel){const a=this.getTransformedText("label");$("#advanced-card-label-"+e)[0].innerHTML=a}else $("#advanced-card-label-"+e).hide();$("#advanced-card-value-"+e)[0].innerText=s.valueFormat(modelsHiddenParams[t].value),$("#advanced-card-sub-label-"+e)[0].innerText=s.valueFormat(modelsHiddenParams[t].subLabel),this.updateEcharts(h)};const n={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:advancedKpiCardWidget",type:"object",properties:{value:{type:["string","number","boolean"]},subLabel:{type:["string","number","boolean"]}},required:["value","subLabel"]},r=new WidgetActuatorDescription("extendedValue","Current value and sub-label",WidgetActuatorDescription.READ,n);this.getActuatorDescriptions=function(){return[r]},this.extendedValue={updateCallback:function(){},setValue:function(a){modelsHiddenParams[t]=a},getValue:function(){return modelsHiddenParams[t]},addValueChangedHandler:function(a){this.updateCallback=a,s.enable()},removeValueChangedHandler:function(a){s.disable()},setCaption:function(a,e){modelsParameters[t].inheritLabelFromData&&(s.captionHelper(a,s.bIsInteractive,e),s.render())},clearCaption:function(){modelsParameters[t].label="",s.render()}},s.render()},this.advancedKpiCardWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"advancedKpiCard",widgetsDefinitionList:{advancedKpiCard:{factory:"advancedKpiCardWidget",title:"Advanced KPI value",icn:"kpi-advanced"}}},this.constructor()}modelsHiddenParams.advancedKpiCard={value:"--",subLabel:"--"},modelsParameters.advancedKpiCard={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valuePosition:"bottom",valueFontSize:3,valueColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",decimalDigits:3,subLabelFontSize:.5,subLabelColor:"var(--widget-subtext-color)",subLabelFontFamily:"var(--widget-font-family)",borderShadow:!1,graphColor:"var(--widget-label-color)"},modelsTempParams.advancedKpiCard={echartsInstance:"",echartsListData:[]},modelsLayout.advancedKpiCard={height:"33vh",width:"14vw",minWidth:"64px",minHeight:"32px"},advancedKpiWidgetsPluginClass.prototype=basePlugin.prototype;var advancedKpiWidgetsPlugin=new advancedKpiWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(advancedKpiWidgetsPlugin);
function doubleSliderWidgetsPluginClass(){this.doubleSliderFlatUiWidget=function(e,a,l,n){this.constructor(e,a,l,n);var i=this;this.enable=function(){},this.disable=function(){},this.getCleanedOptions=function(e){return{floor:e.minRange,ceil:e.maxRange,step:e.step,precision:e.precision,enforceStep:e.enforceStep,disableAnimation:e.disableAnimation,onEnd:e.onEnd}},this.updateMinValue=function(){i.bIsInteractive&&(i.minValue.updateCallback(i.minValue,i.minValue.getValue()),modelsHiddenParams[l].minValue=i.minValue.getValue())},this.updateMaxValue=function(){i.bIsInteractive&&(i.maxValue.updateCallback(i.maxValue,i.maxValue.getValue()),modelsHiddenParams[l].maxValue=i.maxValue.getValue())},this.rescale=function(){this.render()},_.isUndefined(modelsParameters[l].forceValuesToMinAndMax)&&(modelsParameters[l].forceValuesToMinAndMax=!1),this.render=function(){var n=document.createElement("div");n.setAttribute("style","display: table; height: inherit; width: inherit; cursor: inherit"),n.setAttribute("id","div-for-ng-slider"+a),$("#"+e).html(n);Math.min($("#div-for-ng-slider"+a).width(),$("#div-for-ng-slider"+a).height());var t="sliderValues.values_"+l,o="30%",r="labelText",d='<div><rzslider id="ng-slider'+a+'" ng-click="changeValue()" rz-slider-model="'+t+'.minValue"  rz-slider-high="'+t+'.maxValue"  rz-slider-options="getModel('+("sliderValues.params_"+l)+')" ></rzslider></div>',s="",u="calc(7px + 0.5vw + 0.4vh)";1==modelsParameters[l].displayLabel&&(_.isUndefined(modelsParameters[l].label)||(r=this.getTransformedText("label")),_.isUndefined(modelsParameters[l].labelWidthProportion)||(o=modelsParameters[l].labelWidthProportion),_.isUndefined(modelsParameters[l].labelFontSize)||(u=this.labelFontSize()),s='<span class="label-h-slider" id="h-slider-span" style="heigh: auto; width:'+o+"; "+u+this.labelColor()+this.labelFontFamily()+';">'+r+"</span>");var m=angular.element(s+'<div style="display: table-cell; vertical-align: middle; padding-bottom: 18px;"> '+d+"</div>");modelsParameters[l].onEnd=function(e,a,l,n){"max"==n&&i.updateMaxValue(),"min"==n&&i.updateMinValue()};var c=document.getElementById("div-for-ng-slider"+a);angular.element(c).append(m),angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,a){var n=angular.element(m).scope();a.sliderValues||(a.sliderValues={}),a.sliderValues["values_"+l]={minValue:modelsHiddenParams[l].minValue,maxValue:modelsHiddenParams[l].maxValue},a.getModel=function(e){var a=angular.copy(e);return i.bIsInteractive?(_.isUndefined(a.minRange)||(a.floor=a.minRange),_.isUndefined(a.maxRange)||(a.ceil=a.maxRange)):(a.ceil=a.maxRange,a.floor=a.minRange,a.readOnly=!0),a},a.changeValue=function(){},a.sliderValues["params_"+l]=i.getCleanedOptions(modelsParameters[l]),e(m)(n)}]),document.styleSheets[0].addRule("#ng-slider"+a+" > .rz-bar-wrapper > .rz-bar",this.sliderSegmentColor()),document.styleSheets[0].addRule("#ng-slider"+a+" > .rz-bar-wrapper > .rz-selection",this.sliderRangeColor()),document.styleSheets[0].addRule("#ng-slider"+a+" > .rz-pointer",this.sliderHandleDefaultColor()),document.styleSheets[0].addRule("#ng-slider"+a+" > .rz-pointer:hover",this.sliderHandleHoverColor()),document.styleSheets[0].addRule("#ng-slider"+a+" > .rz-pointer:active",this.sliderHandleActiveColor())};const t=new WidgetActuatorDescription("minValue","Selected minimum value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER),o=new WidgetActuatorDescription("maxValue","Selected maximum value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER),r=new WidgetActuatorDescription("minRange","Minimum allowed value",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER),d=new WidgetActuatorDescription("maxRange","Maximum allowed value",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER);this.getActuatorDescriptions=function(e){const a=e||modelsParameters[l],n=[t,o];return a&&a.rangeActuator&&(n.push(r),n.push(d)),n},this.minValue={updateCallback:function(){},setValue:function(e){var a=Number(e);modelsHiddenParams[l].minValue=a,angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,n){n.sliderValues["values_"+l].minValue=a,n.safeApply()}])},getValue:function(){var e=0;return angular.element(document.body).injector().invoke(["$compile","$rootScope",function(a,n){e=n.sliderValues["values_"+l].minValue}]),e},addValueChangedHandler:function(e){this.updateCallback=e,i.enable()},removeValueChangedHandler:function(e){i.disable()},setCaption:function(e,a){},clearCaption:function(){modelsParameters[l].label="",i.render()}},this.maxValue={updateCallback:function(){},setValue:function(e){var a=Number(e);modelsHiddenParams[l].maxValue=a,angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,n){n.sliderValues["values_"+l].maxValue=a,n.safeApply()}])},getValue:function(){var e;return angular.element(document.body).injector().invoke(["$compile","$rootScope",function(a,n){e=n.sliderValues["values_"+l].maxValue}]),e},addValueChangedHandler:function(e){this.updateCallback=e,i.enable()},removeValueChangedHandler:function(e){i.disable()},setCaption:function(e,a){},clearCaption:function(){modelsParameters[l].label="",i.render()}},i.maxRange={updateCallback:function(){},setValue:function(e){var a=Number(e);modelsParameters[l].maxRange=a,angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,a){a.sliderValues["params_"+l]=i.getCleanedOptions(modelsParameters[l]),a.safeApply()}]),modelsParameters[l].forceValuesToMinAndMax&&(i.maxValue.setValue(modelsParameters[l].maxRange),i.updateMaxValue())},getValue:function(){var e;return angular.element(document.body).injector().invoke(["$compile","$rootScope",function(a,n){e=modelsParameters[l].maxRange}]),e},addValueChangedHandler:function(e){this.updateCallback=e,i.enable()},removeValueChangedHandler:function(e){i.disable()}},i.minRange={updateCallback:function(){},setValue:function(e){var a=Number(e);modelsParameters[l].minRange=a,angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,a){a.sliderValues["params_"+l]=i.getCleanedOptions(modelsParameters[l]),a.safeApply()}]),modelsParameters[l].forceValuesToMinAndMax&&(i.minValue.setValue(modelsParameters[l].minRange),i.updateMinValue())},getValue:function(){var e;return angular.element(document.body).injector().invoke(["$compile","$rootScope",function(a,n){e=modelsParameters[l].minRange}]),e},addValueChangedHandler:function(e){this.updateCallback=e,i.enable()},removeValueChangedHandler:function(e){i.disable()}},i.render()},this.doubleSliderFlatUiWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"flatUiDoubleSlider",widgetsDefinitionList:{flatUiDoubleSlider:{factory:"doubleSliderFlatUiWidget",title:"Double slider",icn:"double-slider",help:"wdg/wdg-basics/#double-slider"}}},this.constructor()}modelsHiddenParams.flatUiDoubleSlider={minValue:25,maxValue:75},modelsParameters.flatUiDoubleSlider={label:"labelText",displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelWidthProportion:"30%",minRange:0,maxRange:100,step:.1,precision:2,enforceStep:!1,disableAnimation:!1,rangeActuator:!1,forceValuesToMinAndMax:!1,sliderSegmentColor:"var(--widget-segment-color)",sliderRangeColor:"var(--widget-range-color)",sliderHandleDefaultColor:"var(--widget-handle-default-color)",sliderHandleHoverColor:"var(--widget-handle-hover-color)",sliderHandleActiveColor:"var(--widget-handle-active-color)"},modelsLayout.flatUiDoubleSlider={height:"8vh",width:"24vw",minWidth:"200px",minHeight:"24px"},doubleSliderWidgetsPluginClass.prototype=basePlugin.prototype;var doubleSliderWidgetsPlugin=new doubleSliderWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(doubleSliderWidgetsPlugin);
function datePickerWidgetsPluginClass(){var e=this;this.datePickerWidget=function(e,t,a,i,l){this.constructor(e,t,a,i);var r=this;this.dateFieldShow=function(){var e=$("#ng-datepicker"+t);e.hasClass("daterangepicker-hide")&&e.removeClass("daterangepicker-hide")},this.dateFieldHide=function(){var e=$("#ng-datepicker"+t);e.hasClass("daterangepicker-hide")||e.addClass("daterangepicker-hide")},this.enable=function(){$("#"+a+"c").on("click",(function(e,t){widgetPreview.elevateZIndex(a,e),r.dateFieldShow()}))},this.disable=function(){r.dateFieldHide()},this.updateValue=function(e){r.dateValue.updateCallback(r.dateValue,r.dateValue.getValue()),r.dateFieldHide()},this.getShortDate=function(e){var t=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),i=e.getFullYear();return e=i+"-"+a+"-"+t},this.rescale=function(){this.render()},this.render=function(){var i=document.createElement("div"),l=!1,d=" ",n="display: table;";modelsHiddenParams[a].visibility&&(l=!0,d="display: none; ",n=""),i.setAttribute("style",n+"text-align: left; height: inherit; width: inherit; cursor: inherit"),i.setAttribute("id","div-for-ng-datepicker"+t),$("#"+e).html(i);var o=$("#div-for-ng-datepicker"+t).height(),s="datepickerValues.val"+a,c="100%",p="labelText",u=($("#div-for-ng-datepicker"+t).width(),""),g="calc(7px + 0.5vw + 0.4vh)",h="calc(7px + 0.5vw + 0.4vh)";if(1==modelsParameters[a].displayLabel&&(_.isUndefined(modelsParameters[a].label)||(p=this.getTransformedText("label")),_.isUndefined(modelsParameters[a].labelWidthProportion)||(c=modelsParameters[a].labelWidthProportion,(100-parseInt(c))*$("#div-for-ng-datepicker"+t).width()/100),_.isUndefined(modelsParameters[a].labelFontSize)||(g=this.labelFontSize()),_.isUndefined(modelsParameters[a].valueFontSize)||(h="calc(7px + "+modelsParameters[a].valueFontSize*getFontFactor()+"vw + 0.4vh)"),u='<span class="value-span" id="date-label-span'+t+'" style="width:'+c+"; "+g+this.labelColor()+this.labelFontFamily()+'">'+p+"</span>",l)){var m=80*$("#div-for-ng-datepicker"+t).width()/100,v=20*$("#div-for-ng-datepicker"+t).height()/100;u='<span class="value-span" id="date-label-span'+t+'" style="width:'+m+"px;height:"+v+"px;text-align: center;padding-bottom: 0px; "+g+this.labelColor()+this.labelFontFamily()+'">'+p+"</span>"}var b="disabled",f="cursor: inherit; ";if(this.bIsInteractive){b="";f="cursor: pointer; "}var k=this.border(),P='<datepicker id="ng-datepicker'+t+'" date-format="yyyy-MM-dd" datepicker-show="'+l+'" selector="form-control"><div style="cursor: inherit"><input  id="'+("calender-input"+t)+'" class="value-input form-control " style="'+f+" height: "+o+"px; border-radius: 6px; "+d+k+"float: right; font-size: "+h+";"+this.valueColor()+this.valueFontFamily()+this.backgroundColor()+"padding-right: "+h.replace("(","(3*(").replace(")","))")+";text-align: "+modelsParameters[a].valueTextAlign+'; " ng-model="'+s+'.currentDate" '+b+' placeholder="Choose a date"/><span class="form-control-feedback" style="cursor: inherit; display: table;margin-top:0; top:0; padding-right: '+h+"; height: "+o+'px;"><i class="fa fa-lg fa-calendar" style="display: table-cell; vertical-align: middle; font-size:'+h+'"></i></span></div></datepicker>',y=u+'<div style="cursor: inherit; height: 100%"> '+P+"</div> ";if(l){var w="height: 100%; width: 100%";modelsParameters[a].displayLabel&&(w="height: 80%; width: 80%"),y='<div style="'+w+'"> '+P+"</div> "+u}var F=angular.element(y),S=document.getElementById("div-for-ng-datepicker"+t);angular.element(S).append(F),angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,t){var i=angular.element(F).scope();if(t.datepickerValues||(t.datepickerValues={}),t.datepickerValues["val"+a]||(t.datepickerValues["val"+a]={currentDate:r.getShortDate(new Date)}),modelsHiddenParams[a]){if(!modelsHiddenParams[a].value){var l=new Date;modelsHiddenParams[a].value=r.getShortDate(l)}t.datepickerValues["val"+a]={currentDate:modelsHiddenParams[a].value}}t.$watch("datepickerValues.val"+a,(function(){r.updateValue()}),!0),e(F)(i)}]),r.dateFieldHide(),this.bIsInteractive?r.enable():r.disable()};const d=new WidgetActuatorDescription("dateValue","Selected date as YYYY-MM-DD",WidgetActuatorDescription.READ_WRITE,{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:datePickerWidgetSemi",type:"string",pattern:"^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d$"});this.getActuatorDescriptions=function(){return[d]},this.dateValue={updateCallback:function(){},setValue:function(e){var t=Date.parse(e);_.isNaN(t)||(modelsHiddenParams[a].value=r.getShortDate(new Date(t)),angular.element(document.body).injector().invoke(["$compile","$rootScope",function(e,t){t.datepickerValues["val"+a]&&(t.datepickerValues["val"+a].currentDate=modelsHiddenParams[a].value,t.safeApply())}]))},getValue:function(){var e=null;return angular.element(document.body).injector().invoke(["$compile","$rootScope",function(t,i){i.datepickerValues["val"+a]&&(e=i.datepickerValues["val"+a].currentDate,modelsHiddenParams[a].value=e)}]),e},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,i){modelsParameters[a].inheritLabelFromData&&(r.captionHelper(e,r.bIsInteractive,i),$("#date-label-span"+t).text(modelsParameters[a].label))},clearCaption:function(){modelsParameters[a].label="",r.render()}},r.render()},this.datePickerWidgetSemi=function(t,a,i,l){return new e.datePickerWidget(t,a,i,l,"semi")},this.datePickerWidgetFull=function(t,a,i,l){return new e.datePickerWidget(t,a,i,l,"full")},this.datePickerWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"datepicker",widgetsDefinitionList:{datepickerSimple:{factory:"datePickerWidgetSemi",title:"Simple calender",icn:"calendar",help:"wdg/wdg-geo-time/#simple-calendar"}}},this.constructor()}modelsHiddenParams.datepickerSimple={value:"",visibility:!1},modelsHiddenParams.datepickerVisible={value:"",visibility:!0},modelsParameters.datepickerSimple={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelWidthProportion:"30%",valueFontSize:.5,valueColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",valueTextAlign:"left",displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-input-color)"},modelsParameters.datepickerVisible={label:"labelText",inheritLabelFromData:!1,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valueFontSize:.5,valueColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)"},modelsLayout.datepickerSimple={height:"5vh",width:"19vw",minWidth:"150px",minHeight:"32px"},modelsLayout.datepickerVisible={height:"45vh",width:"22vw",minWidth:"150px",minHeight:"190px"},datePickerWidgetsPluginClass.prototype=basePlugin.prototype;var datePickerWidgetsPlugin=new datePickerWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(datePickerWidgetsPlugin);
function dateRangePickerWidgetsPluginClass(){this.dateRangePickerWidget=function(e,a,t,i){this.constructor(e,a,t,i);const r=this;this.formatDateValue="",this.updateDateValue=function(e){this.bIsInteractive&&(r.endDateValue.updateCallback(r.endDateValue,r.endDateValue.getValue()),modelsHiddenParams[t].endDateValue=r.endDateValue.getValue(),r.startDateValue.updateCallback(r.startDateValue,r.startDateValue.getValue()),modelsHiddenParams[t].startDateValue=r.startDateValue.getValue())},this.rescale=function(){this.render()},this.render=function(){const i=document.createElement("div");i.setAttribute("style","display: table;text-align: left; height: inherit; width: inherit; cursor: inherit"),i.setAttribute("id","div-for-daterangepicker"+a),$("#"+e).html(i);let d="0%",l="labelText",n=$("#div-for-daterangepicker"+a).width(),s="",o="calc(7px + 0.5vw + 0.4vh)",u="calc(7px + 0.5vw + 0.4vh)";_.isUndefined(modelsParameters[t].inheritLabelFromData)||delete modelsParameters[t].inheritLabelFromData,1==modelsParameters[t].displayLabel&&(_.isUndefined(modelsParameters[t].label)||(l=this.getTransformedText("label")),_.isUndefined(modelsParameters[t].labelWidthProportion)||(d=modelsParameters[t].labelWidthProportion,n=(100-parseInt(d))*$("#div-for-daterangepicker"+a).width()/100),_.isUndefined(modelsParameters[t].labelFontSize)||(o=this.labelFontSize()),_.isUndefined(modelsParameters[t].valueFontSize)||(u="calc(7px + "+modelsParameters[t].valueFontSize*getFontFactor()+"vw + 0.4vh)"),s='<span class="value-span" id="date-label-span'+a+'" style="width:'+d+"; "+o+this.labelColor()+this.labelFontFamily()+';">'+l+"</span>");let c="disabled",m="cursor: inherit; ";this.bIsInteractive&&(c="",m="cursor: pointer; ");const g=this.border(),p=$("#div-for-daterangepicker"+a).height(),h=s+'<div style="height:100% width: '+n+'px;">'+('<div id="daterangepicker'+a+'" ><input type="text" autocomplete="off" '+c+' placeholder="Choose a date range" id="daterangepickerInput'+a+'" style="'+m+" height: "+p+"px; border-radius: 6px; "+g+"float: right;padding-right: "+u.replace("(","(3*(").replace(")","))")+";text-align: "+modelsParameters[t].valueTextAlign+"; font-size: "+u+"; "+this.valueColor()+this.valueFontFamily()+this.backgroundColor()+'" class="value-input form-control ng-pristine ng-untouched ng-valid ng-empty" /><span class="form-control-feedback" style="'+m+"height: "+p+"px; display:table; margin-top: 0; top:0; padding-right: "+u+'"><i class="fa fa-lg fa-calendar" style="display: table-cell; vertical-align: middle;'+m+"font-size: "+u+';" ></i></span></div>')+"</div>";i.innerHTML=h,modelsParameters[t].displayTimePicker?r.formatDateValue=modelsParameters[t].displayTimePicker24Hour?"YYYY-MM-DD hh:mm":"YYYY-MM-DD hh:mm A":r.formatDateValue="YYYY-MM-DD";let D="",P="";D=""!==modelsHiddenParams[t].startDateValue?modelsHiddenParams[t].startDateValue:moment().startOf("hour"),P=""!==modelsHiddenParams[t].endDateValue?modelsHiddenParams[t].endDateValue:moment().startOf("hour").add(32,"hour"),$('input[id="daterangepickerInput'+a+'"]').daterangepicker({opens:"right",singleDatePicker:!1,showDropdowns:!0,autoUpdateInput:!0,timePicker:modelsParameters[t].displayTimePicker,timePicker24Hour:modelsParameters[t].displayTimePicker24Hour,startDate:D,endDate:P,locale:{format:r.formatDateValue}}),$('input[id="daterangepickerInput'+a+'"]').on("apply.daterangepicker",(function(e,a){modelsHiddenParams[t].startDateValue=a.startDate.format(r.formatDateValue),modelsHiddenParams[t].endDateValue=a.endDate.format(r.formatDateValue),r.updateDateValue()}))};const d={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:dateRangeWidget_date",type:"string",pattern:"^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d$"},l=new WidgetActuatorDescription("startDateValue","Selected start date as YYYY-MM-DD",WidgetActuatorDescription.READ_WRITE,d),n=new WidgetActuatorDescription("endDateValue","Selected end date as YYYY-MM-DD",WidgetActuatorDescription.READ_WRITE,d);this.getActuatorDescriptions=function(){return[l,n]},this.startDateValue={updateCallback:function(){},setValue:function(e){moment(e,r.formatDateValue,!0).isValid()&&(modelsHiddenParams[t].startDateValue=e,$('input[id="daterangepickerInput'+a+'"]').data("daterangepicker").setStartDate(modelsHiddenParams[t].startDateValue))},getValue:function(){return modelsHiddenParams[t].startDateValue},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,a){},clearCaption:function(){modelsParameters[t].label="",r.render()}},this.endDateValue={updateCallback:function(){},setValue:function(e){moment(e,r.formatDateValue,!0).isValid()&&(modelsHiddenParams[t].endDateValue=e,$('input[id="daterangepickerInput'+a+'"]').data("daterangepicker").setEndDate(modelsHiddenParams[t].endDateValue))},getValue:function(){return modelsHiddenParams[t].endDateValue},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,a){},clearCaption:function(){modelsParameters[t].label="",r.render()}},r.render()},this.dateRangePickerWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"dateRangePicker",widgetsDefinitionList:{dateRangePicker:{factory:"dateRangePickerWidget",title:"Date-range calendar",icn:"date-range-calendar",help:"wdg/wdg-geo-time/#advanced-calendar"}}},this.constructor()}modelsHiddenParams.dateRangePicker={startDateValue:"",endDateValue:""},modelsParameters.dateRangePicker={label:"labelText",displayLabel:!0,displayTimePicker:!1,displayTimePicker24Hour:!1,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",labelWidthProportion:"25%",valueFontSize:.5,valueColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",valueTextAlign:"left",displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-input-color)"},modelsLayout.dateRangePicker={height:"5vh",width:"24vw",minWidth:"170px",minHeight:"32px"},dateRangePickerWidgetsPluginClass.prototype=basePlugin.prototype;var dateRangePickerWidgetsPlugin=new dateRangePickerWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(dateRangePickerWidgetsPlugin);
function timePickerWidgetsPluginClass(){this.timepickerWidget=function(e,i,t,a){this.constructor(e,i,t,a);var l=this;this.enable=function(){},this.disable=function(){},this.updateValue=function(e){l.timeValue.updateCallback(l.timeValue,l.timeValue.getValue()),modelsHiddenParams[t].timeValue=l.timeValue.getValue()},this.rescale=function(){this.render()},this.render=function(){var a=document.createElement("div");a.setAttribute("style","display: table;text-align: left; height: inherit; width: inherit; cursor: inherit"),a.setAttribute("id","div-for-ng-timepicker"+i),$("#"+e).html(a);var r="";r=this.bIsInteractive?"clockpicker ":" ";var n="0%",o="labelText",s=$("#div-for-ng-timepicker"+i).width(),d="",c="calc(7px + 0.5vw + 0.4vh)",u="calc(7px + 0.5vw + 0.4vh)";1==modelsParameters[t].displayLabel&&(_.isUndefined(modelsParameters[t].label)||(o=this.getTransformedText("label")),_.isUndefined(modelsParameters[t].labelWidthProportion)||(n=modelsParameters[t].labelWidthProportion,s=(100-parseInt(n))*$("#div-for-ng-timepicker"+i).width()/100),_.isUndefined(modelsParameters[t].labelFontSize)||(c=this.labelFontSize()),_.isUndefined(modelsParameters[t].valueFontSize)||(u="calc(7px + "+modelsParameters[t].valueFontSize*getFontFactor()+"vw + 0.4vh)"),d='<span class="value-span" id="time-label-span'+i+'" style="width:'+n+"; "+c+this.labelColor()+this.labelFontFamily()+';">'+o+"</span>");var m="disabled",p="cursor: inherit; ";this.bIsInteractive&&(m="",p="cursor: pointer; ");var g=this.border(),h=$("#div-for-ng-timepicker"+i).height(),f=d+'<div style="height:100% width: '+s+'px;">'+('<div id="clockpicker'+i+'" ><div class="'+r+'"><input autocomplete="off" '+m+' placeholder="Select Time" id="clockpickerInput'+i+'" style="'+p+" height: "+h+"px; border-radius: 6px; "+g+"float: right;padding-right: "+u.replace("(","(3*(").replace(")","))")+";text-align: "+modelsParameters[t].valueTextAlign+"; font-size: "+u+"; "+this.valueColor()+this.valueFontFamily()+this.backgroundColor()+'" class="value-input form-control ng-pristine ng-untouched ng-valid ng-empty"><span class="form-control-feedback" style="'+p+"height: "+h+"px; display:table; margin-top: 0; top:0; padding-right: "+u+'"><i class="fa fa-lg fa-clock-o" style="display: table-cell; vertical-align: middle;'+p+"font-size: "+u+';" ></i></span></div></div>')+"</div>";a.innerHTML=f,$("#clockpicker"+i).clockpicker({autoclose:!0,default:"12:00",init:function(){this.value=modelsHiddenParams[t].timeValue},beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},beforeHourSelect:function(){},afterHourSelect:function(){},beforeDone:function(){},afterDone:function(){}}).find("input").change((function(){modelsHiddenParams[t].timeValue=this.value,l.updateValue()})),$("#clockpickerInput"+i)[0].value=modelsHiddenParams[t].timeValue,$("#check-minutes").click((function(e){e.stopPropagation(),input.clockpicker("show").clockpicker("toggleView","minutes")})),this.bIsInteractive?l.enable():l.disable()};const r=new WidgetActuatorDescription("timeValue","Selected time as MM:HH",WidgetActuatorDescription.READ_WRITE,{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:timepickerWidget",type:"string",pattern:"^[0-2]\\d:[0-5]\\d$"});this.getActuatorDescriptions=function(){return[r]},this.timeValue={updateCallback:function(){},setValue:function(e){modelsHiddenParams[t].timeValue=e,$("#clockpickerInput"+i)[0].value=e},getValue:function(){return modelsHiddenParams[t].timeValue},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()},setCaption:function(e,a){modelsParameters[t].inheritLabelFromData&&(l.captionHelper(e,l.bIsInteractive,a),$("#time-label-span"+i).text(modelsParameters[t].label))},clearCaption:function(){modelsParameters[t].label="",l.render()}},l.render()},this.timepickerWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"timepicker",widgetsDefinitionList:{timepickerSimple:{factory:"timepickerWidget",title:"Simple clock",icn:"clock",help:"wdg/wdg-geo-time/#simple-clock"}}},this.constructor()}modelsHiddenParams.timepickerSimple={timeValue:""},modelsParameters.timepickerSimple={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",labelWidthProportion:"30%",valueFontSize:.5,valueColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",valueTextAlign:"left",displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-input-color)"},modelsLayout.timepickerSimple={height:"5vh",width:"19vw",minWidth:"150px",minHeight:"32px"},timePickerWidgetsPluginClass.prototype=basePlugin.prototype;var timePickerWidgetsPlugin=new timePickerWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(timePickerWidgetsPlugin);
function calendarD3WidgetPluginClass(){this.calendarD3Widget=function(t,e,a,n){this.constructor(t,e,a,n);const i=this;this.enable=function(){},this.disable=function(){},this.updateValue=function(t){i.SelectedDate.updateCallback(i.SelectedDate,i.SelectedDate.getValue())},this.rescale=function(){this.render()},this.render=function(){const n=document.createElement("div");n.setAttribute("style","display: table;text-align: left; height: inherit; width: inherit; cursor: inherit"),n.setAttribute("id","div-for-calendarD3"+e),$("#"+t).html(n);const l=n.getBoundingClientRect(),r=l.width,d=l.height,o=d3.timeFormat("%Y-%m-%d"),s=d3.timeParse("%Y-%m-%d"),c=modelsHiddenParams[a].CalendarValues;var u;let p;if(u=c&&"values"in c?c.values:"",!_.isUndefined(u)&&u.length)p=u;else{const t=d3.timeDay.range(new Date(2020,5,2),Date.now());p=t.map(t=>({date:o(t),value:void 0}))}p=p.map(t=>({date:s(t.date),value:t.value})).sort((t,e)=>t.date.getTime()-e.date.getTime());const g=_.isUndefined(c.start)?p[0].date:s(c.start),h=_.isUndefined(c.end)?p[p.length-1].date:s(c.end),y=d3.timeDay.range(g,h),m=_.difference(y.map((function(t){return t.getTime()})),p.map((function(t){return t.date.getTime()})));m.length>0&&(m.forEach((function(t){p.push({date:new Date(t),value:void 0})})),p=p.sort((function(t,e){return t.date.getTime()-e.date.getTime()})));let f,D,M,Y,b,w,v,k,C,V,x,P,W,A=modelsParameters[a].AllYearsVisible?"full":"single",S=t=>"SMTWTFS"[t],H="%b",F=(d3.interpolateRdYlGn,p[0].date.getFullYear()),E=p[p.length-1].date.getFullYear(),U=E,T=0,L=0;function R(){"single"===A?(f=p.filter(t=>U==t.date.getFullYear()).map(t=>t.date),D=p.filter(t=>U==t.date.getFullYear()).map(t=>t.value)):(f=p.map(t=>t.date),D=p.map(t=>t.value)),M=d3.range(f.length),P=d3.groups(M,t=>f[t].getFullYear()).reverse(),Y=t=>(t+6)%7,b=d3.timeMonday,w=7;let t=d/((w+2)*P.length),e=(r-40)/53;W=Math.min(t,e),v=W*(w+2),T=(r-(40+53*W))/2,(T<0||"single"===A)&&(T=0),L=(d-v*P.length)/2,(L<0||"single"===A)&&(L=0),k=d3.quantile(D,.9975),C=d3.scaleSequential([0,k],["#d5f4c7","red"]).unknown("none"),H=d3.timeFormat(H),V=d3.timeFormat("%B %-d, %Y"),x=C.tickFormat(100,"+%"),title=t=>`${V(f[t])}\n${x(D[t])}`}function j(t){const e=Math.max(0,Math.min(w,Y(t.getDay()))),a=b.count(d3.timeYear(t),t);return`${0===e?`M${a*W},0`:e===w?`M${(a+1)*W},0`:`M${(a+1)*W},0V${e*W}H${a*W}`}V${w*W}`}R(),d3.selection.prototype.conditionalDraw=function(){const t=22*W+40,e=v*P.length/2;return"single"===A?this.attr("x",t).attr("y",e).style("opacity",0).transition().duration(500):this};const I=d3.select(n).append("svg").attr("style","width: inherit; height: inherit;").attr("font-family","sans-serif").attr("font-size",W);if(d3.select("body").append("div").attr("class","tooltip").attr("id","tooltipCalendar").style("display","none").style("pointer-events","none").style("background","#fff").style("color","#000").style("border","2px solid #000").style("opacity",0),"single"===A){const t="M 1 1 L 12 10 L 1 19 L 1 1",e="M 12 1 L 1 10 L 12 19 L 12 1",a=I.append("path").attr("d",t).style("fill-rule","evenodd").attr("transform","translate("+(28*W+40)+", "+v*P.length+") ").attr("stroke-width","0.0").attr("stroke","black").attr("fill","#888888"),n=I.append("path").attr("d",e).style("fill-rule","evenodd").attr("transform","translate("+(22*W+40)+", "+v*P.length+") ").attr("stroke-width","0.0").attr("stroke","black").attr("fill","#888888");a.on("click",(function(){O(1,a,n)})),n.on("click",(function(){O(-1,a,n)})),a.attr("opacity",.2)}async function O(t,e,a){const n=22*W+40,i=v*P.length/2,l=U+t;l>E||l<F||(U=l,await I.selectAll(".year").selectAll("*").transition().duration(500).attr("x",n).attr("y",i).style("opacity",0).end(),I.selectAll(".year").remove(),l==F?(a.attr("opacity",.2),e.attr("opacity",1)):l==E?(a.attr("opacity",1),e.attr("opacity",.2)):(a.attr("opacity",1),e.attr("opacity",1)),R(),q())}function q(){const t=I.selectAll("g").data(P).join("g");t.attr("class","year").attr("transform",(t,e)=>"translate("+(40+T)+`,${v*e+1.5*W+L})`),t.append("text").conditionalDraw().attr("x",-5).attr("y",-5).attr("font-weight","bold").attr("text-anchor","end").text(([t])=>t).style("opacity",1),t.append("g").attr("text-anchor","end").selectAll("text").data(d3.range(7)).join("text").conditionalDraw().attr("x",-5).attr("y",t=>(Y(t)+.5)*W).attr("dy","0.31em").text(S).style("opacity",1),t.append("g").selectAll("rect").data(([,t])=>t).join("rect").attr("width",W-1).attr("height",W-1).attr("fill",(function(t,e){return _.isUndefined(D[t])?modelsParameters[a].UndefinedValueColor:C(D[t])})).on("mouseover",(function(t,e){_.isUndefined(D[e])||(d3.select(this).attr("height",W-2).attr("width",W-2).attr("transform","translate(1,1)").style("stroke","black").style("stroke-width",1).style("stroke-opacity",1),d3.select("#tooltipCalendar").style("display","block").style("opacity",1).html("<center>"+o(f[e])+"</center>Value : "+D[e]).style("left",t.pageX+10+"px").style("top",t.pageY+10+"px"))})).on("mouseout",(function(t,e){_.isUndefined(D[e])||(d3.select(this).style("stroke","black").style("stroke-width",0).style("stroke-opacity",0).attr("transform","translate(0,0)").attr("width",W-1).attr("height",W-1),d3.select("#tooltipCalendar").style("display","none").style("opacity",0))})).on("click",(function(t,e){modelsHiddenParams[a].SelectedDate=o(f[e]),i.updateValue()})).conditionalDraw().style("opacity",1).attr("x",t=>b.count(d3.timeYear(f[t]),f[t])*W+.5).attr("y",t=>Y(f[t].getDay())*W+.5);const e=t.append("g").selectAll("g").data(([,t])=>d3.timeMonths(d3.timeMonth(f[t[0]]),f[t[t.length-1]])).join("g");e.filter((t,e)=>e).append("path").attr("fill","none").attr("stroke","#fff").attr("stroke-width",2).attr("d",j),e.append("text").text(H).conditionalDraw().style("opacity",1).attr("x",t=>b.count(d3.timeYear(t),b.ceil(t))*W+3).attr("y",-5).style("opacity",1)}function j(t){const e=Math.max(0,Math.min(w,Y(t.getDay()))),a=b.count(d3.timeYear(t),t);return`${0===e?`M${a*W},0`:e===w?`M${(a+1)*W},0`:`M${(a+1)*W},0V${e*W}H${a*W}`}V${w*W}`}q()};const l={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:calendarD3Widget_input",type:"object",properties:{start:{type:"string"},end:{type:"string"},values:{type:"array",items:{type:"object",properties:{date:{type:"string"},value:{type:"number"}}}}}},r=new WidgetActuatorDescription("CalendarValues","Calendar Values Object{start : YYYY-MM-DD, end : YYYY-MM-DD, values : Array[{date : YYYY-MM-DD, value : number}]}",WidgetActuatorDescription.READ,l),d={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:calendarD3Widget_dateSelected",type:"string"},o=new WidgetActuatorDescription("SelectedDate","Selected date as YYYY-MM-DD",WidgetActuatorDescription.WRITE,d);this.getActuatorDescriptions=function(){return[r,o]},this.CalendarValues={updateCallback:function(){},setValue:function(t){modelsHiddenParams[a].CalendarValues=t,i.render()},getValue:function(){return modelsHiddenParams[a].timeValue},addValueChangedHandler:function(t){this.updateCallback=t,i.enable()},removeValueChangedHandler:function(t){i.disable()}},this.SelectedDate={updateCallback:function(){},setValue:function(t){modelsHiddenParams[a].SelectedDate=t},getValue:function(){return modelsHiddenParams[a].SelectedDate},addValueChangedHandler:function(t){this.updateCallback=t},removeValueChangedHandler:function(t){}},i.render()},this.calendarD3Widget.prototype=baseWidget.prototype,this.pluginDefinition={name:"calendarD3",widgetsDefinitionList:{calendarD3:{factory:"calendarD3Widget",title:"Year Calenddar",icn:"year-calendar",help:"wdg/wdg-geo-time/#simple-clock"}}},this.constructor()}modelsHiddenParams.calendarD3={CalendarValues:[],SelectedDate:""},modelsParameters.calendarD3={AllYearsVisible:!0,UndefinedValueColor:"#F6F6F6"},modelsLayout.calendarD3={height:"5vh",width:"19vw",minWidth:"100px",minHeight:"100px"},calendarD3WidgetPluginClass.prototype=basePlugin.prototype;var calendarD3Plugin=new calendarD3WidgetPluginClass;widgetsPluginsHandler.loadWidgetPlugin(calendarD3Plugin);
function getLedSvg(t,e,i){var a="#008400",r="#00b700";switch(t){case"off":a=modelsParameters[i].offColor;var o=w3color(a);o.darker(5),r=o.toHexString();break;case"on":r=modelsParameters[i].onColor;var s=w3color(r);s.darker(10),a=s.toHexString();break;case"inactive":a="#e6e6e6",r="#a6a6a6"}return'<svg xmlns="http://www.w3.org/2000/svg" xmlns: xlink="http://www.w3.org/1999/xlink" viewBox="-1 -1 51 51"  preserveAspectRatio="xMinYMin meet" class="svg-content"><title>LED '+t+'</title><defs><linearGradient y2="0.154336" y1="1.1441" xlink: href="#linearGradient6506_'+e+'" x2="0.566583" x1="0.577235" id="linearGradient6650_'+e+'"/><linearGradient y2="0.846351" y1="0.057496" xlink: href="#linearGradient5756_'+e+'" x2="0.609143" x1="0.532859" id="linearGradient6646_'+e+'"/><linearGradient y2="1" y1="0.019227" xlink: href="#linearGradient5742_'+e+'" x2="0.500488" x1="0.496181" id="linearGradient6644_'+e+'"/><linearGradient id="linearGradient6506_'+e+'"><stop stop-color="#ffffff" stop-opacity="0" offset="0" id="stop6508_'+e+'" /><stop stop-color="#ffffff" stop-opacity="0.87451" offset="1" id="stop6510_'+e+'" /></linearGradient><linearGradient id="linearGradient5756_'+e+'"><stop stop-color="#828282" offset="0" id="stop5758_'+e+'" /><stop stop-color="#929292" stop-opacity="0.352941" offset="1" id="stop5760_'+e+'" /></linearGradient><linearGradient id="linearGradient5742_'+e+'"><stop stop-color="#adadad" offset="0" id="stop5744_'+e+'" /><stop stop-color="#f0f0f0" offset="1" id="stop5746_'+e+'" /></linearGradient><linearGradient y2="0.553776" x2="0.632943" y1="1" x1="1" id="svg_1_'+e+'"><stop offset="0" stop-opacity="0.984375" stop-color="'+a+'" /><stop offset="0.984505" stop-opacity="0.980469" stop-color="'+r+'" /></linearGradient></defs><g><title>Layer 1</title><g id="layer1_'+e+'"><g transform="matrix(31.25, 0, 0, 31.25, -625.023, -1325)" id="g9447_'+e+'"><path fill="url(#linearGradient6644_'+e+')" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" id="path6596_'+e+'" d="m21.60074,43.19165c0,0.441601 -0.3584,0.799999 -0.800001,0.799999c-0.441599,0 -0.799999,-0.358398 -0.799999,-0.799999c0,-0.441601 0.3584,-0.799999 0.799999,-0.799999c0.441601,0 0.800001,0.358398 0.800001,0.799999z" /><path fill="url(#linearGradient6646_'+e+')" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" id="path6598_'+e+'" d="m21.44627,43.191471c0,0.35638 -0.28924,0.645618 -0.64562,0.645618c-0.35638,0 -0.64562,-0.289238 -0.64562,-0.645618c0,-0.35638 0.28924,-0.645611 0.64562,-0.645611c0.35638,0 0.64562,0.28923 0.64562,0.645611z" /><path fill="url(#svg_1_'+e+')" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" id="path6600_'+e+'" d="m21.378719,43.191639c0,0.31905 -0.25893,0.577991 -0.57798,0.577991c-0.31905,0 -0.57799,-0.258942 -0.57799,-0.577991c0,-0.319038 0.25894,-0.577969 0.57799,-0.577969c0.31905,0 0.57798,0.25893 0.57798,0.577969z" /><path transform="rotate(-34.3336, 20.5508, 42.8652)" fill="url(#linearGradient6650_'+e+')" stroke-width="0.8" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="4" id="path6602_'+e+'" d="m20.7453,42.86636c0,0.065899 -0.087271,0.11937 -0.194811,0.11937c-0.107529,0 -0.194809,-0.053471 -0.194809,-0.11937c0,-0.06588 0.08728,-0.119358 0.194809,-0.119358c0.10754,0 0.194811,0.053478 0.194811,0.119358z" /></g></g></g></svg>'}function ledWidgetsPluginClass(){this.statusLedWidget=function(t,e,i,a){this.constructor(t,e,i,a);var r=this;this.enable=function(){},this.disable=function(){},this.backwardCompatibility=function(){modelsParameters[i].redAtStateOff&&delete modelsParameters[i].redAtStateOff,_.isUndefined(modelsParameters[i].onColor)&&(modelsParameters[i].onColor="#00b700"),_.isUndefined(modelsParameters[i].offColor)&&(modelsParameters[i].offColor="#004d00")},this.backwardCompatibility(),this.insertLabel=function(t){const a=this.getTransformedText("label"),r=$("<span>",{class:"led-span",id:"led-span"+e,html:a});let o="height: inherit; "+this.labelFontSize()+this.labelColor()+this.labelFontFamily();_.isUndefined(modelsParameters[i].labelWidthProportion)?o+=" width: 20%; ":o+=modelsParameters[i].labelWidthProportion+"; ",r.attr("style",o),t.append(r[0])},this.rescale=function(){this.render()},this.render=function(){var a,o=document.createElement("div");a=this.bIsInteractive?modelsHiddenParams[i].status?"on":"off":"inactive";var s=1;modelsParameters[i].displayLabel&&(s=(100-Number(modelsParameters[i].labelWidthProportion.replace("%","")))/100);var n=0,l=0;$("#"+t).width()*s>$("#"+t).height()?n=$("#"+t).height()-2:(n=$("#"+t).width()*s-2,l=($("#"+t).height()-n-2)/2),o.setAttribute("class","led-widget-html"),o.setAttribute("style","height: inherit");var d=document.createElement("div");d.setAttribute("class","svg-container"),d.setAttribute("style","display: inline-block; margin-top: "+l+"px; cursor: inherit; width:"+n+"px; height: "+n+"px");var c=getLedSvg(a,e,i);d.innerHTML=c,o.appendChild(d),modelsParameters[i].displayLabel&&this.insertLabel(o),$("#"+t).html(o),this.bIsInteractive?r.enable():r.disable()};const o=new WidgetActuatorDescription("status","Current status (boolean)",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_BOOLEAN);this.getActuatorDescriptions=function(){return[o]},this.status={updateCallback:function(){},setValue:function(t){t!=modelsHiddenParams[i].status&&(modelsHiddenParams[i].status=t,r.render())},getValue:function(){return modelsHiddenParams[i]},addValueChangedHandler:function(t){this.updateCallback=t,r.enable()},removeValueChangedHandler:function(t){r.disable()},setCaption:function(t,e){modelsParameters[i].inheritLabelFromData&&r.captionHelper(t,r.bIsInteractive,e)},clearCaption:function(){modelsParameters[i].label="",r.render()}},r.render()},this.statusLedWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"led",widgetsDefinitionList:{ledStatus:{factory:"statusLedWidget",title:"Status led",icn:"status"}}},this.constructor()}modelsHiddenParams.ledStatus={status:!1},modelsParameters.ledStatus={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",labelWidthProportion:"60%",onColor:"#00b700",offColor:"#004d00"},modelsLayout.ledStatus={height:"10vh",width:"10vw",minWidth:"40px",minHeight:"40px"},ledWidgetsPluginClass.prototype=basePlugin.prototype;var ledWidgetsPlugin=new ledWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(ledWidgetsPlugin);
function flatUiComplexWidgetsPluginClass(){this.selectFlatUiWidget=function(e,t,l,a){this.constructor(e,t,l,a);const i=this;this.bFirstExec=!0,this.tmpSelectedValue="",this.enable=function(){$("#select"+t).off("click").on("click",(function(e,t){modelsHiddenParams[l].selectedValue=i.selectedValue.getValue(),i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue())})),$("#select"+t).prop("disabled",!1),document.styleSheets[0].addRule("#s2id_select"+t+" > .select2-choice > .select2-chosen",this.selectedValueColor()),document.styleSheets[0].addRule("#s2id_select"+t+" > .select2-choice",this.selectedItemDefaultColor()),document.styleSheets[0].addRule("#s2id_select"+t+" > .select2-choice:hover",this.selectedItemHoverColor())},this.disable=function(){$("#select"+t).prop("disabled",!0)},this.rescale=function(){this.render()},this.render=function(){const a=document.createElement("div");a.setAttribute("id","select-widget-html"+t),a.setAttribute("class","select-widget-html");let s=Math.min($("#"+e).height(),$("#"+e).width()/2),o="";if(""!=modelsParameters[l].label&&modelsParameters[l].displayLabel){const a=this.getTransformedText("label");if(s=Math.min($("#"+e).height(),$("#"+e).width()/4),_.isUndefined(modelsParameters[l].selectWidthProportion))o='<span id="select-span'+t+'" class="select-span" style="max-width: 45%; '+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+'">'+a+"</span>";else{const e=Math.max(0,100-parseFloat(modelsParameters[l].selectWidthProportion))+"%";o='<span id="select-span'+t+'" class="select-span" style="width:'+e+"; "+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+'">'+a+"</span>"}}let r=[];if(_.isUndefined(modelsParameters[l].isKeyValuePairs)&&(modelsParameters[l].isKeyValuePairs=!0),!_.isUndefined(modelsHiddenParams[l].value))if(0!=modelsHiddenParams[l].value.length)r=modelsHiddenParams[l].value;else if(0!=modelsHiddenParams[l].values.length){for(let e=0;e<modelsHiddenParams[l].values.length;e++)r[e]={},r[e].value=modelsHiddenParams[l].values[e];for(let e=0;e<modelsHiddenParams[l].keys.length;e++)r[e].key=modelsHiddenParams[l].keys[e]}o+='<select data-toggle="select" id="select'+t+'" class="select-div form-control select select-primary select-block mbl" style="height: '+s+'px;">';for(let e=0;e<r.length;e++)o+='<option value="'+r[e].value+'">'+r[e].key+"</option>";o+="</select>",a.innerHTML=o,a.setAttribute("id","select-div-container"+t),a.setAttribute("style","height: "+s+"px; "+this.selectFontSize()+this.selectValueFontFamily()),$("#"+e).html(a),this.bIsInteractive?i.enable():i.disable();new MutationObserver((function(e,l){for(const a of e)if("childList"===a.type&&a.addedNodes.length){const e=document.querySelector("#s2id_select"+t+" > a > span:first-child");if(e){const t=e.getAttribute("id").split("-"),a=t[t.length-1];document.styleSheets[0].addRule("#select2-results-"+a,i.selectValueFontFamily()),l.disconnect()}}})).observe(document.body,{childList:!0,subtree:!0}),""!=modelsHiddenParams[l].selectedValue&&($("#select"+t)[0].value=modelsHiddenParams[l].selectedValue),this.findInSelect(this.tmpSelectedValue)&&($("#select"+t)[0].value=this.tmpSelectedValue),$("#select"+t).select2(),i.bFirstExec=!1},this.findInSelect=function(e){let t={};return _.isUndefined(i.values)?_.isUndefined(i.keyValuePairs)||(t=i.keyValuePairs):t=i.values,bFind=_.find(t.selectionValues,(function(t){return t==e})),bFind};const s=new WidgetActuatorDescription("selectedValue","Selected value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER),o=new WidgetActuatorDescription("selectedValue","Selected value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_STRING),r=new WidgetActuatorDescription("selectedValue","Selected value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER_OR_STRING),n=new WidgetActuatorDescription("keys","Labels of the selectable options",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING_ARRAY),d=new WidgetActuatorDescription("values","Selectable values. Must match 'keys'.",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING_ARRAY),c=new WidgetActuatorDescription("values","Selectable values. Must match 'keys'.",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER_ARRAY),u=new WidgetActuatorDescription("keyValuePairs","Array of selectable key-value objects; Key being the displayed label",WidgetActuatorDescription.READ,{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:selectFlatUiWidget_keyValuePairs_isNumber",type:"array",items:{type:"object",properties:{key:{type:["string","number","boolean"]},value:{type:"number"}},required:["key"]}}),h=new WidgetActuatorDescription("keyValuePairs","Array of selectable key-value objects; Key being the displayed label",WidgetActuatorDescription.READ,{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:selectFlatUiWidget_keyValuePairs",type:"array",items:{type:"object",properties:{key:{type:["string","number","boolean"]},value:{type:"string"}},required:["key"]}});this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[l],a=[];t&&t.isKeyValuePairs?a.push(t.isNumber?u:h):(a.push(n),a.push(t&&t.isNumber?c:d));let i=r;return t&&(i=t.isNumber?s:o),a.push(i),a},this.selectedValue={updateCallback:function(){},setValue:function(e){i.tmpSelectedValue=e;i.findInSelect(e)&&($("#select"+t)[0].value=e,modelsHiddenParams[l].selectedValue=e,i.render())},getValue:function(){return modelsParameters[l].isNumber?Number($("#select"+t)[0].value):$("#select"+t)[0].value},addValueChangedHandler:function(e){this.updateCallback=e,""!=$("#select"+t)[0].value&&e(this,$("#select"+t)[0].value),i.enable()},removeValueChangedHandler:function(e){i.disable()},setCaption:function(e,a){modelsParameters[l].inheritLabelFromData&&(i.captionHelper(e,i.bIsInteractive,a),$("#select-span"+t).text(modelsParameters[l].label))},clearCaption:function(){modelsParameters[l].label="",i.render()}},modelsParameters[l].isKeyValuePairs?this.keyValuePairs={selectionValues:[],setValue:function(e){if(""==e)selectionValues=[],modelsHiddenParams[l].value=e,i.render();else{const t='"keyValuePairs" must be an array of key or an array of key/value pairs (in widget'+l+")",a='Example1: [{"key":"choice1"}, {"key":"choice2"}] \n or Example2: [{"key":"choice1", "value":"1"}, {"key":"choice2", "value":"2"}]';if(!Array.isArray(e))return void swal(t,a,"info");for(let l=0;l<e.length;l++){if(_.isUndefined(e[l].key))return void swal(t,a,"info");_.isUndefined(e[l].value)&&(e[l].value=e[l].key),this.selectionValues[l]=e[l].value}modelsHiddenParams[l].value=e,i.render()}},getValue:function(){return modelsHiddenParams[l].value},addValueChangedHandler:function(e){i.enable()},removeValueChangedHandler:function(e){i.disable()}}:(this.keys={selectionValues:[],setValue:function(e){if(""===e)selectionValues=[],modelsHiddenParams[l].value=e,i.render();else{const t='"keys" must be an array (in widget'+l+")",a='Example: ["choice1","choice2"]';if(!Array.isArray(e))return void swal(t,a,"info");if("object"==typeof e[0])return void swal(t,a,"info");for(let t=0;t<e.length;t++)this.selectionValues[t]=e[t];modelsHiddenParams[l].value=[],modelsHiddenParams[l].keys=e,i.render()}},getValue:function(){return modelsHiddenParams[l].value},addValueChangedHandler:function(e){i.enable()},removeValueChangedHandler:function(e){i.disable()}},this.values={selectionValues:[],setValue:function(e){if(""===e)selectionValues=[],modelsHiddenParams[l].value=e,i.render();else{const t='"value" must be an array (in widget'+l+")",a="Example: [1, 2]";if(_.isNull(e)&&(e=modelsHiddenParams[l].keys),!Array.isArray(e))return void swal(t,a,"info");if("object"==typeof e[0])return void swal(t,a,"info");for(let t=0;t<e.length;t++)this.selectionValues[t]=e[t];modelsHiddenParams[l].value=[],modelsHiddenParams[l].values=e,i.render()}},getValue:function(){return modelsHiddenParams[l].value},addValueChangedHandler:function(e){i.enable()},removeValueChangedHandler:function(e){i.disable()}}),i.render()},this.selectFlatUiWidget.prototype=baseWidget.prototype,this.multiSelectFlatUiWidget=function(e,t,l,a){this.constructor(e,t,l,a);const i=this;this.enable=function(){$("#multi-select"+t).on("click",(function(e){i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue())})),$("#multi-select"+t)[0].style.opacity="1"},this.disable=function(){$("#multi-select"+t)[0].style.opacity="0.7"},this.rescale=function(){this.render()},this.hasScrollBar=function(e){return e.get(0).scrollHeight>e.get(0).clientHeight},this.render=function(){const a=document.createElement("div"),s=$("#"+e).height();a.setAttribute("style","width: inherit; height: "+s+"px; cursor: inherit;");let o='<div class="multi-select-div" id="multi-select'+t+'" style="height: '+s+"px; "+this.valueDefaultColor()+this.border()+'">';const r=modelsHiddenParams[l].value;let n="";if(n=this.bIsInteractive?"cursor: pointer; ":"cursor: inherit; ",_.isUndefined(modelsParameters[l].valueFontSize)&&(modelsParameters[l].valueFontSize=.4),Array.isArray(r))for(const e of r)o+="<label >",o+='<input type="checkbox" value="'+e+'" />',o+='<span id="multi-select-label'+t+'" style="'+n+this.valueFontFamily()+this.valueFontSize()+this.checkboxWidth()+this.checkboxHeight()+'" tabindex="-1">'+e+"</span>",o+="</label>";o+="</div>",a.innerHTML=o,$("#"+e).html(a);i.hasScrollBar($("#multi-select"+t))||$("#multi-select"+t+".multi-select-div").css("align-content","center");const d=window.mobileAndTabletCheck();("ontouchstart"in document.documentElement||d)&&($("#multi-select"+t)[0].style.height="auto"),modelsParameters[l].resetPastSelection||_.isEmpty(modelsHiddenParams[l].selectedValue)||$("#multi-select"+t+" > label > input[type='checkbox']").each((function(){for(const e of modelsHiddenParams[l].selectedValue)$(this).val()==e&&$(this).attr("checked",!0)})),document.styleSheets[0].addRule("#multi-select-label"+t,this.valueDefaultColor()),document.styleSheets[0].addRule("#multi-select-label"+t,this.checkboxDefaultColor()),document.styleSheets[0].addRule("#multi-select-label"+t,this.checkboxBorder()),document.styleSheets[0].addRule("#multi-select-label"+t+":hover",this.valueHoverColor()),document.styleSheets[0].addRule("#multi-select-label"+t+":hover",this.checkboxHoverColor()),document.styleSheets[0].addRule("#multi-select-label"+t+":hover",this.checkboxHoverBorderColor()),document.styleSheets[0].addRule('input[type="checkbox"]:checked + #multi-select-label'+t,this.valueFocusColor()),document.styleSheets[0].addRule('input[type="checkbox"]:checked + #multi-select-label'+t,this.checkboxFocusColor()),document.styleSheets[0].addRule('input[type="checkbox"]:checked + #multi-select-label'+t,this.checkboxFocusBorderColor()),this.bIsInteractive?i.enable():i.disable()};const s=new WidgetActuatorDescription("value","Available choices",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_PRIMITIVE_ARRAY),o=new WidgetActuatorDescription("selectedValue","Currently selected choices",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_STRING_ARRAY);this.getActuatorDescriptions=function(){return[s,o]},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[l].value=e,i.render(),i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue())},getValue:function(){return modelsParameters[l].isNumber?Number(modelsHiddenParams[l].value):modelsHiddenParams[l].value},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,t){},clearCaption:function(){}},this.selectedValue={updateCallback:function(){},setValue:function(e){$("#multi-select"+t+" > label > input[type='checkbox']").each((function(){for(const t of e)$(this).val()===t&&$(this).attr("checked",!0)})),modelsHiddenParams[l].selectedValue=e},getValue:function(){const e=[];return $("#multi-select"+t+" > label > input[type='checkbox']:checked").each((function(){modelsParameters[l].isNumber?e.push(Number($(this).val())):e.push($(this).val())})),e},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,t){},clearCaption:function(){}},i.render()},this.multiSelectFlatUiWidget.prototype=baseWidget.prototype,this.listFlatUiWidget=function(e,t,l,a){this.constructor(e,t,l,a);const i=this;this.enable=function(){let e=!1,l=!1;$("#list"+t).on("keyup",(function(e){l&&(65!=e.keyCode&&97!=e.keyCode&&17!=e.keyCode||(i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue()),l=!1))})),$("#list"+t).on("click keyup",(function(a){l=!1,a.ctrlKey?e||(e=!0,$("#list"+t).one("keyup",(function(t){i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue()),e=!1,l=!0}))):(i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue()),e||(e=!0,$("#list"+t).one("keyup",(function(t){65!=t.keyCode&&97!=t.keyCode&&17!=t.keyCode||(i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue()),e=!1,l=!0)}))))})),$("#list"+t)[0].style.opacity="1"},this.disable=function(){$("#list"+t)[0].style.opacity="0.7"},this.rescale=function(){this.render()},this.render=function(){const a=document.createElement("div"),s=$("#"+e).height();a.setAttribute("style","width: inherit; height: "+s+"px; cursor: inherit;");const o=this.border();let r='<select class="form-control" id="list'+t+'" multiple size="10" style="width: 100%; height: '+s+"px;/*background-color: rgba(255, 255, 255, 0)*/; border-radius: 6px; color: "+modelsParameters[l].listValueColor+"; "+o+"; "+this.valueFontFamily()+"box-sizing: border-box; font-size: calc(7px + "+modelsParameters[l].listValueFontSize*getFontFactor()+'vw + 0.4vh); cursor: inherit; max-width : 2000px">';const n=modelsHiddenParams[l].value;let d="";if(d=this.bIsInteractive?"cursor: pointer; ":"cursor: inherit; ",Array.isArray(n))for(const e of n)r+='<option style="'+d+'">'+e+"</option>";r+="</select>",a.innerHTML=r,$("#"+e).html(a);const c=window.mobileAndTabletCheck();("ontouchstart"in document.documentElement||c)&&($("#list"+t)[0].style.height="auto"),_.isEmpty(modelsHiddenParams[l].selectedValue)||$("#list"+t).val(modelsHiddenParams[l].selectedValue),document.styleSheets[0].addRule("#list"+t+" option",modelsParameters[l].listValueColor),document.styleSheets[0].addRule("#list"+t+" option",this.listBackgroundColor()),document.styleSheets[0].addRule("#list"+t+" option:checked",this.selectValueColor()),document.styleSheets[0].addRule("#list"+t+" option:checked",this.selectValueBackgroundColor()),this.bIsInteractive?i.enable():i.disable()};const s=new WidgetActuatorDescription("value","Available choices",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_PRIMITIVE_ARRAY),o=new WidgetActuatorDescription("selectedValue","Currently selected choices",WidgetActuatorDescription.READ_WRITE,{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:listFlatUiWidget_selectedValue",anyOf:[{type:"string"},{type:"array",items:{type:"string"}}]});this.getActuatorDescriptions=function(){return[s,o]},this.value={updateCallback:function(){},setValue:function(e){pastSelect=JSON.stringify(modelsHiddenParams[l].selectedValue),modelsHiddenParams[l].value=e,i.render(),selected=JSON.stringify(i.selectedValue.getValue()),selected!==pastSelect&&i.selectedValue.updateCallback(i.selectedValue,i.selectedValue.getValue())},getValue:function(){return modelsHiddenParams[l].value},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,t){},clearCaption:function(){}},this.selectedValue={updateCallback:function(){},setValue:function(e){$("#list"+t).val(e),modelsHiddenParams[l].selectedValue=e},getValue:function(){const e=document.getElementById("list"+t),a=$("#list"+t).val(),i=e.selectedOptions;let s=0;if(Array.isArray(modelsHiddenParams[l].value)&&(s=modelsHiddenParams[l].value.length),0===i.length)return"";for(const e of i)if(e.index<0||e.index>=s)return"";return a},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,t){},clearCaption:function(){}},i.render()},this.listFlatUiWidget.prototype=baseWidget.prototype,this.tableFlatUiWidget=function(e,t,l,a){this.constructor(e,t,l,a);const i=this;this.enable=function(){$("#table"+t).editableTableWidget(),$("#table"+t+" td").on("change",(function(e,t){const a=$(this),s=a.parent(),o=a.index();let r=s.index(),n=.5;_.isUndefined(modelsParameters[l].tableValueFontSize)||(n=modelsParameters[l].tableValueFontSize),modelsParameters[l].headerLine&&(r+=1),_.isNaN(Number(t))||(t=Number(t)),modelsHiddenParams[l].value[r][o]=t,a.html('<span style="'+i.valueColor()+i.valueFontFamily()+" font-size: calc(7px + "+n*getFontFactor()+'vw)">'+t+"<span>"),i.value.updateCallback(i.value,i.value.getValue())}))},this.disable=function(){$("#table"+t+" td").on("change",(function(e,t){}))},this.buildTable=function(e){let t,a="",i=0,s=.5;_.isUndefined(modelsParameters[l].tableValueFontSize)||(s=modelsParameters[l].tableValueFontSize);let o=Array.isArray(e);if(o){let r=e[0];if(o=Array.isArray(r),o){if(modelsParameters[l].headerLine){i=1,a+="<thead><tr>";for(const t of e[0])a+='<th style="'+this.valueAlign()+'"><span style="'+this.valueColor()+this.valueFontFamily()+" font-size: calc(7px + "+s*getFontFactor()+'vw);"><b>'+t+"</b></span></th>";a+="</tr></thead>"}a+="<tbody>";for(let o=i;o<e.length;o++){modelsParameters[l].striped?o%2!=0&&(a+='<tr style="'+this.tableBackgroundColor("secondary")+'">'):a+="<tr>";for(let i=0;i<e[o].length;i++){let r=[];try{r=JSON.parse(modelsParameters[l].editableCols)}catch(e){}let n="";-1==_.indexOf(r,i)?t="false":(t="true",this.bIsInteractive&&(n="cursor: cell;")),a+='<td style="'+n+this.valueAlign()+'" data-editable="'+t+'"><span style="'+this.valueColor()+this.valueFontFamily()+" font-size: calc(7px + "+s*getFontFactor()+'vw)">'+e[o][i]+"</span></td>"}a+="</tr>"}a+="</tbody>"}else{a+="<tbody><tr>";for(let t=i;t<e.length;t++)r=e[t],a+='<td style="'+this.valueAlign()+'"><span style="'+this.valueColor()+this.valueFontFamily()+" font-size: calc(7px + "+s*getFontFactor()+'vw)">'+r+"</span></td>";a+="</tr></tbody>"}}return a},this.rescale=function(){this.render()},this.render=function(){const a=document.createElement("div"),s="cursor: "+(this.bIsInteractive?"auto":"inherit")+"; width: inherit; height: inherit; overflow: auto";a.setAttribute("style",s);let o='<table style="margin: 0; height: 100%; '+this.tableBackgroundColor("primary")+'" class="table';modelsParameters[l].bordered&&(o+=" table-bordered "),_.isUndefined(modelsParameters[l].noBorder)?modelsParameters[l].noBorder=!1:modelsParameters[l].noBorder&&(o+=" no-border "),o+=' table-responsive" id="table'+t+'" >';const r=modelsHiddenParams[l].value;let n=i.buildTable(r);""==n&&(n="<tbody><tr><td/><td/><td/></tr><tr><td/><td/><td/></tr></tbody>"),o+=n+"</table>",a.innerHTML=o,$("#"+e).html(a),this.bIsInteractive?i.enable():i.disable()};const s={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:tableFlatUiWidget",anyOf:[{type:"array",items:{anyOf:[{type:"string"},{type:"number"},{type:"boolean"}]}},{type:"array",items:{type:"array",items:{anyOf:[{type:"string"},{type:"number"},{type:"boolean"}]}}}]},o=new WidgetActuatorDescription("value","Table content as an array or array of arrays",WidgetActuatorDescription.READ,s),r=new WidgetActuatorDescription("value","Table content as an array or array of arrays",WidgetActuatorDescription.READ_WRITE,s);this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[l];let a=[];try{a=JSON.parse(t.editableCols)}catch(e){}return Array.isArray(a)&&a.length?[r]:[o]},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[l].value=e,i.render()},getValue:function(){return modelsHiddenParams[l].value},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,t){},clearCaption:function(){}},i.render()},this.tableFlatUiWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"flatUi",widgetsDefinitionList:{flatUiSelect:{factory:"selectFlatUiWidget",title:"Select",icn:"select",help:"wdg/wdg-basics/#select"},flatUiMultiSelect:{factory:"multiSelectFlatUiWidget",title:"Multi-select",icn:"multi-select",help:"wdg/wdg-basics/#multi-select"},flatUiList:{factory:"listFlatUiWidget",title:"List",icn:"list",help:"wdg/wdg-basics/#list"},flatUiTable:{factory:"tableFlatUiWidget",title:"Table",icn:"board",help:"wdg/wdg-basics/#table"}}},this.constructor()}modelsHiddenParams.flatUiSelect={keys:[],values:[],value:[],selectedValue:""},modelsHiddenParams.flatUiMultiSelect={value:[],selectedValue:""},modelsHiddenParams.flatUiList={value:[],selectedValue:""},modelsHiddenParams.flatUiTable={value:null},modelsParameters.flatUiSelect={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",selectWidthProportion:"70%",isNumber:!1,selectValueFontFamily:"var(--widget-font-family)",selectValueFontSize:.5,selectedValueColor:"var(--widget-select-option-highlighted-text)",selectedItemDefaultColor:"var(--widget-select-option-highlighted-color)",selectedItemHoverColor:"var(--widget-select-option-highlighted-color)",isKeyValuePairs:!1},modelsParameters.flatUiMultiSelect={addControls:!1,resetPastSelection:!1,valueFontSize:.4,valueFontFamily:"var(--widget-font-family)",checkboxWidth:7,checkboxHeight:1.5,valueDefaultColor:"var(--widget-label-color)",checkboxDefaultColor:"var(--widget-multiselect-color)",checkboxBorderColor:"var(--widget-multiselect-border-color)",valueHoverColor:"var(--widget-multiselect-hover-text)",checkboxHoverColor:"var(--widget-multiselect-hover-color)",checkboxHoverBorderColor:"var(--widget-multiselect-hover-border-color)",valueFocusColor:"var(--widget-multiselect-checked-text)",checkboxFocusColor:"var(--widget-multiselect-checked-color)",checkboxFocusBorderColor:"var(--widget-multiselect-checked-border-color)",displayBorder:!0,borderColor:"var(--widget-border-color)",isNumber:!1},modelsParameters.flatUiList={addControls:!1,listValueFontSize:.5,listValueColor:"var(--widget-select-drop-text)",listBackgroundColor:"var(--widget-select-drop-color)",selectValueColor:"var(--widget-select-option-highlighted-text)",selectValueBackgroundColor:"var(--widget-select-option-highlighted-color)",valueFontFamily:"var(--widget-font-family)",borderColor:"var(--widget-border-color)",displayBorder:!0},modelsParameters.flatUiTable={headerLine:!1,tableValueFontSize:.5,striped:!0,valueColor:"var(--widget-table-value-color)",valueFontFamily:"var(--widget-font-family)",valueAlign:"left",bordered:!0,noBorder:!1,editableCols:"[]",backgroundColor:{primary:"var(--widget-color-0)",secondary:"var(--widget-table-striped-odd)"}},modelsLayout.flatUiSelect={height:"5vh",width:"19vw",minWidth:"40px",minHeight:"27px"},modelsLayout.flatUiMultiSelect={height:"16vh",width:"11vw",minWidth:"80px",minHeight:"75px"},modelsLayout.flatUiList={height:"16vh",width:"11vw",minWidth:"80px",minHeight:"75px"},modelsLayout.flatUiTable={height:"10vh",width:"11vw",minWidth:"88px",minHeight:"79px"},flatUiComplexWidgetsPluginClass.prototype=basePlugin.prototype;var flatUiComplexWidgetsPlugin=new flatUiComplexWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(flatUiComplexWidgetsPlugin);
function flatUiBooleanWidgetsPluginClass(){this.checkboxFlatUiWidget=function(e,t,i,l){this.constructor(e,t,i,l);const a=this;this.enable=function(){$("#checkbox"+t).off("click").on("click",(function(e,t){a.value.updateCallback(a.value,a.value.getValue())})),$("#checkbox"+t).radiocheck("enable")},this.disable=function(){$("#checkbox"+t).unbind("click"),$("#checkbox"+t).radiocheck("disable")},this.rescale=function(){this.render()},this.render=function(){let l=20,s=20;_.isNull($(".icons").height())||(l=$(".icons").height()),_.isNull($(".icons").width())||(s=$(".icons").width()),_.isUndefined(modelsParameters[i].checkboxSize)&&(modelsParameters[i].checkboxSize=1);const o=modelsParameters[i].checkboxSize*s,c=modelsParameters[i].checkboxSize*l;let d="";const n=document.createElement("div");n.setAttribute("id","checkbox-widget-html"+t);modelsParameters[i].checkboxSize,$("#"+e).height();n.setAttribute("style","width: inherit; cursor: inherit; display: flex; justify-content: center;");const r=_.isUndefined(modelsParameters[i].labelPosition)||"right"!==modelsParameters[i].labelPosition?"left":"right",h="left"===r?"rtl":"ltr";if(document.styleSheets[0].addRule("#checkbox-widget-html"+t,"direction: "+h),""!=modelsParameters[i].label&&modelsParameters[i].displayLabel){const e=this.getTransformedText("label");let l='style = "cursor: inherit; padding-top:'+c+"px;";l+="right"===r?" padding-right: "+o+'px; padding-left: 0px; margin-right: 6px;"':" padding-left: "+o+'px; padding-right: 0px; margin-left: 6px;"',d+='<label class="checkbox" id="label'+t+'" '+l+' for="checkbox'+t+'">',d+='<input type="checkbox" class="nohover" data-toggle="radio" style="zoom:'+modelsParameters[i].checkboxSize+'" value="" id="checkbox'+t+'" disabled>',d+="</input>",d+="</label>";const a='style="display: flex; align-items: center; '+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+'"';d+='<span id="checkbox-span'+t+'" class="checkbox-span" '+a+">"+e+"</span>"}else{d+='<label class="checkbox" id="label'+t+'" '+('style = "cursor: inherit; padding-top:'+c+"px; padding-left: "+o+'px; padding-right: 0px;"')+' for="checkbox'+t+'">',d+='<input type="checkbox" class="nohover" data-toggle="radio" style="zoom:'+modelsParameters[i].checkboxSize+' value="" id="checkbox'+t+'" disabled>',d+="</input>",d+="</label>"}n.innerHTML=d,$("#"+e).html(n),$('[data-toggle="checkbox"]').radiocheck(),$('[data-toggle="radio"]').radiocheck(),1==modelsHiddenParams[i].value?$("#checkbox"+t).radiocheck("check"):0==modelsHiddenParams[i].value&&$("#checkbox"+t).radiocheck("uncheck"),document.styleSheets[0].addRule("#label"+t+" .icons *","zoom: "+modelsParameters[i].checkboxSize),document.styleSheets[0].addRule("#label"+t+" .icons .icon-checked",this.checkedColor()),document.styleSheets[0].addRule("#label"+t+" .icons .icon-unchecked",this.uncheckedColor()),this.bIsInteractive?a.enable():a.disable()};const s=new WidgetActuatorDescription("value","Current value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_BOOLEAN);this.getActuatorDescriptions=function(){return[s]},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[i].value=e,$("#checkbox"+t)[0].checked=e},getValue:function(){return $("#checkbox"+t)[0].checked},addValueChangedHandler:function(e){this.updateCallback=e,a.enable()},removeValueChangedHandler:function(e){a.disable()},setCaption:function(e,t){modelsParameters[i].inheritLabelFromData&&(a.captionHelper(e,a.bIsInteractive,t),a.render())},clearCaption:function(){modelsParameters[i].label="",a.render()}},a.render()},this.checkboxFlatUiWidget.prototype=baseWidget.prototype,this.switchFlatUiWidget=function(e,t,i,l){this.constructor(e,t,i,l);const a=this;this.enable=function(i){$("#switch"+t).on("click",(function(i,l){if(a.value.updateCallback(a.value,a.value.getValue()),$("#switch"+t)[0].checked){const i=$("#switch-label"+t).height(),l=$("#"+e).width(),a=Math.min(l,i)-8,s=$("#slide"+t).width()-a-8;document.styleSheets[0].addRule("#slide"+t+":before","transform: translateX("+s+"px);")}else document.styleSheets[0].addRule("#slide"+t+":before","transform: translateX(0px);")})),$("#switch"+t).prop("disabled",!1)},this.disable=function(){$("#switch"+t).unbind("click"),$("#switch"+t).prop("disabled",!0)},this.updateSwitchStatus=function(){if(1==modelsHiddenParams[i].value){if(!$("#switch"+t)[0].checked){$("#switch"+t).prop("checked",!0);const i=$("#switch-label"+t).height(),l=$("#"+e).width(),a=Math.min(l,i)-8,s=$("#slide"+t).width()-a-8;document.styleSheets[0].addRule("#slide"+t+":before","transform: translateX("+s+"px);"),document.styleSheets[0].addRule("input:checked + #slide"+t,this.switchOnColor()),document.styleSheets[0].addRule("input:focus + #slide"+t,this.switchOnColor())}}else 0==modelsHiddenParams[i].value&&$("#switch"+t)[0].checked&&($("#switch"+t).prop("checked",!1),document.styleSheets[0].addRule("#slide"+t+":before","transform: translateX(0px);"))},this.rescale=function(){this.render()},this.render=function(){let l=1;_.isUndefined(modelsParameters[i].switchWidthProportion)||(l=Math.min(1,parseFloat(modelsParameters[i].switchWidthProportion)/100));const s=$("#"+e).height();let o=Math.min(s,260);o=Math.min(o,l*$("#"+e).width()/3),o=Math.ceil(o);const c=$("#"+e).width(),d=document.createElement("div");d.setAttribute("id","switch-widget-html"+t),d.setAttribute("class","switch-widget-html"),d.setAttribute("style","height: "+s+"px;");const n=_.isUndefined(modelsParameters[i].labelPosition)||"right"!==modelsParameters[i].labelPosition?"left":"right",r="left"===n?"rtl":"ltr";let h;if(document.styleSheets[0].addRule("#switch-widget-html"+t,"direction: "+r),_.isUndefined(modelsParameters[i].switchWidthProportion))h='<div class="switch-div" style="width: 100%;">';else{h='<div class="switch-div" style="width: '+(Math.min(100,parseFloat(modelsParameters[i].switchWidthProportion))+"%")+';">'}let u="";if(u=this.bIsInteractive?"cursor: pointer;":"cursor: inherit;",h+='<label id="switch-label'+t+'" class="switch-label" style="height:'+o+'px;">',h+='<input type="checkbox" id="switch'+t+'">',h+='<div id="slide'+t+'"class="slider round" style="'+u+'">',h+="</div>",h+="</label>",h+="</div>",""!=modelsParameters[i].label&&modelsParameters[i].displayLabel){const e=this.getTransformedText("label");h+='<span id="switch-span'+t+'" class="switch-span" style="'+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+" text-align: "+n+';">'+e+"</span>"}d.innerHTML=h,$("#"+e).html(d),document.styleSheets[0].addRule("input + #slide"+t,this.switchOffColor()),document.styleSheets[0].addRule("input:checked + #slide"+t,this.switchOnColor()),document.styleSheets[0].addRule("input:focus + #slide"+t,this.switchShadowColor());const m=Math.min(c,o)-8;if(document.styleSheets[0].addRule("#slide"+t+":before","width: "+m+"px;"),document.styleSheets[0].addRule("#slide"+t+":before","height: "+m+"px;"),null==modelsHiddenParams[i].value&&(modelsHiddenParams[i].value=!1),1==modelsHiddenParams[i].value){$("#switch"+t).prop("checked",!0);const e=$("#slide"+t).width()-m-8;document.styleSheets[0].addRule("#slide"+t+":before","transform: translateX("+e+"px);")}else 0==modelsHiddenParams[i].value&&($("#switch"+t).prop("checked",!1),document.styleSheets[0].addRule("#slide"+t+":before","transform: translateX(0px);"));this.bIsInteractive?a.enable():a.disable(),$("#switch"+t)[0].checked=modelsHiddenParams[i].value};const s=new WidgetActuatorDescription("value","Current value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_BOOLEAN);this.getActuatorDescriptions=function(){return[s]},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[i].value=e,a.updateSwitchStatus()},getValue:function(){return $("#switch"+t)[0].checked},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e,t){modelsParameters[i].inheritLabelFromData&&(a.captionHelper(e,a.bIsInteractive,t),a.render())},clearCaption:function(){modelsParameters[i].label="",a.render()}},a.render()},this.switchFlatUiWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"flatUiBoolean",widgetsDefinitionList:{flatUiCheckbox:{factory:"checkboxFlatUiWidget",title:"Checkbox",icn:"checkbox",help:"wdg/wdg-basics/#checkbox"},flatUiSwitch:{factory:"switchFlatUiWidget",title:"Switch",icn:"switch",help:"wdg/wdg-basics/#switch"}}},this.constructor()}modelsHiddenParams.flatUiCheckbox={value:!1},modelsHiddenParams.flatUiSwitch={value:!1},modelsParameters.flatUiCheckbox={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelPosition:"right",labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",checkboxSize:1,checkedColor:"var(--widget-input-checked-color)",uncheckedColor:"var(--widget-input-unchecked-color)"},modelsParameters.flatUiSwitch={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelPosition:"right",labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",switchWidthProportion:"30%",switchOnColor:"var(--widget-input-checked-color)",switchOffColor:"var(--widget-input-unchecked-color)"},modelsLayout.flatUiCheckbox={height:"5vh",width:"9vw",minWidth:"32px",minHeight:"24px"},modelsLayout.flatUiSwitch={height:"5vh",width:"10vw",minWidth:"50px",minHeight:"24px"},flatUiBooleanWidgetsPluginClass.prototype=basePlugin.prototype;var flatUiBooleanWidgetsPlugin=new flatUiBooleanWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(flatUiBooleanWidgetsPlugin);
function flatUiAddressCompletionWidgetsPluginClass(){this.hereAutocompleteValueFlatUiWidget=function(e,t,a,i){this.constructor(e,t,a,i);var s=this;this.updateValue=function(e){if(!_.contains([9,16,17,18,20,33,34,35,36,37,38,39,40],e.which)&&(10==e.which||13==e.which||27==e.which)){var i=$("#ac-value"+t)[0].value;modelsHiddenParams[a].value=i,s.value.updateCallback(s.value,i),e.preventDefault()}},this.enable=function(){$("#ac-value"+t).prop("disabled",!1),$("#ac-value"+t).bind("typeahead:selected",(function(e,t,i){modelsHiddenParams[a].value=t.word,s.value.updateCallback(s.value,t.word)})),$("#ac-value"+t).on("keyup",(function(e,t){s.updateValue(e)})),$("#ac-value"+t).on("click",(function(e,t){widgetPreview.elevateZIndex(a,e)})),s.initTypeahead()},this.disable=function(){$("#ac-value"+t).prop("disabled",!0)},this.formatHereSuggestTable=function(e){var t=[];if(_.isUndefined(e))return t;if(_.isEmpty(e))return t;if(_.isUndefined(e.suggestions))return t;if(_.isEmpty(e.suggestions))return t;for(var a=0;a<e.suggestions.length;a++)t[a]=[],t[a][0]=e.suggestions[a].address.houseNumber,t[a][1]=e.suggestions[a].address.street,t[a][2]=e.suggestions[a].address.postalCode,t[a][3]=e.suggestions[a].address.city,t[a][4]=e.suggestions[a].address.county,t[a][5]=e.suggestions[a].address.state,t[a][6]=e.suggestions[a].address.country;return t},this.formatSuggestWords=function(e){var t,a,i,s=[];if(e.length<1)return"";for(var l=0;l<e.length;l++){s[l]="",i=!0;for(var o=0;o<=6;o++)a=i?"":", ",t=e[l][o],_.isNull(t)||_.isUndefined(t)||(s[l]=s[l]+a+t,i=!1)}var n=[];if(_.isArray(s))for(l=0;l<s.length;l++)n[l]={word:s[l]};return n},this.initTypeahead=function(){var e="";_.isUndefined(modelsParameters[a].countryIsoCodes)||(e="&country="+modelsParameters[a].countryIsoCodes),$("#ac-value"+t).typeahead("destroy"),$("#ac-value"+t).typeahead(null,{name:"suggestions",displayKey:"word",source:function(t,a){$.ajax({url:"https://xdashgateway.azure-api.net/autocomplete/suggest.json?query="+t+"&language=fr"+e,method:"GET",dataType:"json",success:function(e){var t=s.formatHereSuggestTable(e),i=s.formatSuggestWords(t);_.isUndefined(i)||a($.map(i,(function(e){return e})))}})}})},this.rescale=function(){this.render()},this.render=function(){let i=Math.min($("#"+e).height(),$("#"+e).width()/2);const l=document.createElement("div");l.setAttribute("id","ac-value-widget-html"+t),l.setAttribute("class","ac-value-widget-html");let o="";if(""!=modelsParameters[a].label&&modelsParameters[a].displayLabel){let s="";if(i=Math.min($("#"+e).height(),$("#"+e).width()/4),_.isUndefined(modelsParameters[a].valueWidthProportion))s="max-width: 45%; ";else{s="width: "+(Math.max(0,100-parseFloat(modelsParameters[a].valueWidthProportion))+"%")+"; "}const l=this.getTransformedText("label");o+='<span id ="ac-value-span'+t+'" class="ac-value-span" style="'+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+s+'">'+l+"</span>"}const n=this.border();o+='<div id="ac-value-no-input-group">',o+='<input id="ac-value'+t+'" type="text" placeholder="Type an address" autocomplete="off" spellcheck="false" class="value-input form-control" style="height: '+i+"px; "+n+"; float: right; "+this.valueFontSize()+this.valueColor()+this.valueFontFamily()+this.backgroundColor()+'text-align: left;">',o+="</input>",o+="</div>",l.innerHTML=o,this.bIsInteractive?l.setAttribute("style","height: "+i+"px; cursor: text;"):l.setAttribute("style","height: "+i+"px;"),$("#"+e).html(l),$("#ac-value"+t)[0].value=modelsHiddenParams[a].value,this.bIsInteractive?s.enable():s.disable()};const l=new WidgetActuatorDescription("value","Current value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(){return[l]},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[a].value=e,$("#ac-value"+t)[0].value=modelsHiddenParams[a].value},getValue:function(){return modelsHiddenParams[a].value},addValueChangedHandler:function(e){this.updateCallback=e,s.enable()},removeValueChangedHandler:function(e){s.disable()},setCaption:function(e,i){modelsParameters[a].inheritLabelFromData&&(s.captionHelper(e,s.bIsInteractive,i),$("#ac-value-span"+t).text(modelsParameters[a].label))},clearCaption:function(){modelsParameters[a].label="",s.render()}},s.render()},this.hereAutocompleteValueFlatUiWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"flatUiAddressCompletion",widgetsDefinitionList:{flatUiHereAutocompleteValue:{factory:"hereAutocompleteValueFlatUiWidget",title:"Address auto-completion",iconWidth:70,icn:"address-autocompletion",help:"wdg/wdg-geo-time/#address-autocompletion"}}},this.constructor()}modelsHiddenParams.flatUiHereAutocompleteValue={value:""},modelsParameters.flatUiHereAutocompleteValue={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valueWidthProportion:"70%",valueFontSize:.5,valueColor:"var(--widget-color)",valueFontFamily:"var(--widget-font-family)",displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-input-color)",countryIsoCodes:"FRA"},modelsLayout.flatUiHereAutocompleteValue={height:"5vh",width:"19vw",minWidth:"150px",minHeight:"32px"},flatUiAddressCompletionWidgetsPluginClass.prototype=basePlugin.prototype;var flatUiAddressCompletionWidgetsPlugin=new flatUiAddressCompletionWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(flatUiAddressCompletionWidgetsPlugin);
function flatUiWidgetsPluginClass(){const e=this;!function(e){e.fn.addSliderSegments=function(){return this.each((function(){var t=e(this),a=t.slider("option"),i=(a.max-a.min)/a.step;if("vertical"===a.orientation){for(var l="",r=1;r<=i-1;r++)l+='<div class="ui-slider-segment" style="top:'+100/i*r+'%;"></div>';t.prepend(l)}else{var o='<div class="ui-slider-segment" style="margin-left: '+(100/i+"%")+';"></div>';t.prepend(o.repeat(i-1))}}))}}(jQuery),this.buttonFlatUiWidget=function(e,t,a,i){this.constructor(e,t,a,i);const l=this;this.numberOfTriggers=modelsParameters[a].numberOfTriggers,this.enable=function(){},this.disable=function(){},this.readFileEvt=function(){const e=$("#button"+t+"_select_file");e.on("change",(function(e){const t=new FileReader,i=e.target.files[0],l=i.size;let r="";r=l<1024?l+" bytes":l<1048576?(l/1024).toFixed(1)+" KB":(l/1048576).toFixed(1)+" MB";const o={type:i.type,size:r,name:i.name};t.addEventListener("load",(function(e){const t=e.target.result;t instanceof ArrayBuffer?(o.content=btoa([].reduce.call(new Uint8Array(t),(function(e,t){return e+String.fromCharCode(t)}),"")),o.isBinary=!0):(o.content=t,o.isBinary=!1),updateDataNodeFileFromWidget(a,o)})),modelsParameters[a].binaryFileInput?t.readAsArrayBuffer(i):t.readAsText(i)})),$("#button"+t).mousedown((function(t){t.preventDefault(),e.trigger("click")}))},this.rescale=function(){this.render()},this.render=function(){const i=document.createElement("div");i.setAttribute("id","button-widget-html"+t),i.setAttribute("class","button-widget-html");const r=Math.min($("#"+e).height(),$("#"+e).width()/2);let o=.5;_.isUndefined(modelsParameters[a].buttonFontSize)||(o=modelsParameters[a].buttonFontSize);const n='style="height: inherit; font-size: calc(7px + '+o*getFontFactor()+"vw + 0.4vh); "+this.buttonFontFamily()+'" class="btn btn-table-cell btn-lg '+a+"widgetCustomColor";this.setButtonColorStyle();let s="";const d=this.getTransformedText("text");let u=d;if(this.displayIcon()){u='<i class="'+this.fontAwesomeIcon()+'"></i>'+" "+d}if(this.bIsInteractive){if(modelsParameters[a].fileInput||modelsParameters[a].binaryFileInput){s+="<a "+n+'" id="button'+t+'">'+u+("<input onclick=\"displaySpinnerOnInputFileButton('"+t+'\')" type="file" style="display : none;" id="button'+t+'_select_file"></input>')+"</a>"}else s+="<a onclick=\"updateDataNodeFromWidgetwithspinButton( '"+a+"', '"+t+"')\" "+n+'" id="button'+t+'">'+u+"</a>";l.enable()}else s+="<a "+n+' /*disabled*/" id="button'+t+'">'+u+"</a>",l.disable();i.innerHTML=s,i.setAttribute("style","height: "+r+"px;"),$("#"+e).html(i),(modelsParameters[a].fileInput||modelsParameters[a].binaryFileInput)&&l.readFileEvt()},this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[a],i=[];if(t&&t.numberOfTriggers){const e=t.fileInput||t.binaryFileInput;for(let a=1;a<=t.numberOfTriggers;a++){const t="trigger"+a;e?i.push(new WidgetActuatorDescription(t,"File content",WidgetActuatorDescription.FILE)):i.push(new WidgetActuatorDescription(t,"Node to trigger/re-evaluate",WidgetActuatorDescription.TRIGGER,WidgetPrototypesManager.SCHEMA_ANYTHING))}}return i};for(let e=1;e<=this.numberOfTriggers;e++){this["trigger"+e]={updateCallback:function(){},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()}}}l.render()},this.buttonFlatUiWidget.prototype=baseWidget.prototype,this.horizontalSliderFlatUiWidget=function(e,t,a,i){this.constructor(e,t,a,i);var l=this;l.updateValue=function(e){var i=Number($("#hslider-value"+t)[0].value);$("#slider"+t).slider({value:i}),modelsHiddenParams[a].value=i,l.value.updateCallback(l.value,l.value.getValue()),e.preventDefault()},this.enable=function(){$("#slider"+t).on("slidestop",(function(e,t){l.value.setValue(t.value),l.value.updateCallback(l.value,t)})),$("#slider"+t).on("slide",(function(e,t){l.value.setValue(t.value)})),$("#slider"+t).slider("enable"),modelsParameters[a].validationOnFocusOut&&$("#hslider-value"+t).on("focusout",(function(e,t){l.updateValue(e)})),modelsParameters[a].displayValue&&($("#hslider-value"+t).prop("disabled",!1),$("#hslider-value"+t).on("keypress",(function(e,t){13==e.which&&l.updateValue(e)})))},this.disable=function(){$("#slider"+t).on("slide",(function(e,t){})),$("#slider"+t).on("slidestop",(function(e,t){})),$("#slider"+t).slider("disable"),modelsParameters[a].displayValue&&$("#hslider-value"+t).prop("disabled",!0)},this.insertLabel=function(e){const t=this.getTransformedText("label"),i=document.createElement("span");i.setAttribute("class","label-h-slider"),i.setAttribute("id","h-slider-span"),_.isUndefined(modelsParameters[a].labelWidthProportion)?i.setAttribute("style","width: 20%; "+this.labelFontSize()+this.labelColor()+this.labelFontFamily()):i.setAttribute("style","width:"+modelsParameters[a].labelWidthProportion+"; "+this.labelFontSize()+this.labelColor()+this.labelFontFamily()),i.innerHTML=t,e.appendChild(i)},this.insertValue=function(i){var l;l=modelsParameters[a].displayLabel?Math.min($("#"+e).height(),$("#"+e).width()/6):Math.min($("#"+e).height(),$("#"+e).width()/8);var r=document.createElement("div");r.setAttribute("class","h-slider-value-div"),r.setAttribute("id","div-for-hslider-value"+t),_.isUndefined(modelsParameters[a].valueWidthProportion)?r.setAttribute("style","width:30%;"):r.setAttribute("style","width:"+modelsParameters[a].valueWidthProportion+";");var o="";o=this.bIsInteractive?"cursor: text;":"cursor: inherit;";var n='<input id="hslider-value'+t+'" type="text" placeholder="" class="hslider-input form-control" style="height: '+l+"px; "+this.valueFontSize()+this.valueColor()+this.valueFontFamily()+o+'" disabled></input>';r.innerHTML=n,i.appendChild(r)},this.rescale=function(){this.render()},this.render=function(){var i=document.createElement("div");i.setAttribute("class","sliderInput"),i.setAttribute("style","display: table");var r=document.createElement("div");r.setAttribute("id","h-slider-div"),_.isUndefined(modelsParameters[a].sliderWidthProportion)?r.setAttribute("style","width:50%;"):r.setAttribute("style","width:"+modelsParameters[a].sliderWidthProportion+";");var o=document.createElement("div");o.setAttribute("id","slider"+t),r.appendChild(o),modelsParameters[a].displayLabel&&this.insertLabel(i),i.appendChild(r),modelsParameters[a].displayValue&&this.insertValue(i),$("#"+e).html(i);var n=$("#slider"+t);n.length>0&&n.slider({min:modelsParameters[a].min,max:modelsParameters[a].max,step:modelsParameters[a].step,value:modelsHiddenParams[a].value,orientation:"horizontal",range:"min"}).addSliderSegments(),$("#slider"+t).addClass("h-slider-div-div"),document.styleSheets[0].addRule("#slider"+t,this.sliderSegmentColor()),document.styleSheets[0].addRule("#slider"+t+" > .ui-slider-range",this.sliderRangeColor()),document.styleSheets[0].addRule("#slider"+t+" > .ui-slider-handle",this.sliderHandleDefaultColor()),document.styleSheets[0].addRule("#slider"+t+" > .ui-slider-handle:hover",this.sliderHandleHoverColor()),document.styleSheets[0].addRule("#slider"+t+" > .ui-slider-handle:active",this.sliderHandleActiveColor()),document.styleSheets[0].addRule("#hslider-value"+t,this.valueBorderColor()),this.bIsInteractive?l.enable():l.disable(),modelsParameters[a].displayValue&&(modelsParameters[a].min>modelsHiddenParams[a].value?$("#hslider-value"+t)[0].value=modelsParameters[a].min:$("#hslider-value"+t)[0].value=modelsHiddenParams[a].value)};const r=new WidgetActuatorDescription("value","Current value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER),o=new WidgetActuatorDescription("min","Value lower bound",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER),n=new WidgetActuatorDescription("max","Value upper bound",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER);this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[a],i=[r];return t&&t.rangeActuator&&(i.push(o),i.push(n)),i},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[a].value=e,$("#slider"+t).slider({value:e}),modelsParameters[a].displayValue&&($("#hslider-value"+t)[0].value=e)},getValue:function(){return modelsHiddenParams[a].value},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()},setCaption:function(e,t){modelsParameters[a].inheritLabelFromData&&(l.captionHelper(e,l.bIsInteractive,t),l.render())},clearCaption:function(){modelsParameters[a].label="",l.render()}},this.max={updateCallback:function(){},setValue:function(e){const t=Number(e);modelsParameters[a].max=t,l.render()},getValue:function(){return modelsParameters[a].max},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()}},this.min={updateCallback:function(){},setValue:function(e){const t=Number(e);modelsParameters[a].min=t,l.render()},getValue:function(){return modelsParameters[a].min},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()}},l.render()},this.horizontalSliderFlatUiWidget.prototype=baseWidget.prototype,this.verticalSliderFlatUiWidget=function(e,t,a,i){this.constructor(e,t,a,i);var l=this;this.enable=function(e){$("#vertical-slider"+t).on("slidestop",(function(e,t){l.value.setValue(t.value),l.value.updateCallback(l.value,t)})),$("#vertical-slider"+t).on("slide",(function(e,t){l.value.setValue(t.value)})),$("#vertical-slider"+t).slider("enable")},this.disable=function(){$("#vertical-slider"+t).on("slidestop",(function(e,t){})),$("#vertical-slider"+t).on("slide",(function(e,t){})),$("#vertical-slider"+t).slider("disable")},this.insertLabel=function(e){const t=this.getTransformedText("label"),a=document.createElement("div");a.setAttribute("class","v-slider-div");const i=document.createElement("span");i.setAttribute("class","v-slider-span label-v-slider"),i.setAttribute("style",this.labelFontSize()+this.labelColor()+this.labelFontFamily()),i.innerHTML=t,a.appendChild(i),e.appendChild(a)},this.rescale=function(){this.render()},this.render=function(){var i=document.createElement("div");i.setAttribute("class","sliderInput");var r=document.createElement("div");r.setAttribute("id","vertical-slider"+t),r.setAttribute("class","v-slider-div-div"),r.setAttribute("style","height: calc(100% - 24px);"),i.appendChild(r),modelsParameters[a].displayLabel&&""!=modelsParameters[a].label&&(r.setAttribute("style","height: 80%;"),this.insertLabel(i)),$("#"+e).html(i);var o=$("#vertical-slider"+t);o.length>0&&o.slider({min:modelsParameters[a].min,max:modelsParameters[a].max,step:modelsParameters[a].step,value:modelsHiddenParams[a].value,orientation:"vertical",range:"min"}).addSliderSegments(o.slider("option").max,"vertical"),document.styleSheets[0].addRule("#vertical-slider"+t,this.sliderSegmentColor()),document.styleSheets[0].addRule("#vertical-slider"+t+" > .ui-slider-range",this.sliderRangeColor()),document.styleSheets[0].addRule("#vertical-slider"+t+" > .ui-slider-handle",this.sliderHandleDefaultColor()),document.styleSheets[0].addRule("#vertical-slider"+t+" > .ui-slider-handle:hover",this.sliderHandleHoverColor()),document.styleSheets[0].addRule("#vertical-slider"+t+" > .ui-slider-handle:active",this.sliderHandleActiveColor()),this.bIsInteractive?l.enable():l.disable()};const r=new WidgetActuatorDescription("value","Current value",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER),o=new WidgetActuatorDescription("min","Value lower bound",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER),n=new WidgetActuatorDescription("max","Value upper bound",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER);this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[a],i=[r];return t&&t.rangeActuator&&(i.push(o),i.push(n)),i},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[a].value=e,$("#vertical-slider"+t).slider({value:e})},getValue:function(){return modelsHiddenParams[a].value},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()},setCaption:function(e,t){modelsParameters[a].inheritLabelFromData&&(l.captionHelper(e,l.bIsInteractive,t),l.render())},clearCaption:function(){modelsParameters[a].label="",l.render()}},this.max={updateCallback:function(){},setValue:function(e){const t=Number(e);modelsParameters[a].max=t},getValue:function(){return modelsParameters[a].max},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()}},this.min={updateCallback:function(){},setValue:function(e){const t=Number(e);modelsParameters[a].min=t},getValue:function(){return modelsParameters[a].min},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()}},l.render()},this.verticalSliderFlatUiWidget.prototype=baseWidget.prototype,this.progressBarFlatUiWidget=function(e,t,a,i){this.constructor(e,t,a,i);var l=this;this.enable=function(){modelsParameters[a].displayValue&&$("#progress-bar-value"+t).prop("disabled",!1)},this.disable=function(){modelsParameters[a].displayValue&&$("#progress-bar-value"+t).prop("disabled",!0)},this.insertLabel=function(e){const t=this.getTransformedText("label"),i=document.createElement("span");i.setAttribute("class","label-progress-bar"),i.setAttribute("id","progress-bar-span"),_.isUndefined(modelsParameters[a].labelWidthProportion)?i.setAttribute("style","width: 20%; "+this.labelFontSize()+this.labelColor()+this.labelFontFamily()):i.setAttribute("style","width:"+modelsParameters[a].labelWidthProportion+"; "+this.labelFontSize()+this.labelColor()+this.labelFontFamily()),i.innerHTML=t,e.appendChild(i)},this.insertValue=function(i){var l;l=modelsParameters[a].displayLabel?Math.min($("#"+e).height(),$("#"+e).width()/6):Math.min($("#"+e).height(),$("#"+e).width()/8);var r=document.createElement("div");r.setAttribute("class","progress-bar-value-div"),r.setAttribute("id","div-for-progress-bar-value"+t),_.isUndefined(modelsParameters[a].valueWidthProportion)?r.setAttribute("style","width:30%;"):r.setAttribute("style","width:"+modelsParameters[a].valueWidthProportion+";");var o="";o=this.bIsInteractive?"cursor: text;":"cursor: inherit;";var n='<input id="progress-bar-value'+t+'" type="text" placeholder="" class="hslider-input form-control" style="height: '+l+"px; "+this.valueFontSize()+this.valueColor()+this.valueFontFamily()+o+'" disabled></input>';r.innerHTML=n,i.appendChild(r)},this.updateProgressBarWidth=function(){if(!_.isUndefined(modelsHiddenParams[a].value)){var e,i=modelsHiddenParams[a].value,l=$("#progress-bar"+t+" div"),r=modelsParameters[a].min,o=modelsParameters[a].max;e=i<=r?0:Math.ceil((i-r)/(o-r)*100),l.css("width",e+"%")}},this.updateProgressBarValue=function(){modelsParameters[a].displayValue&&(modelsParameters[a].min>modelsHiddenParams[a].value?$("#progress-bar-value"+t)[0].value=modelsParameters[a].min:$("#progress-bar-value"+t)[0].value=modelsHiddenParams[a].value)},this.rescale=function(){this.render()},this.render=function(){var i=document.createElement("div");i.setAttribute("class","progress-bar-widget");var r=document.createElement("div");r.setAttribute("id","progress-bar-div"),_.isUndefined(modelsParameters[a].progressBarWidthProportion)?r.setAttribute("style","width:50%;"):r.setAttribute("style","width:"+modelsParameters[a].progressBarWidthProportion+";");var o=document.createElement("div");o.setAttribute("id","progress-bar"+t),o.setAttribute("class","progress");var n=document.createElement("div");n.setAttribute("class","progress-bar"),n.setAttribute("role","progressbar"),o.appendChild(n),r.appendChild(o),modelsParameters[a].displayLabel&&this.insertLabel(i),i.appendChild(r),modelsParameters[a].displayValue&&this.insertValue(i),$("#"+e).html(i),$("#progress-bar"+t).addClass("progress-bar-div-div"),document.styleSheets[0].addRule("#progress-bar"+t,this.progressBarSegmentColor()),document.styleSheets[0].addRule("#progress-bar"+t+" > .progress-bar",this.progressBarRangeColor()),this.bIsInteractive?l.enable():l.disable(),this.updateProgressBarWidth(),this.updateProgressBarValue()};const r=new WidgetActuatorDescription("value","Current progress",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER),o=new WidgetActuatorDescription("min","Base progress value",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER),n=new WidgetActuatorDescription("max","Final progress value",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER);this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[a],i=[r];return t&&t.rangeActuator&&(i.push(o),i.push(n)),i},this.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[a].value=e,modelsParameters[a].displayValue&&($("#progress-bar-value"+t)[0].value=e),l.render()},getValue:function(){return modelsHiddenParams[a].value},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()},setCaption:function(e,t){modelsParameters[a].inheritLabelFromData&&(l.captionHelper(e,l.bIsInteractive,t),l.render())},clearCaption:function(){modelsParameters[a].label="",l.render()}},this.max={updateCallback:function(){},setValue:function(e){const t=Number(e);modelsParameters[a].max=t,l.render()},getValue:function(){return modelsParameters[a].max},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()}},this.min={updateCallback:function(){},setValue:function(e){const t=Number(e);modelsParameters[a].min=t,l.render()},getValue:function(){return modelsParameters[a].min},addValueChangedHandler:function(e){this.updateCallback=e,l.enable()},removeValueChangedHandler:function(e){l.disable()}},l.render()},this.progressBarFlatUiWidget.prototype=baseWidget.prototype,this.valueFlatUiWidgetModel=function(e,t,a,i,l,r){const o=l;o.updateValue=function(e){const i=$("#"+r+t)[0].value;modelsHiddenParams[a].value=i,o.value.updateCallback(o.value,o.value.getValue()),e.preventDefault()},o.enable=function(){$("#"+r+t).prop("disabled",!1),modelsParameters[a].validationButton&&$("#"+r+"-valid-btn"+t).prop("disabled",!1),$("#"+r+t).on("keypress",(function(e,t){13==e.which&&o.updateValue(e)})),modelsParameters[a].validationOnFocusOut?$("#"+r+t).on("focusout",(function(e,t){o.updateValue(e)})):$("#"+r+t).on("focusout",(function(e,t){})),$("#"+r+"-valid-btn"+t).off("click").on("click",(function(e,t){o.updateValue(e)}))},o.disable=function(){modelsParameters[a].validationButton},o.rescale=function(){this.render()},o.render=function(){let i=Math.min($("#"+e).height(),$("#"+e).width()/2);const l=document.createElement("div");l.setAttribute("id",r+"-widget-html"+t),l.setAttribute("class","value-widget-html");let n="";if(""!=modelsParameters[a].label&&modelsParameters[a].displayLabel){const l=this.getTransformedText("label");if(i=Math.min($("#"+e).height(),$("#"+e).width()/4),_.isUndefined(modelsParameters[a].valueWidthProportion))n='<span id ="'+r+"-span"+t+'" class="value-span" style="max-width: 45%;'+ +this.labelFontSize()+this.labelColor()+this.labelFontFamily()+'">'+l+"</span>";else{const e=Math.max(0,100-parseFloat(modelsParameters[a].valueWidthProportion))+"%";n='<span id ="'+r+"-span"+t+'" class="value-span" style="width:'+e+"; "+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+'">'+l+"</span>"}}let s,d="disabled ";switch(d="",r){case"value":case"text-input":s=modelsParameters[a].isPassword?"password":"text";break;case"numeric-input":s="number";break;case"value-display":s="text"}let u="",c="";"value-display"===r&&(u="readonly ",c="opacity: 1; ");let m="",p="",h="";modelsParameters[a].validationButton?(m='<div class="input-group">',p="border-bottom-right-radius: 0; border-top-right-radius: 0; ",h='<span class="input-group-btn"><button id="'+r+"-valid-btn"+t+'" class="/*ui-value-button*/ btn btn-primary" type="button" style="height:'+i+"px; width:"+i+'px; "><span class="fa fa-check" style="color: #ffffff"/></button></span>'):(m='<div id="value-no-input-group">',p="float: right;"),n+=m,n+="<input "+u+' id="'+r+t+'" type='+s+' placeholder="" class="value-input form-control" style="height: '+i+"px; "+c+this.valueColor()+this.backgroundColor()+this.valueFontFamily()+this.border()+this.valueFontSize()+p+" text-align:"+modelsParameters[a].valueTextAlign+';"</input>',n+=h,n+="</div>","text-input"!=r&&""!=modelsParameters[a].unit&&modelsParameters[a].displayUnit&&(n=n+'<span id ="unit-span'+t+'" class="value-span" style="max-width: 45%; font-size: calc(7px + '+modelsParameters[a].unitFontSize*getFontFactor()+'vw + 0.4vh);">'+modelsParameters[a].unit+"</span>"),l.innerHTML=n,"value-display"!==r&&(document.styleSheets[0].addRule("#"+r+"-valid-btn"+t,this.validationButtonBorderColor()),document.styleSheets[0].addRule("#"+r+"-valid-btn"+t,this.validationButtonDefaultColor()),document.styleSheets[0].addRule("#"+r+"-valid-btn"+t+":hover"," outline: none; "+this.validationButtonHoverColor()),document.styleSheets[0].addRule("#"+r+"-valid-btn"+t+":focus"," outline: none; "),document.styleSheets[0].addRule("#"+r+"-valid-btn"+t+":active",this.validationButtonActiveColor())),this.bIsInteractive?l.setAttribute("style","height: "+i+"px; cursor: auto;"):l.setAttribute("style","height: "+i+"px;"),$("#"+e).html(l),$("#"+r+t)[0].value=o.valueFormat(modelsHiddenParams[a].value),this.bIsInteractive?o.enable():o.disable()},o.value={updateCallback:function(){},setValue:function(e){modelsHiddenParams[a].value=e,$("#"+r+t)[0].value=o.valueFormat(e)},getValue:function(){switch(r){case"value":case"value-display":return modelsParameters[a].isNumber?Number(modelsHiddenParams[a].value):modelsHiddenParams[a].value;case"text-input":return modelsHiddenParams[a].value;case"numeric-input":return Number(modelsHiddenParams[a].value)}},addValueChangedHandler:function(e){this.updateCallback=e,o.enable()},removeValueChangedHandler:function(e){o.disable()},setCaption:function(e,i){modelsParameters[a].inheritLabelFromData&&(o.captionHelper(e,o.bIsInteractive,i),$("#"+r+"-span"+t).text(modelsParameters[a].label))},clearCaption:function(){modelsParameters[a].label="",o.render()}},o.render()},this.valueFlatUiWidget=function(t,a,i,l){this.constructor(t,a,i,l),e.valueFlatUiWidgetModel(t,a,i,l,this,"value");const r=new WidgetActuatorDescription("value","Current number",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER),o=new WidgetActuatorDescription("value","Current string",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(e){return[(e=e||modelsParameters[i])&&e.isNumber?r:o]}},this.valueFlatUiWidget.prototype=baseWidget.prototype,this.textInputFlatUiWidget=function(t,a,i,l){this.constructor(t,a,i,l),e.valueFlatUiWidgetModel(t,a,i,l,this,"text-input");const r=new WidgetActuatorDescription("value","Current string",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=()=>[r]},this.textInputFlatUiWidget.prototype=baseWidget.prototype,this.numericInputFlatUiWidget=function(t,a,i,l){this.constructor(t,a,i,l),e.valueFlatUiWidgetModel(t,a,i,l,this,"numeric-input");const r=new WidgetActuatorDescription("value","Current number",WidgetActuatorDescription.READ_WRITE,WidgetPrototypesManager.SCHEMA_NUMBER);this.getActuatorDescriptions=()=>[r]},this.numericInputFlatUiWidget.prototype=baseWidget.prototype,this.valueDisplayFlatUiWidget=function(t,a,i,l){this.constructor(t,a,i,l),e.valueFlatUiWidgetModel(t,a,i,l,this,"value-display");const r=new WidgetActuatorDescription("value","Displayed value",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER_OR_STRING);this.getActuatorDescriptions=()=>[r]},this.valueDisplayFlatUiWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"flatUi",widgetsDefinitionList:{flatUiHorizontalSlider:{factory:"horizontalSliderFlatUiWidget",title:"Horizontal slider",icn:"horizontal-slider",help:"wdg-basics/#horizontal-slider"},flatUiVerticalSlider:{factory:"verticalSliderFlatUiWidget",title:"Vertical slider",icn:"vertical-slider",help:"wdg/wdg-basics/#vertical-slider"},flatUiProgressBar:{factory:"progressBarFlatUiWidget",title:"Progress bar",icn:"progress-bar",help:"wdg-basics/#progress-bar"},flatUiValue:{factory:"valueFlatUiWidget",title:"Value",icn:"value",help:"wdg/wdg-basics/#value"},flatUiTextInput:{factory:"textInputFlatUiWidget",title:"Text Input",icn:"text-input",help:"wdg/wdg-basics/#text-input"},flatUiNumericInput:{factory:"numericInputFlatUiWidget",title:"Numeric Input",icn:"numeric-input",help:"wdg/wdg-basics/#numeric-input"},flatUiValueDisplay:{factory:"valueDisplayFlatUiWidget",title:"Value Display",icn:"value",help:"wdg/wdg-basics/#value-display"},flatUiButton:{factory:"buttonFlatUiWidget",title:"Push button",icn:"button",help:"wdg/wdg-basics/#push-button"}}},this.constructor()}String.prototype.repeat=function(e){return new Array(Math.round(e)+1).join(this)},modelsHiddenParams.flatUiHorizontalSlider={value:0},modelsHiddenParams.flatUiVerticalSlider={value:0},modelsHiddenParams.flatUiProgressBar={value:0},modelsHiddenParams.flatUiValue={value:""},modelsHiddenParams.flatUiTextInput={value:""},modelsHiddenParams.flatUiNumericInput={value:""},modelsHiddenParams.flatUiValueDisplay={value:""},modelsParameters.flatUiHorizontalSlider={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",rangeActuator:!1,min:0,max:100,step:1,displayValue:!0,validationOnFocusOut:!0,valueFontSize:.5,valueFontFamily:"var(--widget-font-family)",valueBorderColor:"var(--widget-border-color)",labelWidthProportion:"20%",sliderWidthProportion:"60%",valueWidthProportion:"20%",sliderRangeColor:"var(--widget-range-color)",sliderSegmentColor:"var(--widget-segment-color)",sliderHandleDefaultColor:"var(--widget-handle-default-color)",sliderHandleHoverColor:"var(--widget-handle-hover-color)",sliderHandleActiveColor:"var(--widget-handle-active-color)",valueColor:"var(--widget-color)"},modelsParameters.flatUiVerticalSlider={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",rangeActuator:!1,min:0,max:100,step:1,sliderRangeColor:"var(--widget-range-color)",sliderSegmentColor:"var(--widget-segment-color)",sliderHandleDefaultColor:"var(--widget-handle-default-color)",sliderHandleHoverColor:"var(--widget-handle-hover-color)",sliderHandleActiveColor:"var(--widget-handle-active-color)"},modelsParameters.flatUiProgressBar={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",rangeActuator:!1,min:0,max:100,displayValue:!1,valueFontSize:.5,valueFontFamily:"var(--widget-font-family)",labelWidthProportion:"20%",progressBarWidthProportion:"60%",valueWidthProportion:"20%",progressBarRangeColor:"var(--widget-range-color)",progressBarSegmentColor:"var(--widget-segment-color)",valueColor:"var(--widget-color)"},modelsParameters.flatUiValue={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valueWidthProportion:"70%",validationButton:!1,validationBtnDefaultColor:"var(--widget-button-primary-color)",validationBtnActiveColor:"var(--widget-button-active-color)",validationBtnHoverColor:"var(--widget-button-hover-color)",validationOnFocusOut:!0,isNumber:!1,isPassword:!1,decimalDigits:3,valueFontSize:.5,valueColor:"var(--widget-input-text)",valueFontFamily:"var(--widget-font-family)",valueTextAlign:"left",displayBorder:!0,borderColor:"var(--widget-border-color)",unit:"unitText",displayUnit:!1,unitFontSize:.5},modelsParameters.flatUiTextInput={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valueWidthProportion:"70%",validationButton:!1,validationBtnDefaultColor:"var(--widget-button-primary-color)",validationBtnActiveColor:"var(--widget-button-active-color)",validationBtnHoverColor:"var(--widget-button-hover-color)",validationOnFocusOut:!0,isPassword:!1,valueFontSize:.5,valueColor:"var(--widget-input-text)",valueFontFamily:"var(--widget-font-family)",valueTextAlign:"left",displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-input-color)"},modelsParameters.flatUiNumericInput={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valueWidthProportion:"70%",validationButton:!1,validationBtnDefaultColor:"var(--widget-button-primary-color)",validationBtnActiveColor:"var(--widget-button-active-color)",validationBtnHoverColor:"var(--widget-button-hover-color)",validationOnFocusOut:!0,valueFontSize:.5,valueColor:"var(--widget-input-text)",valueFontFamily:"var(--widget-font-family)",valueTextAlign:"left",displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-input-color)",unit:"unitText",displayUnit:!1,unitFontSize:.5},modelsParameters.flatUiValueDisplay={label:"labelText",inheritLabelFromData:!0,displayLabel:!0,labelFontSize:.5,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",valueWidthProportion:"70%",decimalDigits:3,valueFontSize:.5,valueColor:"var(--widget-input-text)",valueFontFamily:"var(--widget-font-family)",valueTextAlign:"left",displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-input-color)",unit:"unitText",displayUnit:!1,unitFontSize:.5},modelsParameters.flatUiButton={text:"Push button",numberOfTriggers:1,fileInput:!1,binaryFileInput:!1,buttonFontSize:.3,displayIcon:!1,fontAwesomeIcon:"",buttonFontFamily:"var(--widget-font-family)",buttonTextColor:"var(--widget-button-primary-text)",buttonDefaultColor:"var(--widget-button-primary-color)",buttonActiveColor:"var(--widget-button-active-color)",buttonHoverColor:"var(--widget-button-hover-color)"},modelsLayout.flatUiHorizontalSlider={height:"5vh",width:"24vw",minWidth:"200px",minHeight:"24px"},modelsLayout.flatUiVerticalSlider={height:"20vh",width:"5vw",minWidth:"32px",minHeight:"50px"},modelsLayout.flatUiProgressBar={height:"5vh",width:"24vw",minWidth:"200px",minHeight:"24px"},modelsLayout.flatUiValue={height:"5vh",width:"19vw",minWidth:"150px",minHeight:"24px"},modelsLayout.flatUiTextInput={height:"5vh",width:"19vw",minWidth:"150px",minHeight:"24px"},modelsLayout.flatUiNumericInput={height:"5vh",width:"19vw",minWidth:"150px",minHeight:"24px"},modelsLayout.flatUiValueDisplay={height:"5vh",width:"19vw",minWidth:"150px",minHeight:"24px"},modelsLayout.flatUiButton={height:"6vh",width:"8vw",minWidth:"55px",minHeight:"24px"},flatUiWidgetsPluginClass.prototype=basePlugin.prototype;var flatUiWidgetsPlugin=new flatUiWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(flatUiWidgetsPlugin);
function saveToFileButtonWidgetsPluginClass(){this.buttonSaveToFileWidget=function(t,e,i,o){this.constructor(t,e,i,o);var n=this;this.enable=function(){},this.disable=function(){},this.saveFile=function(){const t=modelsParameters[i].fileName;let e=modelsHiddenParams[i].value;if(!e)return;e="data:text/plain;charset=utf-8,"+e;const o=encodeURI(e),n=document.createElement("a");n.setAttribute("href",o),n.setAttribute("download",t),n.click()},this.rescale=function(){this.render()},this.render=function(){var o=document.createElement("div");o.setAttribute("id","button-save-to-file-widget-html"+e),o.setAttribute("class","button-widget-html");var a=Math.min($("#"+t).height(),$("#"+t).width()/2),l=.5;_.isUndefined(modelsParameters[i].buttonFontSize)||(l=modelsParameters[i].buttonFontSize);var s='style="text-align: center; vertical-align: middle;font-size: calc(7px + '+l*getFontFactor()+"vw + 0.4vh); height: "+a+"px; display:table-cell; "+this.buttonFontFamily()+'" class="btn btn-block btn-lg '+i+"widgetCustomColor";this.setButtonColorStyle();const r=this.getTransformedText("text");var u;u="<a "+s+'" id="button-save-to-file'+e+'">  '+r+"  </a>",o.innerHTML=u,o.setAttribute("style","height: "+a+"px;"),$("#"+t).html(o),$("#button-save-to-file"+e).on("click",(function(){n.saveFile()}))};const a=new WidgetActuatorDescription("value","File content",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(){return[a]},this.value={updateCallback:function(){},setValue:function(t){modelsHiddenParams[i].value=t},getValue:function(){return modelsHiddenParams[i].value},addValueChangedHandler:function(t){this.updateCallback=t,n.enable()},removeValueChangedHandler:function(t){n.disable()}},n.render()},this.buttonSaveToFileWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"saveToFileButton",widgetsDefinitionList:{saveToFileButton:{factory:"buttonSaveToFileWidget",title:"Save to file button",icn:"export-to-file",help:"wdg/wdg-basics/#save-to-file-button"}}},this.constructor()}modelsHiddenParams.saveToFileButton={value:""},modelsParameters.saveToFileButton={text:"Save to file",fileName:"export.txt",buttonFontSize:.5,buttonFontFamily:"var(--widget-font-family)",buttonTextColor:"var(--widget-button-primary-text)",buttonDefaultColor:"var(--widget-button-primary-color)",buttonActiveColor:"var(--widget-button-active-color)",buttonHoverColor:"var(--widget-button-hover-color)"},modelsLayout.saveToFileButton={height:"5vh",width:"8vw",minWidth:"55px",minHeight:"50px"},saveToFileButtonWidgetsPluginClass.prototype=basePlugin.prototype;var saveToFileButtonWidgetsPlugin=new saveToFileButtonWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(saveToFileButtonWidgetsPlugin);
function loadFileWidgetsPluginClass(){this.loadFileWidget=function(idDivContainer,idWidget,idInstance,bInteractive){this.constructor(idDivContainer,idWidget,idInstance,bInteractive);const self=this;function _getFileSize(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(1)+" KB":(e/1048576).toFixed(1)+" MB"}function _getFileExtension(e){return e.split(".").pop()}function _processTextFile(fileExtension,fileData){const extensions=["json","xprjson"];return extensions.includes(fileExtension)?JSON.parse(JSON.stringify(eval("("+fileData+")")),null,2):fileData}function _processBinaryFile(e){return btoa([].reduce.call(new Uint8Array(e),(e,t)=>e+String.fromCharCode(t),""))}function _checkFileSize(e){if(e>104857600)throw new Error("Unable to load file due to large size over 100MB")}function _handleFileError(e,t){const i=new PNotify({title:"Unzip file",text:"Error reading "+e.name+": "+t,type:"error",styling:"bootstrap3"});return $(".ui-pnotify-container").on("click",()=>i.remove()),console.error("Error reading "+e.name+": "+t),-1}this.enable=function(){},this.disable=function(){},this.updateValue=function(e){},this.readFile=async function(e){try{_checkFileSize(e.size)}catch(t){return _handleFileError(e,t.message)}const t={type:e.type,size:_getFileSize(e.size),name:e.name,content:""},i=_getFileExtension(e.name),a=["txt","json","xprjson","xml","svg","html","css","js","ts","md","csv"],d=[];if(i&&["","application/json"].includes(t.type)&&(t.type=i),"zip"===i)try{const i=await JSZip.loadAsync(e);for(const e in i.files){const t=i.files[e];if(t.dir)continue;const n=_getFileExtension(e);if(!(t._data.uncompressedSize>73400320))if(n&&a.includes(n)){const i=await t.async("string");d.push({name:e,content:_processTextFile(n,i)})}else{const i=await t.async("uint8array");d.push({name:e,content:_processBinaryFile(i)})}}t.content=d,modelsHiddenParams[idInstance].outputFile=t,updateDataNodeFileFromWidget(idInstance,t)}catch(t){return _handleFileError(e,t)}else{const a=new FileReader;a.addEventListener("load",(function(e){const a=e.target.result;if(a instanceof ArrayBuffer)t.content=_processBinaryFile(a),t.isBinary=!0;else{const e=_processTextFile(i,a);t.content=e,t.isBinary=!1}modelsHiddenParams[idInstance].outputFile=t,updateDataNodeFileFromWidget(idInstance,t)})),modelsParameters[idInstance].binaryFileInput?a.readAsArrayBuffer(e):a.readAsText(e)}},this.rescale=function(){this.render()},this.render=function(){const e=document.createElement("div");e.setAttribute("id","load-file-widget-html"+idWidget),_.isUndefined(modelsParameters[idInstance].displayBrowseButton)&&(modelsParameters[idInstance].displayBrowseButton=!0),modelsParameters[idInstance].displayBorder?e.setAttribute("class","load-file-widget-html load-file-widget-html--border"):e.setAttribute("class","load-file-widget-html");let t="";if(modelsParameters[idInstance].displayLabel){const e=this.getTransformedText("label");t+='<div id="load-file-label'+idWidget+'" class="label-wrapper" style="'+this.labelFontSize()+this.labelColor()+this.labelFontFamily()+" text-align: "+modelsParameters[idInstance].labelAlign+'">',t+="<p>"+e+"</p>",t+="</div>"}if(t+='<div id="drag-area'+idWidget+'" class="drag-area">',t+='<div id="drag-area-icon'+idWidget+'" class="drag-area__icon-wrapper">',t+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor">\n          <path d="M28.992 21.44c-0.704-0.512-1.536-0.768-2.176-0.896v-10.752c0-0.192-0.064-0.32-0.192-0.448l-8.512-8.448c-0.128-0.128-0.256-0.192-0.448-0.192h-11.84c-0.32 0-0.64 0.256-0.64 0.64v29.312c0 0.32 0.256 0.576 0.64 0.576h20.352c0.32 0 0.64-0.256 0.64-0.576v-2.624h0.704c0.512 0 1.344-0.192 1.984-0.768 0.704-0.576 1.152-1.472 1.152-2.88-0.064-1.344-0.768-2.368-1.664-2.944zM24.704 9.088h-6.912v-6.912l6.912 6.912zM25.664 30.208h-19.392v-28.352h10.432v7.68c0 0.32 0.256 0.576 0.64 0.576h8.32v7.872c-0.064-0.064-0.064-0.128-0.128-0.192-0.896-1.28-2.432-2.368-4.992-2.368-3.712 0-5.44 2.048-6.016 3.456-2.624 0.192-4.864 1.92-4.864 4.352s1.792 4.736 4.8 4.736h11.2v2.24zM28.736 26.496c-0.448 0.384-0.96 0.512-1.28 0.512h-12.928c-2.368 0-3.712-1.792-3.712-3.712 0-1.728 1.792-3.264 4.16-3.264 0.256 0 0.512-0.192 0.576-0.448 0.256-0.96 1.6-3.008 5.056-3.008 2.112 0 3.392 0.896 4.096 1.92 0.768 1.024 0.96 2.176 0.96 2.496 0 0.064 0 0.128 0.064 0.192 0.064 0.192 0.256 0.384 0.512 0.384 0.192 0 0.384 0.064 0.576 0.128 0.512 0.128 1.088 0.32 1.6 0.64 0.704 0.448 1.152 1.152 1.152 2.112-0.064 1.088-0.384 1.728-0.832 2.048z"></path>\n          <path d="M20.992 19.712c-0.192-0.192-0.576-0.192-0.768 0l-2.048 2.048c-0.192 0.192-0.192 0.576 0 0.768s0.576 0.192 0.768 0l1.088-1.088v3.648c0 0.32 0.256 0.576 0.576 0.576s0.512-0.256 0.512-0.576v-3.648l1.088 1.088c0.192 0.192 0.576 0.192 0.768 0s0.192-0.576 0-0.768l-1.984-2.048z"></path>\n        </svg>',t+="</div>",t+='<div id="drag-area-text'+idWidget+'" class="drag-area__text-wrapper">',t+='<span style="'+this.labelFontFamily()+this.textSize()+this.textColor()+'">Drag & drop file here</span>',t+='<span style="'+this.labelFontFamily()+this.textSize()+this.subTextColor()+'">Limit 100MB per file</span>',t+="</div>",modelsParameters[idInstance].displayBrowseButton&&(t+='<div id="browse-btn'+idWidget+'" class="drag-area__browse-btn-wrapper">',t+='<input type="file" name="file" id="browse-btn-input'+idWidget+'_select_file" />',t+='<label id="browse-btn-label'+idWidget+'" style="'+this.labelFontFamily()+this.textSize()+this.browseButtonTextColor()+'" for="browse-btn-input'+idWidget+'_select_file">Browse files</label>',t+="</div>",t+="</div>"),e.innerHTML=t,$("#"+idDivContainer).html(e),document.styleSheets[0].addRule("#drag-area"+idWidget," background-color: "+modelsParameters[idInstance].backgroundColor),document.styleSheets[0].addRule("#load-file-widget-html"+idWidget," border-color: "+modelsParameters[idInstance].borderColor),document.styleSheets[0].addRule("#load-file-widget-html"+idWidget," background-color: "+modelsParameters[idInstance].labelBackgroundColor),document.styleSheets[0].addRule("#browse-btn-label"+idWidget,this.browseButtonDefaultColor()),document.styleSheets[0].addRule("#browse-btn-label"+idWidget+":hover",this.browseButtonHoverColor()),document.styleSheets[0].addRule("#browse-btn-label"+idWidget+":active",this.browseButtonActiveColor()),this.addFileDiv=function(e,t){let i='<div id="loaded-file'+idWidget+'" class="loaded-file">';i+='<div class="loaded-file__icon-wrapper">',i+='<i class="fa fa-file" aria-hidden="true"></i>',i+="</div>",i+='<div class="loaded-file__info-file-wrapper">',i+='<span id="file-name-'+idWidget+'" title="'+e+'" class="loaded-file__info-file-wrapper__name" style="'+this.labelFontFamily()+this.textSize()+this.textColor()+'">'+e+"</span>",i+='<span id="file-size-'+idWidget+'" title="'+t+'" class="loaded-file__info-file-wrapper__size" style="'+this.labelFontFamily()+this.textSize()+this.subTextColor()+'">'+t+"</span>",i+="</div>",i+='<div id="close-file-btn'+idWidget+'" class="loaded-file__close-btn-wrapper">',i+='<i class="fa fa-times" aria-hidden="true"></i>',i+="</div>",i+="</div>",$("#load-file-widget-html"+idWidget).append(i),document.styleSheets[0].addRule("#close-file-btn"+idWidget+" > i",this.deleteButtonDefaultColor()),document.styleSheets[0].addRule("#close-file-btn"+idWidget+" > i:hover",this.deleteButtonHoverColor()),document.styleSheets[0].addRule("#close-file-btn"+idWidget+" > i:active",this.deleteButtonActiveColor()),document.styleSheets[0].addRule("#close-file-btn"+idWidget+" > i","color: "+modelsParameters[idInstance].deleteButtonIconColor),document.styleSheets[0].addRule("#close-file-btn"+idWidget+" > i:hover","color: "+modelsParameters[idInstance].deleteButtonIconHoverColor),$("#close-file-btn"+idWidget).on("click",(function(){$("#browse-btn-input"+idWidget+"_select_file").val(""),$("#loaded-file"+idWidget).remove(),delete modelsTempParams[idInstance].fileName,delete modelsTempParams[idInstance].fileSize,modelsHiddenParams[idInstance].outputFile={},updateDataNodeFileFromWidget(idInstance,{}),self.render()}))},_.isUndefined(modelsHiddenParams[idInstance].outputFile)||(_.isEmpty(modelsHiddenParams[idInstance].outputFile)?(updateDataNodeFileFromWidget(idInstance,{}),delete modelsTempParams[idInstance].fileName,delete modelsTempParams[idInstance].fileSize):updateDataNodeFileFromWidget(idInstance,modelsHiddenParams[idInstance].outputFile)),!_.isUndefined(modelsTempParams[idInstance].fileName)&&!_.isUndefined(modelsTempParams[idInstance].fileSize)){const e=modelsTempParams[idInstance].fileName,t=modelsTempParams[idInstance].fileSize;self.addFileDiv(e,t)}this.addSpinner=function(){const e=document.getElementById("load-file-widget-html"+idWidget),t=document.createElement("div"),i=document.createElement("i");t.setAttribute("id","icon-wrapper"+idWidget),t.setAttribute("class","load-spinner-wrapper"),i.setAttribute("class","fa fa-spinner fa-spin load-spinner-wrapper__icon"),t.append(i),e.append(t)},this.removeSpinner=function(){document.getElementById("icon-wrapper"+idWidget).remove()},this.readFileEvent=async function(e){this.addSpinner();let t={};"change"==e.type?t=e.target.files[0]:"drop"==e.type&&(t=e.originalEvent.dataTransfer.files[0]);if(-1!=await self.readFile(t)){const e=t.name,i=_getFileSize(t.size);modelsTempParams[idInstance].fileName=e,modelsTempParams[idInstance].fileSize=i,$("#loaded-file"+idWidget).length?($("#file-name-"+idWidget).text(e),$("#file-size-"+idWidget).text(i)):self.addFileDiv(e,i)}this.removeSpinner()},this.displayFile=(modelsTempParams[idInstance].counter=0,$("#drag-area"+idWidget).on("dragenter",(function(e){e.preventDefault(),e.stopPropagation(),modelsTempParams[idInstance].counter++,$("#drag-area"+idWidget).css({opacity:".5"})})),$("#drag-area"+idWidget).on("dragover",(function(e){e.preventDefault(),e.stopPropagation()})),$("#drag-area"+idWidget).on("dragleave",(function(e){e.preventDefault(),e.stopPropagation(),modelsTempParams[idInstance].counter--,0===modelsTempParams[idInstance].counter&&$("#drag-area"+idWidget).css({opacity:""})})),$("#drag-area"+idWidget).on("drop",(function(e){$("#drag-area"+idWidget).css({opacity:""}),e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length&&(e.preventDefault(),e.stopPropagation(),self.readFileEvent(e))})),void $("#browse-btn-input"+idWidget+"_select_file").on("change",(function(e){self.readFileEvent(e)})));const i=document.getElementById(idDivContainer),a=i.clientWidth,d=a<290,n=a<240,l=document.getElementById("drag-area"+idWidget),o=document.getElementById("drag-area-text"+idWidget),s=document.getElementById("drag-area-icon"+idWidget);if(this.updateWidgetContent=function(){d?document.styleSheets[0].addRule(`#loaded-file${idWidget} .loaded-file__icon-wrapper`,"display: none"):document.styleSheets[0].addRule(`#loaded-file${idWidget} .loaded-file__icon-wrapper`,"display: block"),s.classList.toggle("drag-area__icon-wrapper--hidden",d),l.classList.toggle("drag-area--column",n),o.children[0].textContent=n?"Drag & Drop":"Drag & drop file here",o.children[1].classList.toggle("drag-area__text-wrapper__span--hidden",n)},bInteractive)this.updateWidgetContent();else{new ResizeObserver(()=>{this.updateWidgetContent()}).observe(i)}};const _OUTPUT_DESCRIPTOR=new WidgetActuatorDescription("outputFile","File content",WidgetActuatorDescription.FILE);this.getActuatorDescriptions=function(){return[_OUTPUT_DESCRIPTOR]},this.outputFile={updateCallback:function(){},setValue:function(e){},getValue:function(){return modelsHiddenParams[idInstance].outputFile},addValueChangedHandler:function(e){this.updateCallback=e,self.enable()},removeValueChangedHandler:function(e){self.disable()},setCaption:function(e,t){modelsParameters[idInstance].inheritLabelFromData&&(self.captionHelper(e,self.bIsInteractive,t),self.render())},clearCaption:function(){modelsParameters[idInstance].label="",self.render()}},self.render()},this.loadFileWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"loadFile",widgetsDefinitionList:{loadFile:{factory:"loadFileWidget",title:"Load file",icn:"load-file",help:"wdg/wdg-basics/#load-file"}}},this.constructor()}modelsHiddenParams.loadFile={outputFile:""},modelsParameters.loadFile={label:"Choose a file",displayLabel:!0,labelFontSize:.1,labelColor:"var(--widget-label-color)",labelFontFamily:"var(--widget-font-family)",labelAlign:"left",textColor:"var(--widget-color)",subTextColor:"var(--widget-color)",textSize:.1,binaryFileInput:!1,displayBorder:!0,borderColor:"var(--widget-border-color)",backgroundColor:"var(--widget-dropzone-background-color)",displayBrowseButton:!0,labelBackgroundColor:"var(--widget-dropzone-label-background-color)",browseButtonTextColor:"var(--widget-button-text)",browseButtonDefaultColor:"var(--widget-button-color)",browseButtonActiveColor:"var(--widget-button-active-color)",browseButtonHoverColor:"var(--widget-button-hover-color)",deleteButtonDefaultColor:"var(--widget-delete-button-default-color)",deleteButtonActiveColor:"var(--widget-delete-button-active-color)",deleteButtonHoverColor:"var(--widget-delete-button-hover-color)",deleteButtonIconColor:"var(--widget-delete-button-icon-color)",deleteButtonIconHoverColor:"var(--widget-delete-button-icon-hover-color)"},modelsLayout.loadFile={height:"15vh",width:"20vw",minWidth:"95px",minHeight:"70px"},loadFileWidgetsPluginClass.prototype=basePlugin.prototype;var loadFileWidgetsPlugin=new loadFileWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(loadFileWidgetsPlugin);
const USE_PLOTLY_VALIDATION=!0,colorway=["var(--widget-color-2)","var(--widget-color-5)","var(--widget-color-6)","var(--widget-color-7)"],textColor="var(--widget-color)",axisParams={title:"",tickfont:{color:textColor}},plotlyColorParams={paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",colorway:colorway,legend:{font:{color:textColor}}},_SCHEMA_PLOTLY_DATA={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:plotly_data",type:"array",items:{type:"object",properties:{type:{type:"string"}},required:["type"]}},_SCHEMA_PLOTLY_LAYOUT={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:plotly_layout",type:"object"};modelsParameters.plotlyLine={numberOfAxis:1,layout:{title:"",xaxis:{title:"x",tickfont:{color:textColor}},yaxis:{title:"y",tickfont:{color:textColor}},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",colorway:colorway,legend:{font:{color:textColor}},showlegend:!1,margin:{l:50,r:50,b:100,t:100,pad:4}},hideModeBar:!1},modelsParameters.plotlyBar={numberOfAxis:1,layout:{title:"",barmode:"group",xaxis:{title:"x",tickfont:{color:textColor}},yaxis:{title:"y",tickfont:{color:textColor}},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",colorway:colorway,legend:{font:{color:textColor}},showlegend:!1,margin:{l:50,r:50,b:100,t:100,pad:4}},hideModeBar:!1},modelsParameters.plotlyPie={layout:{title:"",paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",colorway:colorway,legend:{font:{color:textColor}},showlegend:!1,margin:{l:50,r:50,b:100,t:100,pad:4}},hideModeBar:!1},modelsParameters.plotly3dSurface={layout:{title:"",scene:{xaxis:{title:"x"},yaxis:{title:"y"},zaxis:{title:"z"}},paper_bgcolor:"rgba(0,0,0,0)",plot_bgcolor:"rgba(0,0,0,0)",showlegend:!1,margin:{l:50,r:50,b:100,t:100,pad:4}},hideModeBar:!1},modelsParameters.plotlyGeneric={hideModeBar:!1},modelsParameters.plotlyRealTime={hideModeBar:!1},modelsHiddenParams.plotlyLine={...modelsParameters.plotlyLine,data:[{type:"scatter",x:[0,1,2],y:[0,4,0],name:"trace 0"}],selection:[{}]},modelsHiddenParams.plotlyBar={...modelsParameters.plotlyBar,data:[{type:"bar",x:["first","second"],y:[1,2]}],selection:[{}]},modelsHiddenParams.plotlyPie={...modelsParameters.plotlyPie,data:[{type:"pie",labels:["half1","half2"],values:[.5,.5],sort:!1}],selection:[{}]},modelsHiddenParams.plotly3dSurface={...modelsParameters.plotly3dSurface,data:[{type:"surface",x:[1,2,3],y:[1,2,3],z:[[4,5,6],[16,19,20],[10,18,23]]}],selection:[{}]},modelsHiddenParams.plotlyRealTime={...modelsParameters.plotlyRealTime,data:[{y:[],mode:"lines"}],selection:[{}]},modelsHiddenParams.plotlyGeneric={data:[{}],layout:[{}],selection:[{}]},modelsTempParams.plotlyLine={lastEditTimeStamp:0,pngCache:""},modelsTempParams.plotlyBar={lastEditTimeStamp:0,pngCache:""},modelsTempParams.plotlyPie={lastEditTimeStamp:0,pngCache:""},modelsTempParams.plotly3dSurface={lastEditTimeStamp:0,pngCache:""},modelsTempParams.plotlyGeneric={lastEditTimeStamp:0,pngCache:""},modelsTempParams.plotlyRealTime={lastEditTimeStamp:0,pngCache:""},modelsLayout.plotlyLine={height:"30vh",width:"30vw",minWidth:"100px",minHeight:"100px"},modelsLayout.plotlyBar={height:"30vh",width:"30vw",minWidth:"100px",minHeight:"100px"},modelsLayout.plotlyPie={height:"30vh",width:"30vw",minWidth:"100px",minHeight:"100px"},modelsLayout.plotly3dSurface={height:"30vh",width:"30vw",minWidth:"378px",minHeight:"305px"},modelsLayout.plotlyGeneric={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},modelsLayout.plotlyRealTime={height:"30vh",width:"30vw",minWidth:"100px",minHeight:"100px"};const _SCHEMA_PLOTLY_NUMERIC_DATA={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:plotly_numeric_data",anyOf:[{type:"number"},{type:"array",items:{type:"number"}}]},_SCHEMA_PLOTLY_ANY_DATA={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:plotly_any_data",anyOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"array",items:{anyOf:[{type:"string"},{type:"number"},{type:"boolean"}]}}]};function _createPlotlyAnyDataDescriptor(e){return new WidgetActuatorDescription(e,"Array of values to plot",WidgetActuatorDescription.READ,_SCHEMA_PLOTLY_ANY_DATA)}function _createPlotlyNumericDataDescriptor(e){return new WidgetActuatorDescription(e,"Array of numeric values to plot",WidgetActuatorDescription.READ,_SCHEMA_PLOTLY_NUMERIC_DATA)}function _isAxisLinear(e,t){return e&&e[t]&&"linear"===e[t].type}function plotlyWidgetsPluginClass(){var e=0;function t(e,t,a,o){this.bIsInteractive=o;var i="plotly"+t;o&&(i+="c");var r=this;_.isUndefined(modelsParameters[a].hideModeBar)&&(modelsParameters[a].hideModeBar=!1),this.getColorValueFromCSSProperty=function(e){var t=e;if(t.includes("var(--")){var a=e.substring(4,e.length-1);t=window.getComputedStyle(document.documentElement).getPropertyValue(a)}return t},this.checkNested=function(e,t,...a){return void 0!==e&&(!(0!=a.length||!e.hasOwnProperty(t))||this.checkNested(e[t],...a))},this.getTransformedText=function(e){if(e){if(!($("<div>").html(e).children().length>0)){e=(new DOMParser).parseFromString("<!doctype html><body>"+e,"text/html").body.textContent}}return e},this.render=function(){const t=modelsParameters[a].layout;if(_.isUndefined(t)||_.isUndefined(t.title)||(_.isUndefined(t.title.text)?t.title=this.getTransformedText(t.title):t.title.text=this.getTransformedText(t.title.text)),modelsHiddenParams[a].layout){let e=JSON.parse(JSON.stringify(modelsHiddenParams[a].layout));modelsHiddenParams[a].layout=e,modelsParameters[a].layout&&(e=JSON.parse(JSON.stringify(modelsParameters[a].layout))),this.checkNested(e,"colorway")&&(modelsHiddenParams[a].layout.colorway=e.colorway.map(e=>this.getColorValueFromCSSProperty(e))),["xaxis","yaxis","zaxis"].forEach(t=>{this.checkNested(e,t,"tickfont","color")&&(modelsHiddenParams[a].layout[t].tickfont.color=this.getColorValueFromCSSProperty(e[t].tickfont.color))}),this.checkNested(e,"legend","font","color")&&(modelsHiddenParams[a].layout.legend.font.color=this.getColorValueFromCSSProperty(e.legend.font.color)),this.checkNested(e,"paper_bgcolor")&&(modelsHiddenParams[a].layout.paper_bgcolor=this.getColorValueFromCSSProperty(e.paper_bgcolor)),this.checkNested(e,"plot_bgcolor")&&(modelsHiddenParams[a].layout.plot_bgcolor=this.getColorValueFromCSSProperty(e.plot_bgcolor))}if(this.bIsInteractive){$("#"+i).html(""),_.isUndefined(modelsHiddenParams[a].layout)||_.isNull(modelsHiddenParams[a].layout)||modelsHiddenParams[a].layout.autosize&&(delete modelsHiddenParams[a].layout.width,delete modelsHiddenParams[a].layout.height);var o={};modelsParameters[a].hideModeBar&&(o={displayModeBar:!1}),Plotly.newPlot(i,modelsHiddenParams[a].data,modelsHiddenParams[a].layout,o),this.setSelectionActuator()}else{$("#"+i).html(""),$("#"+i).html('<img id="png-export-'+i+'"></img>');var r,l=$("#png-export-"+i);const t=6e3;if(Date.now()-modelsTempParams[a].lastEditTimeStamp<t){l.attr("src",modelsTempParams[a].pngCache);var s=document.getElementById(e);return l[0].style.minHeight=parseInt(s.parentNode.style.minHeight)-3+"px",l[0].style.minWidth=parseInt(s.parentNode.style.minWidth)-3+"px",l[0].style.width=parseFloat(s.parentNode.style.width)-1+"vw",l[0].style.height=parseFloat(s.parentNode.style.height)-1+"vh",void(l[0].style.margin="3px")}Plotly.newPlot(i,modelsHiddenParams[a].data,modelsHiddenParams[a].layout).then((function(t){Plotly.toImage(t,{height:$("#"+e).height(),width:$("#"+e).width()}).then((function(e){r=e,Plotly.purge(t),l.attr("src",r),t.style.minHeight=t.parentNode.style.minHeight,t.style.minWidth=t.parentNode.style.minWidth,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height,l[0].style.minHeight=parseInt(t.parentNode.style.minHeight)-3+"px",l[0].style.minWidth=parseInt(t.parentNode.style.minWidth)-3+"px",l[0].style.width=parseFloat(t.parentNode.style.width)-1+"vw",l[0].style.height=parseFloat(t.parentNode.style.height)-1+"vh",l[0].style.margin="3px",modelsTempParams[a].lastEditTimeStamp=Date.now(),modelsTempParams[a].pngCache=r}))}))}},this.setSelectionActuator=function(){this.bIsInteractive=o;var e="plotly"+t;if(o){e+="c";var a=document.getElementById(e);a.on("plotly_selected",(function(e){if(!_.isUndefined(e)){var t=Array(a.data.length).fill(null).map(()=>[]),o=Array(a.data.length).fill(null).map(()=>[]);e.points.forEach((function(e){if(!_.isUndefined(e.pointNumber)){var i=e.curveNumber,r=e.pointNumber;t[i].push(r),_.isUndefined(a.data[i].customdata)||o[i].push(a.data[i].customdata[r])}if(!_.isUndefined(e.pointNumbers)){i=e.pointNumbers.curveNumber;pointNumbers.forEach((function(e){t[i].push(e),_.isUndefined(a.data[i].customdata)||o[i].push(a.data[i].customdata[e])}))}}));var i=t.map((function(e,t){return{trace:t,selection:e,customdata:o[t]}}));r.selection.setValue(i),r.selection.updateCallback(r.selection,r.selection.getValue())}})),a.on("plotly_deselect",(function(){r.selection.setValue({range:{}}),r.selection.updateCallback(r.selection,r.selection.getValue())}))}},r.render(),this.getByName=function(e){if(this.hasOwnProperty(e))return this[e]},this.getInteractive=function(){return this.bIsInteractive},this.setInteractive=function(e){e!=this.bIsInteractive&&(this.bIsInteractive=e,this.render())},this.rescale=function(){this.bIsInteractive?Plotly.Plots.resize($("#"+i)[0]):this.render()}}this.createWidget=function(t,a,o,i){switch(function(e,t,a){var o=document.createElement("div"),i="plotly"+t;a&&(i+="c"),o.setAttribute("id",i),o.setAttribute("class","js-plotly-plot"),o.setAttribute("style","text-align:center; height: inherit; width: inherit; background-color: transparent"),$("#"+e).html(o)}(t,e+=1,i),a){case"plotlyLine":return new this.linePlotlyWidget(t,e,o,i);case"plotlyBar":return new this.barPlotlyWidget(t,e,o,i);case"plotlyPie":return new this.piePlotlyWidget(t,e,o,i);case"plotly3dSurface":return new this.d3surfacePlotlyWidget(t,e,o,i);case"plotlyGeneric":return new this.genericPlotlyWidget(t,e,o,i);case"plotlyRealTime":return new this.realTimePlotlyWidget(t,e,o,i)}},this.copyWidget=function(e,t,a,o,i){return this.createWidget(e,t,o,i)},this.clear=function(){e=0},this.linePlotlyWidget=function(e,t,a,o){this.constructor(e,t,a,o);var i=this;this.numberOfAxis=modelsParameters[a].numberOfAxis,_.isUndefined(modelsParameters[a].layout)||(modelsParameters[a].layout={...plotlyColorParams,...modelsParameters[a].layout},["xaxis","yaxis"].forEach(e=>{_.isUndefined(modelsParameters[a].layout[e])||(modelsParameters[a].layout[e]={...axisParams,...modelsParameters[a].layout[e]})})),modelsHiddenParams[a].data.length>this.numberOfAxis&&modelsHiddenParams[a].data.splice(this.numberOfAxis,modelsHiddenParams[a].data.length),this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[a],o=[t&&_isAxisLinear(t.layout,"xaxis")?_createPlotlyNumericDataDescriptor("x"):_createPlotlyAnyDataDescriptor("x")];if(t&&t.numberOfAxis){const e=_isAxisLinear(t.layout,"yaxis");for(let a=1;a<=t.numberOfAxis;a++){const t="y"+a;o.push(e?_createPlotlyNumericDataDescriptor(t):_createPlotlyAnyDataDescriptor(t))}}return o},this.x={setValue:function(e){if(_.isUndefined(e))swal("Invalid data value","value in x axis is undefined !","error");else{if(!Array.isArray(e)){if("number"!=typeof e&&"string"!=typeof e&&"bigint"!=typeof e)return void swal("Invalid data type","x axis must be an array !","error");e=[e],console.log("value in x axis is converted to an array.")}modelsHiddenParams[a].data[0].x=e,modelsHiddenParams[a].layout=modelsParameters[a].layout,i.render()}},getValue:function(){return modelsHiddenParams[a].data[0].x},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){},setCaption:function(e,t){modelsParameters[a].layout.xaxis.title=e,modelsHiddenParams[a].layout=modelsParameters[a].layout}};for(let e=1;e<=this.numberOfAxis;e++){const t="y"+e;e>1&&_.isUndefined(modelsHiddenParams[a].data[e-1])&&(modelsHiddenParams[a].data[e-1]={x:[],y:[],name:"caption "+(e-1)}),this[t]={index:e-1,setValue:function(e){const t=this.index+1;if(_.isUndefined(e))swal("Invalid data value","value in y"+t+" axis is undefined !","error");else{if(!Array.isArray(e)){if("number"!=typeof e&&"string"!=typeof e&&"bigint"!=typeof e)return void swal("Invalid data type","y"+t+" axis must be an array !","error");e=[e],console.log("value in y"+t+" axis is converted to an array.")}modelsHiddenParams[a].data[this.index].y=e,modelsHiddenParams[a].data[this.index].x=modelsHiddenParams[a].data[0].x,modelsHiddenParams[a].layout=modelsParameters[a].layout,i.render()}},getValue:function(){return modelsHiddenParams[a].data[this.index].y},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){},setCaption:function(e,t){1==modelsParameters[a].numberOfAxis?(modelsParameters[a].layout.yaxis.title=e,modelsHiddenParams[a].layout=modelsParameters[a].layout):(modelsHiddenParams[a].data[this.index].name=e,modelsParameters[a].layout.yaxis.title="",modelsHiddenParams[a].layout=modelsParameters[a].layout)}}}},this.linePlotlyWidget.prototype=t.prototype,this.barPlotlyWidget=function(e,t,a,o){this.constructor(e,t,a,o);const i=this;this.numberOfAxis=modelsParameters[a].numberOfAxis,_.isUndefined(modelsParameters[a].layout)||(modelsParameters[a].layout={...plotlyColorParams,...modelsParameters[a].layout},["xaxis","yaxis"].forEach(e=>{_.isUndefined(modelsParameters[a].layout[e])||(modelsParameters[a].layout[e]={...axisParams,...modelsParameters[a].layout[e]})})),this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[a],o=[];if(t&&t.numberOfAxis){const e=_isAxisLinear(t.layout,"xaxis"),a=_isAxisLinear(t.layout,"yaxis");for(let i=1;i<=t.numberOfAxis;i++)o.push(e?_createPlotlyNumericDataDescriptor("x"+i):_createPlotlyAnyDataDescriptor("x"+i)),o.push(a?_createPlotlyNumericDataDescriptor("y"+i):_createPlotlyAnyDataDescriptor("y"+i))}return o},modelsHiddenParams[a].data.length>this.numberOfAxis&&modelsHiddenParams[a].data.splice(this.numberOfAxis,modelsHiddenParams[a].data.length),delete this.x;for(let e=1;e<=2;e++){const t=1===e?"x":"y";for(let e=1;e<=this.numberOfAxis;e++){const o=t+e;e>1&&"x"===t&&_.isUndefined(modelsHiddenParams[a].data[e-1])&&(modelsHiddenParams[a].data[e-1]={x:[],y:[],type:"bar"}),this[o]={index:e-1,strAxis:t,setValue:function(e){modelsHiddenParams[a].data[this.index][this.strAxis]=e,modelsHiddenParams[a].layout=modelsParameters[a].layout,i.render()},getValue:function(){return modelsHiddenParams[a].data[this.index][this.strAxis]},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){},setCaption:function(e,t){1==modelsParameters[a].numberOfAxis?(modelsParameters[a].layout[this.strAxis+"axis"].title=e,modelsHiddenParams[a].layout=modelsParameters[a].layout):modelsHiddenParams[a].data[this.index].name=e}}}}},this.barPlotlyWidget.prototype=t.prototype,this.piePlotlyWidget=function(e,t,a,o){this.constructor(e,t,a,o);var i=this;_.isUndefined(modelsParameters[a].layout)||(modelsParameters[a].layout={...plotlyColorParams,...modelsParameters[a].layout});const r=new WidgetActuatorDescription("labels","Array of labels",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING_ARRAY),l=new WidgetActuatorDescription("values","Array of numeric values",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER_ARRAY);this.getActuatorDescriptions=function(){return[r,l]},this.labels={setValue:function(e){modelsHiddenParams[a].data[0].labels=e,modelsHiddenParams[a].layout=modelsParameters[a].layout,i.render()},getValue:function(){return modelsHiddenParams[a].data[0].labels},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){}},this.values={setValue:function(e){modelsHiddenParams[a].data[0].values=e,modelsHiddenParams[a].layout=modelsParameters[a].layout,i.render()},getValue:function(){return modelsHiddenParams[a].data[0].values},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){}}},this.piePlotlyWidget.prototype=t.prototype,this.d3surfacePlotlyWidget=function(e,t,a,o){this.constructor(e,t,a,o);const i=this;_.isUndefined(modelsParameters[a].layout)||(modelsParameters[a].layout={...plotlyColorParams,...modelsParameters[a].layout},delete modelsParameters[a].layout.colorway,delete modelsParameters[a].layout.legend);const r=new WidgetActuatorDescription("x","1d array for the grid's Xs",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER_ARRAY),l=new WidgetActuatorDescription("y","1d array for the grid's Ys",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER_ARRAY),s=new WidgetActuatorDescription("z","2d array of arrays for the grid's Zs",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER_ARRAY_2D);this.getActuatorDescriptions=function(){return[r,l,s]},this.x={setValue:function(e){modelsHiddenParams[a].data[0].x=e,modelsHiddenParams[a].layout=modelsParameters[a].layout,i.render()},getValue:function(){return modelsHiddenParams[a].data[0].x},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){},setCaption:function(e,t){modelsParameters[a].layout.scene.xaxis.title=e,modelsHiddenParams[a].layout=modelsParameters[a].layout}},this.y={setValue:function(e){modelsHiddenParams[a].data[0].y=e,modelsHiddenParams[a].layout=modelsParameters[a].layout,i.render()},getValue:function(){return modelsHiddenParams[a].data[0].y},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){},setCaption:function(e,t){modelsParameters[a].layout.scene.yaxis.title=e,modelsHiddenParams[a].layout=modelsParameters[a].layout}},this.z={setValue:function(e){modelsHiddenParams[a].data[0].z=e,i.render()},getValue:function(){return modelsHiddenParams[a].data[0].z},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){},setCaption:function(e,t){modelsParameters[a].layout.scene.zaxis.title=e,modelsHiddenParams[a].layout=modelsParameters[a].layout}}},this.d3surfacePlotlyWidget.prototype=t.prototype,this.genericPlotlyWidget=function(e,t,a,o){this.constructor(e,t,a,o);const i=this,r=new WidgetActuatorDescription("data","Plotly data array",WidgetActuatorDescription.READ,void 0,e=>(Plotly.validate(e,{})||[]).map(e=>new WidgetActuatorValidationError(e.msg))),l=new WidgetActuatorDescription("layout","Plotly layout object",WidgetActuatorDescription.READ,void 0,e=>(Plotly.validate([],e)||[]).map(e=>new WidgetActuatorValidationError(e.msg))),s=new WidgetActuatorDescription("selection","Plotly selection",WidgetActuatorDescription.WRITE);this.getActuatorDescriptions=function(){return[r,l,s]},this.data={setValue:function(e){modelsHiddenParams[a].data=e,i.render()},getValue:function(){return modelsHiddenParams[a].data},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){}},this.layout={setValue:function(e){modelsHiddenParams[a].layout=e,i.render()},getValue:function(){return modelsHiddenParams[a].layout},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){}},this.selection={setValue:function(e){modelsHiddenParams[a].selection=e},getValue:function(){return modelsHiddenParams[a].selection},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}},this.genericPlotlyWidget.prototype=t.prototype,this.realTimePlotlyWidget=function(e,t,a,o){var i=this;this.numberOfAxis=1;const r=new WidgetActuatorDescription("layout","Plotly layout object",WidgetActuatorDescription.READ,void 0,e=>(Plotly.validate([],e)||[]).map(e=>new WidgetActuatorValidationError(e.msg))),l=new WidgetActuatorDescription("y1","Numeric value to add to the plot",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_NUMBER);this.getActuatorDescriptions=function(){const e=[];return e.push(l),e.push(r),e},modelsHiddenParams[a].data.length>this.numberOfAxis&&modelsHiddenParams[a].data.splice(this.numberOfAxis,modelsHiddenParams[a].data.length);for(let e=1;e<=this.numberOfAxis;e++){const i="y"+e;e>1&&_.isUndefined(modelsHiddenParams[a].data[e-1])&&(modelsHiddenParams[a].data[e-1]={x:[],y:[],name:"caption "+(e-1)}),this[i]={index:e-1,setValue:function(e){new Date;var a="plotly"+t;o&&(a+="c"),Plotly.extendTraces(a,{y:[[e]]},[this.index])},getValue:function(){return modelsHiddenParams[a].data[this.index].y},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){},setCaption:function(e,t){}}}this.layout={setValue:function(e){modelsHiddenParams[a].layout=e,i.render()},getValue:function(){return modelsHiddenParams[a].layout},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){}},this.constructor(e,t,a,o)},this.realTimePlotlyWidget.prototype=t.prototype,this.pluginDefinition={name:"plotly",widgetsDefinitionList:{plotlyLine:{factory:"linePlotlyWidget",title:"Plotly line",icn:"plotly-line",help:"wdg/wdg-plots/#plotly-line"},plotlyBar:{factory:"barPlotlyWidget",title:"Plotly bar",icn:"plotly-bar",help:"wdg/wdg-plots/#plotly-bar"},plotlyPie:{factory:"piePlotlyWidget",title:"Plotly pie",icn:"plotly-pie",help:"wdg/wdg-plots/#plotly-pie"},plotly3dSurface:{factory:"d3surfacePlotlyWidget",title:"Plotly 3D surface",icn:"plotly-3D",help:"wdg/wdg-plots/#plotly-3d-surface"},plotlyGeneric:{factory:"genericPlotlyWidget",title:"Plotly generic",icn:"plotly-javascript-generic",help:"wdg/wdg-plots/#plotly-generic"},plotlyRealTime:{factory:"realTimePlotlyWidget",title:"Plotly real-time",icn:"plotly-real-time"}}}}var plotlyWidgetsPlugin=new plotlyWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(plotlyWidgetsPlugin);
function pyodideWidgetsPluginClass(){var t=document.createElement("div");t.setAttribute("style","height: 1in; width: 1in; left: 100%; position: fixed; top: 100%;"),t.setAttribute("id","hiddenDivDpi"),document.body.appendChild(t);var e=document.getElementById("hiddenDivDpi").offsetWidth,i=document.getElementById("hiddenDivDpi").offsetHeight;function n(t,e){var i=document.createElement("div");i.setAttribute("id",e),i.setAttribute("style","text-align:center; height: inherit; width: inherit; background-color: transparent"),$("#"+t).html(i)}this.genericPlotlyPythonWidget=function(t,e,i,o){this.constructor(t,e,i,o);var d=this;this.rescale=function(){},this.render=async function(){var d="plotlyPython"+e;o&&(d+="c"),n(t,d);let a=modelsHiddenParams[i].fig;if(a&&"OK"==datanodesManager.getDataNodeByName(a).status()){let e='fig = globalScope["'+a+'"]\n';e+="\n# convert figure to JSON\nfig_json = fig.to_json(\nvalidate=True,\npretty=False)\nfig_json\n";try{const i=await pyodideManager.runPythonScript(e),n=JSON.parse(i);if(o)Plotly.newPlot(d,n.data,n.layout,n.config);else{$("#"+d).html(""),$("#"+d).html('<img id="png-export-'+d+'"></img>');var l,r=$("#png-export-"+d);Plotly.newPlot(d,n.data,n.layout,n.config).then((function(e){Plotly.toImage(e,{height:$("#"+t).height(),width:$("#"+t).width()}).then((function(t){l=t,Plotly.purge(e),r.attr("src",l),e.style.minHeight=e.parentNode.style.minHeight,e.style.minWidth=e.parentNode.style.minWidth,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height,r[0].style.minHeight=parseInt(e.parentNode.style.minHeight)+"px",r[0].style.minWidth=parseInt(e.parentNode.style.minWidth)+"px",r[0].style.width=parseFloat(e.parentNode.style.width)+"vw",r[0].style.height=parseFloat(e.parentNode.style.height)+"vh"}))}))}}catch(t){console.log(t)}}};const a=new WidgetActuatorDescription("fig","Plotly figure object",WidgetActuatorDescription.READ);this.getActuatorDescriptions=function(){return[a]},this.fig={setValue:function(t){modelsHiddenParams[i].fig=t,d.render()},getValue:function(){return modelsHiddenParams[i].fig},addValueChangedHandler:function(t){},removeValueChangedHandler:function(t){}},pyodideManager.loadPyodideLibs({standardLibs:[],micropipLibs:["plotly"]}),d.render()},this.genericPlotlyPythonWidget.prototype=baseWidget.prototype,this.genericMatplotlibWidget=function(t,o,d,a){this.constructor(t,o,d,a);var l=this;this.render=async function(){var l="innerMatplotlib"+o;a&&(l+="c"),n(t,l);let r=modelsHiddenParams[d].fig;if(r&&"OK"==datanodesManager.getDataNodeByName(r).status()){let t='fig = globalScope["'+r+'"]\n';t=t+"fig.set_size_inches("+$("#"+l).width()/e+","+$("#"+l).height()/i+")\n",t+="\nimport io, base64\nbuf = io.BytesIO()\nfig.savefig(buf, format='png')\nbuf.seek(0)\nimg_str = 'data:image/png;base64,' + base64.b64encode(buf.read()).decode('UTF-8')\nimg_str\n";try{const e=await pyodideManager.runPythonScript(t);$("#"+l).html('<img id="png-export-'+l+'"></img>');var s=$("#png-export-"+l),g=e;s.attr("src",g),s[0].style.width="inherit",s[0].style.height="inherit"}catch(t){console.log(t)}}};const r=new WidgetActuatorDescription("fig","Matplotlib figure object",WidgetActuatorDescription.READ);this.getActuatorDescriptions=function(){return[r]},this.fig={setValue:function(t){modelsHiddenParams[d].fig=t,l.render()},getValue:function(){return modelsHiddenParams[d].fig},addValueChangedHandler:function(t){},removeValueChangedHandler:function(t){}},pyodideManager.loadPyodideLibs({standardLibs:["matplotlib"],micropipLibs:[]}),l.render()},this.genericMatplotlibWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"pyodide",widgetsDefinitionList:{plotlyPyGeneric:{factory:"genericPlotlyPythonWidget",title:"Plotly Python generic",icn:"plotly-python-generic",help:"wdg/wdg-plots/#plotly-python-generic"},matplotlib:{factory:"genericMatplotlibWidget",title:"Matplotlib generic",icn:"matplolib-generic",help:"wdg/wdg-plots/#matplotlib"}}},this.constructor()}modelsParameters.plotlyPyGeneric={},modelsParameters.matplotlib={},modelsHiddenParams.plotlyPyGeneric={fig:""},modelsHiddenParams.matplotlib={fig:""},modelsLayout.plotlyPyGeneric={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},modelsLayout.matplotlib={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},pyodideWidgetsPluginClass.prototype=basePlugin.prototype;var pyodideWidgetsPlugin=new pyodideWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(pyodideWidgetsPlugin);
function vegaWidgetsPluginClass(){let e;this.genericVegaWidget=function(t,i,n,a){void 0!==window.xdash&&void 0===e&&(e=null,fetch("assets/data/vega_json_schema_v5.json").then(e=>e.json()).then(t=>{e=t,e.$id=WidgetPrototypesManager.ID_URI_SCHEME+"xdash:vega"}).catch(e=>console.error(e))),this.constructor(t,i,n,a);var r=this;this.rescale=function(){},this.render=function(){var e=JSON.parse(JSON.stringify(modelsHiddenParams[n].spec));if(function(e,t,i){var n=document.createElement("div"),a="vega"+t;i&&(a+="c"),n.setAttribute("id",a),n.setAttribute("style","text-align:center; height: inherit; width: inherit; background-color: transparent"),$("#"+e).html(n)}(t,i,a),modelsParameters[n].inheritWidthAndHeight&&(a?(e.width=$("#vega"+i+"c").width(),e.height=$("#vega"+i+"c").height()):(e.width=$("#vega"+i).width(),e.height=$("#vega"+i).height())),a)return new vega.View(vega.parse(e),{renderer:"canvas",container:"#vega"+i+"c",hover:!0}).runAsync();new vega.View(vega.parse(e),{renderer:"none"}).toCanvas().then((function(e){var t=e.toDataURL("image/png");$("#vega"+i).html('<img src="'+t+'"/>')})).catch((function(e){console.error(e)}))};const s=new WidgetActuatorDescription("spec","Vega JSON specification",WidgetActuatorDescription.READ,e);this.getActuatorDescriptions=function(){return[s]},this.spec={setValue:function(e){e!=modelsHiddenParams[n].spec&&(modelsHiddenParams[n].spec=JSON.parse(JSON.stringify(e)),r.render())},getValue:function(){return modelsHiddenParams[n].spec},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){}},r.render()},this.genericVegaWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"vega",widgetsDefinitionList:{vegaGeneric:{factory:"genericVegaWidget",title:"Vega generic",icn:"vega-generic-javascript",help:"wdg/wdg-plots/#vega"}}},this.constructor()}modelsParameters.vegaGeneric={inheritWidthAndHeight:!0},modelsHiddenParams.vegaGeneric={spec:{marks:[{type:"text",encode:{update:{text:{value:"Write then connect your Vega spec"}}}}]}},modelsLayout.vegaGeneric={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},vegaWidgetsPluginClass.prototype=basePlugin.prototype;var vegaWidgetsPlugin=new vegaWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(vegaWidgetsPlugin);
modelsParameters.echartsGeneric={};const echartsDefaultColors=["var(--widget-color-2)","var(--widget-color-5)","var(--widget-color-6)","var(--widget-color-7)"];function echartsWidgetsPluginClass(){this.genericEchartsWidget=function(e,t,i,n){this.constructor(e,t,i,n);var r=this;this.rescale=function(){this.render()},this.updateValue=function(e){modelsHiddenParams[i].selection&&(modelsHiddenParams[i].selection=e,_.isUndefined(r.selection.updateCallback)||r.selection.updateCallback(r.selection,r.selection.getValue()))},this.getColorValueFromCSSProperty=function(e){var t=e;if(t.includes("var(--")){var i=e.substring(4,e.length-1);t=window.getComputedStyle(document.documentElement).getPropertyValue(i)}return t},this.render=function(){var o=JSON.parse(JSON.stringify(modelsHiddenParams[i].option));if(o.hasOwnProperty("color")||(o.color=echartsDefaultColors),o.color=o.color.map(e=>this.getColorValueFromCSSProperty(e)),function(e,t,i){var n=document.createElement("div"),r="echarts"+t;i&&(r+="c"),n.setAttribute("id",r),n.setAttribute("style","text-align:center; height: inherit; width: inherit; background-color: transparent"),$("#"+e).html(n)}(e,t,n),n){var a=echarts.init(document.getElementById("echarts"+t+"c"));try{a.setOption(o)}catch(e){console.log(e)}a.on("datazoom",e=>{r.updateValue({start:e.start,end:e.end})})}else{a=echarts.init(document.getElementById("echarts"+t));try{a.setOption(o)}catch(e){console.log(e)}var s=a.getDataURL();a.dispose(),$("#echarts"+t).html('<img src="'+s+'"/>')}};const o=new WidgetActuatorDescription("option","Chart definition",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_ANY_OBJECT),a=new WidgetActuatorDescription("selection","Current selection",WidgetActuatorDescription.WRITE,WidgetPrototypesManager.SCHEMA_ANY_OBJECT);this.getActuatorDescriptions=function(){return[o,a]},this.option={setValue:function(e){e==modelsHiddenParams[i].option||""==e||_.isUndefined(e)||(modelsHiddenParams[i].option=e,r.render())},getValue:function(){return modelsHiddenParams[i].option},addValueChangedHandler:function(e){},removeValueChangedHandler:function(e){}},this.selection={setValue:function(e){modelsHiddenParams[i].selection=e},getValue:function(){return modelsHiddenParams[i].selection},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}},r.render()},this.genericEchartsWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"echarts",widgetsDefinitionList:{echartsGeneric:{factory:"genericEchartsWidget",title:"Echarts generic",icn:"echarts-generic-javascript",help:"wdg/wdg-plots/#echarts"}}},this.constructor()}modelsHiddenParams.echartsGeneric={option:{color:echartsDefaultColors},selection:{}},modelsLayout.echartsGeneric={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},echartsWidgetsPluginClass.prototype=basePlugin.prototype;var echartsWidgetsPlugin=new echartsWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(echartsWidgetsPlugin);
modelsHiddenParams.hereMaps={inputGeoJson:{},mapMatchingResult:{},heatMapData:{}},modelsHiddenParams.openStreetMaps={geoJson:{geoJsonLayers:[],geoJsonBounds:[]},choropleth:{choroplethLayers:[],choroplethBounds:[]},lineHeatMap:{lineHeatMapLayers:[],lineHeatMapBounds:[]},heatMap:{heatMapData:[],heatMapBuffer:[]},imageOverlay:{imageData:[]},svgOverlay:{svgData:[],svgElements:[]},legends:[],colors:["#800080","#FF00FF","#000080","#0000FF","#008080","#00FFFF","#FFFF00","#800000","#6666ff","#cc6699","#66ff66","#666699","#996633","#ff0000","#669999","#ffff99"]},modelsTempParams.openStreetMaps={geoJson:{geoJsonLayers:[]},choropleth:{choroplethLayers:[]},lineHeatMap:{lineHeatMapLayers:[]},heatMap:{heatMapLayers:[]},imageOverlay:{imageLayers:[]},svgOverlay:{svgLayers:[]},mapObj:null},modelsParameters.openStreetMaps={geoJson:{numberOfLayers:1},choropleth:{numberOfLayers:0},heatMap:{numberOfLayers:0,sampledDisplay:!1,densityHeatMap:!1},lineHeatMap:{numberOfLayers:0},imageOverlay:{numberOfLayers:0},svgOverlay:{numberOfLayers:0},defaultCenter:{latitude:48.872063,longitude:2.331773,zoom:16},offlineSupport:!1,tileServer:"MapboxStreets",drawingFeatures:!1,drawingFeaturesOptions:{point:!0,line:!0,polygone:!0,rectangle:!0,modal:!1},captureClickEvent:!1,markerCluster:!0},modelsLayout.openStreetMaps={height:"35vh",width:"35vw"};const _SCHEMA_SELECTED_POINT={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_imageOverlay",type:"object",properties:{lat:{type:"number"},lag:{type:"number"}},required:["lat","lag"]},_SCHEMA_IMAGE_OVERLAY={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_imageOverlay",type:"object",properties:{imageUrl:{type:"string"},imageBounds:{type:"array",items:{type:"array",items:{type:"number"},minItems:2,maxItems:2},minItems:2,maxItems:2},title:{type:"string"},addAs:{enum:["overlay","baseLayer"]}},required:["imageUrl","imageBounds","title","addAs"]},_SCHEMA_SVG_POINT_OVERLAY={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_svgPointOverlay",type:"object",properties:{data:{anyOf:[{type:"object",properties:{lat:{type:"number"},lng:{type:"number"},direction:{type:"number"}},required:["lat","lng"]},{type:"object",properties:{lat:{type:"number"},lng:{type:"number"},rotation:{type:"number"}},required:["lat","lng"]}]},config:{type:"object",properties:{title:{type:"string"},addAs:{enum:["overlay","baseLayer"]},disableAutoscale:{type:"boolean"},marker:{enum:["arrow","triangle","emptyTriangle","fullTriangle","circle"]},length:{type:"number"},color:{type:"string"}},required:["title","length"]}},required:["data","config"]},_SCHEMA_SVG_OVERLAY={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_svgOverlay",type:"object",properties:{data:{type:"array",items:{anyOf:[{type:"object",properties:{lat:{type:"number"},lng:{type:"number"},direction:{type:"number"}},required:["lat","lng"]},{type:"object",properties:{lat:{type:"number"},lng:{type:"number"},rotation:{type:"number"}},required:["lat","lng"]}]}},config:{type:"object",properties:{title:{type:"string"},addAs:{enum:["overlay","baseLayer"]},disableAutoscale:{type:"boolean"},marker:{enum:["arrow","triangle","emptyTriangle","fullTriangle","circle"]},length:{type:"number"},color:{type:"string"}},required:["title","length"]}},required:["data","config"]},__SCHEMA_VALUED_COORD={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet__valued_coord",anyOf:[{type:"object",properties:{lat:{type:"number",minimum:-90,maximum:90},lng:{type:"number",minimum:-180,maximum:180}},required:["lat","lng"],minProperties:3,maxProperties:3,additionalProperties:{type:"number"}},{type:"array",items:[{type:"number",minimum:-90,maximum:90},{type:"number",minimum:-180,maximum:180},{type:"number"}],minItems:3,maxItems:3}]},__SCHEMA_COORD={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet__coord",anyOf:[{type:"object",properties:{lat:{type:"number",minimum:-90,maximum:90},lng:{type:"number",minimum:-180,maximum:180}},required:["lat","lng"]},{type:"array",items:[{type:"number",minimum:-90,maximum:90},{type:"number",minimum:-180,maximum:180}],minItems:2,maxItems:2}]},__SCHEMA_HEATMAP_DENSITY_CONFIG={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet__heatmap_density_config",type:"object",properties:{minOpacity:{type:"number",minimum:0,maximum:1},maxZoom:{type:"number",minimum:0},radius:{type:"number",minimum:0},blur:{type:"number",minimum:0},disableAutoscale:{type:"boolean"},colorScale:{type:"string"},reverseColorScale:{type:"boolean"}}},__SCHEMA_HEATMAP_CONFIG={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet__heatmap_config",type:"object",properties:{opacity:{type:"number",minimum:0,maximum:1},radius:{type:"number",minimum:0},max:{type:"number"},min:{type:"number"},disableAutoscale:{type:"boolean"},addTextLabel:{type:"boolean"},colorScale:{type:"string"},reverseColorScale:{type:"boolean"}}},_SCHEMA_HEATMAP_DENSITY=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_heatmap_density",type:"object",properties:{data:{type:"array",items:{$ref:__SCHEMA_VALUED_COORD.$id}},config:{$ref:__SCHEMA_HEATMAP_DENSITY_CONFIG.$id}},required:["data"]},__SCHEMA_VALUED_COORD,__SCHEMA_HEATMAP_DENSITY_CONFIG],_SCHEMA_HEATMAP_DENSITY_SAMPLED=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_heatmap_density_sampled",type:"object",properties:{data:{$ref:__SCHEMA_VALUED_COORD.$id},config:{$ref:__SCHEMA_HEATMAP_DENSITY_CONFIG.$id}},required:["data"]},__SCHEMA_VALUED_COORD,__SCHEMA_HEATMAP_DENSITY_CONFIG],_SCHEMA_HEATMAP=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_heatmap",type:"object",properties:{data:{type:"array",items:{$ref:__SCHEMA_VALUED_COORD.$id}},config:{$ref:__SCHEMA_HEATMAP_CONFIG.$id}},required:["data"]},__SCHEMA_VALUED_COORD,__SCHEMA_HEATMAP_CONFIG],_SCHEMA_HEATMAP_SAMPLED=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_heatmap_sampled",type:"object",properties:{data:{$ref:__SCHEMA_VALUED_COORD.$id},config:{$ref:__SCHEMA_HEATMAP_CONFIG.$id}},required:["data"]},__SCHEMA_VALUED_COORD,__SCHEMA_HEATMAP_CONFIG],__SCHEMA_GEOJSON_COORD={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_geojson_coord",anyOf:[{type:"array",items:[{type:"number",minimum:-180,maximum:180},{type:"number",minimum:-90,maximum:90}],minItems:2,maxItems:2},{type:"array",items:[{type:"number",minimum:-180,maximum:180},{type:"number",minimum:-90,maximum:90},{type:"number"}],minItems:3,maxItems:3}]},__SCHEMA_GEOJSON_COORDINATES={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_geojson_coordinates",type:"array",items:{$ref:__SCHEMA_GEOJSON_COORD.$id}},_SCHEMA_LINE_HEATMAP=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_line_heatmap",type:"object",properties:{data:{type:"array",items:{type:"object",properties:{coordinates:{type:"array",items:{$ref:__SCHEMA_GEOJSON_COORD.$id},minItems:2}},required:["coordinates"],patternProperties:{"^(?!coordinates).*$":{type:"number"}},minProperties:2,maxProperties:2}},config:{type:"object",properties:{opacity:{type:"number",minimum:0,maximum:1},weight:{type:"number",minimum:0},max:{type:"number"},min:{type:"number"},disableAutoscale:{type:"boolean"},colorScale:{type:"string"},reverseColorScale:{type:"boolean"}},required:["weight"]}},required:["data","config"]},__SCHEMA_GEOJSON_COORD],__SCHEMA_GEOJSON_GEOMETRY_PRIMITIVE={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_geojson_geometry_primitive",anyOf:[{type:"object",properties:{type:{const:"Point"},coordinates:{$ref:__SCHEMA_GEOJSON_COORD.$id}},required:["type","coordinates"]},{type:"object",properties:{type:{const:"LineString"},coordinates:{$ref:__SCHEMA_GEOJSON_COORDINATES.$id}},required:["type","coordinates"]},{type:"object",properties:{type:{const:"Polygon"},coordinates:{type:"array",items:{$ref:__SCHEMA_GEOJSON_COORDINATES.$id}}},required:["type","coordinates"]}]},__SCHEMA_GEOJSON_GEOMETRY_ALL={$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_geojson_geometry_all",anyOf:[{$ref:__SCHEMA_GEOJSON_GEOMETRY_PRIMITIVE.$id},{type:"object",properties:{type:{const:"MultiPoint"},coordinates:{$ref:__SCHEMA_GEOJSON_COORDINATES.$id}},required:["type","coordinates"]},{type:"object",properties:{type:{const:"MultiLineString"},coordinates:{type:"array",items:{$ref:__SCHEMA_GEOJSON_COORDINATES.$id}}},required:["type","coordinates"]},{type:"object",properties:{type:{const:"MultiPolygon"},coordinates:{type:"array",items:{type:"array",items:{$ref:__SCHEMA_GEOJSON_COORDINATES.$id}}}},required:["type","coordinates"]},{type:"object",properties:{type:{const:"GeometryCollection"},geometries:{type:"array",items:{$ref:__SCHEMA_GEOJSON_GEOMETRY_PRIMITIVE.$id}}},required:["type","geometries"]}]},_SCHEMA_CHOROPLETH=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_choropleth",type:"object",properties:{data:{type:"array",items:{type:"object",properties:{geometry:{$ref:__SCHEMA_GEOJSON_GEOMETRY_ALL.$id}},required:["geometry"],patternProperties:{"^(?!geometry).*$":{type:"number"}},minProperties:2,maxProperties:2}},config:{type:"object",properties:{opacity:{type:"number",minimum:0,maximum:1},weight:{type:"number",minimum:0},max:{type:"number"},min:{type:"number"},disableAutoscale:{type:"boolean"},colorScale:{type:"string"},reverseColorScale:{type:"boolean"}}}},required:["data"]},__SCHEMA_GEOJSON_COORD,__SCHEMA_GEOJSON_COORDINATES,__SCHEMA_GEOJSON_GEOMETRY_PRIMITIVE,__SCHEMA_GEOJSON_GEOMETRY_ALL],_SCHEMA_GEOJSON=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_geojson",type:"object",properties:{type:{const:"FeatureCollection"},features:{type:"array",items:{type:"object",properties:{type:{const:"Feature"},id:{type:"string"},geometry:{$ref:__SCHEMA_GEOJSON_GEOMETRY_ALL.$id},properties:{type:"object",properties:{description:{type:"string"},style:{type:"object",properties:{color:{type:"string"},weight:{type:"number"},opacity:{type:"number"}},additionalProperties:{$ref:WidgetPrototypesManager.SCHEMA_ANY_PRIMITIVE.$id}}}}},if:{properties:{geometry:{type:"object",properties:{type:{const:"Point"}},required:["type"]}}},then:{properties:{properties:{type:"object",properties:{awesomeMarker:{type:"object",properties:{icon:{type:"string"},prefix:{type:"string"},markerColor:{type:"string"},iconColor:{type:"string"},spin:{type:"boolean"},extraClasses:{type:"string"}},required:["icon"]},comment:{type:"string"},html:{type:"string"}},anyOf:[{not:{required:["comment"]}},{not:{required:["html"]}}]}}},required:["type","geometry","properties"]}},properties:{type:"object",properties:{description:{type:"string"}}}},required:["type","features"]},__SCHEMA_GEOJSON_COORD,__SCHEMA_GEOJSON_COORDINATES,__SCHEMA_GEOJSON_GEOMETRY_PRIMITIVE,__SCHEMA_GEOJSON_GEOMETRY_ALL,WidgetPrototypesManager.SCHEMA_ANY_PRIMITIVE],_SCHEMA_SELECTED_GEOJSON=[{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:leaflet_selected_geojson",type:"object",properties:{type:{const:"FeatureCollection"},features:{type:"array",items:{type:"object",required:["type","geometry","properties"],properties:{type:{const:"Feature"},geometry:{$ref:__SCHEMA_GEOJSON_GEOMETRY_PRIMITIVE.$id},properties:{type:"object",properties:{layerId:{type:"number"}},required:["layerId"]}},if:{properties:{geometry:{type:"object",properties:{type:{const:"Polygon"}},required:["type"]}}},then:{properties:{geometry:{type:"object",properties:{isRectangle:{type:"boolean"},isCut:{type:"boolean"}},required:["isRectangle","isCut"]}}}}}},required:["type","features"]},__SCHEMA_GEOJSON_COORD,__SCHEMA_GEOJSON_COORDINATES,__SCHEMA_GEOJSON_GEOMETRY_PRIMITIVE,WidgetPrototypesManager.SCHEMA_ANY_PRIMITIVE];function mapWidgetsPluginClass(){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e.setAttribute("width","0"),e.setAttribute("height","0");e.innerHTML='<defs><marker id="styledArrow" markerUnits="strokeWidth" markerWidth="12" markerHeight="12" viewBox="0 0 12 12" refX="6" refY="6" orient="auto"><path d="M2,2 L10,6 L2,10 L6,6 L2,2" style="fill: black;"></path></marker></defs>';var a=document.createElement("div");a.setAttribute("style","width:0px; height:0px; margin:0px; padding: 0px"),a.setAttribute("id","hiddenDiv"),a.appendChild(e),document.body.appendChild(a),this.openStreetMapsWidget=function(e,a,t,r){var o=modelsParameters[t].drawingFeatures,s=modelsParameters[t].captureClickEvent,n=modelsParameters[t].markerCluster,i={drawCircle:!1,drawCircleMarker:!1,drawMarker:!0,drawPolyline:!0,drawPolygon:!0,drawRectangle:!0};o&&(i={drawCircle:!1,drawCircleMarker:!1,drawMarker:modelsParameters[t].drawingFeaturesOptions.point,drawPolyline:modelsParameters[t].drawingFeaturesOptions.line,drawPolygon:modelsParameters[t].drawingFeaturesOptions.polygone,drawRectangle:modelsParameters[t].drawingFeaturesOptions.rectangle}),this.constructor(e,a,t,r);var l=this,d=(d3.select("body"),[0,25,50,75,100]);function m(e,a,t,r){var o=(a-e)/8;return r(Math.floor((t-e)/o)*(1/8))}if(this.numberOfGeoJsonLayers=modelsParameters[t].geoJson.numberOfLayers,modelsParameters[t].choropleth?this.numberOfChoroplethLayers=modelsParameters[t].choropleth.numberOfLayers:this.numberOfChoroplethLayers=0,modelsParameters[t].lineHeatMap?this.numberOfLineHeatMapLayers=modelsParameters[t].lineHeatMap.numberOfLayers:this.numberOfLineHeatMapLayers=0,this.numberOfHeatMapLayers=modelsParameters[t].heatMap.numberOfLayers,_.isUndefined(modelsHiddenParams[t].heatMap.heatMapBuffer)&&(modelsHiddenParams[t].heatMap.heatMapBuffer=[]),_.isUndefined(modelsParameters[t].imageOverlay)?(this.numberOfImageLayers=0,modelsParameters[t].imageOverlay={numberOfLayers:0}):this.numberOfImageLayers=modelsParameters[t].imageOverlay.numberOfLayers,_.isUndefined(modelsHiddenParams[t].imageOverlay)&&(modelsHiddenParams[t].imageOverlay={imageData:[]}),_.isUndefined(modelsParameters[t].svgOverlay)?(this.numberOfSvgLayers=0,modelsParameters[t].svgOverlay={numberOfLayers:0}):this.numberOfSvgLayers=modelsParameters[t].svgOverlay.numberOfLayers,_.isUndefined(modelsHiddenParams[t].svgOverlay)&&(modelsHiddenParams[t].svgOverlay={svgData:[],svgElements:[]}),_.isUndefined(modelsParameters[t].lineHeatMap)?(this.numberOfLineHeatMapLayers=0,modelsParameters[t].lineHeatMap={numberOfLayers:0}):this.numberOfLineHeatMapLayers=modelsParameters[t].lineHeatMap.numberOfLayers,_.isUndefined(modelsHiddenParams[t].lineHeatMap)&&(modelsHiddenParams[t].lineHeatMap={lineHeatMapLayers:[],lineHeatMapBounds:[]}),_.isUndefined(modelsParameters[t].choropleth)?(this.numberOfChoroplethLayers=0,modelsParameters[t].choropleth={numberOfLayers:0}):this.numberOfChoroplethLayers=modelsParameters[t].choropleth.numberOfLayers,_.isUndefined(modelsHiddenParams[t].choropleth)&&(modelsHiddenParams[t].choropleth={choroplethLayers:[],choroplethBounds:[]}),_.isUndefined(l.mapLayers)&&(l.mapLayers=jQuery.extend(!0,{},modelsTempParams.openStreetMaps)),this.configStore=[],modelsHiddenParams[t].geoJson.geoJsonLayers.length>l.numberOfGeoJsonLayers&&modelsHiddenParams[t].geoJson.geoJsonLayers.splice(l.numberOfGeoJsonLayers),modelsHiddenParams[t].geoJson.geoJsonBounds.length>l.numberOfGeoJsonLayers&&modelsHiddenParams[t].geoJson.geoJsonBounds.splice(l.numberOfGeoJsonLayers),l.mapLayers.geoJson.geoJsonLayers.length>l.numberOfGeoJsonLayers&&l.mapLayers.geoJson.geoJsonLayers.splice(l.numberOfGeoJsonLayers),modelsHiddenParams[t].choropleth.choroplethLayers.length>l.numberOfChoroplethLayers&&modelsHiddenParams[t].choropleth.choroplethLayers.splice(l.numberOfChoroplethLayers),modelsHiddenParams[t].choropleth.choroplethBounds.length>l.numberOfChoroplethLayers&&modelsHiddenParams[t].choropleth.choroplethBounds.splice(l.numberOfChoroplethLayers),l.mapLayers.choropleth.choroplethLayers.length>l.numberOfChoroplethLayers&&l.mapLayers.choropleth.choroplethLayers.splice(l.numberOfChoroplethLayers),modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers.length>l.numberOfLineHeatMapLayers&&modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers.splice(l.numberOfLineHeatMapLayers),modelsHiddenParams[t].lineHeatMap.lineHeatMapBounds.length>l.numberOfLineHeatMapLayers&&modelsHiddenParams[t].lineHeatMap.lineHeatMapBounds.splice(l.numberOfLineHeatMapLayers),l.mapLayers.lineHeatMap.lineHeatMapLayers.length>l.numberOfLineHeatMapLayers&&l.mapLayers.lineHeatMap.lineHeatMapLayers.splice(l.numberOfLineHeatMapLayers),modelsHiddenParams[t].heatMap.heatMapData.length>l.numberOfHeatMapLayers&&(modelsHiddenParams[t].heatMap.heatMapData.splice(l.numberOfHeatMapLayers),modelsHiddenParams[t].legends.splice(l.numberOfHeatMapLayers)),modelsHiddenParams[t].heatMap.heatMapBuffer.length>l.numberOfHeatMapLayers&&(modelsHiddenParams[t].heatMap.heatMapBuffer.splice(l.numberOfHeatMapLayers),modelsHiddenParams[t].legends.splice(l.numberOfHeatMapLayers)),l.mapLayers.heatMap.heatMapLayers.length>l.numberOfHeatMapLayers&&l.mapLayers.heatMap.heatMapLayers.splice(l.numberOfHeatMapLayers),modelsHiddenParams[t].imageOverlay.imageData.length>l.numberOfImageLayers&&modelsHiddenParams[t].imageOverlay.imageData.splice(l.numberOfImageLayers),l.mapLayers.imageOverlay.imageLayers.length>l.numberOfImageLayers&&l.mapLayers.imageOverlay.imageLayers.splice(l.numberOfImageLayers),modelsHiddenParams[t].svgOverlay.svgData.length>l.numberOfSvgLayers&&(modelsHiddenParams[t].svgOverlay.svgData.splice(l.numberOfSvgLayers),modelsHiddenParams[t].svgOverlay.svgElements.splice(l.numberOfSvgLayers)),l.mapLayers.svgOverlay.svgLayers.length>l.numberOfSvgLayers&&l.mapLayers.svgOverlay.svgLayers.splice(l.numberOfSvgLayers),this.getColorScale=function(e,a,t,r){var o=d3.interpolateYlOrRd;return _.isUndefined(e)||_.isUndefined(d3[e])||!e.includes("interpolate")||(o=d3[e]),!_.isUndefined(a)&&a?d3.scaleSequential().interpolator(o).domain([r,t]):d3.scaleSequential().interpolator(o).domain([t,r])},this.goToFirstRadioButton=function(){if("play"==tabActive&&l.numberOfHeatMapLayers>0){var e=0;_.isUndefined($("input[name='leaflet-base-layers']"))||(e=$("input[name='leaflet-base-layers']").length);for(var a=0;a<e;a++)if($.contains(document.getElementById(t+"c"),$("input[name='leaflet-base-layers']")[a])&&!_.isUndefined(modelsHiddenParams[t])&&modelsHiddenParams[t].legends!=[]){$("input[name='leaflet-base-layers']")[a].click();var r=_.keys(modelsHiddenParams[t].legends)[0];return l.showLegend(r),l.currentBaseLayer=r,void document.removeEventListener("play-tab-loaded",l.goToFirstRadioButton)}}},this.updateValue=function(e){modelsHiddenParams[t].selectedGeoJson&&(modelsHiddenParams[t].selectedGeoJson.features?modelsHiddenParams[t].selectedGeoJson.features.push(e):modelsHiddenParams[t].selectedGeoJson={type:"FeatureCollection",features:[e]},l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue()))},this.getGeoJsonPoint=function(e,a){var t=[];if("polygon"!==e.geometry.type&&"Polygon"!==e.geometry.type||!e.geometry.isCut){if("LineString"===e.geometry.type||"lineString"===e.geometry.type){for(var r=0;r<a._latlngs.length;r++){var o=a._latlngs[r];t.push([o.lng,o.lat])}return t}if("polygon"!==e.geometry.type&&"Polygon"!==e.geometry.type||e.geometry.isCut)return"Point"===e.geometry.type||"point"===e.geometry.type?t=[a._latlng.lng,a._latlng.lat]:[];var s=a._latlngs?a._latlngs[0]:a.pm._layers[0]._latlngs[0];for(r=0;r<s.length;r++){o=s[r];t.push([o.lng,o.lat])}return[t]}return(s=a._latlngs?a._latlngs:a.pm._layers[0]._latlngs).forEach((function(e){for(var a=[],r=0;r<e.length;r++)a.push([e[r].lng,e[r].lat]);t.push(a)})),t},this.getGeoJsonPoint1=function(e,a,t){var r=[],o=[];"rectangle"===e||"Polygon"===e&&t||"polygon"===e||"Polygon"===e&&!t?r=a[0]:"LineString"===e?r=a:"Point"===e&&(r=[],o=[a[1],a[0]]);for(var s=0;s<r.length;s++)o.push([r[s][1],r[s][0]]);return o},this.getLayerInformation=function(e){var a={title:"",description:"",timeStamp:""};if(modelsHiddenParams[t].selectedGeoJson){for(var r=0;r<modelsHiddenParams[t].selectedGeoJson.features.length;r++)modelsHiddenParams[t].selectedGeoJson.features[r].properties.layerId==e&&modelsHiddenParams[t].selectedGeoJson.features[r].properties.information&&(a.title=modelsHiddenParams[t].selectedGeoJson.features[r].properties.information.title,a.description=modelsHiddenParams[t].selectedGeoJson.features[r].properties.information.description,a.timeStamp=modelsHiddenParams[t].selectedGeoJson.features[r].properties.information.timeStamp);l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())}return a},this.updateLayerInformation=function(e,a){if(modelsHiddenParams[t].selectedGeoJson){for(var r=0;r<modelsHiddenParams[t].selectedGeoJson.features.length;r++)modelsHiddenParams[t].selectedGeoJson.features[r].properties.layerId==e&&(modelsHiddenParams[t].selectedGeoJson.features[r].properties.information=a);l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())}},this.editList=function(e){if(modelsHiddenParams[t].selectedGeoJson){for(var a=e.map._layers,r=Object.keys(a),o=0;o<r.length;o++)for(var s=0;s<modelsHiddenParams[t].selectedGeoJson.features.length;s++)if(modelsHiddenParams[t].selectedGeoJson.features[s].properties.layerId==a[r[o]]._leaflet_id){var n=l.getGeoJsonPoint(modelsHiddenParams[t].selectedGeoJson.features[s],a[r[o]]);modelsHiddenParams[t].selectedGeoJson.features[s].geometry.coordinates=n}l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())}},this.rotateLayer=function(e){var a=e.layer._drawnByGeoman?e.layer._leaflet_id:e.layer.feature.properties.layerId;if(modelsHiddenParams[t].selectedGeoJson){for(var r=0;r<modelsHiddenParams[t].selectedGeoJson.features.length;r++)if(modelsHiddenParams[t].selectedGeoJson.features[r].properties.layerId==a){var o=l.getGeoJsonPoint(modelsHiddenParams[t].selectedGeoJson.features[r],e.layer);modelsHiddenParams[t].selectedGeoJson.features[r].geometry.coordinates=o}l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())}},this.deleteLayer=function(e){var a=e.layer._drawnByGeoman?e.layer._leaflet_id:e.layer.feature.properties.layerId;if(modelsHiddenParams[t].selectedGeoJson){for(var r=0;r<modelsHiddenParams[t].selectedGeoJson.features.length;r++)modelsHiddenParams[t].selectedGeoJson.features[r].properties.layerId==a&&modelsHiddenParams[t].selectedGeoJson.features.splice(r,1);l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())}},s&&(this.selectedPoint={updateCallback:function(){},getValue:function(){return modelsHiddenParams[t].selectedPoint},setValue:function(e){},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){},setCaption:function(e){},clearCaption:function(){modelsParameters[t].label="",l.render()}}),o&&(this.selectedGeoJson={updateCallback:function(){},getValue:function(){return modelsHiddenParams[t].selectedGeoJson},setValue:function(e){modelsHiddenParams[t].selectedGeoJson=e},addValueChangedHandler:function(e){"None"!==widgetConnector.widgetsConnection[t].sliders.selectedGeoJson.dataNode&&(this.updateCallback=e,l.addDrawingFeatures())},removeValueChangedHandler:function(e){},setCaption:function(e){},clearCaption:function(){modelsParameters[t].label="",l.render()}}),this.modal=function(e){if(modelsParameters[t].drawingFeaturesOptions.modal){var a=l.getLayerInformation(e.leafletId),r=['<div class="modal-header"><h4>{title} </h4></div>','<h5 class="pull-left" style="padding-left: 10px"><a>Please add a title and a short description</a></h5>','<div class="modal-body">','<div class="row">{content}</div>',"</div>",'<div class="modal-footer">','<input id="dialog-ok" type="submit" class="bouton {OK_CLS}" value="Ok">','<input id="dialog-ok" type="submit" class="bouton  {CANCEL_CLS}" value="Cancel">',"</div>"].join(""),o=["<table>","<body>","<tr>",'<td style="width: 40%;padding-top: 20px;">Title</td>','<td style="width: 60%;padding-top: 20px;">','<textarea type="text" class="form-control"  style="width:190px;max-width: 200px ;max-height: 40px  ;color: #34495e" rows="1" id="modalInput1"  placeholder="Enter title">',a.title,"</textarea>","</td>","</tr>","<tr>",'<td style="width: 30%;padding-top: 20px;">Description</td>','<td style="width: 70%;padding-top: 20px;">','<textarea type="text" class="form-control"  style="width:190px;max-width: 200px ;max-height: 70px  ;color: #34495e" rows="2" id="modalInput2"  placeholder="Enter Description">',a.description,"</textarea>","</td>","</tr>","</body>","</table>"].join("");e.type,l.map.openModal({leafletId:e.leafletId||"NA",content:o,template:r,okText:"Ok",title:a.title,description:a.description,cancelText:"Cancel",OK_CLS:"modal-ok",CANCEL_CLS:"modal-cancel",MODAL_CONTENT_CLS:"modal-content modal-content-black",width:350,onShow:function(a){var t=a.modal;L.DomEvent.on(t._container.querySelector(".modal-ok"),"click",(function(){e.title=document.getElementById("modalInput1").value,e.description=document.getElementById("modalInput2").value;var a=new Date;e.timeStamp=a.toISOString(),l.updateLayerInformation(e.leafletId,e),t.hide()})).on(t._container.querySelector(".modal-cancel"),"click",(function(){t.hide()}))}})}},this.addDrawingFeatures=function(){var e=new L.FeatureGroup;if(l.map.addLayer(e),this.bIsInteractive){if(modelsHiddenParams[t].selectedGeoJson)if(modelsHiddenParams[t].selectedGeoJson.features){for(var a=0;a<modelsHiddenParams[t].selectedGeoJson.features.length;a++){var r=l.getGeoJsonPoint1(modelsHiddenParams[t].selectedGeoJson.features[a].geometry.type,modelsHiddenParams[t].selectedGeoJson.features[a].geometry.coordinates,modelsHiddenParams[t].selectedGeoJson.features[a].geometry.isRectangle),o=null;"LineString"===modelsHiddenParams[t].selectedGeoJson.features[a].geometry.type?o=L.polyline(r):"Point"===modelsHiddenParams[t].selectedGeoJson.features[a].geometry.type?o=L.marker(r):"Polygon"===modelsHiddenParams[t].selectedGeoJson.features[a].geometry.type&&(o=(modelsHiddenParams[t].selectedGeoJson.features[a].geometry.isRectangle,L.geoJSON(modelsHiddenParams[t].selectedGeoJson.features[a],{}))),o&&(o.on("click",(function(e){console.log("click pol leaflet_id",e.target._leaflet_id),l.modal({leafletId:e.target._leaflet_id})})),e.addLayer(o),modelsHiddenParams[t].selectedGeoJson.features[a].properties.layerId=o._leaflet_id)}l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())}else modelsHiddenParams[t].selectedGeoJson.type="FeatureCollection",modelsHiddenParams[t].selectedGeoJson.features=[],l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue());else modelsHiddenParams[t].selectedGeoJson={type:"FeatureCollection",features:[]},l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue());l.map.on("pm:globaleditmodetoggled",(function(e){console.log("pm:globaleditmodetoggled",e),l.editList(e)})),l.map.on("pm:globaldragmodetoggled",(function(e){console.log("pm:globaldragmodetoggled",e),l.editList(e)})),l.map.on("pm:rotateend",(function(e){console.log("pm:rotateend",e),l.rotateLayer(e)})),l.map.on("pm:remove",(function(e){console.log("pm:remove",e),l.deleteLayer(e)})),l.map.on("pm:cut",(function(e){console.log("pm:cut",e);for(var a=e.originalLayer._drawnByGeoman?e.originalLayer._leaflet_id:e.originalLayer.feature.properties.layerId,r=0;r<modelsHiddenParams[t].selectedGeoJson.features.length;r++)modelsHiddenParams[t].selectedGeoJson.features[r].properties.layerId==a&&(modelsHiddenParams[t].selectedGeoJson.features[r].properties.layerId=e.layer._leaflet_id,modelsHiddenParams[t].selectedGeoJson.features[r].geometry.coordinates=e.layer.feature.geometry.coordinates,modelsHiddenParams[t].selectedGeoJson.features[r].geometry.isCut=!0);l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())})),l.map.on("pm:create",a=>{console.log("pm:create",a),e.addLayer(a.layer);var r=[];if(modelsHiddenParams[t].selectedGeoJson)if("Polygon"==a.shape){for(var o=0;o<a.layer._latlngs[0].length;o++){var s=a.layer._latlngs[0][o];r.push([s.lng,s.lat])}l.updateValue({type:"Feature",geometry:{type:"Polygon",coordinates:[r],isRectangle:!1,isCut:!1},properties:{layerId:a.layer._leaflet_id}})}else if("Line"==a.shape){for(o=0;o<a.layer._latlngs.length;o++){s=a.layer._latlngs[o];r.push([s.lng,s.lat])}l.updateValue({type:"Feature",geometry:{type:"LineString",coordinates:r},properties:{layerId:a.layer._leaflet_id}})}else if("Rectangle"==a.shape){for(o=0;o<a.layer._latlngs[0].length;o++){s=a.layer._latlngs[0][o];r.push([s.lng,s.lat])}l.updateValue({type:"Feature",geometry:{type:"Polygon",coordinates:[r],isRectangle:!0,isCut:!1},properties:{layerId:a.layer._leaflet_id}})}else"Marker"==a.shape&&(r=[a.layer._latlng.lng,a.layer._latlng.lat],l.updateValue({type:"Feature",geometry:{type:"Point",coordinates:r},properties:{layerId:a.layer._leaflet_id}}))})}else modelsHiddenParams[t].selectedGeoJson={type:"FeatureCollection",features:[]},l.selectedGeoJson.updateCallback(l.selectedGeoJson,l.selectedGeoJson.getValue())},this.render=function(){var r=document.createElement("div");r.setAttribute("id","openStreetMap"+a),r.setAttribute("style","width: inherit; height: inherit"),document.addEventListener("play-tab-loaded",l.goToFirstRadioButton),$("#"+e).html(r),l.map=L.map("openStreetMap"+a,{preferCanvas:!0}).setView([modelsParameters[t].defaultCenter.latitude,modelsParameters[t].defaultCenter.longitude],modelsParameters[t].defaultCenter.zoom),modelsTempParams[t].mapObj=l.map,s&&this.bIsInteractive&&l.map.on("click",(function(e){modelsHiddenParams[t].selectedPoint,modelsHiddenParams[t].selectedPoint={lat:e.latlng.lat,lag:e.latlng.lng},l.selectedPoint.updateCallback(l.selectedPoint,l.selectedPoint.getValue())})),this.bIsInteractive||(l.map.dragging.disable(),l.map.touchZoom.disable(),l.map.doubleClickZoom.disable(),l.map.scrollWheelZoom.disable(),l.map.boxZoom.disable(),l.map.keyboard.disable());var n={};n.MapboxStreets={url:"https://xdashgateway.azure-api.net/mapbox/tiles?z={z}&x={x}&y={y}",attribution:'Imagery © <a href="http://mapbox.com">Mapbox</a>',maxZoom:18,id:"streets-v11",tileSize:512,zoomOffset:-1},n.MapboxDark={url:"https://xdashgateway.azure-api.net/mapbox/tilesgeneral?z={z}&x={x}&y={y}&id={id}",attribution:'Imagery © <a href="http://mapbox.com">Mapbox</a>',maxZoom:18,id:"dark-v10",tileSize:512,zoomOffset:-1},n.HereSatelliteDay={url:"https://xdashgateway.azure-api.net/here{s}/maptile?z={z}&x={x}&y={y}&lg=eng",attribution:'Map &copy; 1987-2014 <a href="http://developer.here.com">HERE</a>',id:" satellite.day",maxZoom:20,subdomains:"1234"},n.HereTerrainDay={url:"https://xdashgateway.azure-api.net/here{s}/maptile?z={z}&x={x}&y={y}&lg=eng",attribution:'Map &copy; 1987-2014 <a href="http://developer.here.com">HERE</a>',id:"terrain.day",maxZoom:20,subdomains:"1234"},n.HereHybridDay={url:"https://xdashgateway.azure-api.net/here{s}/maptile?z={z}&x={x}&y={y}&lg=eng",attribution:'Map &copy; 1987-2014 <a href="http://developer.here.com">HERE</a>',id:" HERE.hybridDay",maxZoom:20,subdomains:"1234"},"true"!=xDashConfig.xDashBasicVersion&&(n.EsriWorldImagery={url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community",id:"Esri.WorldImagery",maxZoom:19},n["GeoportailFrance.orthos"]={url:"https://wxs.ign.fr/{apikey}/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE={style}&TILEMATRIXSET=PM&FORMAT={format}&LAYER=ORTHOIMAGERY.ORTHOPHOTOS&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',minZoom:2,maxZoom:19,apikey:"choisirgeoportail",format:"image/jpeg",style:"normal"});var d="MapboxStreets";_.isUndefined(modelsParameters[t].tileServer)||_.contains(_.keys(n),modelsParameters[t].tileServer)&&(d=modelsParameters[t].tileServer);var m={url:n[d].url,maxZoom:n[d].maxZoom,attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, '+n[d].attribution};if(_.isUndefined(n[d].subdomains)||(m.subdomains=n[d].subdomains),_.isUndefined(n[d].id)||(m.id=n[d].id),_.isUndefined(n[d].apikey)||(m.apikey=n[d].apikey),_.isUndefined(n[d].format)||(m.format=n[d].format),_.isUndefined(n[d].style)||(m.style=n[d].style),_.isUndefined(n[d].tileSize)||(m.tileSize=n[d].tileSize),_.isUndefined(n[d].zoomOffset)||(m.zoomOffset=n[d].zoomOffset),_.isUndefined(n[d].accessToken)||(m.accessToken=n[d].accessToken),modelsParameters[t].offlineSupport){m.attribution='Progress: <span id="leafletProgress'+a+'"></span> / <span id="leafletTotal'+a+'"></span>. Current storage: <span id="leafletStorage'+a+'"></span> files.Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, '+n[d].attribution,l.baseLayer=L.tileLayer.offline(n[d].url,m),l.baseLayer.addTo(l.map);var p=[];if(modelsParameters[t].defaultCenter.zoom<=n[d].maxZoom)for(var y=0;y<n[d].maxZoom-modelsParameters[t].defaultCenter.zoom;y++)p[y]=modelsParameters[t].defaultCenter.zoom+y;else p=modelsParameters[t].defaultCenter.zoom;var c,g=L.control.savetiles(l.baseLayer,{zoomlevels:p,confirm:function(e,a){window.confirm("Save "+e._tilesforSave.length)&&a()},confirmRemoval:function(e,a){window.confirm("Remove all the tiles?")&&a()},saveText:'<i class="icon-download-alt icon" aria-hidden="true"></i>',rmText:'<i class="icon-trash icon" aria-hidden="true"></i>'});g.addTo(l.map),l.baseLayer.on("storagesize",(function(e){document.getElementById("leafletStorage"+a).innerHTML=e.storagesize})),g.setPosition("topright"),l.baseLayer.on("savestart",(function(e){c=0,document.getElementById("leafletTotal"+a).innerHTML=e._tilesforSave.length})),l.baseLayer.on("savetileend",(function(e){c++,document.getElementById("leafletProgress"+ +a).innerHTML=c})),l.baseLayer.on("loadend",(function(e){swal("","Saved all tiles","info")})),l.baseLayer.on("tilesremoved",(function(e){document.getElementById("leafletProgress"+ +a).innerHTML="",document.getElementById("leafletTotal"+a).innerHTML="",swal("","Removed all tiles","info")}))}else l.baseLayer=L.tileLayer(n[d].url,m),l.baseLayer.addTo(l.map);L.control.scale().addTo(l.map),l.map.zoomControl.setPosition("topright"),l.ctrl=L.control.layers({},{},{position:"topright",collapsed:!0,autoZIndex:!0}).addTo(l.map),o&&l.map.pm.addControls(i);try{for(y=0;y<l.numberOfGeoJsonLayers;y++)_.isUndefined(modelsHiddenParams[t].geoJson.geoJsonLayers[y])||_.isUndefined(modelsHiddenParams[t].geoJson.geoJsonLayers[y])||l.addGeoJson(modelsHiddenParams[t].geoJson.geoJsonLayers[y],y+1);for(y=0;y<l.numberOfChoroplethLayers;y++)_.isUndefined(modelsHiddenParams[t].choropleth.choroplethLayers[y])||_.isUndefined(modelsHiddenParams[t].choropleth.choroplethLayers[y])||l.addChoropleth(modelsHiddenParams[t].choropleth.choroplethLayers[y],y+1);for(y=0;y<l.numberOfLineHeatMapLayers;y++)_.isUndefined(modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers[y])||_.isUndefined(modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers[y])||l.addLineHeatMap(modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers[y],y+1);for(y=0;y<l.numberOfHeatMapLayers;y++)modelsHiddenParams[t].heatMap.heatMapBuffer[y]=[],_.isUndefined(modelsHiddenParams[t].heatMap.heatMapData[y])||_.isUndefined(modelsHiddenParams[t].heatMap.heatMapData[y])||l.drawHeatMap(modelsHiddenParams[t].heatMap.heatMapData[y],y+1);for(y=0;y<l.numberOfImageLayers;y++)_.isUndefined(modelsHiddenParams[t].imageOverlay.imageData[y])||_.isUndefined(modelsHiddenParams[t].imageOverlay.imageData[y])||l.addImageOverlay(modelsHiddenParams[t].imageOverlay.imageData[y],y+1);for(y=0;y<l.numberOfSvgLayers;y++)_.isUndefined(modelsHiddenParams[t].svgOverlay.svgData[y])||_.isUndefined(modelsHiddenParams[t].svgOverlay.svgData[y])||l.addSvgOverlay(modelsHiddenParams[t].svgOverlay.svgData[y],y+1,!1)}catch(e){console.error(e)}l.map.on("baselayerchange",(function(e){l.showLegend(e.name),l.currentBaseLayer=e.name}))},this.showLegend=function(e){var a=_.keys(modelsHiddenParams[t].legends);if(_.has(modelsHiddenParams[t].legends,e)){var r=_.without(a,e);_.each(r,(function(e){l.map.removeControl(modelsHiddenParams[t].legends[e])})),modelsHiddenParams[t].legends[e].addTo(l.map),o&&(l.map.pm.removeControls(),l.map.pm.addControls(i))}},this.rescale=function(){try{l.map.invalidateSize()}catch(e){console.log(e.message)}},this.addGeoJson=function(e,a){if(modelsHiddenParams[t].geoJson.geoJsonBounds[a-1]=null,!(_.isUndefined(e)||(_.isEmpty(l.mapLayers.geoJson.geoJsonLayers[a-1])||(l.ctrl.removeLayer(l.mapLayers.geoJson.geoJsonLayers[a-1]),l.map.removeLayer(l.mapLayers.geoJson.geoJsonLayers[a-1])),_.isEmpty(e)||e=={}||_.isUndefined(e.features)||_.isEmpty(e.features)))){var r="Trace"+a;_.isUndefined(e.properties)||_.isUndefined(e.properties.description)||(r=e.properties.description);var o={color:modelsHiddenParams[t].colors[a-1],weight:4,opacity:1},s=L.geoJSON(e,{style:function(e){return _.isUndefined(e.properties)?o:(_.isUndefined(e.properties.description)||(r=e.properties.description),_.isUndefined(e.properties.style)?o:e.properties.style)},onEachFeature:function(e,a){if("Point"==e.geometry.type&&e.properties)if(e.properties.comment)if(e.properties.openPopup){a.bindPopup(e.properties.comment,{autoClose:!1,autoPan:!1}).on("add",(function(e){e.target.openPopup()}))}else a.bindPopup(e.properties.comment);else if(e.properties.html)e.properties.openPopup?(mk=a.bindPopup(e.properties.html,{autoClose:!1,autoPan:!1}),mk.on("add",(function(e){e.target.openPopup()}))):a.bindPopup(e.properties.html);else{var t=jQuery.extend(!0,{},e.properties);t.awesomeMarker&&delete t.awesomeMarker,e.properties.openPopup?(mk=a.bindPopup(syntaxHighlight(JSON.stringify(t)),{autoClose:!1,autoPan:!1}),mk.on("add",(function(e){e.target.openPopup()}))):a.bindPopup(syntaxHighlight(JSON.stringify(t)))}},pointToLayer:function(e,a){if("Point"==e.geometry.type){if(e.properties&&e.properties.awesomeMarker){var t=L.AwesomeMarkers.icon(e.properties.awesomeMarker);return L.marker(a,{icon:t})}return L.marker(a)}}});if(n){var i=L.markerClusterGroup();i.addLayer(s),l.mapLayers.geoJson.geoJsonLayers[a-1]=i}else l.mapLayers.geoJson.geoJsonLayers[a-1]=s;l.map.addLayer(l.mapLayers.geoJson.geoJsonLayers[a-1]),l.ctrl.addOverlay(l.mapLayers.geoJson.geoJsonLayers[a-1],r);try{var d=geojsonExtent(e),m=L.latLng(d[1],d[0]),p=L.latLng(d[3],d[2]),y=L.latLngBounds(m,p);modelsHiddenParams[t].geoJson.geoJsonBounds[a-1]=y;var c=!1;_.isUndefined(e.properties)||_.isUndefined(e.properties.disableAutoscale)||(c=e.properties.disableAutoscale),c||l.map.fitBounds(l.globalLayersBounds())}catch(e){console.log(e)}}},this.addChoropleth=function(e,a){if(_.isUndefined(e))return;if(_.isEmpty(e))return;if(e=={})return;var r=l.convertToChoroplethObject(e);if(modelsHiddenParams[t].choropleth.choroplethBounds[a-1]=null,_.isEmpty(l.mapLayers.choropleth.choroplethLayers[a-1])||(l.ctrl.removeLayer(l.mapLayers.choropleth.choroplethLayers[a-1]),l.map.removeLayer(l.mapLayers.choropleth.choroplethLayers[a-1])),_.isUndefined(r.features))return;if(_.isEmpty(r.features))return;var o=_.without(_.keys(e.data[0]),"geometry")[0];_.isUndefined(r.properties)||_.isUndefined(r.properties.description)||(o=r.properties.description);var s=_.max(_.pluck(e.data,o)),n=_.min(_.pluck(e.data,o)),i=4,d=.7;let p;try{_.isUndefined(e.config.max)||(s=e.config.max),_.isUndefined(e.config.min)||(n=e.config.min),_.isUndefined(e.config.weight)||(i=e.config.weight),_.isUndefined(e.config.opacity)||(d=e.config.opacity),p=l.getColorScale(e.config.colorScale,e.config.reverseColorScale,0,1)}catch(e){}l.createChoroplethLegend(n,s,o,p),l.showLegend(o),l.mapLayers.choropleth.choroplethLayers[a-1]=L.geoJSON(r,{style:function(e){return{weight:i,opacity:d,color:"white",dashArray:"3",fillOpacity:d,fillColor:m(n,s,e.properties.density,p)}}}).addTo(l.map),l.ctrl.addBaseLayer(l.mapLayers.choropleth.choroplethLayers[a-1],o);var y=!1;try{y=e.config.disableAutoscale}catch(e){}try{if(!y){var c=geojsonExtent(r),g=L.latLng(c[1],c[0]),u=L.latLng(c[3],c[2]),f=L.latLngBounds(g,u);modelsHiddenParams[t].choropleth.choroplethBounds[a-1]=f,l.map.fitBounds(f)}}catch(e){console.log(e)}},this.convertToChoroplethObject=function(e){let a=[];const t=e.data;if(t.length){const e=_.without(_.keys(t[0]),"geometry")[0];a=t.map((a,t)=>({type:"Feature",id:t,properties:{},geometry:a.geometry,properties:{density:a[e]}}))}return{type:"FeatureCollection",features:a}},this.createChoroplethLegend=function(e,a,r,o){_.isUndefined(modelsHiddenParams[t].legends[r])||l.map.removeControl(modelsHiddenParams[t].legends[r]),modelsHiddenParams[t].legends[r]=L.control({position:"topright"}),modelsHiddenParams[t].legends[r].onAdd=function(t){for(var r,s,n=(a-e)/8,i=L.DomUtil.create("div","info legend"),l=[e,e+n,e+2*n,e+3*n,e+4*n,e+5*n,e+6*n,a],d=[],p=0;p<l.length;p++)r=l[p],s=l[p+1],d.push('<i style="background:'+m(e,a,r+1,o)+'"></i> <span>'+d3.format("~s")(r)+(s?"&ndash;"+d3.format("~s")(s):"+")+"</span>");return i.innerHTML=d.join("<br>"),i}},this.convertToGeoJSONObject=function(e){var a=[],t="";return _.each(e.data,(function(r){var o=Object.keys(r);_.each(o,(function(e){"coordinates"!=e&&(t=e)}));var s,n,i,d={type:"Feature",geometry:{type:"LineString",coordinates:r.coordinates},properties:{style:{color:l.getColorScale(e.config.colorScale,e.config.reverseColorScale,0,100)((s=r[t],n=e.config.min,i=100*(s-n)/(e.config.max-n),i>100&&(i=100),i<0&&(i=0),i)),weight:e.config.weight,opacity:e.config.opacity}}};a.push(d)})),{type:"FeatureCollection",features:a,properties:{description:t}}},this.addLineHeatMap=function(e,a){if(!_.isUndefined(e)&&!_.isEmpty(e)&&e!={}){var r=l.convertToGeoJSONObject(e);if(modelsHiddenParams[t].lineHeatMap.lineHeatMapBounds[a-1]=null,_.isEmpty(l.mapLayers.lineHeatMap.lineHeatMapLayers[a-1])||(l.ctrl.removeLayer(l.mapLayers.lineHeatMap.lineHeatMapLayers[a-1]),l.map.removeLayer(l.mapLayers.lineHeatMap.lineHeatMapLayers[a-1])),!_.isUndefined(r.features)&&!_.isEmpty(r.features)){var o="Trace"+a;_.isUndefined(r.properties)||_.isUndefined(r.properties.description)||(o=r.properties.description);var s={color:modelsHiddenParams[t].colors[a-1],weight:4,opacity:1},n=_.max(_.pluck(e.data,o)),i=_.min(_.pluck(e.data,o));try{_.isUndefined(e.config.max)||(n=e.config.max),_.isUndefined(e.config.min)||(i=e.config.min)}catch(e){}var m=l.getColorScale(e.config.colorScale,e.config.reverseColorScale,0,100);l.createLegend(m,100,d,i,n,o),l.showLegend(o),l.mapLayers.lineHeatMap.lineHeatMapLayers[a-1]=L.geoJSON(r,{style:function(e){return _.isUndefined(e.properties)?s:(_.isUndefined(e.properties.description)||(o=e.properties.description),_.isUndefined(e.properties.style)?s:e.properties.style)},onEachFeature:function(e,a){"Point"==e.geometry.type&&e.properties&&a.bindPopup(syntaxHighlight(JSON.stringify(e.properties)))}}).addTo(l.map),l.ctrl.addBaseLayer(l.mapLayers.lineHeatMap.lineHeatMapLayers[a-1],o);var p=!1;try{p=e.config.disableAutoscale}catch(e){}if(!p)try{var y=geojsonExtent(r),c=L.latLng(y[1],y[0]),g=L.latLng(y[3],y[2]),u=L.latLngBounds(c,g);modelsHiddenParams[t].lineHeatMap.lineHeatMapBounds[a-1]=u,l.map.fitBounds(l.globalLayersLineHeatBounds())}catch(e){console.log(e)}}}},this.addImageOverlay=function(e,a){if(_.isUndefined(e))return;if(_.isEmpty(e))return;if(e=={})return;const t=e.imageUrl,r=e.imageBounds,o=e.title,s=e.addAs,n=e.options;_.isEmpty(l.mapLayers.imageOverlay.imageLayers[a-1])||(l.ctrl.removeLayer(l.mapLayers.imageOverlay.imageLayers[a-1]),l.map.removeLayer(l.mapLayers.imageOverlay.imageLayers[a-1])),l.mapLayers.imageOverlay.imageLayers[a-1]=L.imageOverlay(t,r,n).addTo(l.map),"overlay"==s?l.ctrl.addOverlay(l.mapLayers.imageOverlay.imageLayers[a-1],o):l.ctrl.addBaseLayer(l.mapLayers.imageOverlay.imageLayers[a-1],o)},this.globalLayersBounds=function(){for(var e=L.latLngBounds(l.map.getCenter()),a=0;a<l.numberOfGeoJsonLayers;a++)null!=modelsHiddenParams[t].geoJson.geoJsonBounds[a]&&e.extend(modelsHiddenParams[t].geoJson.geoJsonBounds[a]);return e},this.globalLayersLineHeatBounds=function(){for(var e=L.latLngBounds(l.map.getCenter()),a=0;a<l.numberOfLineHeatMapLayers;a++)null!=modelsHiddenParams[t].lineHeatMap.lineHeatMapBounds[a]&&e.extend(modelsHiddenParams[t].lineHeatMap.lineHeatMapBounds[a]);return e},this.createSvgOverlay=function(e,a){var t=l.createOneCircle,r=e.config.marker;switch(r){case"arrow":t=l.createOneArrow;break;case"triangle":case"emptyTriangle":case"fullTriangle":t=l.createOneTriangle;break;default:r="circle",t=l.createOneCircle}return l.createObjectsOverlay(e,a,r,t)},this.appendSvgOverlay=function(e,a){switch(e.config.marker){case"arrow":return l.appendArrowsOverlay(e,a)}},this.appendArrowsOverlay=function(e,a){var r=e.data[0],o=L.latLng([r.lat,r.lng]),s=l.map.latLngToLayerPoint(o).x,n=l.map.latLngToLayerPoint(o).y,i=0,d="black";_.isUndefined(r.direction)||(i=r.direction),_.isUndefined(r.rotation)||(i=r.rotation),_.isUndefined(r.color)||(d=r.color);var m=l.createOneArrow(s,n,i,modelsHiddenParams[t].svgOverlay.svgElements[a-1].reductionFactor,modelsHiddenParams[t].svgOverlay.svgElements[a-1].lengthInPx,d);modelsHiddenParams[t].svgOverlay.svgElements[a-1].SVG.innerHTML=modelsHiddenParams[t].svgOverlay.svgElements[a-1].SVG.innerHTML+m},this.createObjectsOverlay=function(e,a,r,o){modelsHiddenParams[t].svgOverlay.svgElements[a-1]={},modelsHiddenParams[t].svgOverlay.svgElements[a-1].currentZoom=l.map.getZoom(),[modelsHiddenParams[t].svgOverlay.svgElements[a-1].reductionFactor,modelsHiddenParams[t].svgOverlay.svgElements[a-1].lengthInPx]=l.computeDimensions(e);var s="",n=e.config.color||"#000";e.data.forEach((function(e){var i=L.latLng([e.lat,e.lng]),d=0;_.isUndefined(e.direction)||(d=e.direction),_.isUndefined(e.rotation)||(d=e.rotation);var m=l.map.latLngToContainerPoint(i).x,p=l.map.latLngToContainerPoint(i).y;s+=o(m,p,d,modelsHiddenParams[t].svgOverlay.svgElements[a-1].reductionFactor,modelsHiddenParams[t].svgOverlay.svgElements[a-1].lengthInPx,r,n)}));var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg");var d="0 0 "+l.map.getSize().x+" "+l.map.getSize().y;return i.setAttribute("viewBox",d),modelsHiddenParams[t].svgOverlay.svgElements[a-1].SVG=i,modelsHiddenParams[t].svgOverlay.svgElements[a-1].SVG.innerHTML=s,L.svgOverlay(modelsHiddenParams[t].svgOverlay.svgElements[a-1].SVG,l.map.getBounds())},this.computeDimensions=function(e){const a=e.config.length,t=l.map.getBounds(),r=t.getSouthWest(),o=t.getNorthEast(),s=l.map.latLngToContainerPoint(r).y-l.map.latLngToContainerPoint(o).y,n=L.latLng(o.lat,r.lng),i=a/l.map.distance(r,n);return[i,s*i]},this.autoscaleSvg=function(e){var a,t,r,o=[],s=[];_.isEmpty(e.data)||(e.data.forEach((function(e){o.push(e.lat),s.push(e.lng)})),o.length>1?(a=L.latLng(_.max(o),_.max(s)),t=L.latLng(_.min(o),_.min(s)),r=L.latLngBounds(a,t),l.map.fitBounds(r)):l.map.setView(L.latLng(o[0],s[0]),l.map.getZoom()))},this.createOneArrow=function(e,a,t,r,o,s){var n='<line x1="'+e+'" y1="'+a+'" x2="'+e+'" y2="'+(a-o)+'" stroke="#000" stroke-width="'+50*r+'" marker-end="url(#styledArrow)" ';return n=n+'transform="rotate('+t+" "+e+" "+a+')"  />'},this.createOneCircle=function(e,a,t,r,o){var s='<circle cx="'+e+'" cy="'+a+'" stroke="#000" r="'+50*r+'"';return s+="/>"},this.rotationPoint=function(e,a,t,r,o){var s=Math.PI/180*o,n=Math.cos(s),i=Math.sin(s);return[n*(t-e)+i*(r-a)+e,n*(r-a)-i*(t-e)+a]},this.getTrianglePoints=function(e,a,t){var r=e.y,o=e.x-0,s=e.y,n=e.x-a,i=e.y-a/2,d=e.x,m=e.y+a/2,p=e.x,y=l.rotationPoint(o,r,n,s,t),c=l.rotationPoint(o,r,d,i,t),g=l.rotationPoint(o,r,p,m,t);return y[1]+" "+y[0]+" "+c[1]+" "+c[0]+" "+g[1]+" "+g[0]},this.createOneTriangle=function(e,a,t,r,o,s,n){var i=l.getTrianglePoints({x:a,y:e},o,t),d='<polygon points="'+i+'"  style="fill:'+n+";stroke:"+n+";stroke-width:"+50*r+'"   />';return"emptyTriangle"==s&&(d='<polygon points="'+i+'"  fill="none" style="stroke:'+n+";stroke-width:"+50*r+'"   />'),d},this.addSvgOverlay=function(e,a,r){if(!_.isUndefined(e)&&!_.isEmpty(e)&&e!={}&&!_.isUndefined(e.data)){var o=e.config.title,s=e.config.addAs,n=e.config.disableAutoscale;if(!_.isUndefined(modelsHiddenParams[t].svgOverlay.svgElements[a-1])&&!_.isUndefined(modelsHiddenParams[t].svgOverlay.svgElements[a-1].currentZoom)){var i=l.map.getZoom();modelsHiddenParams[t].svgOverlay.svgElements[a-1].currentZoom!=i&&(r=!1)}r?l.appendSvgOverlay(e,a):(n||l.autoscaleSvg(e),_.isEmpty(l.mapLayers.svgOverlay.svgLayers[a-1])||(l.ctrl.removeLayer(l.mapLayers.svgOverlay.svgLayers[a-1]),l.map.removeLayer(l.mapLayers.svgOverlay.svgLayers[a-1])),l.mapLayers.svgOverlay.svgLayers[a-1]=L.layerGroup().addLayer(l.createSvgOverlay(e,a)).addTo(l.map),"overlay"==s?l.ctrl.addOverlay(l.mapLayers.svgOverlay.svgLayers[a-1],o):l.ctrl.addBaseLayer(l.mapLayers.svgOverlay.svgLayers[a-1],o))}},this.psetSvg=function(e,a){if(!_.isUndefined(e)&&!_.isEmpty(e)&&!_.isEmpty(e.data)){var t,r=e.data;t=_.isUndefined(e.config)?{data:[r]}:{data:[r],config:e.config},_.isEmpty(l.mapLayers.svgOverlay.svgLayers[a-1])?l.addSvgOverlay(t,a,!1):l.addSvgOverlay(t,a,!0)}},this.createLabelIcon=function(e,a){return L.divIcon({className:e,html:a})},this.drawHeatMap2=function(e,a){if(_.isEmpty(l.mapLayers.heatMap.heatMapLayers[a-1])||(l.ctrl.removeLayer(l.mapLayers.heatMap.heatMapLayers[a-1]),l.map.removeLayer(l.mapLayers.heatMap.heatMapLayers[a-1]),l.mapLayers.heatMap.heatMapLayers[a-1].remove(),delete l.mapLayers.heatMap.heatMapLayers[a-1]),_.isUndefined(e))return;if(_.isEmpty(e))return;if(_.isUndefined(e.data))return;if(heatMapData=e.data,_.isEmpty(heatMapData)||0==heatMapData.length){var t=L.layerGroup([]);return l.mapLayers.heatMap.heatMapLayers[a-1]=t.addTo(l.map),l.ctrl.addBaseLayer(l.mapLayers.heatMap.heatMapLayers[a-1],"none"),void(_.isUndefined($("input[name='leaflet-base-layers']")[l.numberOfHeatMapLayers-1])||$("input[name='leaflet-base-layers']")[l.numberOfHeatMapLayers-1].click())}let r,o,s,n=.8,i=5,m=!1,p=!1;try{heatMapConfig=e.config,n=heatMapConfig.opacity||n,i=heatMapConfig.radius||i,r=heatMapConfig.max,o=heatMapConfig.min,m=heatMapConfig.disableAutoscale,p=heatMapConfig.addTextLabel,s=l.getColorScale(heatMapConfig.colorScale,heatMapConfig.reverseColorScale,0,100)}catch(e){}const y=[];let c=-Number.MAX_VALUE,g=Number.MAX_VALUE;const u=[],f=[],h=[],M=_.keys(heatMapData[0])[2];for(var H=0;H<heatMapData.length;H++)y[H]=_.values(heatMapData[H]),u[H]=y[H][0],f[H]=y[H][1],null!==y[H][2]&&(y[H][2]>c&&(c=y[H][2]),y[H][2]<g&&(g=y[H][2]));for(_.isUndefined(r)&&(r=1==heatMapData.length?1:c),_.isUndefined(o)&&(o=1==heatMapData.length?0:g),H=0;H<heatMapData.length;H++)null!==y[H][2]&&(y[H][2]>r?h[H]=100:y[H][2]<o?h[H]=0:h[H]=100*(y[H][2]-o)/(r-o));var O=[],v="#000000";for(H=0;H<y.length;H++)v=null!==h[H]?s(h[H]):"#000000",O.push(L.circle([u[H],f[H]],{stroke:!1,color:v,fillColor:v,fillOpacity:n,radius:i,stroke:!1})),p&&O.push(L.marker(new L.LatLng(u[H],f[H]),{icon:l.createLabelIcon("boldWhiteHeatMapLabel",nFormatter(y[H][2]))}));l.configStore[a-1]={color:s,fillOpacity:n,radius:i,minValue:o,maxValue:r};t=L.layerGroup(O);if(l.mapLayers.heatMap.heatMapLayers[a-1]=t.addTo(l.map),l.ctrl.addBaseLayer(l.mapLayers.heatMap.heatMapLayers[a-1],M),!m){var P=L.latLng(_.max(u),_.max(f)),E=L.latLng(_.min(u),_.min(f)),b=L.latLngBounds(P,E);l.map.fitBounds(b)}l.map.invalidateSize(),l.createLegend(s,100,d,o,r,M),l.showLegend(M),_.isUndefined($("input[name*='leaflet-base-layers']")[l.numberOfHeatMapLayers-1])||$("input[name*='leaflet-base-layers']")[l.numberOfHeatMapLayers-1].click()},this.createLegend=function(e,a,r,o,s,n){o=Number(o),s=Number(s);_.isUndefined(modelsHiddenParams[t].legends[n])||l.map.removeControl(modelsHiddenParams[t].legends[n]),modelsHiddenParams[t].legends[n]=L.control({position:"topleft"}),modelsHiddenParams[t].legends[n].onAdd=function(t){for(var i=L.DomUtil.create("div","scaleLegend"),l="",d=0;d<a;d++)l=l+'<rect height="10" x="'+4*d+'" width="4" style="fill: '+e(d)+';"></rect>';var m,p='<svg id="legend" width="450" height="50"><g class="key" transform="translate(25,16)">'+l,y=o;m=nFormatter(o,2);for(d=0;d<r.length;d++)p=p+'<g class="tick" transform="translate('+4*r[d]+',0)" style="opacity: 1;"><line y2="-1" x2="0"></line><text dy="0em" y="-4" x="0" style="text-anchor: middle;">'+m+"</text></g>",y+=(s-o)/4,m=nFormatter(y,2);return p=(p+='<path class="domain" d="M0,-1V0H400V-1"></path>')+'<text class="" y="21">'+n+"</text>",p+="</g></svg>",i.innerHTML=p,i}},this.drawHeatMap1=function(e,a){if(_.isEmpty(l.mapLayers.heatMap.heatMapLayers[a-1])||(l.ctrl.removeLayer(l.mapLayers.heatMap.heatMapLayers[a-1]),l.map.removeLayer(l.mapLayers.heatMap.heatMapLayers[a-1]),l.mapLayers.heatMap.heatMapLayers[a-1].remove(),delete l.mapLayers.heatMap.heatMapLayers[a-1]),!(_.isUndefined(e)||_.isEmpty(e)||_.isUndefined(e.data)||(heatMapData=e.data,_.isUndefined(heatMapData.length)))){for(var t=[],r=Number.MIN_VALUE,o=[],s=[],n=_.keys(heatMapData[0])[2],i=0;i<heatMapData.length;i++)t[i]=_.values(heatMapData[i]),o[i]=t[i][0],s[i]=t[i][1],t[i][2]>r&&(r=t[i][2]);1==heatMapData.length&&(r=1),r=1;var d,m,p,y,c,g=null,u=!1;try{heatMapConfig=e.config,d=heatMapConfig.minOpacity,m=heatMapConfig.maxZoom,p=heatMapConfig.radius,y=heatMapConfig.blur,u=heatMapConfig.disableAutoscale,g=new Object,c=l.getColorScale(heatMapConfig.colorScale,heatMapConfig.reverseColorScale,0,1),d3.range(11).forEach(e=>g[.1*e]=c(.1*e))}catch(e){g=null}if(l.mapLayers.heatMap.heatMapLayers[a-1]=L.meanLayer(t,{minOpacity:d,maxZoom:m,max:r,radius:p,blur:y,gradient:g}).addTo(l.map),l.ctrl.addBaseLayer(l.mapLayers.heatMap.heatMapLayers[a-1],n),!u){var f=L.latLng(_.max(o),_.max(s)),h=L.latLng(_.min(o),_.min(s)),M=L.latLngBounds(f,h);l.map.fitBounds(M)}l.map.invalidateSize()}},_.isUndefined(modelsParameters[t].heatMap.densityHeatMap)||modelsParameters[t].heatMap.densityHeatMap?this.drawHeatMap=l.drawHeatMap1:this.drawHeatMap=l.drawHeatMap2,this.clearHeatMapLayer=function(e){l.mapLayers.heatMap.heatMapLayers[e-1].clearLayers()},this.psetHeatMap=function(e,a){if(!_.isUndefined(e)&&!_.isEmpty(e)&&!_.isEmpty(e.data)){var r,o=e.data;r=_.isUndefined(e.config)?{data:[o]}:{data:[o],config:e.config};var s=_.values(e.data);if(_.isEmpty(l.mapLayers.heatMap.heatMapLayers[a-1]))l.drawHeatMap(r,a);else{if(_.isUndefined(modelsParameters[t].heatMap.densityHeatMap))l.mapLayers.heatMap.heatMapLayers[a-1].addLatLng(s);else if(modelsHiddenParams[t].heatMap.densityHeatMap)l.mapLayers.heatMap.heatMapLayers[a-1].addLatLng(s);else{const n=r.config||{},i={circleFillOpacity:n.opacity,circleRadius:n.radius,maxValue:n.max,minValue:n.min},d=l.configStore[a-1],m={circleFillOpacity:d.fillOpacity,circleRadius:d.radius,maxValue:d.maxValue,minValue:d.minValue};if(!(void 0!==i.circleFillOpacity&&i.circleFillOpacity!==m.circleFillOpacity||void 0!==i.circleRadius&&i.circleRadius!==m.circleRadius||void 0!==i.maxValue&&i.maxValue!==m.maxValue||void 0!==i.minValue&&i.minValue!==m.minValue)){let e=100*(s[2]-l.configStore[a-1].minValue)/(l.configStore[a-1].maxValue-l.configStore[a-1].minValue);e<0&&(e=0),e>100&&(e=100),modelsHiddenParams[t].heatMap.heatMapBuffer[a-1].push(o);const r=L.circle([o.lat,o.lng],{color:l.configStore[a-1].color(e),fillColor:l.configStore[a-1].color(e),fillOpacity:l.configStore[a-1].fillOpacity,radius:l.configStore[a-1].radius,stroke:!1});l.mapLayers.heatMap.heatMapLayers[a-1].addLayer(r)}else{l.configStore[a-1].minValue=r.config.min,l.configStore[a-1].maxValue=r.config.max,l.configStore[a-1].radius=r.config.radius,l.configStore[a-1].fillOpacity=r.config.opacity,l.clearHeatMapLayer(a),modelsHiddenParams[t].heatMap.heatMapBuffer[a-1].push(o);const s={data:modelsHiddenParams[t].heatMap.heatMapBuffer[a-1],config:e.config};l.drawHeatMap(s,a)}}_.isUndefined(e.config)||_.isUndefined(e.config.disableAutoscale)?l.map.setView(o):e.config.disableAutoscale||l.map.setView(o)}}},modelsParameters[t].geoJson.numberOfLayers>0)for(let e=1;e<=l.numberOfGeoJsonLayers;e++){_.isUndefined(modelsHiddenParams[t].geoJson.geoJsonLayers[e-1])&&(modelsHiddenParams[t].geoJson.geoJsonLayers[e-1]={}),_.isUndefined(l.mapLayers.geoJson.geoJsonLayers[e-1])&&(l.mapLayers.geoJson.geoJsonLayers[e-1]={});this["geoJson"+e]={layerIndex:e,updateCallback:function(){},setValue:function(e){modelsHiddenParams[t].geoJson.geoJsonLayers[this.layerIndex-1]=e,l.addGeoJson(e,this.layerIndex)},getValue:function(){return modelsHiddenParams[t].geoJson.geoJsonLayers[e-1]},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}}if(modelsParameters[t].choropleth&&modelsParameters[t].choropleth.numberOfLayers>0)for(let e=1;e<=l.numberOfChoroplethLayers;e++){_.isUndefined(modelsHiddenParams[t].choropleth.choroplethLayers[e-1])&&(modelsHiddenParams[t].choropleth.choroplethLayers[e-1]={}),_.isUndefined(l.mapLayers.choropleth.choroplethLayers[e-1])&&(l.mapLayers.choropleth.choroplethLayers[e-1]={});this["choropleth"+e]={layerIndex:e,updateCallback:function(){},setValue:function(e){modelsHiddenParams[t].choropleth.choroplethLayers[this.layerIndex-1]=e,l.addChoropleth(e,this.layerIndex)},getValue:function(){return modelsHiddenParams[t].choropleth.choroplethLayers[e-1]},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}}if(modelsParameters[t].lineHeatMap&&modelsParameters[t].lineHeatMap.numberOfLayers>0)for(let e=1;e<=l.numberOfLineHeatMapLayers;e++){_.isUndefined(modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers[e-1])&&(modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers[e-1]={}),_.isUndefined(l.mapLayers.lineHeatMap.lineHeatMapLayers[e-1])&&(l.mapLayers.lineHeatMap.lineHeatMapLayers[e-1]={});this["lineHeatMap"+e]={layerIndex:e,updateCallback:function(){},setValue:function(e){modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers[this.layerIndex-1]=e,l.addLineHeatMap(e,this.layerIndex)},getValue:function(){return modelsHiddenParams[t].lineHeatMap.lineHeatMapLayers[e-1]},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}}if(modelsParameters[t].heatMap.numberOfLayers>0)for(let e=1;e<=l.numberOfHeatMapLayers;e++){const a="heatMapData"+e,r="heatMapPoint"+e;_.isUndefined(modelsHiddenParams[t].heatMap.heatMapData[e-1])&&(modelsHiddenParams[t].heatMap.heatMapData[e-1]={}),_.isUndefined(modelsHiddenParams[t].heatMap.heatMapBuffer[e-1])&&(modelsHiddenParams[t].heatMap.heatMapBuffer[e-1]=[]),_.isUndefined(l.mapLayers.heatMap.heatMapLayers[e-1])&&(l.mapLayers.heatMap.heatMapLayers[e-1]={}),modelsParameters[t].heatMap.sampledDisplay?this[r]={layerIndex:e,updateCallback:function(){},setValue:function(e){l.bIsInteractive&&l.psetHeatMap(e,this.layerIndex)},getValue:function(){},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}:this[a]={layerIndex:e,updateCallback:function(){},setValue:function(e){e!=modelsHiddenParams[t].heatMap.heatMapData[this.layerIndex-1]&&(modelsHiddenParams[t].heatMap.heatMapData[this.layerIndex-1]=e,l.drawHeatMap(e,this.layerIndex))},getValue:function(){return modelsHiddenParams[t].heatMap.heatMapData[this.layerIndex-1]},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}}if(l.numberOfImageLayers>0)for(let e=1;e<=l.numberOfImageLayers;e++){const a="imageOverlay"+e;_.isUndefined(modelsHiddenParams[t].imageOverlay.imageData[e-1])&&(modelsHiddenParams[t].imageOverlay.imageData[e-1]={}),_.isUndefined(l.mapLayers.imageOverlay.imageLayers[e-1])&&(l.mapLayers.imageOverlay.imageLayers[e-1]={}),this[a]={layerIndex:e,updateCallback:function(){},setValue:function(e){e!=modelsHiddenParams[t].imageOverlay.imageData[this.layerIndex-1]&&(modelsHiddenParams[t].imageOverlay.imageData[this.layerIndex-1]=e,l.addImageOverlay(e,this.layerIndex))},getValue:function(){return modelsHiddenParams[t].imageOverlay.imageData[this.layerIndex-1]},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}}if(l.numberOfSvgLayers>0)for(let e=1;e<=l.numberOfSvgLayers;e++){const a="svgOverlay"+e,r="svgPoint"+e;_.isUndefined(modelsHiddenParams[t].svgOverlay.svgData[e-1])&&(modelsHiddenParams[t].svgOverlay.svgData[e-1]={}),_.isUndefined(l.mapLayers.svgOverlay.svgLayers[e-1])&&(l.mapLayers.svgOverlay.svgLayers[e-1]={}),modelsParameters[t].svgOverlay.sampledDisplay?this[r]={layerIndex:e,updateCallback:function(){},setValue:function(e){l.bIsInteractive&&l.psetSvg(e,this.layerIndex)},getValue:function(){},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}:this[a]={layerIndex:e,updateCallback:function(){},setValue:function(e){modelsHiddenParams[t].svgOverlay.svgData[this.layerIndex-1]=e,l.addSvgOverlay(e,this.layerIndex,!1)},getValue:function(){return modelsHiddenParams[t].svgOverlay.svgData[this.layerIndex-1]},addValueChangedHandler:function(e){this.updateCallback=e},removeValueChangedHandler:function(e){}}}const p=new WidgetActuatorDescription("selectedPoint","Selected coordinates",WidgetActuatorDescription.WRITE,_SCHEMA_SELECTED_POINT),y=new WidgetActuatorDescription("selectedGeoJson","Drawn GeoJSON figure",WidgetActuatorDescription.WRITE,_SCHEMA_SELECTED_GEOJSON);this.getActuatorDescriptions=function(e=null){const a=e||modelsParameters[t],r=[];if(a){if(a.captureClickEvent&&r.push(p),a.drawingFeatures&&r.push(y),a.geoJson&&a.geoJson.numberOfLayers)for(let e=1;e<=a.geoJson.numberOfLayers;e++)r.push(new WidgetActuatorDescription("geoJson"+e,"GeoJSON features",WidgetActuatorDescription.READ,_SCHEMA_GEOJSON));if(a.lineHeatMap&&a.lineHeatMap.numberOfLayers)for(let e=1;e<=a.lineHeatMap.numberOfLayers;e++)r.push(new WidgetActuatorDescription("lineHeatMap"+e,"Lines colored by values",WidgetActuatorDescription.READ,_SCHEMA_LINE_HEATMAP));if(a.choropleth&&a.choropleth.numberOfLayers)for(let e=1;e<=a.choropleth.numberOfLayers;e++)r.push(new WidgetActuatorDescription("choropleth"+e,"Choropleth data",WidgetActuatorDescription.READ,_SCHEMA_CHOROPLETH));if(a.heatMap&&a.heatMap.numberOfLayers)for(let e=1;e<=a.heatMap.numberOfLayers;e++)if(a.heatMap.sampledDisplay){const t="heatMapPoint"+e;a&&!a.densityHeatMap?r.push(new WidgetActuatorDescription(t,"Cumulative heatmap",WidgetActuatorDescription.READ,_SCHEMA_HEATMAP_SAMPLED)):r.push(new WidgetActuatorDescription(t,"Cumulative density heatmap",WidgetActuatorDescription.READ,_SCHEMA_HEATMAP_DENSITY_SAMPLED))}else{const t="heatMapData"+e;a&&!a.densityHeatMap?r.push(new WidgetActuatorDescription(t,"Heatmap",WidgetActuatorDescription.READ,_SCHEMA_HEATMAP)):r.push(new WidgetActuatorDescription(t,"Density heatmap",WidgetActuatorDescription.READ,_SCHEMA_HEATMAP_DENSITY))}if(a.imageOverlay&&a.imageOverlay.numberOfLayers)for(let e=1;e<=a.imageOverlay.numberOfLayers;e++)r.push(new WidgetActuatorDescription("imageOverlay"+e,"Image to place on the map",WidgetActuatorDescription.READ,_SCHEMA_IMAGE_OVERLAY));if(a.svgOverlay&&a.svgOverlay.numberOfLayers)for(let e=1;e<=a.svgOverlay.numberOfLayers;e++)a.svgOverlay.sampledDisplay?r.push(new WidgetActuatorDescription("svgPoint"+e,"Place a symbol on the map",WidgetActuatorDescription.READ,_SCHEMA_SVG_POINT_OVERLAY)):r.push(new WidgetActuatorDescription("svgOverlay"+e,"Place symbols on the map",WidgetActuatorDescription.READ,_SCHEMA_SVG_OVERLAY))}return r},l.render()},this.openStreetMapsWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"Maps",widgetsDefinitionList:{openStreetMaps:{factory:"openStreetMapsWidget",title:"Leaflet maps",icn:"map",help:"wdg/wdg-geo-time/#leaflet-maps"}}},this.constructor()}mapWidgetsPluginClass.prototype=basePlugin.prototype;var mapWidgetsPlugin=new mapWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(mapWidgetsPlugin);
function foliumWidgetPluginClass(){this.foliumMapWidget=function(i,t,e,n){this.constructor(i,t,e,n);var l=this;this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},this.hasScrollBar=function(i){return i.get(0).scrollHeight>i.get(0).clientHeight},this.render=function(){let l=document.createElement("div"),o="folium-map"+t;if(n&&(o+="c"),l.setAttribute("id",o),modelsHiddenParams[e].map){l.innerHTML=modelsHiddenParams[e].map;try{div1=l.firstElementChild,"DIV"==div1.tagName&&(div1.style.height="100%",div2=div1.firstElementChild,"DIV"==div2.tagName&&(div2.style.height="100%",div2.style["padding-bottom"]=null,div3=div2.firstElementChild,"DIV"==div3.tagName&&(div3.style.height="100%")))}catch(i){console.log(i)}}l.setAttribute("style","width: inherit; height: inherit; background-color:"+modelsParameters[e].backgroundColor),$("#"+i).html(l)};const o=new WidgetActuatorDescription("_repr_html_","Folium Map _repr_html_",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(){return[o]},this._repr_html_={setValue:function(i){modelsHiddenParams[e].map=i,l.render()},getValue:function(){return modelsHiddenParams[e].map},addValueChangedHandler:function(i){l.enable()},removeValueChangedHandler:function(i){l.disable()}},l.render()},this.foliumMapWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"Maps",widgetsDefinitionList:{foliumMaps:{factory:"foliumMapWidget",title:"Folium Map",icn:"folium",help:""}}},this.constructor()}modelsHiddenParams.foliumMaps={map:""},modelsParameters.foliumMaps={backgroundColor:"rgba(0, 0, 0, 0)"},modelsLayout.foliumMaps={height:"30vh",width:"30vw",minWidth:"50px",minHeight:"32px"},foliumWidgetPluginClass.prototype=basePlugin.prototype;var foliumWidgetPlugin=new foliumWidgetPluginClass;widgetsPluginsHandler.loadWidgetPlugin(foliumWidgetPlugin);
function annotationWidgetsPluginClass(){this.iconInfoAnnotationWidget=function(e,t,i,a){this.constructor(e,t,i,a);var n=this;this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},this.render=function(){var a=20;_.isNull($(".icons").height())||(a=$(".icons").height()),_.isNull($(".icons").width())||$(".icons").width();var n=$("#"+e).height(),o=$("#"+e).width(),r=modelsParameters[i].iconSize*a,s=(n-a*modelsParameters[i].iconSize)/2,d=document.createElement("div"),l='<i class="fa fa-'+modelsParameters[i].iconSign+'" style="line-height:normal;zoom:'+modelsParameters[i].iconSize+'"></i>';d.innerHTML=l,d.setAttribute("class","btn"),d.setAttribute("id","annotationiconInfo"+t),d.setAttribute("style","width: "+o+"px; height:"+n+"px; cursor: pointer; margin: auto; color:"+modelsParameters[i].iconColor+"; line-height:"+r+"px;padding-top: "+s+"px; "),$("#"+e).html(d);const c=this.getTransformedText("text");$("#annotationiconInfo"+t).bt(c,{fill:this.tipBackgroundColor(),cssStyles:{color:modelsParameters[i].textColor,fontWeight:modelsParameters[i].fontWeight,fontSize:modelsParameters[i].fontSize,fontFamily:modelsParameters[i].fontFamily},width:modelsParameters[i].tipWidth,shrinkToFit:!0,padding:modelsParameters[i].textPadding,cornerRadius:modelsParameters[i].cornerRadius,spikeLength:modelsParameters[i].spikeLength,spikeGirth:modelsParameters[i].spikeGirth,strokeStyle:this.tipBorderColor(),shadowColor:"rgba(0,0,0,.9)",positions:modelsParameters[i].tipPositions,trigger:modelsParameters[i].tipEventTrigger})};const o=new WidgetActuatorDescription("value","Hover text of the icon",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[i];return t&&t.enableActuator?[o]:[]},this.value={setValue:function(e){modelsParameters[i].text=e,$("#annotationiconInfo"+t)[0].value=e},getValue:function(){return $("#annotationiconInfo"+t)[0].value},addValueChangedHandler:function(e){n.enable()},removeValueChangedHandler:function(e){n.disable()}},n.render()},this.iconInfoAnnotationWidget.prototype=baseWidget.prototype,this.labelAnnotationWidget=function(e,t,i,a){this.constructor(e,t,i,a);var n=this;_.isUndefined(modelsParameters[i].textAlign)&&(modelsParameters[i].textAlign="left"),this.enable=function(){},this.disable=function(){},this.rescale=function(){this.render()},_.isUndefined(modelsParameters[i].centerVertically)&&(modelsParameters[i].centerVertically=!0),this.render=function(){var a=document.createElement("div"),n="table",o="table-cell";if(!modelsParameters[i].centerVertically)n="flex",o="table";const r=this.getTransformedText("text");var s='<div id="annotationLabelTextArea'+t+'" style="max-width: 2000px; background-color: transparent;  box-shadow: none; width: inherit;  height: inherit; white-space: pre-wrap; color:'+modelsParameters[i].textColor+"; text-align: "+modelsParameters[i].textAlign+"; background-color: "+modelsParameters[i].backgroundColor+"; padding: 4px; resize: inherit; margin: auto; vertical-align: middle ; border-radius: 6px; "+this.fontSize()+this.valueFontFamily()+this.border()+"display: "+o+'" readonly>'+r+"</textarea>";a.innerHTML=s,a.setAttribute("style","width: inherit; height: inherit; display: "+n+"; justify-content: center;"),$("#"+e).html(a)};const o=new WidgetActuatorDescription("value","Label text",WidgetActuatorDescription.READ,WidgetPrototypesManager.SCHEMA_ANY_PRIMITIVE);this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[i];return t&&t.enableActuator?[o]:[]},this.value={setValue:function(e){modelsParameters[i].text=e,$("#annotationLabelTextArea"+t)[0].value=e},getValue:function(){return $("#annotationLabelTextArea"+t)[0].value},addValueChangedHandler:function(e){n.enable()},removeValueChangedHandler:function(e){n.disable()}},n.render()},this.labelAnnotationWidget.prototype=baseWidget.prototype,this.imageAnnotationWidget=function(e,t,i,a){this.constructor(e,t,i,a);var n=this;if(_.isUndefined(modelsHiddenParams[i].ratio)){var o=$("#"+e),r=o.width(),s=o.height();modelsHiddenParams[i].ratio=r/s}this.enable=function(){},this.disable=function(){},this.renderOriginalSize=function(){var a=modelsHiddenParams[i].widthPx,n=modelsHiddenParams[i].heightPx,o=$("#"+i);o.width(unitW(a+2)),o.height(unitH(n+2));var r=$("#"+e);r.width(unitW(a)),r.height(unitH(n)),r.css("left","0px"),r.css("top","0px"),r.css("position","absolute"),$("#imgContainer"+t).attr("style","width: "+unitW(a)+"; height: "+unitH(n)+";")},this.rescale=function(){this.render()},this.render=function(){var a=document.createElement("div");a.setAttribute("style","width: inherit; height: inherit; margin: auto; position: absolute; top: 0; left: 0"),a.setAttribute("id","imgContainer"+t);var o="";if(""!=modelsHiddenParams[i].fileContentBase64){o=o+'<img id="img'+t+'" style="position: relative;';var r=$("#"+e);o+="width: inherit; height: inherit; ",modelsParameters[i].keepRatio?o+="object-fit: contain; ":o+="object-fit: fill; ",r.width(inheritWcWidthFromIdInst(i)),r.height(inheritWcHeightFromIdInst(i)),r.css("left","0px"),r.css("top","0px"),r.css("position","absolute"),a.setAttribute("style","width: inherit; height: inherit; margin: auto;"),n.bIsInteractive||(o+=" opacity: 0.75"),o=o+'" src="data:'+modelsHiddenParams[i].mimeType+";base64,"+modelsHiddenParams[i].fileContentBase64+'">',o+="</img>"}if(!n.bIsInteractive&&!modelsParameters[i].hideImageURL){o=(o=o+'<div id="image_drop_zone'+t+'" style="z-index: 1000000; position: absolute; display: table; top: 20px; left:20px; height: calc(100%-40px); width: calc(100%-40px)">')+'<div id="image_drop_zone_new'+t+'" style="; cursor: pointer; display: table-cell; vertical-align: middle"><a><center id="image_import_handle'+t+'">Click here to import your image file</center></a></div>',o+="</div>";var s=document.getElementById("_otherUse"),d='<input type="file" id="image-file'+t+'" name="files[]" accept=".jpg,.jpeg,.png,.gif" style="padding-bottom: 15px; display: none" required="">';s.insertAdjacentHTML("beforeend",d)}(a.innerHTML=o,$("#"+e).html(a),n.bIsInteractive||modelsParameters[i].hideImageURL)||document.getElementById("image_import_handle"+t).addEventListener("click",(function(e){return e.stopPropagation(),document.getElementById("image-file"+t).addEventListener("change",(function(e){e.stopPropagation();var t=new FileReader;return t.addEventListener("load",(function(e){e.stopPropagation();var t=e.target;modelsHiddenParams[i].mimeType=getRealMimeType(t.result),modelsHiddenParams[i].fileContentBase64=encodeURIComponent(base64ArrayBuffer(t.result));var a=new Image;return a.onload=function(){modelsHiddenParams[i].widthPx=a.width,modelsHiddenParams[i].heightPx=a.height,modelsHiddenParams[i].ratio=a.width/a.height,n.renderOriginalSize()},a.src="data:"+modelsHiddenParams[i].mimeType+";base64,"+modelsHiddenParams[i].fileContentBase64,n.render(),!1}),!1),t.readAsArrayBuffer(e.target.files[0]),modelsParameters[i].hideImageURL=!0,!1}),!1),$("#image-file"+t).trigger("click"),!1}),!0)};const d=new WidgetActuatorDescription("base64Image","Image encoded as a data URL",WidgetActuatorDescription.READ,{$schema:WidgetPrototypesManager.SCHEMA_VERSION,$id:WidgetPrototypesManager.ID_URI_SCHEME+"xdash:imageAnnotationWidget",type:"string",pattern:'^data:image/([a-zA-Z]*);base64,([^"]*)$'});this.getActuatorDescriptions=function(e=null){const t=e||modelsParameters[i];return t&&t.enableActuator?[d]:[]},this.base64Image={setValue:function(e){if(""!=e){var t=new RegExp('^data:image/([a-zA-Z]*);base64,([^"]*)$').exec(e);null==t||3!=t.length?modelsHiddenParams[i].fileContentBase64=e:(modelsHiddenParams[i].mimeType=t[1],modelsHiddenParams[i].fileContentBase64=t[2]),n.render()}},getValue:function(){return modelsHiddenParams[i].fileContentBase64},addValueChangedHandler:function(e){n.enable()},removeValueChangedHandler:function(e){n.disable()}},n.render()},this.imageAnnotationWidget.prototype=baseWidget.prototype,this.videoAnnotationWidget=function(e,t,i,a){this.constructor(e,t,i,a);var n=this;n.showCropBar=!1,n.cropPercentage=100;const o="btn btn-xs btn-block btn-primary "+i+"widgetCustomColor",r="btn btn-xs btn-block btn-primary disabled "+i+"widgetCustomColor";this.enable=function(){$("#video-capture-button-"+t).attr("class",o),$("#video-crop-button-"+t).attr("class",o),$("#video-screenshot-button-"+t).attr("class",o)},this.disable=function(){$("#video-capture-button-"+t).attr("class",r),$("#video-crop-button-"+t).attr("class",r),$("#video-screenshot-button-"+t).attr("class",r)},this.placeCanvas=function(){if(n.canvas&&n.video){const e=n.video.videoWidth,t=n.video.videoHeight,i=n.video.clientWidth,a=n.video.clientHeight;if(e&&t&&i&&a){const o=e/t;let r=Math.round(o*a),s=a;r>i&&(r=i,s=Math.min(a,Math.round(i/o)));const d=Math.round((i-r)/2),l=Math.round((a-s)/2);n.canvas.style.left=d.toString()+"px",n.canvas.style.top=l.toString()+"px"}}},this.handleSuccess=function(e){n.video.srcObject=e,n.video.addEventListener("loadeddata",(function(){n.canvas.width=n.video.videoWidth,n.canvas.height=n.video.videoHeight,n.drawCanvas(),n.placeCanvas()}))},this.handleError=function(e){swal("Annotation Video Widget","navigator.getUserMedia error: "+e,"error")},this.toggleCrop=function(){n.showCropBar=!n.showCropBar,$("#video-crop-button-"+t).toggleClass(i+"widgetCustomColor"),$("#video-crop-button-"+t).toggleClass("btn-warning"),n.showCropBar?$("#cropbar"+t).show():$("#cropbar"+t).hide(),n.drawCanvas(),n.placeCanvas()},this.captureWindow=function(){const e=n.canvas.width,t=n.canvas.height;let i=e,a=t,o=n.ratio;if(!o){if(!n.showCropBar||100===n.cropPercentage)return{x:0,y:0,width:i,height:a};o=e/t}i=Math.round(o*a),i>e&&(i=e,a=i/o),n.showCropBar&&100!==n.cropPercentage&&(i=i*n.cropPercentage/100,a=a*n.cropPercentage/100),i=Math.min(Math.round(i),e),a=Math.min(Math.round(a),t),i=Math.max(1,i),a=Math.max(1,a);return{x:Math.round((e-i)/2),y:Math.round((t-a)/2),width:i,height:a}},this.drawCanvas=function(){const e=n.canvas.width,t=n.canvas.height,i=n.canvas.getContext("2d");if(i.clearRect(0,0,e,t),this.bIsInteractive&&n.video.srcObject&&(n.showCropBar||n.ratio)){const e=n.captureWindow();i.globalAlpha=.6,i.strokeStyle="#FFFF00",i.lineWidth=3,i.strokeRect(e.x,e.y,e.width,e.height)}},this.screenshot=function(){const e=n.captureWindow(),t=document.createElement("canvas");t.width=e.width,t.height=e.height;t.getContext("2d").drawImage(n.video,e.x,e.y,e.width,e.height,0,0,e.width,e.height);const a=t.toDataURL("image/jpeg");modelsHiddenParams[i].screenshotBase64=a,modelsHiddenParams[i].screenshotMimeType="image/jpeg",modelsHiddenParams[i].screenshotData=a.replace("data:image/jpeg;base64,","")},this.handleSliderColors=function(){var e="#slider-crop"+t;$(e).find("div").css("background-color",modelsParameters[i].buttonDefaultColor),$(e).find("a").css("background-color",modelsParameters[i].buttonActiveColor),$(e).find("a").hover((function(){$(this).css("background-color",modelsParameters[i].buttonHoverColor)}),(function(){$(this).css("background-color",modelsParameters[i].buttonActiveColor)}))},this.rescale=function(){this.render()},this.render=function(){const a=document.createElement("div");let o="border: 1px solid black; ";this.bIsInteractive||(o+="background-color: lightgrey; opacity: 0.2 "),videoHeightPx=$("#"+e).height()-45;let r='<div id="videoContainer'+t+'" style="text-align: center; align: center; width: inherit; height: inherit;">';if(r+='<div style="display: flex;">',r=r+'<div style="margin: 0 auto; position: relative; height: '+(videoHeightPx+2)+"px; "+o+'; flex: 100%;">',r=r+'<video id="video'+t+'" class="videostream" style="position: absolute; top: 0; left: 0;" width="100%" height="'+videoHeightPx+'px" autoplay></video>',r=r+'<canvas id="canvas'+t+'" style="max-width: 100%; max-height: 100%; position: absolute; top: 0; left: 0; z-index: 10;"></canvas>',r+="</div>",r=r+'<div id="cropbar'+t+'" style="flex: 5px;" hidden><div class="v-slider-div-div" id="slider-crop'+t+'" style="height: '+(videoHeightPx+2)+'px;"></div></div>',r+="</div>",r+='<div style="display:table; width:100%"><div class="container"><div style="margin: 0px" class="row">',r=r+'<div class="col-3" style="padding: 1px"><button id="video-capture-button-'+t+'">start</button></div>',r=r+'<div class="col-6" style="padding: 1px"><button id="video-screenshot-button-'+t+'">screenshot</button></div>',r=r+'<div class="col-3" style="padding: 1px"><button id="video-crop-button-'+t+'">crop</button></div>',r+="</div></div></div></div>",a.innerHTML=r,a.setAttribute("style","width: inherit; height: inherit; text-align:center; align: center"),$("#"+e).html(a),this.setButtonColorStyle(),this.bIsInteractive?n.enable():n.disable(),$("#slider-crop"+t).slider({orientation:"vertical",range:"min",min:0,max:100,value:100,slide:function(e,t){n.cropPercentage=t.value,n.drawCanvas()}}),$("#cropbar"+t).hide(),this.handleSliderColors(),n.video=document.getElementById("video"+t),n.canvas=document.getElementById("canvas"+t),modelsParameters[i].enforceCaptureRatio?n.ratio=modelsParameters[i].captureRatio:n.ratio&&delete n.ratio,this.bIsInteractive){const e=document.getElementById("video-capture-button-"+t);e.onclick=function(){n.video.srcObject?n.video.paused?(n.video.play(),e.textContent="stop"):(n.video.pause(),e.textContent="start"):navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}).then(t=>{n.handleSuccess(t),e.textContent="stop"}).catch(n.handleError)};document.getElementById("video-crop-button-"+t).onclick=function(){n.toggleCrop()};document.getElementById("video-screenshot-button-"+t).onclick=function(){_.isUndefined(n.video)||(modelsParameters[i].pauseOnCapture&&(n.video.pause(),e.textContent="start"),n.screenshot(),n.base64Image.updateCallback(n.base64Image,n.base64Image.getValue()),n.mimeType.updateCallback(n.mimeType,n.mimeType.getValue()),n.imageData.updateCallback(n.imageData,n.imageData.getValue()))}}};const s=new WidgetActuatorDescription("base64Image","Sceenshot as a data URL",WidgetActuatorDescription.WRITE,WidgetPrototypesManager.SCHEMA_STRING),d=new WidgetActuatorDescription("mimeType","MIME type of the screenshot",WidgetActuatorDescription.WRITE,WidgetPrototypesManager.SCHEMA_STRING),l=new WidgetActuatorDescription("imageData","Sceenshot image raw data encoded as base 64",WidgetActuatorDescription.WRITE,WidgetPrototypesManager.SCHEMA_STRING);this.getActuatorDescriptions=function(){return[s,d,l]},this.base64Image={updateCallback:function(){},setValue:function(e){},getValue:function(){return modelsHiddenParams[i].screenshotBase64},addValueChangedHandler:function(e){this.updateCallback=e,n.enable()},removeValueChangedHandler:function(e){n.disable()}},this.mimeType={updateCallback:function(){},setValue:function(e){},getValue:function(){return modelsHiddenParams[i].screenshotMimeType},addValueChangedHandler:function(e){this.updateCallback=e,n.enable()},removeValueChangedHandler:function(e){n.disable()}},this.imageData={updateCallback:function(){},setValue:function(e){},getValue:function(){return modelsHiddenParams[i].screenshotData},addValueChangedHandler:function(e){this.updateCallback=e,n.enable()},removeValueChangedHandler:function(e){n.disable()}},n.render()},this.videoAnnotationWidget.prototype=baseWidget.prototype,this.pluginDefinition={name:"annotation",widgetsDefinitionList:{annotationIconInfo:{factory:"iconInfoAnnotationWidget",title:"Info",icn:"info"},annotationLabel:{factory:"labelAnnotationWidget",title:"Label",icn:"label",help:"wdg/wdg-annotation-video/#label"},annotationImage:{factory:"imageAnnotationWidget",title:"Image",icn:"image",help:"wdg/wdg-annotation-video/#image"},annotationVideo:{factory:"videoAnnotationWidget",title:"Camera",icn:"camera",help:"wdg/wdg-annotation-video/#camera"}}},this.constructor()}modelsHiddenParams.annotationIconInfo={},modelsHiddenParams.annotationLabel={},modelsHiddenParams.annotationImage={fileContentBase64:"",mimeType:"",widthPx:100,heightPx:100,ratio:1},modelsHiddenParams.annotationVideo={screenshotBase64:"",screenshotMimeType:"",screenshotData:""},modelsParameters.annotationIconInfo={text:"Type texte",enableActuator:!1,fontSize:"medium",fontWeight:"bold",fontFamily:"var(--widget-font-family)",textColor:"var(--widget-button-text)",textPadding:10,tipBackgroundColor:"var(--widget-button-color)",tipBorderColor:"var(--widget-button-text)",tipWidth:200,tipPositions:["right"],tipEventTrigger:"hover",iconColor:"var(--widget-label-color)",iconSize:1,iconSign:"info-circle",cornerRadius:10,spikeLength:15,spikeGirth:5},modelsParameters.annotationLabel={text:"Type texte",enableActuator:!1,fontsize:.5,backgroundColor:"rgba(0, 0, 0, 0)",textColor:"var(--widget-label-color)",valueFontFamily:"var(--widget-font-family)",textAlign:"left",displayBorder:!1,borderColor:"var(--widget-border-color)",centerVertically:!0},modelsParameters.annotationImage={keepRatio:!0,hideImageURL:!1,enableActuator:!1},modelsParameters.annotationVideo={enforceCaptureRatio:!1,captureRatio:1,pauseOnCapture:!1,buttonTextColor:"var(--widget-button-text)",buttonDefaultColor:"var(--widget-button-color)",buttonActiveColor:"var(--widget-button-active-color)",buttonHoverColor:"var(--widget-button-active-color)"},modelsLayout.annotationIconInfo={height:"4vh",width:"2vw"},modelsLayout.annotationLabel={height:"5vh",width:"12vw",minWidth:"5px",minHeight:"5px"},modelsLayout.annotationImage={height:"20vh",width:"17vw"},modelsLayout.annotationVideo={height:"30vh",width:"20vw"},annotationWidgetsPluginClass.prototype=basePlugin.prototype;var annotationWidgetsPlugin=new annotationWidgetsPluginClass;widgetsPluginsHandler.loadWidgetPlugin(annotationWidgetsPlugin);
var scalingManager=function(h,t,e){var i=this;function w(h){switch(i.method){case"scaleTwSp":return i.scaleTwSp(h);case"scaleTwSpWS":return i.scaleTwSpWS(h);case"scaleTwSd":return i.scaleTwSd(h);case"scaleTwh":return i.scaleTwh(h);case"scaleTwhS":return i.scaleTwhS(h);case"scaleIdent":default:return i.scaleIdent(h)}}return i.srcDash=h,i.tgDash=t,i.method=e,this.scaleTwSp=function(h){if(_.isUndefined(i.srcDash))return h;var t={},e=i.tgDash,w=i.srcDash;return t.widthVw=h.widthVw/w.widthVw*e.widthVw,t.leftVw=h.leftVw/w.widthVw*e.widthVw,t.heightVh=h.heightVh*(w.heightPx/w.widthPx)*(e.widthPx/e.heightPx)*(e.heightVh/w.heightVh),t.topVh=h.topVh*(w.heightPx/w.widthPx)*(e.widthPx/e.heightPx)*(e.heightVh/w.heightVh),t},this.scaleTwSpWS=function(h){if(_.isUndefined(i.srcDash))return h;var t={},e=i.tgDash,w=i.srcDash;return t.widthVw=h.widthVw/w.scrollWidthVw*e.widthVw,t.leftVw=h.leftVw/w.scrollWidthVw*e.widthVw,t.heightVh=h.heightVh*(w.heightPx/w.scrollWidthPx)*(e.widthPx/e.heightPx)*(e.heightVh/w.heightVh),t.topVh=h.topVh*(w.heightPx/w.scrollWidthPx)*(e.widthPx/e.heightPx)*(e.heightVh/w.heightVh),t},this.scaleTwSd=function(h){if(_.isUndefined(i.srcDash))return h;var t={},e=i.tgDash,w=i.srcDash;return t.widthVw=h.widthVw/w.widthVw*e.widthVw,t.leftVw=h.leftVw/w.widthVw*e.widthVw,h.widthPx=h.widthVw/w.widthVw*w.widthPx,h.heightPx=h.heightVh/w.heightVh*w.heightPx,h.topPx=h.topVh/w.heightVh*w.heightPx,t.heightPx=h.heightPx,t.topPx=h.topPx,t},this.scaleTwh=function(h){if(_.isUndefined(i.srcDash))return h;var t={},e=i.tgDash,w=i.srcDash;return t.widthVw=h.widthVw/w.widthVw*e.widthVw,t.leftVw=h.leftVw/w.widthVw*e.widthVw,t.heightVh=h.heightVh/w.heightVh*e.heightVh,t.topVh=h.topVh/w.heightVh*e.heightVh,t},this.scaleTwhS=function(h){if(_.isUndefined(i.srcDash))return h;var t={},e=i.tgDash,w=i.srcDash;return t.widthVw=h.widthVw/w.scrollWidthVw*e.widthVw,t.leftVw=h.leftVw/w.scrollWidthVw*e.widthVw,t.heightVh=h.heightVh/w.scrollHeightVh*e.heightVh,t.topVh=h.topVh/w.scrollHeightVh*e.heightVh,t},this.scaleIdent=function(h){if(_.isUndefined(i.srcDash))return h;var t={};i.tgDash,i.srcDash;return t.widthVw=h.widthVw,t.leftVw=h.leftVw,t.heightVh=h.heightVh,t.topVh=h.topVh,t},{setMethod:function(h){i.method=h},scale:w,applyRescale:function(h){var t,e,i,V,s,d,r,n;if(h.nodeType==Node.ELEMENT_NODE)for(t=h.style.width,s=rmUnit(t),V=h.style.left,d=rmUnit(V),e=h.style.height,r=rmUnit(e),i=h.style.top,n=w({widthVw:s,leftVw:d,heightVh:r,topVh:rmUnit(i)}),h.style.width=n.widthVw+"vw",h.style.left=n.leftVw+"vw",h.style.height=n.heightVh+"vh",h.style.top=n.topVh+"vh",wcChildren=h.getElementsByTagName("div"),k=0;k<wcChildren.length;k++)-1!=wcChildren[k].id.search("WidgetContainer")&&(wcChildren[k].style.width=n.widthVw-100/document.documentElement.clientWidth*2+"vw",wcChildren[k].style.height=n.heightVh-100/document.documentElement.clientHeight*2+"vh")}}};
var inputHandler={encodeInputPars:function(a){return btoa(JSON.stringify(a))},decodeInputPars:function(a){try{return JSON.parse(atob(a))}catch(a){return console.log(a),null}},patchInputVariables:function(a,t){return _.each(t,t=>{a=function(a,t,e){let n=!1;_.isUndefined(a.data.datanodes)&&(a.data.datanodes=a.data.datasources);for(var d=0;d<a.data.datanodes.length;d++)a.data.datanodes[d].name==t&&(n=!0,"JSON_var_plugin"==a.data.datanodes[d].type?a.data.datanodes[d].settings.json_var=JSON.stringify(e):console.log("patchVariableDataNode failed : dataNode "+t+"  is not a variable"));return n||console.log("patchVariableDataNode failed : unable to find dataNode "+t),a}(a,t.dsName,t.dsVal)}),a}};
var rescaleHelper=function(e,t,i){var o=this;function s(){switch(o.mode){case"edit":return"";case"preview":return"c"}}function r(){var e="";switch(o.mode){case"edit":break;case"preview":e="c"}if(o.rows){const t=o.cols*o.rows;switch(o.scalingMethod){case"scaleTwhS":for(let i=1;i<=t;i++)$("#dpr"+i+e)[0].style.height="100%";break;case"scaleTwSp":for(let t=1;t<=o.rows;t++){const i=o.cellProportion[t],s=(t-1)*o.cols+1,r=$("#dpr"+s+e).width(),n=Math.floor(i*r)+2;for(let t=0;t<o.cols;t++)$("#dpr"+(s+t)+e)[0].style.height=n+"px"}break;case"scaleTwh":case"scaleIdent":for(let e=1;e<=o.rows;e++){o.cols;for(let e=0;e<o.cols;e++);}}switch(o.mode){case"edit":layoutMgr.updateMaxTopAndLeft()}}}function n(){let e=null;const t=$("#dpr1"+s());switch(o.rows){case 0:break;case 1:if(e={widthPx:t.width()+2,heightPx:t.height()+2,widthVw:100*(t.width()+2)/document.documentElement.clientWidth,heightVh:100*(t.height()+2)/document.documentElement.clientHeight},"undefined"!=typeof layoutMgr){const t=layoutMgr.getHeightCols();e.rowHeightPercent=t.length?t[0]:100}break;default:if(e={widthPx:t.width()+16,heightPx:t.height()+2,widthVw:100*(t.width()+16)/document.documentElement.clientWidth,heightVh:100*(t.height()+2)/document.documentElement.clientHeight},"undefined"!=typeof layoutMgr){const t=layoutMgr.getHeightCols();e.rowHeightPercent=t.length?t[0]:100}}return e}function d(){switch(o.rows){case 0:o.cellProportion=1;break;default:o.cellProportion=[];for(let e=1;e<=o.rows;e++){const t=1+(e-1)*o.cols,i=$("#dpr"+t+s());o.cellProportion[e]=i.height()/i.width()}}}return o.dashboardDimensions=e,o.scalingMethod=t,o.mode=i,o.cellProportion=1,o.rows=0,o.cols=1,{setDimensions:function(e){o.dashboardDimensions=e},setScalingMethod:function(e){o.scalingMethod=e},setRows:function(e){o.rows=e},setCols:function(e){o.cols=e},getCols:function(){return o.cols},resizeDashboard:function(e){r();var t=function(){switch(o.mode){case"edit":return widgetEditor.getCurrentDashZoneDims();case"preview":return widgetPreview.getCurrentDashZoneDims()}}(o.mode);_.isUndefined(e)||(t=e);var i=new scalingManager(o.dashboardDimensions,t,o.scalingMethod);o.dashboardDimensions=t;const n=function(){switch(o.mode){case"edit":return document.getElementById("drop-zone");case"preview":return document.getElementById("dashboard-zone")}}(o.mode);for(let e=0;e<n.childNodes.length;e++){const t=n.childNodes[e];if(t.id=="DropperDroite"+s(o.mode))for(let e=0;e<t.childNodes.length;e++){const s=t.childNodes[e];if(""===s.id)return;if($("#"+s.id).hasClass("device-col"))for(let e=0;e<s.childNodes.length;e++){let t;t="edit"==o.mode?s.childNodes[e].childNodes[0]:s.childNodes[e],i.applyRescale(t)}else{let e;e="edit"==o.mode?s.childNodes[0]:s,i.applyRescale(e)}}}},resizeWidgetOnMediaChange:function(e,t){const i=function(){switch(o.mode){case"edit":return widgetEditor.getWidgetsRelativeDims().width;case"preview":return widgetPreview.getWidgetsRelativeDims().width}}(),s=function(){switch(o.mode){case"edit":return widgetEditor.getWidgetsRelativeDims().height;case"preview":return widgetPreview.getWidgetsRelativeDims().height}}(),r=function(){switch(o.mode){case"edit":return widgetEditor.getWidgetsRelativeDims().left;case"preview":return widgetPreview.getWidgetsRelativeDims().left}}(),n=function(){switch(o.mode){case"edit":return widgetEditor.getWidgetsRelativeDims().top;case"preview":return widgetPreview.getWidgetsRelativeDims().top}}(),d=$("#"+t)[0];let c=0,h=0,l=0,a=0;switch(o.mode){case"edit":c=$(d.parentNode.parentNode).width()*i[e]+2,h=$(d.parentNode.parentNode).height()*s[e]+2,l=$(d.parentNode.parentNode).width()*r[e],a=$(d.parentNode.parentNode).height()*n[e];break;case"preview":c=$(d.parentNode).width()*i[e]+2,h=$(d.parentNode).height()*s[e]+2,l=$(d.parentNode).width()*r[e],a=$(d.parentNode).height()*n[e]}const g=rmUnit(unitW(c)),w=rmUnit(unitH(h)),u=rmUnit(unitW(l)),m=rmUnit(unitH(a));d.style.left=u+"vw",d.style.top=m+"vh",d.style.width=g+"vw",d.style.height=w+"vh"},getCurrentDropperDims:n,resizeDashboardCols:r,mediaChangeProjection:function(e,t,i){var o,s=e,r=isMediaChanged(e.media);return r.bChanged,o=r.lastMedia,i?(s.widthVw=e.colDims.widthVw,s.widthPx=e.colDims.widthPx,s.scrollWidthVw=e.colDims.widthVw,s.scrollWidthPx=e.colDims.widthPx,s.heightVh=e.colDims.heightVh,s.heightPx=e.colDims.heightPx,s.scrollHeightVh=e.colDims.heightVh,s.scrollHeightPx=e.colDims.heightPx,{lastMedia:o,referenceFrame:s,targetFrame:t=n()}):{lastMedia:o,referenceFrame:s,targetFrame:t}},setCellProportion:function(e){o.cellProportion=e},updateCellsProportions:d,computeRelativeColHeigth:function(e){var t=100,i=e.heightPx;if(_.isUndefined(e.colDims.heightPx))return 100;switch(t=e.colDims.heightPx,o.scalingMethod){case"scaleTwhS":return 100;case"scaleTwSp":return Math.ceil((t+2)/i*100);case"scaleTwh":case"scaleIdent":return Math.ceil((t+2)/i*100)}},deserialize:function(e){if(!_.isUndefined(e)){if(e.colDims)switch(o.rows){case 0:o.cellProportion=1;break;default:o.cellProportion=[];for(let t=1;t<=o.rows;t++)o.cellProportion[t]=e.colDims.heightPx/e.colDims.widthPx}switch(e.scalingMethod){case"scaleTwSp":break;case"scaleTwh":case"scaleIdent":for(var t=1;t<=o.rows;t++)for(var i=(t-1)*o.cols+1,r=0;r<o.cols;r++)$("#dpr"+(i+r)+s())[0].style.height=e.colDims.heightVh+"vh";d()}}}}};
var widgetConnector=function(){var e=[];function t(){const e=angular.element(document.body).injector();e&&e.has("EventCenterService")&&e.invoke(["EventCenterService",e=>{e.sendEvent(EVENTS_EDITOR_CONNECTIONS_CHANGED)}])}function n(){for(const t in e)widgetEditor.widgetContainers.get(e[t].id)||delete e[t];for(const[t,n]of widgetEditor.widgetContainers)if(e[t]){if(widgetEditor.widgetObject[t]){if(!_.isNull(e[t].widgetObjEdit)&&!_.isNull(widgetEditor.widgetObject[t])){let n=e[t].widgetObjEdit.numberOfTriggers-widgetEditor.widgetObject[t].numberOfTriggers;for(;n>0;){let i=Object.keys(e[t].sliders);delete e[t].sliders[i[i.length-1]],n--}}e[t].widgetObjEdit=widgetEditor.widgetObject[t]}}else e[t]={name:t,id:t,instanceId:t,modelJsonId:n.modelJsonId,sliders:[],widgetObjEdit:widgetEditor.widgetObject[t],widgetObjConnect:null};t()}function i(){for(const t in e)d(t);t()}function d(t){const n=e[t];for(const e in n.sliders){const t=n.sliders[e];t.dataNode="None",t.dataFields.length=0}}function o(){for(const t in e)delete e[t];i()}return{widgetsConnection:e,updateWidgetsConnections:n,effectiveSliders:function(){let t=[];return _.each(_.keys(e),n=>{let i=_.keys(e[n].sliders);for(let e=0;e<i.length;e++)_.isEmpty(i[e])||t.push(i[e])}),_.uniq(t)},resetSingleMatchingBox:i,serialize:function(){const t={};for(const n in e){t[n]={};for(const i in e[n].sliders)t[n][i]=jQuery.extend(!0,{},e[n].sliders[i])}return t},deserialize:function(i){o(),n();for(var d=[],r=0;r<datanodesManager.getAllDataNodes().length;r++)d[r]=datanodesManager.getAllDataNodes()[r].name();for(const t in e)for(const n in i[t])_.isUndefined(i[t][n].dataNode)&&(i[t][n].dataNode=i[t][n].dataSource,delete i[t][n].dataSource),e[t].sliders[n]=i[t][n];for(let t in e)try{widgetPreview.plotConstantData(t,!1)}catch(e){console.error(e)}t()},clear:o,duplicateConnection:function(n,i){e[n]=jQuery.extend(!0,{},e[i.id]),e[n].id=n,e[n].name=n,e[n].instanceId=n,t()},refreshDatanodeConsumers:function(t,n,i,d){for(const o in e){const r=e[o];for(const e in r.sliders){const s=r.sliders[e];if("None"!=s.name){let a=null;null!=r.widgetObjEdit?a=r.widgetObjEdit.getByName(s.name):null!=r.widgetObjConnect&&(a=r.widgetObjConnect.getByName(s.name)),null!=a&&(s.dataNode===n?"Python_pyodide_plugin"==datanodesManager.getDataNodeByName(n).type()&&"fig"===e?widgetPreview.setDataOnWidget(o,e,a,n,i,d,!1):widgetPreview.setDataOnWidget(o,e,a,t,i,d,!1):s.dataNode)}}}}}}();
function displaySpinnerOnInputFileButton(e){const t=this,n=document.getElementById("button"+e),o=document.getElementById("button"+e+"_select_file"),a=document.createElement("i");let i;this.disableButton=function(){n.classList.add("disabled"),a.setAttribute("id","icon"+e),a.setAttribute("class","fa fa-spinner fa-spin"),n.append(a)},this.enableButton=function(){n.classList.remove("disabled"),a&&a.remove()},this.disableButton(),o.onchange=function(){clearTimeout(i),document.body.focus(),t.enableButton()},document.body.onfocus=function(){i=setTimeout(()=>{t.enableButton(),document.body.onfocus=null},200)}}function updateDataSourceFromWidget(e,t){if(_.isUndefined(widgetConnector.widgetsConnection[e]))return;const n=widgetConnector.widgetsConnection[e].sliders,o=[];if(!_.isUndefined(n)){for(const e in n){const t=n[e].dataNode;"None"!==t&&o.push(datanodesManager.getDataNodeByName(t).name())}o.length>0&&datanodesManager.getDataNodeByName(o[0]).schedulerStart(o,o[0],"triggerButton")}}function updateDataNodeFromWidgetwithspinButton(e,t){if(_.isUndefined(widgetConnector.widgetsConnection[e]))return;const n=widgetConnector.widgetsConnection[e].sliders,o=[];if(!_.isUndefined(n)){for(let e in n){const t=n[e].dataNode;"None"!=t&&o.push(datanodesManager.getDataNodeByName(t).name())}if(o.length>0){const n=document.getElementById("button"+t),a=document.createElement("i");a.setAttribute("id","icon"+t),datanodesManager.getDataNodeByName(o[0]).schedulerStart(o,o[0],"triggerButton");const i=setInterval((function(){const d=[];o.forEach(e=>{"Pending"==datanodesManager.getDataNodeByName(e).status()&&($("#button"+t).attr("class","btn btn-table-cell btn-lg disabled"),d.push(!0),$(a).hasClass("fa fa-spinner fa-spin")||a.setAttribute("class","fa fa-spinner fa-spin"),n.contains(a)||n.append(a))}),0==d.length&&($("#button"+t).attr("class","btn btn-table-cell btn-lg "+e+"widgetCustomColor "),_.isUndefined($("#icon"+t)[0])||$("#icon"+t)[0].remove(),a.remove(),clearInterval(i))}),100)}}}function updateDataNodeFileFromWidget(e,t){if(!_.isUndefined(widgetConnector.widgetsConnection[e])){var n=widgetConnector.widgetsConnection[e].sliders;if(!_.isUndefined(n))for(var o in n){let e=n[o].dataNode;"None"!=e&&datanodesManager.getDataNodeByName(e).isSetFileValid()&&datanodesManager.getDataNodeByName(e).setFile(t)}}}
var widgetPreview=function(){var e,t=[],n="scaleTwh",o=0,i=1,d=new rescaleHelper(e,n,"preview"),a=[],s=[],l=[],r=[],c="",g={};function u(){return{widthPx:$("#dashboard-zone").width(),heightPx:$("#dashboard-zone").height(),scrollWidthPx:$("#dashboard-zone")[0].scrollWidth,scrollHeightPx:$("#dashboard-zone")[0].scrollHeight,widthVw:100*$("#dashboard-zone").width()/document.documentElement.clientWidth,heightVh:100*$("#dashboard-zone").height()/document.documentElement.clientHeight,scrollWidthVw:100*$("#dashboard-zone")[0].scrollWidth/document.documentElement.clientWidth,scrollHeightVh:100*$("#dashboard-zone")[0].scrollHeight/document.documentElement.clientHeight,scalingMethod:n}}function f(){for(let e in t)for(let n of widgetConnector.effectiveSliders())null!=t[e]&&null!=t[e].getByName(n)&&(slider=t[e].getByName(n),slider.addValueChangedHandler(v))}function C(e,n){_.each(_.keys(e.dashboard),e=>{let o=document.getElementById(e+"c"),i=e.substring(0,e.length-1),d=o.firstElementChild.id;t[e]=n?widgetsPluginsHandler.createWidget(d,i,e,!0):widgetsPluginsHandler.copyWidget(d,i,null,e,!0),function(e){$("#"+e+"c")[0].style.position="absolute",$("#"+e+"c")[0].style.border="1px solid rgba(255, 255, 255, 0)"}(e),null!=widgetConnector.widgetsConnection[e]&&(widgetConnector.widgetsConnection[e].widgetObjEdit=null,widgetConnector.widgetsConnection[e].widgetObjConnect=t[e],m(e,!1))}),d.updateCellsProportions(),_.each(_.keys(t),e=>{!function(e,t){a[e]=$("#"+t).width()/$("#"+$("#"+t)[0].parentNode.id).width(),s[e]=$("#"+t).height()/$("#"+$("#"+t)[0].parentNode.id).height(),l[e]=$("#"+t).position().left/$("#"+$("#"+t)[0].parentNode.id).width(),r[e]=$("#"+t).position().top/$("#"+$("#"+t)[0].parentNode.id).height(),c=getMedia()}(e,e+"c")})}function m(e,t){var n=null;if(_.isUndefined(widgetConnector.widgetsConnection[e]))console.log("connection of "+e+" is undefned");else for(var o in widgetConnector.widgetsConnection[e].sliders)if(b(e),"None"!=widgetConnector.widgetsConnection[e].sliders[o].name&&(n=null,null!=widgetConnector.widgetsConnection[e].widgetObjEdit?n=widgetConnector.widgetsConnection[e].widgetObjEdit.getByName(widgetConnector.widgetsConnection[e].sliders[o].name):null!=widgetConnector.widgetsConnection[e].widgetObjConnect&&(n=widgetConnector.widgetsConnection[e].widgetObjConnect.getByName(widgetConnector.widgetsConnection[e].sliders[o].name)),null!=n))if("None"!=widgetConnector.widgetsConnection[e].sliders[o].dataNode){let i=widgetConnector.widgetsConnection[e].sliders[o].dataNode;if("None"!=i)if(_.isUndefined(datanodesManager.getDataNodeByName(i)))msg="Invalid connection with data",p(e,o,msg);else{let d=datanodesManager.getDataNodeByName(i).latestData(),a=datanodesManager.getDataNodeByName(i).name(),s=datanodesManager.getDataNodeByName(i).status(),l=datanodesManager.getDataNodeByName(i).last_updated();"Python_pyodide_plugin"==datanodesManager.getDataNodeByName(a).type()&&"fig"==o?y(e,o,n,a,s,l,t):y(e,o,n,d,s,l,t)}else msg="Invalid connection with data",p(e,o,msg)}else $("#collapse-matching-box").hasClass("collapse in")&&widgetPreview.clearDataFromWidget(e,o,n,!0)}function p(e,t,n){if(!g[e]){var o=widgetConnector.widgetsConnection[e].instanceId+"c";_.isUndefined($("#"+o)[0])||"3px groove #e40000"!=$("#"+o)[0].style.border&&(w=parseFloat($("#"+o)[0].style.width)+1,h=parseFloat($("#"+o)[0].style.height)+1,$("#"+o)[0].style.width=w+"vw",$("#"+o)[0].style.height=h+"vh",$("#"+o)[0].style.border="3px groove #e40000",$("#"+o)[0].style.borderRadius="6px",$("#"+o)[0].style.background="rgba(255, 0, 0, 0.26)",$("#"+o).append('<br/><span style="color:red">'+n+' "'+widgetConnector.widgetsConnection[e].sliders[t].dataNode+'" !</span>')),g[e]=!0}}function b(e){var t=widgetConnector.widgetsConnection[e].instanceId+"c";if(!_.isUndefined($("#"+t)[0])&&"1px solid rgba(255, 255, 255, 0)"!=$("#"+t)[0].style.border){w=parseFloat($("#"+t)[0].style.width)-1,h=parseFloat($("#"+t)[0].style.height)-1,$("#"+t)[0].style.width=w+"vw",$("#"+t)[0].style.height=h+"vh",$("#"+t)[0].style.border="1px solid rgba(255, 255, 255, 0)",$("#"+t)[0].style.borderRadius="",$("#"+t)[0].style.background="";for(var n=0;n<$("#"+t)[0].childNodes.length;n++)"span"==$("#"+t)[0].childNodes[n].localName&&$("#"+t)[0].childNodes[n].remove()}g[e]=!1}function y(e,t,n,o,i,d,a){if(_.isUndefined(o)&&"never"!=d||"Error"==i)return msg="Invalid data",void p(e,t,msg);if(b(e),!_.isUndefined(o)&&!_.isNull(o)){const i=widgetConnector.widgetsConnection[e].sliders[t];let d=o,s=i.dataNode;for(let e=0;e<i.dataFields.length;e++){const t=i.dataFields[e];"string"==typeof t&&t.includes(" ... ")||(s=t,"object"==typeof d&&(d=_.isNull(d)||_.isUndefined(d)?o[s]:d[s]))}if(null===d)widgetPreview.clearDataFromWidget(e,t,n,!0);else if("D"===i.name.substring(0,1))try{n.setText(d)}catch(e){console.log("setText got exception with data '"+i.dataNode+"'. "+e)}else{if(!_.isUndefined(n.setCaption))try{n.setCaption(s,a)}catch(e){console.log("setCaption got exception with data '"+i.dataNode+"'. "+e)}if(!_.isUndefined(n.setValue))try{n.setValue(d)}catch(e){console.log("setValue got exception with data '"+i.dataNode+"'. "+e)}}}}function v(e,t){var n=null;if(0==datanodesManager.getAllDataNodes().length);else{var o=!1;for(var i in widgetConnector.widgetsConnection)for(var d in widgetConnector.widgetsConnection[i].sliders)if(null!=widgetConnector.widgetsConnection[i].widgetObjConnect&&null!=widgetConnector.widgetsConnection[i].widgetObjConnect.getByName(widgetConnector.widgetsConnection[i].sliders[d].name)&&e==widgetConnector.widgetsConnection[i].widgetObjConnect.getByName(widgetConnector.widgetsConnection[i].sliders[d].name)){o=!0,n=widgetConnector.widgetsConnection[i].sliders[d];break}if(o&&"None"!=n.dataNode){let t=datanodesManager.getDataNodeByName(n.dataNode);if(_.isUndefined(t))console.log("data was removed or data index was modified!");else if(t.isSetValueValid()&&!_.isUndefined(e.getValue))try{t.setValue(n.dataFields,e.getValue())}catch(e){console.log("setValue got exception with data: "+t.name()+". "+e.message)}else console.log("setValue is not possible with data: "+t.name())}}}function N(){e=u(),d.setDimensions(e);var n,o=isMediaChanged(c);n=o.bChanged,c=o.lastMedia,n?_.each(_.keys(t),e=>{let n=e+"c";d.resizeWidgetOnMediaChange(e,n),function(e){let n=e+"c";for(var o=document.getElementById(n),i=o.id.substring(0,o.id.length-2),d=(e=o.id.substring(0,o.id.length-1),o.firstElementChild),a=o.childNodes.length-1;a>=0;a--)o.removeChild(o.childNodes[a]);var s=document.createElement("div");s.style.height=unitH(o.offsetHeight-2),s.style.width=unitW(o.offsetWidth-2),s.style.minWidth=parseFloat(o.style.minWidth)-5+"px",s.style.minHeight=parseFloat(o.style.minHeight)-5+"px",o.appendChild(s),s.id=d.id;var l=d.id;t[e]=widgetsPluginsHandler.copyWidget(l,i,t[e],e,!0),g[e]=!1}(e),null!=widgetConnector.widgetsConnection[e]&&(widgetConnector.widgetsConnection[e].widgetObjConnect=t[e],m(e))}):_.each(_.keys(t),e=>{rescaleWidget(t,e)})}function x(){for(var e in t)delete t[e];for(var e in $("#dashboard-zone").html(""),a)delete a[e];for(var e in s)delete s[e];for(var e in l)delete l[e];for(var e in r)delete r[e];c=""}return{loadPlayMode:function(){x(),e=widgetEditor.getSnapshotDashZoneDims(),d.setDimensions(e),d.setScalingMethod(n),d.setRows(o),d.setCols(i),C(function(){var e=xdash.serialize();e.scaling=widgetEditor.getSnapshotDashZoneDims();var t=document.getElementById("dashboard-zone"),n=document.createElement("div");return n.id="DropperDroitec",n.className="dropperR",n.style.zIndex=0,n.style.borderRadius="10px",t.appendChild(n),reconstructFoundations.buildDivsFromXprjson(e),e}(),!1),0!=datanodesManager.getAllDataNodes().length&&f()},renderDashboardWidgets:C,updateDataFromWidget:v,resizeDashboard:function(e){if("undefined"!=typeof execOutisdeEditor&&execOutisdeEditor){var t=0;switch($("#nav-menu")[0]&&(t=parseInt($("#nav-menu")[0].style.height),isNaN(t)&&(t=0)),jsonContent.exportOptions){case"rowToPage":rowToPageRuntime.rowToPagePrepareRescale(o,i);break;case"rowToTab":rowToTabRuntime.rowToTabPrepareRescale(o,i);break;case"customNavigation":customNavigationRuntime.customNavigationPrepareRescale(o,i);break;case"keepOriginalWidth":$("#dashboard-zone")[0].style.height=scalingSrc.scrollHeightPx+t+"px";break;default:$("#dashboard-zone")[0].style.height=document.body.clientHeight-t+"px"}}d.setScalingMethod(n),d.setRows(o),d.setCols(i),d.resizeDashboard(e),N(),"undefined"!=typeof execOutsideEditor&&execOutsideEditor&&"rowToPage"==jsonContent.exportOptions&&setTimeout(rowToPageRuntime.rowToPageFinishRescale,500,o,i)},resizeDashboardCols:function(){d.resizeDashboardCols()},widget:t,plotConstantData:m,assignValueChangeHandlers:f,rescale:N,clear:function(){x(),htmlExport.exportOptions="ajustToTargetWindow"},deserialize:function(e){let t;for(t in _.each(_.keys(e),e=>{let t=e.substring(0,e.length-1),n=e+"c";null==widgetConnector.widgetsConnection[e]&&(widgetConnector.widgetsConnection[e]={name:n,id:n,instanceId:e,modelJsonId:t,sliders:[],widgetObjEdit:null,widgetObjConnect:null})}),widgetConnector.widgetsConnection)for(var n in e[t])_.isUndefined(e[t][n].dataNode)&&(e[t][n].dataNode=e[t][n].dataSource,delete e[t][n].dataSource),widgetConnector.widgetsConnection[t].sliders[n]=e[t][n];for(t in widgetConnector.widgetsConnection)try{widgetPreview.plotConstantData(t,!1),widgetConnector.widgetsConnection[t].widgetObjEdit=null}catch(e){}},setDataOnWidget:y,clearDataFromWidget:function(e,t,n,o){"D"===widgetConnector.widgetsConnection[e].sliders[t].name.substring(0,1)?n.setText(""):(!_.isUndefined(n.clearCaption)&&o&&n.clearCaption(),_.isUndefined(n.setValue)||n.setValue(null))},getCurrentDashZoneDims:u,getSnapshotDashZoneDims:function(){return e},getWidgetsRelativeDims:function(){return{width:a,height:s,left:l,top:r}},setScalingInformation:function(e,t,a,s){null!=e&&(d.setDimensions(e),null!=e.colDims&&d.deserialize(e)),null!=t&&(n=t,d.setScalingMethod(n)),null!=a&&(o=a,d.setRows(o)),null!=s&&(i=s,d.setCols(i))},getCols:function(){return d.getCols()},mediaChangeProjection:function(e,t,n){return d.mediaChangeProjection(e,t,n)},toPng:function(){var e=function(){var e,n,o=0,i=0,d=$("#dashboard-zone").offset().left,a=$("#dashboard-zone").offset().top,s=$("#dashboard-zone").height();for(var l in t)(e=$("#"+l+"c").offset().left-d+$("#"+l+"c").width())>o&&(o=e),(n=$("#"+l+"c").offset().top-a+$("#"+l+"c").height())>i&&(i=n),i>s&&(i=s);return{right:o,bottom:i}}(),n=document.getElementById("dashboard-zone"),o=n.style.height,i=n.style.width;n.style.height=e.bottom+"px",n.style.width=e.right+"px",html2canvas(n,{allowTaint:!1,useCORS:!0}).then((function(t){var d=Canvas2Image.convertToPNG(t,e.right,e.bottom),a=document.createElement("a");a.setAttribute("download",$("#projectName")[0].value+".png"),a.setAttribute("href",d.src.replace("image/png","image/octet-stream")),a.click(),n.style.height=o,n.style.width=i}))},elevateZIndex:function(e,n){var o=0;_.each(Object.keys(t),(function(e){var t=Number($("#"+e+"c")[0].style["z-index"]);t>o&&(o=t)})),$("#"+e+"c")[0].style["z-index"]=o+1}}}();
var pyodideLib={serialize:function(){const{standardLibs:i,micropipLibs:d}=pyodideManager.getProjectLibs();return{pyodideStandard:i.sort(),pyodideMicropip:d.sort()}},deserialize:async function(i){_.isUndefined(i.data.datanodes)&&(i.data.datanodes=i.data.datasources);const d=i.data.datanodes;let a=!1,o={standardLibs:[],micropipLibs:[]};if(d.forEach(i=>{"Python_pyodide_plugin"===i.type&&(a=!0)}),a){const i=pyodideManager.getDefaultLibs();for(const d in o)o[d]=_.union(o[d],i[d])}if(!_.isUndefined(i.libraries)){const{pyodideStandard:d,pyodideMicropip:a}=i.libraries,e={standardLibs:d,micropipLibs:a};for(const i in o)o[i]=_.union(o[i],e[i])}await pyodideManager.loadPyodideLibs(o)}};
var runtimeToolbar={toolbar:['<div class="top-nav" ng-if="showNavBar">','   <nav class="top-nav__menu" id="nav-menu">','       <ul class="top-nav__nav">','           <li class="top-nav__nav-item">','               <a class="top-nav__brand" target="_blank" href="'+xDashConfig.urlWebSite+'" title="Chalk\'it website">',"                   Powered by Chalk'it",'                   <img src="'+xDashConfig.urlBaseForExport+'assets/img/chalk-it-icon.svg" />',"               </a>","           </li>",'           <li ng-if="showPagination && (exportOptions == \'rowToPage\')" class="top-nav__nav-item top-nav__nav-item--row-to-page">\n                  <button class="top-nav__btn top-nav__btn--rounded" ng-click="rowToPageChange(\'previous\')">\n                    <i class="fa fa-chevron-left" aria-hidden="true"></i>\n                  </button>\n                  <div class="top-nav__title">Page {{pageNumber}} / {{totalPages}}</div>\n                  <button class="top-nav__btn top-nav__btn--rounded" ng-click="rowToPageChange(\'next\')">\n                    <i class="fa fa-chevron-right" aria-hidden="true"></i>\n                  </button>\n                </li>\n                <li ng-if="showPagination && (exportOptions == \'rowToTab\')" class="top-nav__nav-item top-nav__nav-item--row-to-tab">\n                  <div class="top-nav__btn-wrapper" ng-repeat="pageName in pageNames">\n                    <button id="btn-page-{{$index + 1}}" class="btn btn-rounded-fill primary" ng-class="{\'cancel\': pageNumber != $index + 1}"  ng-click="rowToTabChange($index + 1)">\n                      {{pageName}}\n                    </button>\n                  </div>\n                </li>',"       </ul>","       <ul class='top-nav__nav top-nav__nav--right'>",'            <li class="top-nav__nav-item dropdown" ng-if="navBarNotification">','                <a class="dropdown-toggle info-number" data-toggle="dropdown" aria-expanded="false">','                    <i class="fa fa-envelope-o" aria-hidden="true"></i>','                    <span class="badge bg-red">{{nbNotifications}}</span>',"                </a>",'                <ul id="menu1" class="dropdown-menu list-unstyled top-nav__msg-list" role="menu">',"                    <form>",'                        <li class="top-nav__msg-item" ng-if="nbNotifications">','                            <div class="text-center">','                                <div ng-show="!searchFrom" style="display: inline-block; width:80%;margin:13px">','                                    <h3 style="margin:0; line-height:normal"> Notifications list</h3>',"                                </div>","                            </div>","                        </li>",'                        <li class="top-nav__msg-item" ng-if="nbNotifications>shownNotificationsMax">','                            <div class="text-center">',"                                <strong>..too many notifications! Please acquit a few to display more.</strong>","                            </div>","                        </li>",'                        <li class="top-nav__msg-item" ng-repeat="notification in listNotifications | limitTo:- 100 |orderBy:-$index " ',"                            ng-show=\"!notification.hide&&(notification.dataNode.indexOf(notificationFilterDataValue)>=0||notificationFilterDataValue=='')\">",'                            <a class="top-nav__msg-link" ng-click="hideNotificationFromNavBar(notification)" title="Click to acquit this notification">','                                <span class="image"><img ng-src="{{urlBase+notification.img}}" alt="error Message"></span>',"                                <span>","                                    <span>{{notification.title || 'Error'}}</span>","                                <span class=\"data\">{{'Data: '}} {{notification.dataNode}}</span>","                                </span>","                                <span class=\"message\">{{notification.text + '. '}}</span>",'                                <span class="time">{{notification.time}}</span>',"                            </a>","                        </li>",'                        <li class="top-nav__msg-item text-center" ng-if="nbNotifications">','                            <a ng-click="clearAllNotifications()">',"                                <strong>Clear All Notifications</strong>",'                                <i class="fa fa-angle-right"></i>',"                            </a>","                        </li>","                    </form>","                </ul>","            </li>","        </ul>","    </nav>","</div>",""]};
var rowToPageRuntime=function(){const e=this;function o(){return e.grid}function r(o){e.grid=o}return e.grid={rows:1,cols:1},{rowToPagePrepareRescale:function(e,s){let{rows:c,cols:t}=o();c=Number(e)||1,t=Number(s)||1,r({rows:c,cols:t}),c>1&&$("[id^=dpr][id$=c]").show()},rowToPageFinishRescale:function(e,s){const c=angular.element(document.body).scope().$root.pageNumber;let{rows:t,cols:i}=o();if(t=Number(e)||1,i=Number(s)||1,r({rows:t,cols:i}),t>1)if($("[id^=dpr][id$=c]").hide(),i>1){const e=c*i;for(let o=e-i+1;o<=e;o++)$("#dpr"+o+"c").show()}else $("#dpr"+c+"c").show()},rowToPageModeInit:function(e){const s=angular.element(document.body).scope().$root;let{rows:c,cols:t}=o();if(c=Number(e.device.cols.valueRow)||1,t=Number(e.device.cols.valueCol)||1,r({rows:c,cols:t}),s.pageNumber=1,s.totalPages=c,s.showPagination=!0,s.exportOptions=e.exportOptions,s.$apply(),c>1)if($("[id^=dpr][id$=c]").hide(),t>1)for(let e=1;e<=t;e++)$("#dpr"+e+"c").show();else $("#dpr"+s.pageNumber+"c").show();s.rowToPageChange=function(e){let o=!0,r="";switch(e){case"previous":o=s.pageNumber>1,r="-";break;case"next":o=s.pageNumber<s.totalPages,r="+"}if(o){switch($("[id^=dpr][id$=c]").hide(),r){case"-":s.pageNumber-=1;break;case"+":s.pageNumber+=1}if(t>1){const e=s.pageNumber*t;for(let o=e-t+1;o<=e;o++)$("#dpr"+o+"c").show()}else $("#dpr"+s.pageNumber+"c").show()}}}}}();
var rowToTabRuntime=function(){const o=this;function e(){return o.grid}function r(e){o.grid=e}return o.grid={rows:1,cols:1},{rowToTabPrepareRescale:function(o,s){let{rows:c,cols:i}=e();c=Number(o)||1,i=Number(s)||1,r({rows:c,cols:i}),c>1&&$("[id^=dpr][id$=c]").show()},rowToTabFinishRescale:function(o,s){const c=angular.element(document.body).scope().$root.pageNumber;let{rows:i,cols:n}=e();if(i=Number(o)||1,n=Number(s)||1,r({rows:i,cols:n}),$("#page-"+c).removeClass("cancel").addClass("primary"),i>1)if($("[id^=dpr][id$=c]").hide(),n>1){const o=c*n;for(let e=o-n+1;e<=o;e++)$("#dpr"+e+"c").show()}else $("#dpr"+c+"c").show()},rowToTabModeInit:function(o){const s=angular.element(document.body).scope().$root;let{rows:c,cols:i}=e();if(c=Number(o.device.cols.valueRow)||1,i=Number(o.device.cols.valueCol)||1,r({rows:c,cols:i}),s.pageNumber=1,s.pageNames=o.pages.pageNames,s.showPagination=!0,s.exportOptions=o.exportOptions,s.$apply(),c>1)if($("[id^=dpr][id$=c]").hide(),i>1)for(let o=1;o<=i;o++)$("#dpr"+o+"c").show();else $("#dpr"+s.pageNumber+"c").show();s.rowToTabChange=function(o){if(s.pageNumber=o,$("[id^=dpr][id$=c]").hide(),i>1){const e=o*i;for(let o=e-i+1;o<=e;o++)$("#dpr"+o+"c").show()}else $("#dpr"+o+"c").show()}}}}();
var customNavigationRuntime=function(){const o=this;function e(){return o.grid}function t(e){o.grid=e}return o.jsonContent={},o.grid={rows:1,cols:1},{customNavigationPrepareRescale:function(o,s){let{rows:n,cols:r}=e();n=Number(o)||1,r=Number(s)||1,t({rows:n,cols:r}),n>1&&$("[id^=dpr][id$=c]").show()},customNavigationModeInit:function(o){const s=Number(o.pages.defaultPage.id);let{rows:n,cols:r}=e();if(n=Number(o.device.cols.valueRow)||1,r=Number(o.device.cols.valueCol)||1,t({rows:n,cols:r}),n>1)if($("[id^=dpr][id$=c]").hide(),r>1){const o=s*r;for(let e=o-r+1;e<=o;e++)$("#dpr"+e+"c").show()}else $("#dpr"+s+"c").show()},setJsonContent:function(e){o.jsonContent=e},customNavigationGoToPage:function(s){const n=angular.element(document.body).scope().$root;if(n.pageNumber=s,"undefined"!=typeof layoutMgr&&!n.bIsPlayMode)return;const r=o.jsonContent;let i="",{rows:c,cols:l}=e();if(_.isEmpty(r)?(c=layoutMgr.getRows()||1,l=layoutMgr.getCols()||1,i=htmlExport.exportOptions):(c=Number(r.device.cols.valueRow)||1,l=Number(r.device.cols.valueCol)||1,i=r.exportOptions),t({rows:c,cols:l}),c>1)if("projectToTargetWindow"==i){$("#dpr"+s*l+"c")[0].scrollIntoView(!1)}else if($("[id^=dpr][id$=c]").hide(),l>1){const o=s*l;for(let e=o-l+1;e<=o;e++)$("#dpr"+e+"c").show()}else $("#dpr"+s+"c").show()}}}();
var xDashApi={setVariable:function(a,e){const t=JSON.parse(JSON.stringify(e));let n=datanodesManager.getDataNodeByName(a);n.notificationCallback("warning",a,"Deprecated feature: please rename 'xDashApi' by 'chalkit'"),n.setValue([],t,!0)},setVariables:function(a,e){for(let t=0;t<a.length;t++){let n=datanodesManager.getDataNodeByName(a[t]);0==t&&n.notificationCallback("warning",a[0],"Deprecated feature: please rename 'xDashApi' by 'chalkit'");const i=JSON.parse(JSON.stringify(e[t]));n.setValue([],i,!0)}},getVariable:function(a){datanodesManager.getDataNodeByName(a).notificationCallback("error",a,"Deprecated feature: 'getVariable' feature is no longer supported")},setVariableProperty:function(a,e,t){const n=JSON.parse(JSON.stringify(t));let i=datanodesManager.getDataNodeByName(a);i.notificationCallback("warning",a,"Deprecated feature: please rename 'xDashApi' by 'chalkit'"),i.setValue(e,n,!0)},executeDataNode:function(a){datanodesManager.getDataNodeByName(a).notificationCallback("warning",a,"Deprecated feature: please rename 'xDashApi' by 'chalkit'")},executeDataNodes:function(a){datanodesManager.getDataNodeByName(a[0]).notificationCallback("warning",a[0],"Deprecated feature: please rename 'xDashApi' by 'chalkit'")},viewProject:function(a,e,t){var n=xDashConfig.urlBaseForExport,i=!1;"999"==xDashConfig.version.minor&&(i=!0);var o="";i||(o="-"+xDashConfig.version.fullVersion);var r=n+"index-view"+o+".html?projectUrl="+a+"&inputParams="+inputHandler.encodeInputPars(e);t?window.open(r,"_blank"):window.location=r},viewPage:function(a,e,t){var n=a+"?inputParams="+inputHandler.encodeInputPars(e);t?window.open(n,"_blank"):window.location=n},goToPage:function(a){customNavigationRuntime.customNavigationGoToPage(a)}};
var chalkit={setVariable:function(e,n){const a=JSON.parse(JSON.stringify(n));datanodesManager.getDataNodeByName(e).setValue([],a,!0)},setVariables:function(e,n){for(let a=0;a<e.length;a++){let t=datanodesManager.getDataNodeByName(e[a]);const o=JSON.parse(JSON.stringify(n[a]));t.setValue([],o,!0)}},setVariableProperty:function(e,n,a){const t=JSON.parse(JSON.stringify(a));datanodesManager.getDataNodeByName(e).setValue(n,t,!0)},executeDataNode:function(e){},executeDataNodes:function(e){},viewProject:function(e,n,a){const t=xDashConfig.urlBaseForExport;let o=!1;"999"==xDashConfig.version.minor&&(o=!0);let i="";o||(i="-"+xDashConfig.version.fullVersion);const s=t+"index-view"+i+".html?projectUrl="+e+"&inputParams="+inputHandler.encodeInputPars(n);a?window.open(s,"_blank"):window.location=s},viewPage:function(e,n,a){const t=e+"?inputParams="+inputHandler.encodeInputPars(n);a?window.open(t,"_blank"):window.location=t},goToPage:function(e){customNavigationRuntime.customNavigationGoToPage(e)}};
!function(e){e.fn.hasVScrollBar=function(){return this.get(0).scrollHeight>this.height()},e.fn.hasHScrollBar=function(){return this.get(0).scrollWidth>this.width()},e.fn.computeRatio=function(){return this.get(0).scrollWidth/this.width()}}(jQuery);var RuntimeDashboard=function(){var e;function a(a,o){e=jQuery.extend(!0,{},a.scaling);var s=0;switch($("#nav-menu")[0]&&(s=parseInt($("#nav-menu")[0].style.height),isNaN(s)&&(s=0)),o){case"keepOriginalWidth":$("#dashboard-zone")[0].style.width=e.scrollWidthPx+"px",$("#dashboard-zone")[0].style.height=e.scrollHeightPx+s+"px",e.scalingMethod="scaleTwSp";break;case"adjustToFullWidth":$("#dashboard-zone")[0].style.width="100%",$("#dashboard-zone")[0].style.height=document.body.clientHeight-s+"px",e.scalingMethod="scaleTwSpWS";break;case"ajustToTargetWindow":$("#dashboard-zone")[0].style.width="100%",$("#dashboard-zone")[0].style.height=document.body.clientHeight-s+"px",e.scalingMethod="scaleTwh";break;case"projectToTargetWindow":case"customNavigation":case"rowToTab":case"rowToPage":$("#dashboard-zone")[0].style.width="100%",$("#dashboard-zone")[0].style.height=document.body.clientHeight-s-1+"px",e.scalingMethod="scaleTwhS";break;default:$("#dashboard-zone")[0].style.width="100%",$("#dashboard-zone")[0].style.height="100%"}if($("#dashboard-zone")[0].style.margin="auto",$("#dashboard-zone")[0].style["overflow-x"]="hidden",$("#dashboard-zone")[0].style["overflow-y"]="hidden",$("#DropperDroitec")[0].style.height="100%",$("#DropperDroitec")[0].style.width="100%",$("#DropperDroitec")[0].style["overflow-y"]="auto",_.isUndefined(a.device))a.device={cols:{valueRow:"none",valueCol:"1",maxCells:0,maxCols:0,classType:""}};else{if(_.isUndefined(a.device.cols.valueRow))if(_.isUndefined(a.device.cols.value))a.device.cols.valueRow="none";else switch(a.device.cols.value){case"none":a.device.cols.valueRow="none";break;case"1":case"3":a.device.cols.valueRow="1";break;case"6":a.device.cols.valueRow="6";break;default:a.device.cols.valueRow="none"}if(_.isUndefined(a.device.cols.valueCol))if(_.isUndefined(a.device.cols.value))a.device.cols.valueCol="1";else switch(a.device.cols.value){case"none":case"1":a.device.cols.valueCol="1";break;case"3":case"6":a.device.cols.valueCol="3";break;default:a.device.cols.valueCol="1"}}const i=a.device.cols.maxCols,t=a.device.cols.maxCells/(i||1);var d=jQuery.extend(!0,{},e),r=widgetPreview.getCurrentDashZoneDims();widgetPreview.setScalingInformation(d,e.scalingMethod,t,i),widgetPreview.resizeDashboardCols();var n=widgetPreview.mediaChangeProjection(d,r,t);d=n.referenceFrame,r=n.targetFrame,widgetPreview.setScalingInformation(d,e.scalingMethod,t,i),widgetPreview.resizeDashboard(r)}return{initContainers:a,loadDashboard:async function(e,o){var s=$("<textarea />").html(JSON.stringify(e.data)).text(),i="";try{i=JSON.parse(s)}catch(e){return void swal("JSON Parse error",e.message,"error")}for(var t in await pyodideLib.deserialize(e),datanodesManager.load(i,!0),a(e,o),e.dashboard)if(_.isEmpty(e.dashboard[t].modelParameters)||(modelsParameters[t]=e.dashboard[t].modelParameters),_.isEmpty(e.dashboard[t].modelHiddenParams)||(modelsHiddenParams[t]=e.dashboard[t].modelHiddenParams),_.isUndefined(modelsTempParams[t])){var d=t.substring(0,t.length-1);modelsTempParams[t]=jQuery.extend(!0,{},modelsTempParams[d])}switch(!!_.isUndefined(e.meta.schedulerLogOff)||e.meta.schedulerLogOff,$("html").attr("data-theme",e.device.theme),widgetPreview.deserialize(e.connections),widgetPreview.renderDashboardWidgets(e,!0),$(".dropperR").css("background-color",e.device.backgroundColor),e.exportOptions){case"rowToPage":rowToPageRuntime.rowToPageModeInit(e);break;case"rowToTab":rowToTabRuntime.rowToTabModeInit(e);break;case"customNavigation":customNavigationRuntime.customNavigationModeInit(e);break;case"projectToTargetWindow":customNavigationRuntime.setJsonContent(e)}setTimeout(()=>{widgetPreview.assignValueChangeHandlers()},2e3)}}}();
var reconstructFoundations=function(){var e=401;function t(e){var t=document.getElementById("DropperDroitec");_.isUndefined(e.scaling)?(t.style.width="100",t.style.height="100"):(t.style.width=e.scaling.widthVw,t.style.height=e.scaling.heightVh),function(e){var t,i,n;if(_.isUndefined(e.device)?(t="",i=0,n=0):(t=e.device.cols.classType,i=e.device.cols.maxCells,n=e.device.cols.maxCols),0!=i)for(var r=document.getElementById("DropperDroitec"),o=i/n,a=1;a<=o;a++)for(var d=1+(a-1)*n;d<=a*n;d++){var s=document.createElement("div");s.setAttribute("class",t+" device-col"),s.setAttribute("id","dpr"+d+"c"),s.style.height=e.scaling.colDims.heightVh+"vh",r.appendChild(s),$("#dpr"+d+"c").hasClass("col-invisible")||$("#dpr"+d+"c").addClass("col-invisible")}}(e)}function i(t,i){var n=document.getElementById(i),r=function(t){var i=document.createElement("div");i.id=t.container.instanceId+"c",i.style.top=t.layout.top,i.style.left=t.layout.left,i.style.width=t.layout.width,i.style.height=t.layout.height,_.isUndefined(t.layout["z-index"])||(i.style["z-index"]=t.layout["z-index"]);i.style.position="absolute",i.style.cursor="default";var n=document.createElement("div");return n.id="WidgetContainer"+e+"c",e++,n.style.width=rmUnit(t.layout.width)-100/document.documentElement.clientWidth*2+"vw",n.style.height=rmUnit(t.layout.height)-100/document.documentElement.clientHeight*2+"vh",i.appendChild(n),i}(t);n.appendChild(r)}function n(e){reconstructFoundations.buildDivsFromXprjson(e);var t=e.exportOptions;_.isUndefined(e)||_.isUndefined(e.meta)||(document.title=e.meta.name),RuntimeDashboard.loadDashboard(e,t)}function r(e){var t=findGetParameter("inputParams");if(null!=t){var i=inputHandler.decodeInputPars(t);e=inputHandler.patchInputVariables(e,i)}}return{buildDivsFromXprjson:function(e){t(e),function(e){var t;if(!!_.isEmpty(e.device)||!!_.isEmpty(e.device.droppers))for(t in e.dashboard)i(e.dashboard[t],"DropperDroitec");else for(var n in e.device.droppers){var r=_.values(e.device.droppers[n]);for(var o in r)i(e.dashboard[r[o]],n+"c")}}(e)},loadXprjson:function(e){var t=findGetParameter("projectUrl");if(null==t){var i=e;e=r(e),n(i)}else $.get(t,(function(e){})).done((function(i){var o;try{o=JSON.parse(i),e=r(o),n(o)}catch(e){swal("Unable to parse "+t+" project",e,"error"),$(".wrapperloading").hide()}})).fail((function(e,t){datanodesManager.showLoadingIndicator(!1),swal("Error in loading xprjson from URL","Server response : "+e.status,"error")}))}}}();
var xdashNotifications=function(){var t=null,a=null;function e(){t&&a||(t=angular.element(document.body),(a=t.scope().$root).pageScalingMethod="ajustToTargetWindow")}return{addNotification:function(t,n){e(),a.notificationsDisabled||t.title&&t.text&&t.type&&(a.PnotifyStatus=!1,a.listNotifications.unshift(t),a.nbNotifications++,n||a.PnotifyStatus||(a.PnotifyStatus=!0,setTimeout((function(){a.PnotifyStatus=!1,function(t){let a=new PNotify({title:t.title,text:t.text,type:t.type,delay:1800,styling:"bootstrap3"});$(".ui-pnotify-container").on("click",(function(){a.remove()}))}(t)}),300)),a.safeApply())},manageNotification:function(t,n,i,o){if(e(),a.navBarNotification){var s="",c="",d="",r=!0;switch(t){case"warning":s="warning",c="Warning",d="assets/img/flat-icon/warning.png";break;case"success":s="success",c="Success",d="assets/img/flat-icon/success.png";break;case"error":s="error",c="Error",d="assets/img/flat-icon/error.png";break;default:s="info",c="Info",d="assets/img/flat-icon/info.png"}if(!_.isUndefined(datanodesManager.getDataNodeByName(n))){if(_.isUndefined(datanodesManager.getDataNodeByName(n).__notifications)&&(datanodesManager.getDataNodeByName(n).__notifications=[]),o){r=!1;var f="none";datanodesManager.getDataNodeByName(n).__notifications.length>0&&(f=datanodesManager.getDataNodeByName(n).__notifications[datanodesManager.getDataNodeByName(n).__notifications.length-1].type),"error"!==f&&"warning"!==f||(r=!0)}if(r){datanodesManager.getDataNodeByName(n).__notifications.push({type:s,title:c,text:i,kind:"dataNode",dataNode:n,img:d,time:(new Date).timeNow()});var g=!1,N="";null!==datanodesManager.getDataNodeByName(n).execInstance()&&(N=datanodesManager.getDataNodeByName(n).execInstance().getSchedulerCallOrigin()),datanodesManager.getDataNodeByName(n).sampleTime()<"60"&&"timer"==N&&(g=!0),xdashNotifications.addNotification({type:s,title:c,text:i,kind:"dataNode",dataNode:n,img:d,time:(new Date).timeNow()},g)}}}},clearAllNotifications:function(){e(),a.listNotifications=[],a.nbNotifications=0,a.safeApply()}}}();